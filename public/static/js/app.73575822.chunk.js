(this.webpackJsonp=this.webpackJsonp||[]).push([[0],{373:function(e,n,t){"use strict";t.d(n,"a",(function(){return fi}));var r=t(374),a=t(0),l=t.n(a),i=t(488),o=t(172),s=t(318),u=t(304),c=t(132),d=t(2),m=t(315),f=t(4),p=t.n(f),g=t(17),v=t(178),b=t(322),y=t(323),h=t(59),E=t(42),S=t(240),x=t(245),I=t(332),k=t.n(I),O=t(126),z=t(262),w=t(106),C=t(127);function j(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function P(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?j(Object(t),!0).forEach((function(n){p()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):j(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var $=P(P(P({},w.a),O.a),{},{colors:P(P({},w.a.colors),O.a.colors)}),T=P(P(P({},C.a),z.a),{},{colors:P(P({},C.a.colors),z.a.colors)}),F={currentUser:null,currentDropzone:null,permissions:[],credentials:null,theme:$,isDarkMode:!1},N=Object(E.b)({name:"global",initialState:F,reducers:{setCredentials:function(e,n){e.credentials=n.payload},setUser:function(e,n){e.currentUser=n.payload},setPermissions:function(e,n){e.permissions=n.payload},setPrimaryColor:function(e,n){e.theme.colors.primary=n.payload},setAccentColor:function(e,n){e.theme.colors.accent=n.payload},setDropzone:function(e,n){var t,r,a,l;(e.currentDropzone=n.payload,null!=(t=e.currentDropzone)&&t.primaryColor)&&(e.theme.colors.primary=null==(a=e.currentDropzone)?void 0:a.primaryColor);null!=(r=e.currentDropzone)&&r.secondaryColor&&(e.theme.colors.accent=null==(l=e.currentDropzone)?void 0:l.secondaryColor)},toggleDarkMode:function(e){var n,t,r,a;(e.isDarkMode=!e.isDarkMode,e.theme=e.isDarkMode?T:$,null!=(n=e.currentDropzone)&&n.primaryColor)&&(e.theme.colors.primary=null==(r=e.currentDropzone)?void 0:r.primaryColor);null!=(t=e.currentDropzone)&&t.secondaryColor&&(e.theme.colors.accent=null==(a=e.currentDropzone)?void 0:a.secondaryColor)},logout:function(e){for(var n in F){var t=n;n in e&&(e[t]=F[t])}}}}),D=t(13),M=Object(E.b)({name:"notifications",initialState:{queue:[]},reducers:{hideSnackbar:function(e){e.queue=e.queue.slice(1)},showSnackbar:function(e,n){e.queue.push(n.payload)}}}),A={fields:{email:{value:"",error:null},password:{value:"",error:null}}},U=Object(E.b)({name:"login",initialState:A,reducers:{setEmail:function(e,n){e.fields.email.value=n.payload},setPassword:function(e,n){e.fields.password.value=n.payload},setEmailError:function(e,n){e.fields.email.error=n.payload},setPasswordError:function(e,n){e.fields.password.error=n.payload},reset:function(e){e.fields=A.fields}}}),q=t(7),W=t.n(q),B={federation:null,fields:{email:{value:"",error:null},password:{value:"",error:null},passwordConfirmation:{value:"",error:null},exitWeight:{value:50,error:null},name:{value:"",error:null},phone:{value:"",error:null},license:{value:null,error:null}}},R=Object(E.b)({name:"login",initialState:B,reducers:{setFederation:function(e,n){e.federation=n.payload},setField:function(e,n){var t=W()(n.payload,2),r=t[0],a=t[1];e.fields[r].value=a,e.fields[r].error=null},setFieldError:function(e,n){var t=W()(n.payload,2),r=t[0],a=t[1];e.fields[r].error=a},reset:function(e){e.fields=B.fields}}}),L={isSearchVisible:!1,searchText:""},H=Object(E.b)({name:"usersScreen",initialState:L,reducers:{setSearchText:function(e,n){e.searchText=n.payload},setSearchVisible:function(e,n){e.isSearchVisible=n.payload},reset:function(e){e.isSearchVisible=L.isSearchVisible,e.searchText=L.searchText}}}),Q={original:null,fields:{federation:{value:null,error:null},name:{value:"",error:null},secondaryColor:{value:"",error:null},primaryColor:{value:"",error:null},banner:{value:"",error:null},isCreditSystemEnabled:{value:!1,error:null},isPublic:{value:!1,error:null}}},V=Object(E.b)({name:"dropzone",initialState:Q,reducers:{setField:function(e,n){var t=W()(n.payload,2),r=t[0],a=t[1];e.fields[r].value=a,e.fields[r].error=null},setFieldError:function(e,n){var t=W()(n.payload,2),r=t[0],a=t[1];r in e.fields&&e.fields[r].error&&(e.fields[r].error=a)},setOriginal:function(e,n){for(var t in e.original=n.payload,n.payload)if(t in e.fields){var r=t;e.fields[r].value=n.payload[r]}},reset:function(e){e.fields=Q.fields,e.original=null}}}),J={original:null,fields:{name:{value:"",error:null},registration:{value:"",error:null},minSlots:{value:0,error:null},maxSlots:{value:4,error:null},hours:{value:null,error:null},nextMaintenanceHours:{value:null,error:null}}},G=Object(E.b)({name:"Plane",initialState:J,reducers:{setField:function(e,n){var t=W()(n.payload,2),r=t[0],a=t[1];e.fields[r].value=a,e.fields.name.error=null},setFieldError:function(e,n){var t=W()(n.payload,2),r=t[0],a=t[1];e.fields[r].error=a},setOriginal:function(e,n){e.original=n.payload,e.fields.hours.value=n.payload.hours,e.fields.minSlots.value=n.payload.minSlots,e.fields.maxSlots.value=n.payload.maxSlots,e.fields.name.value=n.payload.name,e.fields.registration.value=n.payload.registration,e.fields.nextMaintenanceHours.value=n.payload.nextMaintenanceHours},reset:function(e){e.fields=J.fields,e.original=null}}}),_={original:null,fields:{name:{value:"",error:null},cost:{value:null,error:null},altitude:{value:14e3,error:null},allowManifestingSelf:{value:!1,error:null},extraIds:{value:[],error:null}}},Y=Object(E.b)({name:"ticketTypeForm",initialState:_,reducers:{setField:function(e,n){var t=W()(n.payload,2),r=t[0],a=t[1];e.fields[r].value=a,e.fields[r].error=null},setFieldError:function(e,n){var t=W()(n.payload,2),r=t[0],a=t[1];e.fields[r].error=a},setOriginal:function(e,n){e.original=n.payload,e.fields.altitude.value=n.payload.altitude,e.fields.cost.value=n.payload.cost,e.fields.allowManifestingSelf.value=n.payload.allowManifestingSelf,e.fields.name.value=n.payload.name},reset:function(e){e.fields=_.fields,e.original=null}}}),Z={original:null,fields:{name:{value:"",error:null},cost:{value:null,error:null},ticketTypeIds:{value:[],error:null}}},K=Object(E.b)({name:"ExtraForm",initialState:Z,reducers:{setField:function(e,n){var t=W()(n.payload,2),r=t[0],a=t[1];e.fields[r].value=a,e.fields.name.error=null},setFieldError:function(e,n){var t=W()(n.payload,2),r=t[0],a=t[1];e.fields[r].error=a},setOriginal:function(e,n){e.original=n.payload,e.fields.ticketTypeIds.value=n.payload.ticketTypes.map((function(e){var n=e.id;return Number(n)})),e.fields.cost.value=n.payload.cost,e.fields.name.value=n.payload.name},reset:function(e){e.fields=Z.fields,e.original=null}}}),X={original:null,fields:{name:{value:"",error:null},gca:{value:null,error:null},dispatchAt:{value:null,error:null},isOpen:{value:!0,error:null},loadMaster:{value:null,error:null},pilot:{value:null,error:null},plane:{value:null,error:null},maxSlots:{value:4,error:null}}},ee=Object(E.b)({name:"loadForm",initialState:X,reducers:{setField:function(e,n){var t=W()(n.payload,2),r=t[0],a=t[1];e.fields[r].value=a,e.fields[r].error=null},setFieldError:function(e,n){var t=W()(n.payload,2),r=t[0],a=t[1];e.fields[r].error=a},setOriginal:function(e,n){for(var t in e.original=n.payload,n.payload)if(t in e.fields){var r=t;e.fields[r].value=n.payload[r]}},reset:function(e){e.fields=X.fields,e.original=null}}}),ne={original:null,fields:{jumpType:{value:null,error:null},extras:{value:[],error:null},load:{value:null,error:null},rig:{value:null,error:null},ticketType:{value:null,error:null},user:{value:null,error:null},exitWeight:{value:null,error:null}}},te=Object(E.b)({name:"slotForm",initialState:ne,reducers:{setField:function(e,n){var t=W()(n.payload,2),r=t[0],a=t[1];e.fields[r].value=a,e.fields[r].error=null},setFieldError:function(e,n){var t=W()(n.payload,2),r=t[0],a=t[1];e.fields[r].error=a},setOriginal:function(e,n){for(var t in e.original=n.payload,n.payload)if(t in e.fields){var r=t;e.fields[r].value=n.payload[r]}},reset:function(e){e.fields=ne.fields,e.original=null}}}),re={original:null,federation:{value:null,error:null},fields:{exitWeight:{value:"",error:null},email:{value:"",error:null},phone:{value:"",error:null},name:{value:null,error:null},rigs:{value:[],error:null},license:{value:null,error:null}}},ae=Object(E.b)({name:"userForm",initialState:re,reducers:{setFederation:function(e,n){e.federation.value=n.payload},setField:function(e,n){var t=W()(n.payload,2),r=t[0],a=t[1];e.fields[r].value=a,e.fields[r].error=null},setFieldError:function(e,n){var t=W()(n.payload,2),r=t[0],a=t[1];e.fields[r].error=a},setOriginal:function(e,n){var t;for(var r in e.original=n.payload,e.federation.value=null==(t=n.payload.license)?void 0:t.federation,n.payload)if(r in e.fields){var a=r;e.fields[a].value=n.payload[a]}},reset:function(e){e.fields=re.fields,e.original=null}}}),le={original:null,fields:{role:{value:null,error:null},credits:{value:0,error:null},expiresAt:{value:null,error:null}}},ie=Object(E.b)({name:"dropzoneUserForm",initialState:le,reducers:{setField:function(e,n){var t=W()(n.payload,2),r=t[0],a=t[1];e.fields[r].value=a,e.fields[r].error=null},setFieldError:function(e,n){var t=W()(n.payload,2),r=t[0],a=t[1];e.fields[r].error=a},setOriginal:function(e,n){for(var t in e.original=n.payload,n.payload)if(t in e.fields){var r=t;e.fields[r].value=n.payload[r]}},reset:function(e){e.fields=le.fields,e.original=null}}}),oe={original:null,fields:{make:{value:"",error:null},model:{value:"",error:null},serial:{value:"",error:null},repackExpiresAt:{value:null,error:null},canopySize:{value:null,error:null}}},se=Object(E.b)({name:"rigForm",initialState:oe,reducers:{setField:function(e,n){var t=W()(n.payload,2),r=t[0],a=t[1];e.fields[r].value=a,e.fields[r].error=null},setFieldError:function(e,n){var t=W()(n.payload,2),r=t[0],a=t[1];e.fields[r].error=a},setOriginal:function(e,n){for(var t in e.original=n.payload,n.payload)if(t in e.fields){var r=t;e.fields[r].value=n.payload[r]}},reset:function(e){e.fields=oe.fields,e.original=null}}}),ue=(U.actions,R.actions,N.actions),ce=H.actions,de=M.actions,me=(G.actions,V.actions,Y.actions,K.actions,ee.actions,te.actions),fe=ae.actions,pe=ie.actions,ge=se.actions,ve={key:"root",storage:"web"===D.a.OS?k.a:Object(S.a)(),whitelist:["global","notifications"]};console.log({localStorage:localStorage,MMKV:S.a});var be=Object(x.a)(ve,{global:N.reducer,notifications:M.reducer,login:U.reducer,signup:R.reducer,dropzoneForm:V.reducer,planeForm:G.reducer,ticketTypeForm:Y.reducer,extraForm:K.reducer,loadForm:ee.reducer,slotForm:te.reducer,userForm:ae.reducer,dropzoneUserForm:ie.reducer,rigForm:se.reducer,usersScreen:H.reducer}),ye=Object(E.a)({reducer:be}),he=Object(x.b)(ye),Ee=function(){return Object(o.b)()},Se=o.c;function xe(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function Ie(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?xe(Object(t),!0).forEach((function(n){p()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):xe(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var ke=Object(g.createHttpLink)({uri:h.a.manifest.extra.url});function Oe(e){var n=e.children,t=Se((function(e){return e.global.credentials})),r=Ee(),i=Object(a.useMemo)((function(){return Object(y.a)((function(e){var n=e.graphQLErrors,t=e.networkError;n&&n.map((function(e){var n=e.message,t=e.locations,a=e.path;return r(de.showSnackbar({message:"[GraphQL error]: "+n+", "+t+", "+a,variant:"error"}))})),t&&r(de.showSnackbar({message:"[Network error]: "+t,variant:"error"})),t&&"ServerError"===t.name&&401===t.statusCode&&r(ue.logout())}))}),[r]),o=Object(a.useMemo)((function(){return Object(b.a)((function(e,n){return{headers:Ie(Ie({},n.headers),null!=t&&t.accessToken?Ie({Authorization:"Bearer "+t.accessToken,"access-token":t.accessToken,"token-type":t.tokenType},t):{})}}))}),[JSON.stringify(t)]),s=Object(a.useMemo)((function(){return new g.ApolloClient({link:i.concat(o).concat(ke),cache:new g.InMemoryCache})}),[o]);return l.a.createElement(v.ApolloProvider,{client:s},n)}var ze=t(5),we=t.n(ze),Ce=t(483),je=t(487),Pe=t(246);function $e(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function Te(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?$e(Object(t),!0).forEach((function(n){p()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):$e(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var Fe=t(1),Ne=t(272);var De={light:{text:"#000",background:"#fff",tint:"#2f95dc",tabIconDefault:"#ccc",tabIconSelected:"#2f95dc",success:"#00C851",error:"#ff4444",warning:"#FF8800",info:"#0099CC"},dark:{text:"#fff",background:"#000",tint:"#fff",tabIconDefault:"#ccc",tabIconSelected:"#fff",success:"#00C851",error:"#ff4444",warning:"#FF8800",info:"#0099CC"}};var Me=function(){return De.light},Ae=M.actions,Ue=(Fe.a.create({container:{flex:1,justifyContent:"space-between"}}),function(){var e=Se((function(e){return e.notifications})),n=Ee(),t=Me(),r=e.queue.length?e.queue[0]:null,l={info:{backgroundColor:t.info},success:{backgroundColor:t.success},error:{backgroundColor:t.error},warning:{backgroundColor:t.warning}};return a.createElement(Ne.a,{visible:!!r,onDismiss:function(){return n(Ae.hideSnackbar())},duration:3e3,action:null==r?void 0:r.action,style:!(null==r||!r.variant)&&l[r.variant]},null==r?void 0:r.message)}),qe={prefixes:[t(375).a("/"),"dz://"],config:{screens:{Authenticated:{screens:{HomeScreen:"/home",LoadScreen:"/load/:load_id",PackingScreen:"/packing",ProfileScreen:"/user/:id",SetupScreen:"/dropzone/setup"}},Limbo:{screens:{DropzonesScreen:"/dropzones",CreateDropzoneScreen:"/dropzone/create"}},Unauthenticated:{screens:{LoginScreen:"/login",SignUpScreen:"/signup"}}}}},We=t(486),Be=t(50),Re=t(71);function Le(e){var n=e.navigation;return a.createElement(d.a,{style:Ve.container},a.createElement(Be.a,{style:Ve.title},"This screen doesn't exist."),a.createElement(Re.a,{onPress:function(){return n.replace("Root")},style:Ve.link},a.createElement(Be.a,{style:Ve.linkText},"Go to home screen!")))}var He,Qe,Ve=Fe.a.create({container:{flex:1,backgroundColor:"#fff",alignItems:"center",justifyContent:"center",padding:20},title:{fontSize:20,fontWeight:"bold"},link:{marginTop:15,paddingVertical:15},linkText:{fontSize:14,color:"#2e78b7"}}),Je=t(26),Ge=t.n(Je),_e=t(16),Ye=t(489),Ze=t(23),Ke=t.n(Ze),Xe=t(27),en=t(484),nn=t(30),tn=t(35),rn=t(222),an=t(293),ln=t(314),on=t(195),sn=t(310),un=t(181),cn=t(31),dn=t.n(cn),mn=t(39),fn=t(290),pn=t(10),gn=t(291),vn=t(292),bn=t(307),yn=t(289),hn=Object(nn.a)(He||(He=Ke()(["\n  query JumpTypes($allowedForUserId: Int) {\n    jumpTypes(allowedForUserId: $allowedForUserId) {\n      id\n      name\n    }\n  }\n"])));function En(e){var n,t,r=Object(a.useState)(!1),i=W()(r,2),o=i[0],s=i[1],u=(Se((function(e){return e.global})),Object(g.useQuery)(hn,{variables:{allowedForUserId:e.userId}})),c=u.data;u.loading,u.refetch;return l.a.createElement(l.a.Fragment,null,l.a.createElement(pn.a.Subheader,null,"Jump type"),l.a.createElement(yn.a,{onDismiss:function(){return s(!1)},visible:o,anchor:l.a.createElement(pn.a.Item,{onPress:function(){s(!0)},title:(null==(n=e.value)?void 0:n.name)||"Please select jump type",description:e.required?null:"Optional"})},null==c||null==(t=c.jumpTypes)?void 0:t.map((function(n){return l.a.createElement(pn.a.Item,{onPress:function(){s(!1),e.onSelect(n)},title:n.name||"-"})}))))}var Sn,xn=Object(nn.a)(Qe||(Qe=Ke()(["\n  query TicketTypes($allowManifestingSelf: Boolean, $dropzoneId: Int!) {\n    ticketTypes(allowManifestingSelf: $allowManifestingSelf, dropzoneId: $dropzoneId) {\n      id\n      name\n\n      extras {\n        id\n        name\n        cost\n      }\n    }\n  }\n"])));function In(e){var n,t,r,i=Object(a.useState)(!1),o=W()(i,2),s=o[0],u=o[1],c=Se((function(e){return e.global})),d=Object(g.useQuery)(xn,{variables:{dropzoneId:Number(null==(n=c.currentDropzone)?void 0:n.id),allowManifestingSelf:e.allowManifestingSelf}}),m=d.data;d.loading,d.refetch;return l.a.createElement(l.a.Fragment,null,l.a.createElement(pn.a.Subheader,null,"Ticket"),l.a.createElement(yn.a,{onDismiss:function(){return u(!1)},visible:s,anchor:l.a.createElement(pn.a.Item,{onPress:function(){u(!0)},title:(null==(t=e.value)?void 0:t.name)||"Please select ticket type",description:e.required?null:"Optional"})},null==m||null==(r=m.ticketTypes)?void 0:r.map((function(n){return l.a.createElement(pn.a.Item,{onPress:function(){u(!1),e.onSelect(n)},title:n.name||"-"})}))))}var kn,On=Object(nn.a)(Sn||(Sn=Ke()(["\nquery QueryPermissions($dropzoneId: Int!) {\n    dropzone(id: $dropzoneId) {\n      id\n      name\n      primaryColor\n      secondaryColor\n      \n      currentUser {\n        id\n        role {\n          id\n          name\n        }\n        permissions\n      }\n\n    }\n  }"])));function zn(e){var n,t,r,a=Se((function(e){return e.global})).currentDropzone,l=Object(g.useQuery)(On,{variables:{dropzoneId:Number(null==a?void 0:a.id)},fetchPolicy:"cache-first"}).data;return(null==l||null==(n=l.dropzone)||null==(t=n.currentUser)||null==(r=t.permissions)?void 0:r.includes(e))||!1}var wn=Object(nn.a)(kn||(kn=Ke()(["\n  query QueryRigs(\n    $dropzoneId: Int\n    $userId: Int\n  ) {\n    rigs(dropzoneId: $dropzoneId, userId: $userId) {\n      id\n      make\n      model\n      canopySize\n      serial\n    }\n  }\n"])));function Cn(e){var n,t,r,i,o,s=Object(a.useState)(!1),u=W()(s,2),c=u[0],d=u[1],m=Se((function(e){return e.global})),f=Object(g.useQuery)(wn,{variables:{dropzoneId:Number(null==(n=m.currentDropzone)?void 0:n.id)}}).data;return l.a.createElement(yn.a,{onDismiss:function(){return d(!1)},visible:c,anchor:l.a.createElement(pn.a.Item,{onPress:function(){d(!0)},title:e.value?(null==(t=e.value)?void 0:t.make)+" "+(null==(r=e.value)?void 0:r.model)+" ("+((null==(i=e.value)?void 0:i.canopySize)||"?")+"sqft)":"Select rig",description:e.required?null:"Optional",left:function(){return l.a.createElement(pn.a.Icon,{icon:"parachute"})}})},null==f||null==(o=f.rigs)?void 0:o.map((function(n){var t,r,a;return l.a.createElement(pn.a.Item,{onPress:function(){d(!1),e.onSelect(n)},title:(null==(t=e.value)?void 0:t.make)+" "+(null==(r=e.value)?void 0:r.model),description:(null==(a=e.value)?void 0:a.canopySize)+" sqft"})})))}var jn=te.actions;function Pn(){var e,n,t,r,l,i,o,s,u,c,d,m,f,p,g,v,b,y,h,E,S,x,I,k,O=Se((function(e){return e.slotForm})),z=Ee(),w=Se((function(e){return e.global}));a.useEffect((function(){var e,n;null!=(e=O.fields.user)&&e.value&&(O.fields.exitWeight.value||z(jn.setField(["exitWeight",Number(O.fields.user.value.exitWeight||60)])),!O.fields.rig.value&&null!=(n=O.fields.user.value.rigs)&&n.length&&z(jn.setField(["rig",O.fields.user.value.rigs[0]])))}),[null==(e=O.fields)||null==(n=e.user)||null==(t=n.value)?void 0:t.id]);var C=null==O||null==(r=O.original)?void 0:r.id,j=(null==O||null==(l=O.fields)||null==(i=l.user)||null==(o=i.value)||o.id,null==(s=w.currentUser)||s.id,zn(C?"updateSlot":"createSlot"),zn(C?"updateUserSlot":"createUserSlot"));return console.log("Fields",O.fields),a.createElement(mn.a,{style:Tn.fields,contentContainerStyle:{flexGrow:1}},a.createElement(En,{value:O.fields.jumpType.value,required:!0,userId:Number(null==O||null==(u=O.fields)||null==(c=u.user)||null==(d=c.value)?void 0:d.id)||null,onSelect:function(e){return z(jn.setField(["jumpType",e]))}}),a.createElement(fn.a,{type:O.fields.jumpType.error?"error":"info"},O.fields.jumpType.error||""),a.createElement(In,{value:O.fields.ticketType.value,required:!0,allowManifestingSelf:!j,onSelect:function(e){return z(jn.setField(["ticketType",e]))}}),a.createElement(fn.a,{type:O.fields.ticketType.error?"error":"info"},O.fields.ticketType.error||""),(null==O||null==(m=O.fields)||null==(f=m.ticketType)||null==(p=f.value)||null==(g=p.extras)?void 0:g.length)&&a.createElement(pn.a.Subheader,null,"Ticket addons"),a.createElement(mn.a,{horizontal:!0,style:Tn.ticketAddons},null==O||null==(v=O.fields)||null==(b=v.ticketType)||null==(y=b.value)||null==(h=y.extras)?void 0:h.map((function(e){var n,t,r,l;return a.createElement(gn.a,{selected:null==O||null==(n=O.fields)||null==(t=n.extras.value)?void 0:t.some((function(n){return n.id===e.id})),onPress:null!=O&&null!=(r=O.fields)&&null!=(l=r.extras.value)&&l.some((function(n){return n.id===e.id}))?function(){var n,t;return z(jn.setField(["extras",null==O||null==(n=O.fields)||null==(t=n.extras.value)?void 0:t.filter((function(n){return n.id!==e.id}))]))}:function(){var n,t;return z(jn.setField(["extras",[].concat(dn()((null==O||null==(n=O.fields)||null==(t=n.extras)?void 0:t.value)||[]),[e])]))}},e.name+" ($"+e.cost+")")}))),a.createElement(fn.a,{type:O.fields.extras.error?"error":"info"},O.fields.extras.error||""),a.createElement(vn.a,null),a.createElement(Cn,{value:O.fields.rig.value,userId:Number(null==(E=O.fields.user)||null==(S=E.value)?void 0:S.id),dropzoneId:Number(null==(x=w.currentDropzone)?void 0:x.id),onSelect:function(e){return z(jn.setField(["jumpType",e]))}}),a.createElement(fn.a,{type:O.fields.rig.error?"error":"info"},O.fields.rig.error||""),a.createElement(bn.a,{style:Tn.field,mode:"outlined",label:"Exit weight",error:!!O.fields.exitWeight.error,value:(null==(I=O.fields.exitWeight)||null==(k=I.value)?void 0:k.toString())||"",keyboardType:"numbers-and-punctuation",right:function(){return a.createElement(bn.a.Affix,{text:"kg"})},onChangeText:function(e){return z(jn.setField(["exitWeight",Number(e)]))}}),a.createElement(fn.a,{type:O.fields.exitWeight.error?"error":"info"},O.fields.exitWeight.error||""))}var $n,Tn=Fe.a.create({fields:{flex:1},field:{marginBottom:8},ticketAddons:{marginBottom:8}}),Fn=Object(g.gql)($n||($n=Ke()(["\n  mutation CreateSlot(\n    $jumpTypeId: Int\n    $extraIds: [Int!]\n    $loadId: Int\n    $rigId: Int\n    $ticketTypeId: Int\n    $userId: Int\n    $exitWeight: Float\n  ) {\n    createSlot(\n      input: {\n        attributes: {\n          jumpTypeId: $jumpTypeId\n          extraIds: $extraIds\n          loadId: $loadId\n          rigId: $rigId\n          ticketTypeId: $ticketTypeId\n          userId: $userId\n          exitWeight: $exitWeight\n        }\n      }\n    ) {\n      errors\n      fieldErrors {\n        field\n        message\n      }\n      slot {\n        id\n        jumpType {\n          id\n          name\n        }\n        extras {\n          id\n          name\n        }\n        exitWeight\n        load {\n          id\n          name\n          createdAt\n          dispatchAt\n          hasLanded\n          maxSlots\n          isFull\n          isOpen\n          plane {\n            id\n            name\n          }\n          gca {\n            id\n            user {\n              id\n              name\n            }\n          }\n          pilot {\n            id\n            user {\n              id\n              name\n            }\n          }\n          loadMaster {\n            id\n            user {\n              id\n              name\n            }\n          }\n          slots {\n            id\n            createdAt\n            user {\n              id\n              name\n            }\n            ticketType {\n              id\n              name\n              altitude\n            }\n            jumpType {\n              id\n              name\n            }\n            extras {\n              id\n              name\n            }\n          }\n        }\n      }\n    }\n  }\n"])));function Nn(e){var n,t,r,i,o,s=Ee(),u=Se((function(e){return e.slotForm})),c=Se((function(e){return e.global})),d=Object(g.useMutation)(Fn),m=W()(d,2),f=m[0],p=m[1],v=Object(a.useCallback)((function(){var e,n,t=!1;return null!=(e=u.fields.jumpType.value)&&e.id||(t=!0,s(me.setFieldError(["jumpType","You must specify the type of jump"]))),null!=(n=u.fields.ticketType.value)&&n.id||(t=!0,s(me.setFieldError(["ticketType","You must select a ticket type to manifest"]))),!t}),[JSON.stringify(u.fields)]),b=Object(a.useCallback)((function(){var n,t,r,a,l,i,o,c,d,m,p,g,b,y,h,E,S,x,I,k,O,z;return we.a.async((function(w){for(;;)switch(w.prev=w.next){case 0:if(v()){w.next=2;break}return w.abrupt("return");case 2:return w.prev=2,w.next=5,we.a.awrap(f({variables:{jumpTypeId:Number(null==(n=u.fields.jumpType.value)?void 0:n.id),extraIds:null==(t=u.fields.extras)||null==(r=t.value)?void 0:r.map((function(e){var n=e.id;return Number(n)})),loadId:Number(null==(a=u.fields.load.value)?void 0:a.id),rigId:null!=(l=u.fields.rig.value)&&l.id?Number(null==(i=u.fields.rig.value)?void 0:i.id):null,ticketTypeId:Number(null==(o=u.fields.ticketType)||null==(c=o.value)?void 0:c.id),userId:Number(null==(d=u.fields.user)||null==(m=d.value)?void 0:m.id),exitWeight:u.fields.exitWeight.value}}));case 5:if(k=w.sent,null==(p=k.data)||null==(g=p.createSlot)||null==(b=g.fieldErrors)||b.map((function(e){var n=e.field,t=e.message;switch(n){case"jump_type":return s(me.setFieldError(["jumpType",t]));case"load":return s(me.setFieldError(["load",t]));case"credits":case"extras":case"extra_ids":return s(me.setFieldError(["extras",t]));case"ticket_type":return s(me.setFieldError(["ticketType",t]));case"rig":return s(me.setFieldError(["rig",t]));case"user":return s(me.setFieldError(["user",t]));case"exit_weight":return s(me.setFieldError(["exitWeight",t]))}})),null==k||null==(y=k.data)||null==(h=y.createSlot)||null==(E=h.errors)||!E.length){w.next=9;break}return w.abrupt("return",s(de.showSnackbar({message:null==k||null==(O=k.data)||null==(z=O.createSlot)?void 0:z.errors[0],variant:"error"})));case 9:null!=(S=k.data)&&null!=(x=S.createSlot)&&null!=(I=x.fieldErrors)&&I.length||e.onSuccess(),w.next=15;break;case 12:w.prev=12,w.t0=w.catch(2),s(de.showSnackbar({message:w.t0.message,variant:"error"}));case 15:case"end":return w.stop()}}),null,null,[[2,12]],Promise)}),[JSON.stringify(u.fields),f,e.onSuccess]);return l.a.createElement(on.a,null,l.a.createElement(sn.a,{visible:!!e.open},l.a.createElement(an.a,{indeterminate:!0,visible:p.loading,color:c.theme.colors.accent}),l.a.createElement(sn.a.Title,null,"Manifest "+(null==u||null==(n=u.fields)||null==(t=n.user)||null==(r=t.value)?void 0:r.name)+" on "+(null==(i=u.fields.load)||null==(o=i.value)?void 0:o.name)),l.a.createElement(sn.a.Content,null,l.a.createElement(Pn,null)),l.a.createElement(sn.a.Actions,{style:{justifyContent:"flex-end"}},l.a.createElement(un.a,{onPress:function(){s(me.reset()),e.onClose()}},"Cancel"),l.a.createElement(un.a,{onPress:b},"Manifest"))))}var Dn=t(135),Mn=t(294),An=t(8),Un=t.n(An);function qn(e,n){var t=e.light;return t||De.light[n]}function Wn(e){var n=e.style,t=e.lightColor,r=e.darkColor,l=Un()(e,["style","lightColor","darkColor"]),i=qn({light:t,dark:r},"text");return a.createElement(Be.a,Ge()({style:[{color:i},n]},l))}function Bn(e){var n=e.style,t=e.lightColor,r=e.darkColor,l=Un()(e,["style","lightColor","darkColor"]),i=qn({light:t,dark:r},"background");return a.createElement(d.a,Ge()({style:[{backgroundColor:i},n]},l))}function Rn(e){var n=e.title,t=e.subtitle;return l.a.createElement(Bn,{style:Ln.empty},l.a.createElement(Dn.a,null,n),l.a.createElement(Mn.a,{style:{textAlign:"center"}},t))}var Ln=Fe.a.create({container:{flex:1,padding:8,display:"flex"},fab:{position:"absolute",margin:16,right:0,bottom:0},empty:{flex:1,alignItems:"center",justifyContent:"center",width:"100%",height:"100%"}});function Hn(e){var n=e.hasPlanes,t=e.hasTicketTypes,r=(e.isPublic,Me());return a.createElement(Bn,{style:{width:"70%"}},a.createElement(Wn,{style:Jn.title},"Set up dropzone"),a.createElement(Bn,{style:Jn.separator,lightColor:"#eee",darkColor:"rgba(255,255,255,0.1)"}),a.createElement(pn.a.Item,{title:"Create dropzone",left:function(){return a.createElement(pn.a.Icon,{color:r.success,icon:"check"})}}),a.createElement(pn.a.Item,{title:"Add a plane",left:function(){return n?a.createElement(pn.a.Icon,{color:r.success,icon:"check"}):a.createElement(pn.a.Icon,{color:r.error,icon:"close"})}}),a.createElement(pn.a.Item,{title:"Configure jump tickets",left:function(){return t?a.createElement(pn.a.Icon,{color:r.success,icon:"check"}):a.createElement(pn.a.Icon,{color:r.error,icon:"close"})}}))}var Qn,Vn,Jn=Fe.a.create({container:{flex:1,alignItems:"center",justifyContent:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"}}),Gn=t(192),_n=t(309),Yn=t(366),Zn=t(380),Kn=Object(nn.a)(Qn||(Qn=Ke()(["\n  query QueryDropzoneUsers(\n    $dropzoneId: Int!\n    $permissions: [Permission!]\n  ) {\n    dropzone(id: $dropzoneId) {\n      id\n      name\n\n      dropzoneUsers(permissions: $permissions) {\n        edges {\n          node {\n            id\n            role {\n              id\n              name\n            }\n            user {\n              id\n              name\n            }\n          }\n        }\n      }\n    }\n  }\n"])));function Xn(e){var n,t,r,i,o,s,u,c=Object(a.useState)(!1),d=W()(c,2),m=d[0],f=d[1],p=Se((function(e){return e.global})),v=Object(g.useQuery)(Kn,{variables:{dropzoneId:Number(null==(n=p.currentDropzone)?void 0:n.id),permissions:["actAsGCA"]}}).data;return zn("updateLoad")?l.a.createElement(yn.a,{onDismiss:function(){return f(!1)},visible:m,anchor:l.a.createElement(gn.a,{mode:"outlined",icon:"radio-handheld",style:{marginHorizontal:4},onPress:function(){return f(!0)}},null!=(r=e.value)&&r.id?null==(i=e.value)?void 0:i.name:"No gca")},null==v||null==(o=v.dropzone)||null==(s=o.dropzoneUsers)||null==(u=s.edges)?void 0:u.map((function(n){var t,r;return l.a.createElement(pn.a.Item,{onPress:function(){var t;f(!1),e.onSelect(null==n||null==(t=n.node)?void 0:t.user)},title:null==n||null==(t=n.node)||null==(r=t.user)?void 0:r.name})}))):l.a.createElement(gn.a,{mode:"outlined",icon:"radio-handheld"},(null==(t=e.value)?void 0:t.name)||"No gca")}function et(e){var n,t,r,i,o=Object(a.useState)(!1),s=W()(o,2),u=s[0],c=s[1],d=zn("updateLoad");return d?l.a.createElement(yn.a,{onDismiss:function(){return c(!1)},visible:u,anchor:l.a.createElement(gn.a,{mode:"outlined",icon:"parachute",style:{marginHorizontal:4},onPress:function(){return d&&c(!0)}},null!=(t=e.value)&&t.id?null==(r=e.value)?void 0:r.name:"No loadmaster")},null==(i=e.slots)?void 0:i.map((function(n){var t;return l.a.createElement(pn.a.Item,{onPress:function(){c(!1),e.onSelect(n.user)},title:null==n||null==(t=n.user)?void 0:t.name})}))):l.a.createElement(gn.a,{mode:"outlined",icon:"radio-handheld"},(null==(n=e.value)?void 0:n.name)||"No loadmaster")}var nt,tt=Object(nn.a)(Vn||(Vn=Ke()(["\n  query QueryDropzoneUsers(\n    $dropzoneId: Int!\n    $permissions: [Permission!]\n  ) {\n    dropzone(id: $dropzoneId) {\n      id\n      name\n\n      dropzoneUsers(permissions: $permissions) {\n        edges {\n          node {\n            id\n            role {\n              id\n              name\n            }\n            user {\n              id\n              name\n            }\n          }\n        }\n      }\n    }\n  }\n"])));function rt(e){var n,t,r,i,o,s,u,c=Object(a.useState)(!1),d=W()(c,2),m=d[0],f=d[1],p=Se((function(e){return e.global})),v=Object(g.useQuery)(tt,{variables:{dropzoneId:Number(null==(n=p.currentDropzone)?void 0:n.id),permissions:["actAsPilot"]}}).data;return zn("updateLoad")?l.a.createElement(yn.a,{onDismiss:function(){return f(!1)},visible:m,anchor:l.a.createElement(gn.a,{mode:"outlined",icon:"airplane-takeoff",style:{marginHorizontal:4},onPress:function(){return f(!0)}},null!=(r=e.value)&&r.id?null==(i=e.value)?void 0:i.name:"No pilot")},null==v||null==(o=v.dropzone)||null==(s=o.dropzoneUsers)||null==(u=s.edges)?void 0:u.map((function(n){var t,r;return l.a.createElement(pn.a.Item,{onPress:function(){var t;f(!1),e.onSelect(null==n||null==(t=n.node)?void 0:t.user)},title:null==n||null==(t=n.node)||null==(r=t.user)?void 0:r.name})}))):l.a.createElement(gn.a,{mode:"outlined",icon:"radio-handheld"},(null==(t=e.value)?void 0:t.name)||"No pilot")}var at,lt,it=Object(nn.a)(nt||(nt=Ke()(["\n  query QueryPlanes(\n    $dropzoneId: Int!\n  ) {\n    planes(dropzoneId: $dropzoneId) {\n      id\n      name\n      registration\n      hours\n      minSlots\n      maxSlots\n      nextMaintenanceHours\n      createdAt\n    }\n  }\n"])));function ot(e){var n,t,r,i,o=Object(a.useState)(!1),s=W()(o,2),u=s[0],c=s[1],d=Se((function(e){return e.global})),m=Object(g.useQuery)(it,{variables:{dropzoneId:Number(null==(n=d.currentDropzone)?void 0:n.id)}}).data,f=zn("updateLoad");return f?l.a.createElement(yn.a,{onDismiss:function(){return c(!1)},visible:u,anchor:l.a.createElement(gn.a,{mode:"outlined",icon:"airplane",style:{marginHorizontal:4},onPress:function(){return f&&c(!0)}},(null==(r=e.value)?void 0:r.name)||"No plane")},null==m||null==(i=m.planes)?void 0:i.map((function(n){return l.a.createElement(pn.a.Item,{onPress:function(){c(!1),e.onSelect(n)},title:n.name})}))):l.a.createElement(gn.a,{mode:"outlined",icon:"airplane-takeoff"},(null==(t=e.value)?void 0:t.name)||"No plane")}var st=Object(g.gql)(at||(at=Ke()(["\n  query QueryLoad($id: Int!) {\n    load(id: $id) {\n      id\n      name\n      createdAt\n      dispatchAt\n      hasLanded\n      maxSlots\n      isFull\n      isOpen\n      plane {\n        id\n        name\n      }\n      gca {\n        id\n        user {\n          id\n          name\n        }\n      }\n      pilot {\n        id\n        user {\n          id\n          name\n        }\n      }\n      loadMaster {\n        id\n        user {\n          id\n          name\n        }\n      }\n      slots {\n        id\n        createdAt\n        exitWeight\n        user {\n          id\n          name\n        }\n        ticketType {\n          id\n          name\n          altitude\n\n          extras {\n            id\n            name\n            cost\n          }\n        }\n        jumpType {\n          id\n          name\n        }\n        extras {\n          id\n          name\n        }\n      }\n    }\n  }\n"]))),ut=Object(g.gql)(lt||(lt=Ke()(["\n  mutation UpdateLoad(\n    $id: Int!,\n    $pilotId: Int,\n    $gcaId: Int,\n    $planeId: Int,\n    $isOpen: Boolean,\n    $loadMasterId: Int,\n    $dispatchAt: Int,\n  ){\n    updateLoad(input: {\n      id: $id\n      attributes: {\n        pilotId: $pilotId,\n        gcaId: $gcaId,\n        planeId: $planeId,\n        isOpen: $isOpen,\n        loadMasterId: $loadMasterId\n        dispatchAt: $dispatchAt\n      }\n    }) {\n      load {\n        id\n        name\n        createdAt\n        dispatchAt\n        hasLanded\n        maxSlots\n        isFull\n        isOpen\n        plane {\n          id\n          name\n        }\n        gca {\n          id\n          user {\n            id\n            name\n          }\n        }\n        pilot {\n          id\n          user {\n            id\n            name\n          }\n        }\n        loadMaster {\n          id\n          user {\n            id\n            name\n          }\n        }\n        slots {\n          id\n          createdAt\n          exitWeight\n          user {\n            id\n            name\n          }\n          ticketType {\n            id\n            name\n            altitude\n          }\n          jumpType {\n            id\n            name\n          }\n          extras {\n            id\n            name\n          }\n        }\n      }\n    }\n  }\n"])));function ct(e){var n,t,r,l,i,o,s,u,c,d,m,f,p,v,b,y,h,E,S,x,I=Se((function(e){return e.global})),k=a.useState(!1),O=W()(k,2),z=O[0],w=O[1],C=a.useState(!1),j=W()(C,2),P=j[0],$=j[1],T=(Object(Xe.useNavigation)(),e.load),F=e.loadNumber,N=e.onManifest,D=e.canManifest,M=Object(g.useQuery)(st,{variables:{id:Number(T.id)}}),A=M.data,U=M.loading,q=Object(g.useMutation)(ut),B=W()(q,2),R=B[0],L=B[1],H=a.useCallback((function(e){return we.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,we.a.awrap(R({variables:{id:Number(T.id),pilotId:Number(e.id)}}));case 3:n.next=7;break;case 5:n.prev=5,n.t0=n.catch(0);case 7:case"end":return n.stop()}}),null,null,[[0,5]],Promise)}),[R,JSON.stringify(T)]),Q=a.useCallback((function(e){return we.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,we.a.awrap(R({variables:{id:Number(T.id),gcaId:Number(e.id)}}));case 3:n.next=7;break;case 5:n.prev=5,n.t0=n.catch(0);case 7:case"end":return n.stop()}}),null,null,[[0,5]],Promise)}),[R,JSON.stringify(T)]),V=a.useCallback((function(e){return we.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,we.a.awrap(R({variables:{id:Number(T.id),planeId:Number(e.id)}}));case 3:n.next=7;break;case 5:n.prev=5,n.t0=n.catch(0);case 7:case"end":return n.stop()}}),null,null,[[0,5]],Promise)}),[R,JSON.stringify(T)]),J=a.useCallback((function(e){return we.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,we.a.awrap(R({variables:{id:Number(T.id),loadMasterId:Number(e.id)}}));case 3:n.next=7;break;case 5:n.prev=5,n.t0=n.catch(0);case 7:case"end":return n.stop()}}),null,null,[[0,5]],Promise)}),[R,JSON.stringify(T)]),G=a.useCallback((function(e){var n;return we.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e?Object(Yn.a)(new Date,e).getTime()/1e3:null,t.prev=1,t.next=4,we.a.awrap(R({variables:{id:Number(T.id),dispatchAt:n?Math.ceil(n):null}}));case 4:t.next=8;break;case 6:t.prev=6,t.t0=t.catch(1);case 8:case"end":return t.stop()}}),null,null,[[1,6]],Promise)}),[R,JSON.stringify(T)]),_=zn("updateLoad"),Y=zn("updateSlot"),Z=zn("updateUserSlot"),K=a.useCallback((function(n){var t,r;if((null==n||null==(t=n.user)?void 0:t.id)===(null==(r=I.currentUser)?void 0:r.id)||Z)return function(){var t,r;(null==(t=n.user)?void 0:t.id)===(null==(r=I.currentUser)?void 0:r.id)?Y&&e.onSlotPress(n):Z&&e.onSlotPress(n)}}),[JSON.stringify(T),Z,e.onSlotPress]);return a.useEffect((function(){var e,n;null!=A&&null!=(e=A.load)&&e.maxSlots&&(null==A||null==(n=A.load)?void 0:n.maxSlots)<5&&!z&&w(!0)}),[null==A||null==(n=A.load)?void 0:n.maxSlots]),a.createElement(Gn.a,{style:{marginVertical:16},elevation:3},a.createElement(Gn.a.Title,{title:"Load "+F,subtitle:T.name}),a.createElement(an.a,{visible:U||L.loading,color:I.theme.colors.accent}),a.createElement(Gn.a.Content,{style:{marginVertical:8,height:z?void 0:300,overflow:"hidden"}},a.createElement(Bn,{style:{flexDirection:"row"}},a.createElement(mn.a,{horizontal:!0},a.createElement(ot,{dropzoneId:Number(null==(t=I.currentDropzone)?void 0:t.id),value:null==A||null==(r=A.load)?void 0:r.plane,onSelect:V}),a.createElement(Xn,{dropzoneId:Number(null==(l=I.currentDropzone)?void 0:l.id),value:null==A||null==(i=A.load)||null==(o=i.gca)?void 0:o.user,onSelect:Q}),a.createElement(rt,{dropzoneId:Number(null==(s=I.currentDropzone)?void 0:s.id),value:null==A||null==(u=A.load)||null==(c=u.pilot)?void 0:c.user,onSelect:H}),a.createElement(et,{dropzoneId:Number(null==(d=I.currentDropzone)?void 0:d.id),value:null==A||null==(m=A.load)||null==(f=m.loadMaster)?void 0:f.user,slots:(null==A?void 0:A.load.slots)||[],onSelect:J}))),a.createElement(_n.a,null,a.createElement(_n.a.Header,{style:{width:"100%"}},a.createElement(_n.a.Title,null,"Name"),a.createElement(_n.a.Title,{numeric:!0},"Exit weight"),a.createElement(_n.a.Title,{numeric:!0},"Jump type"),a.createElement(_n.a.Title,{numeric:!0},"Altitude")),null==A||null==(p=A.load)||null==(v=p.slots)?void 0:v.map((function(e){var n,t,r;return a.createElement(_n.a.Row,{onPress:K(e)},a.createElement(_n.a.Cell,{onPress:K(e)},null==e||null==(n=e.user)?void 0:n.name),a.createElement(_n.a.Cell,{numeric:!0,onPress:K(e)},null==e?void 0:e.exitWeight),a.createElement(_n.a.Cell,{numeric:!0,onPress:K(e)},null==e||null==(t=e.jumpType)?void 0:t.name),a.createElement(_n.a.Cell,{numeric:!0,onPress:K(e)},null==e||null==(r=e.ticketType)?void 0:r.altitude))})),Array.from({length:((null==T?void 0:T.maxSlots)||0)-((null==T||null==(b=T.slots)?void 0:b.length)||0)},(function(e,n){return n})).map((function(){return a.createElement(_n.a.Row,null,a.createElement(_n.a.Cell,null,"- Available -"),a.createElement(_n.a.Cell,{numeric:!0},"-"),a.createElement(_n.a.Cell,{numeric:!0},"-"),a.createElement(_n.a.Cell,{numeric:!0},"-"))})))),!(null==A||null==(y=A.load)||!y.dispatchAt)&&a.createElement(Bn,{style:{flex:1,backgroundColor:"#FF8800",padding:8}},a.createElement(Mn.a,null,"Take-off in "+Object(Zn.a)(new Date,1e3*(null==A||null==(h=A.load)?void 0:h.dispatchAt))+" min")),a.createElement(Gn.a.Actions,null,null!=A&&null!=(E=A.load)&&E.maxSlots&&(null==A||null==(S=A.load)?void 0:S.maxSlots)<5?null:a.createElement(un.a,{onPress:function(){return w(!z)}},z?"Show less":"Show more"),a.createElement(Bn,{style:{flexGrow:1}}),_?null!=A&&null!=(x=A.load)&&x.dispatchAt?a.createElement(un.a,{mode:"outlined",onPress:function(){return G(null)}},"Cancel"):a.createElement(yn.a,{onDismiss:function(){return $(!1)},visible:P,anchor:a.createElement(un.a,{mode:"outlined",onPress:function(){return $(!0)}},"Dispatch")},a.createElement(pn.a.Item,{onPress:function(){$(!1),G(20)},title:"20 minute call"}),a.createElement(pn.a.Item,{onPress:function(){$(!1),G(15)},title:"15 minute call"}),a.createElement(pn.a.Item,{onPress:function(){$(!1),G(10)},title:"10 minute call"}),a.createElement(pn.a.Item,{onPress:function(){$(!1),G(5)},title:"5 minute call"})):null,a.createElement(un.a,{style:{marginLeft:8},mode:"contained",onPress:function(){return N()},disabled:!D},"Manifest")))}var dt;Fe.a.create({container:{flex:1,alignItems:"center",justifyContent:"center",marginVertical:8},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fab:{position:"absolute",margin:16,right:0,bottom:0}});function mt(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function ft(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?mt(Object(t),!0).forEach((function(n){p()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):mt(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var pt=Object(nn.a)(dt||(dt=Ke()(["\n  query QueryDropzone($dropzoneId: Int!, $earliestTimestamp: Int) {\n    dropzone(id: $dropzoneId) {\n      id\n      name\n      primaryColor,\n      secondaryColor,\n      planes {\n        id\n        name\n        registration\n      }\n      ticketTypes {\n        id\n        name\n      }\n\n      currentUser {\n        id\n        user {\n          id\n          name\n          exitWeight\n          email\n          phone\n          rigs {\n            id\n            model\n            make\n            serial\n            canopySize\n            repackExpiresAt\n          }\n          jumpTypes {\n            id\n            name\n          }\n          license {\n            id\n            name\n          }\n        }\n      }\n\n      loads(earliestTimestamp: $earliestTimestamp) {\n        edges {\n          node {\n            id\n            name\n            isOpen\n            maxSlots\n            isFull\n          }\n        }\n      }\n    }\n  }\n"])));function gt(){var e,n,t,r,l,i,o,s,u,c,d,m,f,p=Se((function(e){return e.global})),v=a.useState(!1),b=W()(v,2),y=b[0],h=b[1],E=Ee(),S=Object(g.useQuery)(pt,{variables:{dropzoneId:Number(null==(e=p.currentDropzone)?void 0:e.id),earliestTimestamp:Object(en.a)(new Date).getTime()/1e3},fetchPolicy:"no-cache"}),x=S.data,I=S.loading,k=S.refetch,O=Object(Xe.useNavigation)(),z=!(null==x||null==(n=x.dropzone)||null==(t=n.planes)||!t.length),w=!(null==x||null==(r=x.dropzone)||null==(l=r.ticketTypes)||!l.length),C=!(null==x||null==(i=x.dropzone)||!i.isPublic),j=z&&w;a.useEffect((function(){var e,n;null!=x&&null!=(e=x.dropzone)&&e.id&&(E(ue.setDropzone(x.dropzone)),E(ue.setUser(ft(ft({},null==p?void 0:p.currentUser),(null==x||null==(n=x.dropzone)?void 0:n.currentUser.user)||{}))))}),[JSON.stringify(null==x?void 0:x.dropzone)]),a.useEffect((function(){var e,n,t,r,a,l,i,o;null!=x&&null!=(e=x.dropzone)&&e.primaryColor&&(null==x||null==(n=x.dropzone)?void 0:n.primaryColor)!==(null==(t=p.theme)||null==(r=t.colors)?void 0:r.primary)&&E(ue.setPrimaryColor(x.dropzone.primaryColor)),null!=x&&null!=(a=x.dropzone)&&a.secondaryColor&&(null==x||null==(l=x.dropzone)?void 0:l.secondaryColor)!==(null==(i=p.theme)||null==(o=i.colors)?void 0:o.accent)&&E(ue.setPrimaryColor(x.dropzone.secondaryColor))}),[null==x||null==(o=x.dropzone)?void 0:o.primaryColor,null==x||null==(s=x.dropzone)?void 0:s.secondaryColor]);var P=zn("createSlot"),$=zn("createLoad");return a.createElement(a.Fragment,null,a.createElement(Nn,{open:y,onClose:function(){return h(!1)},onSuccess:function(){return h(!1)}}),a.createElement(an.a,{visible:I,indeterminate:!0,color:p.theme.colors.accent}),a.createElement(Bn,{style:vt.container},!I&&(j?a.createElement(Bn,{style:{width:"100%",flex:1,height:tn.a.get("window").height}},((null==x||null==(u=x.dropzone)||null==(c=u.loads)||null==(d=c.edges)?void 0:d.length)||0)<1?a.createElement(Rn,{title:"No loads so far today",subtitle:"How's the weather?"}):a.createElement(rn.a,{style:{flex:1,height:tn.a.get("window").height},contentContainerStyle:{flexGrow:1},numColumns:1,data:(null==x||null==(m=x.dropzone)||null==(f=m.loads)?void 0:f.edges)||[],refreshing:I,onRefresh:k,renderItem:function(e){var n,t,r,l,i,o=e.item,s=e.index;return null!=o&&o.node?a.createElement(ct,{key:"load-"+o.node.id,load:o.node,canManifest:P&&(null==o||null==(n=o.node)?void 0:n.isOpen)&&!(null!=o&&null!=(t=o.node)&&t.isFull),loadNumber:((null==x||null==(r=x.dropzone)||null==(l=r.loads)||null==(i=l.edges)?void 0:i.length)||0)-s,onSlotPress:function(e){E(me.setOriginal(e)),E(me.setField(["load",o.node])),h(!0)},onManifest:function(){E(me.setField(["user",p.currentUser])),E(me.setField(["load",o.node])),h(!0)}}):null}})):a.createElement(Hn,{hasPlanes:z,hasTicketTypes:w,isPublic:C})),$&&j&&a.createElement(ln.a,{style:vt.fab,small:!0,icon:"plus",onPress:function(){return O.navigate("CreateLoadScreen")},label:"New load"})))}var vt=Fe.a.create({container:{flex:1,alignItems:"center",justifyContent:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fab:{position:"absolute",margin:16,right:0,bottom:0}}),bt=t(377);function yt(e){return a.createElement(Wn,Ge()({},e,{style:[e.style,{fontFamily:"space-mono"}]}))}function ht(e){var n=e.path;return l.a.createElement(Bn,null,l.a.createElement(Bn,{style:St.getStartedContainer},l.a.createElement(Wn,{style:St.getStartedText,lightColor:"rgba(0,0,0,0.8)",darkColor:"rgba(255,255,255,0.8)"},"Open up the code for this screen:"),l.a.createElement(Bn,{style:[St.codeHighlightContainer,St.homeScreenFilename],darkColor:"rgba(255,255,255,0.05)",lightColor:"rgba(0,0,0,0.05)"},l.a.createElement(yt,null,n)),l.a.createElement(Wn,{style:St.getStartedText,lightColor:"rgba(0,0,0,0.8)",darkColor:"rgba(255,255,255,0.8)"},"Change any of the text, save the file, and your app will automatically update.")),l.a.createElement(Bn,{style:St.helpContainer},l.a.createElement(Re.a,{onPress:Et,style:St.helpLink},l.a.createElement(Wn,{style:St.helpLinkText,lightColor:De.light.tint},"Tap here if your app doesn't automatically update after making changes"))))}function Et(){bt.a("https://docs.expo.io/get-started/create-a-new-app/#opening-the-app-on-your-phonetablet")}var St=Fe.a.create({container:{flex:1,backgroundColor:"#fff"},developmentModeText:{marginBottom:20,fontSize:14,lineHeight:19,textAlign:"center"},contentContainer:{paddingTop:30},welcomeContainer:{alignItems:"center",marginTop:10,marginBottom:20},welcomeImage:{width:100,height:80,resizeMode:"contain",marginTop:3,marginLeft:-10},getStartedContainer:{alignItems:"center",marginHorizontal:50},homeScreenFilename:{marginVertical:7},codeHighlightText:{color:"rgba(96,100,109, 0.8)"},codeHighlightContainer:{borderRadius:3,paddingHorizontal:4},getStartedText:{fontSize:17,lineHeight:24,textAlign:"center"},helpContainer:{marginTop:15,marginHorizontal:20,alignItems:"center"},helpLink:{paddingVertical:15},helpLinkText:{textAlign:"center"}});function xt(){return a.createElement(Bn,{style:Ot.container},a.createElement(Wn,{style:Ot.title},"Tab One"),a.createElement(Bn,{style:Ot.separator,lightColor:"#eee",darkColor:"rgba(255,255,255,0.1)"}),a.createElement(ht,{path:"/screens/LoadScreen.tsx"}))}var It,kt,Ot=Fe.a.create({container:{flex:1,alignItems:"center",justifyContent:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"}}),zt=M.actions,wt=t(311),Ct=Object(nn.a)(It||(It=Ke()(["\n  query QueryPlanes(\n    $dropzoneId: Int!\n  ) {\n    planes(dropzoneId: $dropzoneId) {\n      id\n      name\n      registration\n      hours\n      minSlots\n      maxSlots\n      nextMaintenanceHours\n      createdAt\n    }\n  }\n"])));function jt(e){var n,t,r,i=Object(a.useState)(!1),o=W()(i,2),s=o[0],u=o[1],c=Se((function(e){return e.global})),d=Object(g.useQuery)(Ct,{variables:{dropzoneId:Number(null==(n=c.currentDropzone)?void 0:n.id)}}),m=d.data;d.loading,d.refetch;return l.a.createElement(yn.a,{onDismiss:function(){return u(!1)},visible:s,anchor:l.a.createElement(pn.a.Item,{onPress:function(){u(!0)},title:(null==(t=e.value)?void 0:t.name)||"No plane selected",description:e.required?null:"Optional",left:function(){return l.a.createElement(pn.a.Icon,{icon:"airplane"})}})},null==m||null==(r=m.planes)?void 0:r.map((function(n){return l.a.createElement(pn.a.Item,{onPress:function(){u(!1),e.onSelect(n)},title:n.name||"-",description:n.registration})})))}var Pt=function(e,n){var t=n.getPayload;return function(n){var r=n.variables,l=n.onError,i=Ee(),o=Object(g.useQuery)(e,{variables:r}),s=o.data,u=o.loading,c=o.previousData,d=o.refetch,m=o.error,f=Object(a.useMemo)((function(){return t(s)}),[JSON.stringify(s)]);return Object(a.useEffect)((function(){JSON.stringify(c),JSON.stringify(s);null!=m&&m.message&&(!1!==n.showSnackbarErrors&&i(de.showSnackbar({message:m.message,variant:"error"})),l(m.message))}),[n.onError,null==m?void 0:m.message]),{loading:u,data:f,refetch:d}}}(Object(nn.a)(kt||(kt=Ke()(["\nquery QueryDropzoneUsers(\n  $dropzoneId: Int!\n  $permissions: [Permission!]\n) {\n  dropzone(id: $dropzoneId) {\n    id\n    name\n\n    dropzoneUsers(permissions: $permissions) {\n      edges {\n        node {\n          id\n          role {\n            id\n            name\n          }\n          user {\n            id\n            name\n          }\n        }\n      }\n    }\n  }\n}\n"]))),{getPayload:function(e){var n;return null==e||null==(n=e.dropzone)?void 0:n.dropzoneUsers}});function $t(e){var n,t,r,i,o,s=Object(a.useState)(!1),u=W()(s,2),c=u[0],d=u[1],m=Se((function(e){return e.global})),f=Pt({variables:{dropzoneId:Number(null==(n=m.currentDropzone)?void 0:n.id),permissions:e.requiredPermissions}}),p=f.data;f.loading,f.refetch;return l.a.createElement(l.a.Fragment,null,l.a.createElement(Dn.a,null,e.label),l.a.createElement(yn.a,{onDismiss:function(){return d(!1)},visible:c,anchor:l.a.createElement(pn.a.Item,{onPress:function(){d(!0)},title:null!=(t=e.value)&&null!=(r=t.user)&&r.id?null==(i=e.value)?void 0:i.user.name:"No user selected",description:e.required?null:"Optional"})},null==p||null==(o=p.edges)?void 0:o.map((function(n){var t,r,a,i;return l.a.createElement(pn.a.Item,{onPress:function(){d(!1),e.onSelect(null==n?void 0:n.node)},title:(null==n||null==(t=n.node)||null==(r=t.user)?void 0:r.name)||"-",description:(null==n||null==(a=n.node)||null==(i=a.role)?void 0:i.name)||null})}))))}var Tt=ee.actions;function Ft(){var e,n,t,r,l,i=Se((function(e){return e.loadForm})),o=Ee(),s=Se((function(e){return e.global}));return a.createElement(mn.a,{style:Dt.fields,contentContainerStyle:{paddingHorizontal:16}},a.createElement(bn.a,{style:Dt.field,mode:"outlined",label:"Name",error:!!i.fields.name.error,placeholder:"Optional",value:i.fields.name.value||"",onChangeText:function(e){return o(Tt.setField(["name",e]))}}),a.createElement(fn.a,{type:i.fields.name.error?"error":"info"},i.fields.name.error||"e.g Starcrest load, Tandem load"),a.createElement(jt,{value:i.fields.plane.value,onSelect:function(e){o(Tt.setField(["plane",e])),o(Tt.setField(["maxSlots",e.maxSlots]))},dropzoneId:Number(null==(e=s.currentDropzone)?void 0:e.id)}),a.createElement(fn.a,{type:i.fields.plane.error?"error":"info"},i.fields.plane.error||""),a.createElement(bn.a,{style:Dt.field,mode:"outlined",label:"Slots",error:!!i.fields.maxSlots.value,value:null==(n=i.fields.maxSlots)||null==(t=n.value)?void 0:t.toString(),onChangeText:function(e){return o(Tt.setField(["maxSlots",Number(e)]))}}),a.createElement(fn.a,{type:i.fields.maxSlots.error?"error":"info"},i.fields.maxSlots.error||""),a.createElement(wt.a.Item,{label:"Allow public manifesting",status:i.fields.isOpen.value?"checked":"unchecked",onPress:function(){return o(Tt.setField(["isOpen",!i.fields.isOpen.value]))}}),a.createElement(vn.a,null),a.createElement($t,{label:"GCA",onSelect:function(e){return o(Tt.setField(["gca",e]))},dropzoneId:Number(null==(r=s.currentDropzone)?void 0:r.id),value:i.fields.gca.value||null,requiredPermissions:["actAsGCA"],required:!0}),a.createElement(fn.a,{type:i.fields.gca.error?"error":"info"},i.fields.gca.error||""),a.createElement($t,{label:"Pilot",onSelect:function(e){return o(Tt.setField(["pilot",e]))},dropzoneId:Number(null==(l=s.currentDropzone)?void 0:l.id),value:i.fields.pilot.value||null,requiredPermissions:["actAsPilot"]}),a.createElement(fn.a,{type:i.fields.pilot.error?"error":"info"},i.fields.pilot.error||""))}var Nt,Dt=Fe.a.create({fields:{width:"70%",flex:1},field:{marginBottom:8}}),Mt=ee.actions,At=(N.actions,Object(g.gql)(Nt||(Nt=Ke()(["\n  mutation CreateLoad(\n    $name: String,\n    $pilotId: Int,\n    $gcaId: Int,\n    $maxSlots: Int!,\n    $planeId: Int,\n    $isOpen: Boolean,\n  ){\n    createLoad(input: {\n      attributes: {\n        name: $name,\n        pilotId: $pilotId,\n        gcaId: $gcaId,\n        maxSlots: $maxSlots,\n        planeId: $planeId,\n        isOpen: $isOpen,\n      }\n    }) {\n      load {\n        id\n        name\n        pilot {\n          id\n          user {\n            id \n            name\n          }\n        }\n        gca {\n          id\n          user {\n            id \n            name\n          }\n        }\n        maxSlots\n        isOpen\n      }\n      fieldErrors {\n        field,\n        message\n      }\n      errors\n    }\n  }\n"]))));function Ut(){var e=Se((function(e){return e})),n=e.loadForm,t=e.global,r=Ee(),l=Object(Xe.useNavigation)(),i=Object(g.useMutation)(At),o=W()(i,2),s=o[0],u=o[1],c=a.useCallback((function(){var e,t,a=!1;return((null==(e=n.fields.name)||null==(t=e.value)?void 0:t.length)||0)<3&&(a=!0,r(Mt.setFieldError(["name","Name is too short"]))),n.fields.maxSlots.value<1&&(a=!0,r(Mt.setFieldError(["maxSlots","Please specify amount of allowed jumpers"]))),n.fields.plane.value||(a=!0,r(Mt.setFieldError(["plane","What plane is flying this load?"]))),n.fields.gca.value||(a=!0,r(Mt.setFieldError(["gca","You must have a GCA for this load"]))),!a}),[JSON.stringify(n.fields),r]),d=a.useCallback((function(){var e,a,i,o,u,d,m,f,p,g,v,b,y,h,E,S,x,I,k,O,z,w,C,j,P,$,T,F;return we.a.async((function(N){for(;;)switch(N.prev=N.next){case 0:if(e=n.fields,a=e.name,i=e.gca,e.loadMaster,o=e.plane,u=e.maxSlots,d=e.pilot,m=e.isOpen,!c()){N.next=15;break}return N.prev=2,N.next=5,we.a.awrap(s({variables:{dropzoneId:Number(null==(f=t.currentDropzone)?void 0:f.id),name:a.value,maxSlots:u.value,planeId:null!=(p=o.value)&&p.id?Number(null==(g=o.value)?void 0:g.id):null,pilotId:null!=(v=d.value)&&v.id?Number(null==(b=o.value)?void 0:b.id):null,gcaId:null!=(y=i.value)&&null!=(h=y.user)&&h.id?Number(null==(E=i.value)||null==(S=E.user)?void 0:S.id):null,isOpen:!!m.value}}));case 5:if(P=N.sent,null==(x=P.data)||null==(I=x.createLoad)||null==(k=I.fieldErrors)||k.map((function(e){var n=e.field,t=e.message;switch(n){case"name":return r(Mt.setFieldError(["name",t]));case"maxSlots":return r(Mt.setFieldError(["maxSlots",t]));case"plane":return r(Mt.setFieldError(["plane",t]));case"gca":return r(Mt.setFieldError(["gca",t]));case"is_open":return r(Mt.setFieldError(["isOpen",t]));case"pilot":return r(Mt.setFieldError(["pilot",t]))}})),null==P||null==(O=P.data)||null==(z=O.createLoad)||null==(w=z.errors)||!w.length){N.next=9;break}return N.abrupt("return",r(zt.showSnackbar({message:P.data.createLoad.errors[0],variant:"error"})));case 9:null!=(C=P.data)&&null!=(j=C.createLoad)&&j.load&&(F=P.data.createLoad.load,r(zt.showSnackbar({message:"Load "+F.name+" created",variant:"success"})),null!=($=P.data)&&null!=(T=$.createLoad)&&T.fieldErrors||l.goBack()),N.next=15;break;case 12:N.prev=12,N.t0=N.catch(2),r(zt.showSnackbar({message:N.t0.message,variant:"error"}));case 15:case"end":return N.stop()}}),null,null,[[2,12]],Promise)}),[JSON.stringify(n.fields),r,s]);return a.createElement(Bn,{style:Wt.container},a.createElement(Ft,null),a.createElement(Bn,{style:Wt.fields},a.createElement(un.a,{mode:"contained",disabled:u.loading,onPress:d,loading:u.loading},"Save")))}var qt,Wt=Fe.a.create({container:{flex:1,alignItems:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fields:{marginBottom:16},field:{marginBottom:8}}),Bt=t(308),Rt=t(34),Lt=Object(g.gql)(qt||(qt=Ke()(["\n  query QueryDropzonesCompact {\n    dropzones {\n      edges {\n        node {\n          id\n          name\n        }\n      }\n    }\n  }\n"])));var Ht=Fe.a.create({warning:{flexDirection:"row",alignItems:"center",height:56,width:"100%",backgroundColor:"#ffbb33",justifyContent:"space-between",paddingHorizontal:32}}),Qt=function(e){var n,t,r,i,o,s,u,c=e.navigation,m=e.previous,f=e.scene,p=Object(a.useState)(!1),v=W()(p,2),b=v[0],y=v[1],h=Object(g.useQuery)(Lt).data,E=Se((function(e){return e.global})),S=E.currentDropzone,x=(E.theme,Ee()),I=!(null==S||null==(n=S.currentUser)||null==(t=n.user)||null==(r=t.rigs)||!r.length),k=!(null==S||null==(i=S.currentUser)||null==(o=i.user)||!o.exitWeight),O=!I||!k;return l.a.createElement(l.a.Fragment,null,l.a.createElement(Bt.a.Header,null,m?l.a.createElement(Bt.a.BackAction,{onPress:c.goBack}):null,l.a.createElement(Bt.a.Content,{title:f.descriptor.options.title}),l.a.createElement(yn.a,{onDismiss:function(){return y(!1)},visible:b,anchor:l.a.createElement(Rt.a,{onPress:function(){return y(!0)},style:{color:"white",marginRight:8}},null==S?void 0:S.name)},null==h||null==(s=h.dropzones)||null==(u=s.edges)?void 0:u.map((function(e){var n;return l.a.createElement(yn.a.Item,{title:null==e||null==(n=e.node)?void 0:n.name,onPress:function(){x(ue.setDropzone(null==e?void 0:e.node)),y(!1)}})})))),O&&l.a.createElement(d.a,{style:Ht.warning},l.a.createElement(Mn.a,null,"You need to complete your profile"),l.a.createElement(un.a,{color:"black",mode:"outlined",onPress:function(){return c.navigate("Profile")}},"Take me there")))},Vt=Object(We.a)();function Jt(){var e=Se((function(e){return e.global}));return a.createElement(Vt.Navigator,{screenOptions:{headerShown:!(!e.credentials||!e.currentDropzone),header:function(e){return a.createElement(Qt,e)},cardStyle:{flex:1}}},a.createElement(Vt.Screen,{name:"DropzoneScreen",component:gt,options:{title:"Manifest"}}),a.createElement(Vt.Screen,{name:"LoadScreen",component:xt,options:{title:"Loads"}}),a.createElement(Vt.Screen,{name:"CreateLoadScreen",component:Ut,options:{title:"Create load"}}))}Fe.a.create({container:{flex:1,alignItems:"center",justifyContent:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"}}),Object(We.a)();var Gt=t(171),_t=t(369),Yt=t.n(_t);t(470);function Zt(e){var n=a.useState(!1),t=W()(n,2),r=t[0],l=t[1];a.useCallback((function(){l(!1)}),[l]),a.useCallback((function(n){var t=n.date;l(!1),e.onChange(t.getTime()/1e3)}),[l,e.onChange]);return a.createElement(a.Fragment,null,a.createElement(yn.a,{onDismiss:function(){return l(!1)},visible:r,anchor:a.createElement(pn.a.Item,{onPress:function(){return l(!0)},title:e.label,description:e.timestamp?Object(Gt.a)(1e3*e.timestamp,"yyyy/MM/dd"):"No date selected",left:function(){return a.createElement(pn.a.Icon,{icon:"calendar"})}})},a.createElement(Yt.a,{selectedDays:e.timestamp?[new Date(1e3*e.timestamp)]:[],onDayClick:function(n){e.onChange(n.getTime()/1e3),l(!1)}})))}var Kt=se.actions;function Xt(){var e,n=Se((function(e){return e.rigForm})),t=Ee(),r=a.useState(!1),l=W()(r,2);l[0],l[1];return a.createElement(mn.a,{style:tr.fields},a.createElement(bn.a,{style:tr.field,mode:"outlined",label:"Make",error:!!n.fields.make.error,value:n.fields.make.value||"",onChangeText:function(e){return t(Kt.setField(["make",e]))}}),a.createElement(fn.a,{type:n.fields.make.error?"error":"info"},n.fields.make.error||"e.g Javelin, Mirage"),a.createElement(bn.a,{style:tr.field,mode:"outlined",label:"Model",error:!!n.fields.model.error,value:n.fields.model.value||"",onChangeText:function(e){return t(Kt.setField(["model",e]))}}),a.createElement(fn.a,{type:n.fields.model.error?"error":"info"},n.fields.model.error||"e.g G4.1"),a.createElement(bn.a,{style:tr.field,mode:"outlined",label:"Serial",error:!!n.fields.serial.error,value:n.fields.serial.value||"",onChangeText:function(e){return t(Kt.setField(["serial",e]))}}),a.createElement(fn.a,{type:n.fields.serial.error?"error":"info"},n.fields.serial.error||""),a.createElement(bn.a,{style:tr.field,mode:"outlined",label:"Current canopy size",error:!!n.fields.canopySize.error,value:(null==(e=n.fields.canopySize.value)?void 0:e.toString())||"",keyboardType:"number-pad",onChangeText:function(e){return t(Kt.setField(["canopySize",Number(e)]))}}),a.createElement(fn.a,{type:n.fields.canopySize.error?"error":"info"},n.fields.canopySize.error||"Size of canopy in container"),a.createElement(Zt,{timestamp:n.fields.repackExpiresAt.value||(new Date).getTime()/1e3,onChange:function(e){return t(Kt.setField(["repackExpiresAt",e]))},label:"Reserve repack expiry date"}))}var er,nr,tr=Fe.a.create({fields:{flex:1},field:{marginBottom:8}});function rr(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function ar(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?rr(Object(t),!0).forEach((function(n){p()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):rr(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var lr=Object(g.gql)(er||(er=Ke()(["\n  mutation CreateRig(\n    $make: String,\n    $model: String,\n    $serial: String,\n    $canopySize: Int,\n    $repackExpiresAt: Int\n    $userId: Int\n    $dropzoneId: Int\n  ) {\n    createRig(\n      input: {\n        attributes: {\n          make: $make\n          model: $model\n          serial: $serial\n          repackExpiresAt: $repackExpiresAt\n          dropzoneId: $dropzoneId\n          userId: $userId\n          canopySize: $canopySize\n        }\n      }\n    ) {\n      errors\n      fieldErrors {\n        field\n        message\n      }\n      rig {\n        id\n        make\n        model\n        serial\n        canopySize\n        repackExpiresAt\n        packValue\n        maintainedAt\n\n        user {\n          id\n          rigs {\n            id\n            make\n            model\n            serial\n            canopySize\n            repackExpiresAt\n            packValue\n            maintainedAt\n          }\n        }\n      }\n    }\n  }\n"]))),ir=Object(g.gql)(nr||(nr=Ke()(["\n  mutation UpdateRig(\n    $id: Int!\n    $make: String,\n    $model: String,\n    $serial: String,\n    $canopySize: Int,\n    $repackExpiresAt: Int\n    $userId: Int\n    $dropzoneId: Int\n  ) {\n    updateRig(\n      input: {\n        id: $id,\n        attributes: {\n          make: $make\n          model: $model\n          serial: $serial\n          repackExpiresAt: $repackExpiresAt\n          dropzoneId: $dropzoneId\n          userId: $userId\n          canopySize: $canopySize\n        }\n      }\n    ) {\n      errors\n      fieldErrors {\n        field\n        message\n      }\n      rig {\n        id\n        make\n        model\n        serial\n        canopySize\n        repackExpiresAt\n        packValue\n        maintainedAt\n\n        user {\n          id\n          rigs {\n            id\n            make\n            model\n            serial\n            canopySize\n            repackExpiresAt\n            packValue\n            maintainedAt\n          }\n        }\n      }\n    }\n  }\n"])));function or(e){var n,t=Ee(),r=Se((function(e){return e.rigForm})),i=Se((function(e){return e.global})),o=Object(g.useMutation)(lr),s=W()(o,2),u=s[0],c=s[1],d=Object(g.useMutation)(ir),m=W()(d,2),f=m[0],p=m[1],v=Object(a.useCallback)((function(){var e=!1;return r.fields.make.value||(e=!0,t(ge.setFieldError(["make","Required"]))),r.fields.model.value||(e=!0,t(ge.setFieldError(["model","Required"]))),r.fields.serial.value||(e=!0,t(ge.setFieldError(["serial","Required"]))),r.fields.canopySize.value||(e=!0,t(ge.setFieldError(["canopySize","Required"]))),r.fields.repackExpiresAt.value||(e=!0,t(ge.setFieldError(["repackExpiresAt","Required"]))),!e}),[JSON.stringify(r.fields)]),b=Object(a.useCallback)((function(){var n,a,l,i,o,s,c,d,m,p,g,b;return we.a.async((function(y){for(;;)switch(y.prev=y.next){case 0:if(v()){y.next=2;break}return y.abrupt("return");case 2:return y.prev=2,p=null!=(n=r.original)&&n.id?f:u,y.next=6,we.a.awrap(p({variables:ar(ar({},null!=(a=r.original)&&a.id?{id:null==(l=r.original)?void 0:l.id}:{}),{},{make:r.fields.make.value,model:r.fields.model.value,serial:r.fields.serial.value,canopySize:r.fields.canopySize.value,repackExpiresAt:r.fields.repackExpiresAt.value,userId:e.userId?Number(e.userId):null,dropzoneId:e.dropzoneId?Number(e.dropzoneId):null})}));case 6:if(g=y.sent,null==(b=null!=(i=r.original)&&i.id?null==(o=g.data)?void 0:o.updateRig:null==(s=g.data)?void 0:s.createRig)||null==(c=b.fieldErrors)||c.map((function(e){var n=e.field,r=e.message;switch(n){case"make":return t(ge.setFieldError(["make",r]));case"model":return t(ge.setFieldError(["model",r]));case"serial":return t(ge.setFieldError(["serial",r]));case"canopySize":return t(ge.setFieldError(["canopySize",r]));case"repack_expires_at":return t(ge.setFieldError(["repackExpiresAt",r]))}})),null==b||null==(d=b.errors)||!d.length){y.next=11;break}return y.abrupt("return",t(de.showSnackbar({message:null==b?void 0:b.errors[0],variant:"error"})));case 11:null!=b&&null!=(m=b.fieldErrors)&&m.length||e.onSuccess(),y.next=17;break;case 14:y.prev=14,y.t0=y.catch(2),t(de.showSnackbar({message:y.t0.message,variant:"error"}));case 17:case"end":return y.stop()}}),null,null,[[2,14]],Promise)}),[JSON.stringify(r.fields),u,e.onSuccess]);return l.a.createElement(on.a,null,l.a.createElement(sn.a,{visible:!!e.open},l.a.createElement(an.a,{indeterminate:!0,visible:c.loading||p.loading,color:i.theme.colors.accent}),l.a.createElement(sn.a.Title,null,(null!=r&&null!=(n=r.original)&&n.id?"Edit":"New")+" rig"),l.a.createElement(sn.a.Content,null,l.a.createElement(Xt,null)),l.a.createElement(sn.a.Actions,{style:{justifyContent:"flex-end"}},l.a.createElement(un.a,{onPress:function(){t(ge.reset()),e.onClose()}},"Cancel"),l.a.createElement(un.a,{onPress:b},"Save"))))}function sr(e){var n=Object(a.useState)(tn.a.get("window").height),t=W()(n,2),r=t[0],i=t[1];return Object(a.useEffect)((function(){return tn.a.addEventListener("change",(function(e){var n=e.window;return i(n.height)})),function(){tn.a.removeEventListener("change",(function(e){var n=e.window;return i(n.height)}))}}),[]),l.a.createElement(mn.a,{style:[cr.container,{height:r},e.style],contentContainerStyle:[cr.content,e.contentContainerStyle]},e.children)}var ur,cr=Fe.a.create({container:{flex:1},content:{flexGrow:1,alignItems:"center"}}),dr=Object(nn.a)(ur||(ur=Ke()(["\n  query RolesQuery($dropzoneId: Int!) {\n    dropzone(id: $dropzoneId) {\n      id\n      roles {\n        id\n        name\n      }\n    }\n  }\n"])));function mr(e){var n,t,r,i,o=Object(a.useState)(!1),s=W()(o,2),u=s[0],c=s[1],d=Se((function(e){return e.global})),m=Object(g.useQuery)(dr,{variables:{dropzoneId:Number(null==(n=d.currentDropzone)?void 0:n.id)}}),f=m.data;m.loading,m.refetch;return l.a.createElement(l.a.Fragment,null,l.a.createElement(pn.a.Subheader,{style:{paddingLeft:0}},"Access level"),l.a.createElement(yn.a,{onDismiss:function(){return c(!1)},visible:!e.disabled&&u,anchor:l.a.createElement(pn.a.Item,{left:function(){return l.a.createElement(pn.a.Icon,{icon:"lock"})},onPress:e.disabled?void 0:function(){c(!0)},title:(null==(t=e.value)?void 0:t.name)||"Access level",description:e.required?null:"Optional"})},null==f||null==(r=f.dropzone)||null==(i=r.roles)?void 0:i.map((function(n){return l.a.createElement(pn.a.Item,{onPress:function(){c(!1),e.onSelect(n)},title:n.name||"-"})}))))}var fr=ie.actions;function pr(){var e,n,t=Se((function(e){return e})),r=t.dropzoneUserForm,l=(t.global,Ee()),i=zn("updatePermissions");return a.createElement(mn.a,{style:vr.fields},a.createElement(mr,{value:r.fields.role.value,onSelect:function(e){return l(fr.setField(["role",e]))},disabled:!i,required:!0}),a.createElement(fn.a,{type:r.fields.role.error?"error":"info"},r.fields.role.error),a.createElement(pn.a.Subheader,{style:{paddingLeft:0}},"Financial"),a.createElement(Zt,{timestamp:r.fields.expiresAt.value||(new Date).getTime()/1e3,onChange:function(e){return l(fr.setField(["expiresAt",e]))},label:"Membership expires"}),a.createElement(fn.a,{type:r.fields.expiresAt.error?"error":"info"},r.fields.expiresAt.error),a.createElement(bn.a,{style:vr.field,mode:"outlined",label:"Credits",error:!!r.fields.credits.error,value:(null==(e=r.fields.credits.value)?void 0:e.toString())||"",keyboardType:"number-pad",onChangeText:function(e){return l(fr.setField(["credits",Number(e)]))}}),a.createElement(fn.a,{type:r.fields.credits.error?"error":"info"},r.fields.credits.error||"Current balance: $"+((null==(n=r.original)?void 0:n.credits)||0)))}var gr,vr=Fe.a.create({fields:{flex:1},field:{marginBottom:8}});function br(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function yr(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?br(Object(t),!0).forEach((function(n){p()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):br(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var hr,Er=Object(g.gql)(gr||(gr=Ke()(["\n  mutation UpdateDropzoneUser(\n    $credits: Float,\n    $userRoleId: Int,\n    $expiresAt: Int,\n    $dropzoneUserId: Int\n  ) {\n    updateDropzoneUser(\n      input: {\n        id: $dropzoneUserId,\n        attributes: {\n          credits: $credits,\n          userRoleId: $userRoleId,\n          expiresAt: $expiresAt,\n        }\n      }\n    ) {\n      errors\n      fieldErrors {\n        field\n        message\n      }\n      dropzoneUser {\n        id\n        credits\n        expiresAt\n        role {\n          id\n          name\n        }\n\n        user {\n          id\n          name\n        }\n      }\n    }\n  }\n"])));function Sr(e){var n,t=Ee(),r=Se((function(e){return e.dropzoneUserForm})),i=Se((function(e){return e.global})),o=Object(g.useMutation)(Er),s=W()(o,2),u=s[0],c=s[1],d=Object(a.useCallback)((function(){var e=!1;return r.fields.credits.value||(e=!0,t(pe.setFieldError(["credits","Required"]))),r.fields.role.value||(e=!0,t(pe.setFieldError(["role","User must have an access level"]))),r.fields.expiresAt.value||(e=!0,t(pe.setFieldError(["expiresAt","Membership expiry must be set"]))),!e}),[JSON.stringify(r.fields)]),m=Object(a.useCallback)((function(){var n,a,l,i,o,s,c,m,f,p,g,v;return we.a.async((function(b){for(;;)switch(b.prev=b.next){case 0:if(d()){b.next=2;break}return b.abrupt("return");case 2:return b.prev=2,b.next=5,we.a.awrap(u({variables:yr(yr({},null!=(n=r.original)&&n.id?{id:null==(a=r.original)?void 0:a.id}:{}),{},{credits:r.fields.credits.value,userRoleId:Number(null==(l=r.fields.role.value)?void 0:l.id),expiresAt:r.fields.expiresAt.value,dropzoneUserId:Number(null==(i=r.original)?void 0:i.id)})}));case 5:if(g=b.sent,null==(v=null!=(o=r.original)&&o.id?null==(s=g.data)?void 0:s.updateRig:null==(c=g.data)?void 0:c.createRig)||null==(m=v.fieldErrors)||m.map((function(e){var n=e.field,r=e.message;switch(n){case"user_role":return t(pe.setFieldError(["role",r]));case"credits":return t(pe.setFieldError(["credits",r]));case"expires_at":return t(pe.setFieldError(["expiresAt",r]))}})),null==v||null==(f=v.errors)||!f.length){b.next=10;break}return b.abrupt("return",t(de.showSnackbar({message:null==v?void 0:v.errors[0],variant:"error"})));case 10:null!=v&&null!=(p=v.fieldErrors)&&p.length||e.onSuccess(),b.next=16;break;case 13:b.prev=13,b.t0=b.catch(2),t(de.showSnackbar({message:b.t0.message,variant:"error"}));case 16:case"end":return b.stop()}}),null,null,[[2,13]],Promise)}),[JSON.stringify(r.fields),u,e.onSuccess]);return l.a.createElement(on.a,null,l.a.createElement(sn.a,{visible:!!e.open},l.a.createElement(an.a,{indeterminate:!0,visible:c.loading,color:i.theme.colors.accent}),l.a.createElement(sn.a.Title,null,(null!=r&&null!=(n=r.original)&&n.id?"Edit":"New")+" rig"),l.a.createElement(sn.a.Content,null,l.a.createElement(pr,null)),l.a.createElement(sn.a.Actions,{style:{justifyContent:"flex-end"}},l.a.createElement(un.a,{onPress:function(){t(pe.reset()),e.onClose()}},"Cancel"),l.a.createElement(un.a,{onPress:m},"Save"))))}var xr=Object(nn.a)(hr||(hr=Ke()(["\n  query QueryDropzoneUser($dropzoneId: Int!, $dropzoneUserId: Int!) {\n    dropzone(id: $dropzoneId) {\n      id\n      name\n\n      dropzoneUser(id: $dropzoneUserId) {\n        id\n        credits\n        expiresAt\n        role {\n          id\n          name\n        }\n        user {\n          id\n          name\n          exitWeight\n          email\n          phone\n          rigs {\n            id\n            model\n            make\n            serial\n            canopySize\n            repackExpiresAt\n          }\n          jumpTypes {\n            id\n            name\n          }\n          license {\n            id\n            name\n          }\n        }\n      }\n    }\n  }\n"])));function Ir(){var e,n,t,r,l,i,o,s,u,c,d,m,f,p,v,b,y,h,E,S,x,I,k,O,z,w,C,j,P,$,T,F,N,D,M,A,U,q,B=Se((function(e){return e.global})),R=Ee(),L=Object(Xe.useNavigation)(),H=a.useState(!1),Q=W()(H,2),V=Q[0],J=Q[1],G=a.useState(!1),_=W()(G,2),Y=_[0],Z=_[1],K=Object(Xe.useRoute)(),X=(null==(e=B.currentUser)?void 0:e.id)===K.params.userId,ee=Object(g.useQuery)(xr,{variables:{dropzoneId:Number(null==(n=B.currentDropzone)?void 0:n.id),dropzoneUserId:Number(K.params.userId)}}),ne=ee.data,te=ee.loading,re=a.useCallback((function(e){return function(){R(ge.setOriginal(e)),J(!0)}}),[R,J]);return a.createElement(a.Fragment,null,a.createElement(an.a,{color:B.theme.colors.accent,indeterminate:!0,visible:te}),a.createElement(sr,{contentContainerStyle:kr.content},a.createElement(Gn.a,{elevation:3,style:kr.card},a.createElement(Gn.a.Title,{title:"Basic information"}),a.createElement(Gn.a.Content,null,a.createElement(pn.a.Item,{title:"Name",left:function(){return a.createElement(pn.a.Icon,{icon:"account-outline"})},description:(null==ne||null==(t=ne.dropzone)||null==(r=t.dropzoneUser)||null==(l=r.user)?void 0:l.name)||"-"}),a.createElement(pn.a.Item,{title:"Email",left:function(){return a.createElement(pn.a.Icon,{icon:"at"})},description:(null==ne||null==(i=ne.dropzone)||null==(o=i.dropzoneUser)||null==(s=o.user)?void 0:s.email)||"-"}),a.createElement(pn.a.Item,{title:"Phone",left:function(){return a.createElement(pn.a.Icon,{icon:"phone"})},description:(null==ne||null==(u=ne.dropzone)||null==(c=u.dropzoneUser)||null==(d=c.user)?void 0:d.phone)||"-"}),a.createElement(pn.a.Item,{title:"License",left:function(){return a.createElement(pn.a.Icon,{icon:"ticket-account"})},description:(null==ne||null==(m=ne.dropzone)||null==(f=m.dropzoneUser)||null==(p=f.user)||null==(v=p.license)?void 0:v.name)||"-"}),a.createElement(pn.a.Item,{title:"Exit weight",left:function(){return a.createElement(pn.a.Icon,{icon:"scale"})},description:(null==ne||null==(b=ne.dropzone)||null==(y=b.dropzoneUser)||null==(h=y.user)?void 0:h.exitWeight)||"-"})),X&&a.createElement(Gn.a.Actions,{style:{justifyContent:"flex-end"}},a.createElement(un.a,{icon:"pencil",onPress:function(){var e;return L.navigate("UpdateUserScreen",{user:null==(e=B.currentDropzone)?void 0:e.currentUser})}},"Edit"))),a.createElement(Gn.a,{elevation:3,style:kr.card},a.createElement(Gn.a.Title,{title:null==(E=B.currentDropzone)?void 0:E.name}),a.createElement(Gn.a.Content,null,a.createElement(pn.a.Item,{title:"Role",description:null==ne||null==(S=ne.dropzone)||null==(x=S.dropzoneUser)||null==(I=x.role)?void 0:I.name,left:function(){return a.createElement(pn.a.Icon,{icon:"lock"})}}),a.createElement(pn.a.Item,{title:"Credits",description:null==ne||null==(k=ne.dropzone)||null==(O=k.dropzoneUser)?void 0:O.credits,left:function(){return a.createElement(pn.a.Icon,{icon:"cash-multiple"})}}),a.createElement(pn.a.Item,{title:"Membership",description:null!=ne&&null!=(z=ne.dropzone)&&null!=(w=z.dropzoneUser)&&w.expiresAt?Object(Gt.a)(1e3*((null==ne||null==(C=ne.dropzone)||null==(j=C.dropzoneUser)?void 0:j.expiresAt)||0),"yyyy/MM/dd"):a.createElement("span",null,"Not a member"),left:function(){var e,n,t,r;return a.createElement(pn.a.Icon,{icon:"card-account-details",color:null!=ne&&null!=(e=ne.dropzone)&&null!=(n=e.dropzoneUser)&&n.expiresAt&&1e3*(null==ne||null==(t=ne.dropzone)||null==(r=t.dropzoneUser)?void 0:r.expiresAt)>(new Date).getTime()?void 0:"#B00020"})}})),a.createElement(Gn.a.Actions,{style:{justifyContent:"flex-end"}},a.createElement(un.a,{icon:"pencil",onPress:function(){var e;R(pe.setOriginal(null==ne||null==(e=ne.dropzone)?void 0:e.dropzoneUser)),Z(!0)}},"Edit"))),a.createElement(Gn.a,{elevation:3,style:kr.card},a.createElement(Gn.a.Title,{title:"Rigs"}),a.createElement(Gn.a.Content,null,a.createElement(_n.a,null,a.createElement(_n.a.Header,null,a.createElement(_n.a.Title,null,"Container"),a.createElement(_n.a.Title,{numeric:!0},"Repack due"),a.createElement(_n.a.Title,{numeric:!0},"Canopy size")),null==ne||null==(P=ne.dropzone)||null==($=P.dropzoneUser)||null==(T=$.user)||null==(F=T.rigs)?void 0:F.map((function(e){return a.createElement(_n.a.Row,{onPress:re(e)},a.createElement(_n.a.Cell,{onPress:re(e)},[null==e?void 0:e.make,null==e?void 0:e.model,"#"+(null==e?void 0:e.serial)].join(" ")),a.createElement(_n.a.Cell,{onPress:re(e),numeric:!0},null!=e&&e.repackExpiresAt?Object(Gt.a)(1e3*e.repackExpiresAt,"yyyy/MM/dd"):"-"),a.createElement(_n.a.Cell,{onPress:re(e),numeric:!0},""+(null==e?void 0:e.canopySize)))})))),X&&a.createElement(Gn.a.Actions,{style:{justifyContent:"flex-end"}},a.createElement(un.a,{onPress:function(){return J(!0)}},"Add rig"))),(null==ne||null==(N=ne.dropzone)||null==(D=N.dropzoneUser)?void 0:D.id)===(null==(M=B.currentUser)?void 0:M.id)&&a.createElement(un.a,{color:"#B00020",onPress:function(){return R(ue.logout())}},"Log out")),a.createElement(or,{onClose:function(){return J(!1)},onSuccess:function(){return J(!1)},userId:Number(null==ne||null==(A=ne.dropzone)||null==(U=A.dropzoneUser)||null==(q=U.user)?void 0:q.id),open:V}),a.createElement(Sr,{onClose:function(){return Z(!1)},onSuccess:function(){return Z(!1)},open:Y}))}var kr=Fe.a.create({container:{flex:1},content:{alignItems:"center",flexGrow:1,paddingBottom:56},card:{marginVertical:8,width:"80%"},fields:{width:"80%",display:"flex"},spacer:{width:"100%",height:32},title:{fontSize:20,fontWeight:"bold"},fab:{position:"absolute",margin:16,right:0,bottom:0},separator:{marginVertical:30,height:1,width:"80%"}});function Or(){return a.createElement(Bn,{style:Cr.container},a.createElement(Wn,{style:Cr.title},"Tab One"),a.createElement(Bn,{style:Cr.separator,lightColor:"#eee",darkColor:"rgba(255,255,255,0.1)"}),a.createElement(ht,{path:"/screens/RigScreen.tsx"}))}var zr,wr,Cr=Fe.a.create({container:{flex:1,alignItems:"center",justifyContent:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"}}),jr=Object(nn.a)(zr||(zr=Ke()(["\n  query Licenses($federationId: Int) {\n    licenses(federationId: $federationId) {\n      id\n      name\n\n      federation {\n        id\n        name\n      }\n\n    }\n  }\n"])));function Pr(e){var n,t,r=Object(a.useState)(!1),i=W()(r,2),o=i[0],s=i[1],u=(Se((function(e){return e.global})),Object(g.useQuery)(jr,{variables:{federationId:e.federationId}})),c=u.data;u.loading,u.refetch;return l.a.createElement(l.a.Fragment,null,l.a.createElement(pn.a.Subheader,null,"License"),l.a.createElement(yn.a,{onDismiss:function(){return s(!1)},visible:o,anchor:l.a.createElement(pn.a.Item,{onPress:function(){s(!0)},title:(null==(n=e.value)?void 0:n.name)||"Please select a license",description:e.required?null:"Optional"})},null==c||null==(t=c.licenses)?void 0:t.map((function(n){return l.a.createElement(pn.a.Item,{onPress:function(){s(!1),e.onSelect(n)},title:n.name||"-"})}))))}var $r=Object(nn.a)(wr||(wr=Ke()(["\n  query Federations {\n    federations {\n      id\n      name\n    }\n  }\n"])));function Tr(e){var n,t,r=Object(a.useState)(!1),i=W()(r,2),o=i[0],s=i[1],u=Object(g.useQuery)($r).data;return Object(a.useEffect)((function(){var n;1!==(null==u||null==(n=u.federations)?void 0:n.length)||e.value||e.onSelect(u.federations[0])}),[JSON.stringify(null==u?void 0:u.federations)]),l.a.createElement(l.a.Fragment,null,l.a.createElement(pn.a.Subheader,null,"Federation"),l.a.createElement(yn.a,{onDismiss:function(){return s(!1)},visible:o,anchor:l.a.createElement(pn.a.Item,{onPress:function(){s(!0)},title:(null==(n=e.value)?void 0:n.name)||"Please select federation",description:e.required?null:"Optional"})},null==u||null==(t=u.federations)?void 0:t.map((function(n){return l.a.createElement(pn.a.Item,{onPress:function(){s(!1),e.onSelect(n)},title:n.name||"-"})}))))}var Fr=ae.actions;function Nr(){var e,n,t,r,l,i,o,s,u,c,d,m,f,p,g,v,b,y,h,E,S,x,I,k,O,z,w,C=Se((function(e){return e.userForm})),j=Ee(),P=Se((function(e){return e.global}));a.useEffect((function(){var e;C.original&&(C.fields.exitWeight.value||j(Fr.setField(["exitWeight",C.original.exitWeight||"60"])),!C.fields.rigs.value&&null!=(e=C.original)&&e.id&&j(Fr.setField(["rigs",C.original.rigs])))}),[null==(e=C.original)?void 0:e.id]);null==C||null==(n=C.original)||n.id,null==C||null==(t=C.original)||t.id,null==(r=P.currentUser)||r.id;return a.createElement(mn.a,{style:Mr.fields,contentContainerStyle:{flexGrow:1}},a.createElement(bn.a,{style:Mr.field,mode:"outlined",label:"Name",error:!!C.fields.name.error,value:(null==(l=C.fields.name)||null==(i=l.value)?void 0:i.toString())||"",onChangeText:function(e){return j(Fr.setField(["name",e]))}}),a.createElement(fn.a,{type:C.fields.name.error?"error":"info"},C.fields.name.error||" "),a.createElement(bn.a,{style:Mr.field,mode:"outlined",label:"Email",error:!!C.fields.email.error,value:(null==(o=C.fields.email)||null==(s=o.value)?void 0:s.toString())||"",onChangeText:function(e){return j(Fr.setField(["email",e]))}}),a.createElement(fn.a,{type:C.fields.email.error?"error":"info"},C.fields.email.error||" "),a.createElement(bn.a,{style:Mr.field,mode:"outlined",label:"Phone",error:!!C.fields.phone.error,value:(null==(u=C.fields.phone)||null==(c=u.value)?void 0:c.toString())||"",onChangeText:function(e){return j(Fr.setField(["phone",e]))}}),a.createElement(fn.a,{type:C.fields.phone.error?"error":"info"},C.fields.phone.error||""),a.createElement(bn.a,{style:Mr.field,mode:"outlined",label:"Exit weight",error:!!C.fields.exitWeight.error,value:(null==(d=C.fields.exitWeight)||null==(m=d.value)?void 0:m.toString())||"",keyboardType:"numbers-and-punctuation",right:function(){return a.createElement(bn.a.Affix,{text:"kg"})},onChangeText:function(e){return j(Fr.setField(["exitWeight",e]))}}),a.createElement(fn.a,{type:C.fields.exitWeight.error?"error":"info"},C.fields.exitWeight.error||""),a.createElement(vn.a,null),a.createElement(Tr,{value:(null==C||null==(f=C.fields)||null==(p=f.license)||null==(g=p.value)?void 0:g.federation)||C.federation.value,onSelect:function(e){return j(Fr.setFederation(e))},required:!0}),a.createElement(fn.a,{type:C.federation.error?"error":"info"},C.federation.error||""),((null==C||null==(v=C.fields)||null==(b=v.license)||null==(y=b.value)||null==(h=y.federation)?void 0:h.id)||(null==C||null==(E=C.federation)||null==(S=E.value)?void 0:S.id))&&a.createElement(a.Fragment,null,a.createElement(Pr,{value:C.fields.license.value,federationId:Number((null==C||null==(x=C.fields)||null==(I=x.license)||null==(k=I.value)||null==(O=k.federation)?void 0:O.id)||(null==(z=C.federation)||null==(w=z.value)?void 0:w.id)),onSelect:function(e){return j(Fr.setField(["license",e]))},required:!0}),a.createElement(fn.a,{type:C.fields.license.error?"error":"info"},C.fields.license.error||"")))}var Dr,Mr=Fe.a.create({fields:{flex:1,width:"70%",paddingTop:32},field:{marginBottom:8},ticketAddons:{marginBottom:8}}),Ar=ae.actions,Ur=(N.actions,Object(g.gql)(Dr||(Dr=Ke()(["\n  mutation UpdateUser(\n    $id: Int,\n    $name: String,\n    $phone: String,\n    $email: String,\n    $licenseId: Int,\n    $exitWeight: Float,\n  ){\n    updateUser(input: {\n      id: $id\n      attributes: {\n        name: $name,\n        phone: $phone,\n        email: $email,\n        licenseId: $licenseId,\n        exitWeight: $exitWeight,\n      }\n    }) {\n      user {\n        id\n        name\n        exitWeight\n        email\n        phone\n        rigs {\n          id\n          model\n          make\n          serial\n          canopySize\n        }\n        jumpTypes {\n          id\n          name\n        }\n        license {\n          id\n          name\n\n          federation {\n            id\n            name\n          }\n        }\n      }\n    }\n  }\n"]))));function qr(){var e=Se((function(e){return e})),n=e.userForm,t=(e.global,Ee()),r=Object(Xe.useNavigation)(),l=Object(Xe.useRoute)().params.user;a.useEffect((function(){t(Ar.setOriginal(l))}),[null==l?void 0:l.id]);var i=Object(g.useMutation)(Ur),o=W()(i,2),s=o[0],u=o[1],c=a.useCallback((function(){var e,r,a,l,i,o,s,u,c,d=!1,m=new RegExp(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/);return((null==(e=n.fields.name)||null==(r=e.value)?void 0:r.length)||0)<3&&(d=!0,t(Ar.setFieldError(["name","Name is too short"]))),((null==(a=n.fields.email)||null==(l=a.value)?void 0:l.length)||0)<3&&(d=!0,t(Ar.setFieldError(["email","Email is too short"]))),((null==(i=n.fields.phone)||null==(o=i.value)?void 0:o.length)||0)<3&&(d=!0,t(Ar.setFieldError(["phone","Phone number is too short"]))),m.test((null==(s=n.fields)||null==(u=s.email)?void 0:u.value)||"")||(d=!0,t(Ar.setFieldError(["email","Please enter a valid email"]))),((null==(c=n.fields.exitWeight)?void 0:c.value)||0)<30&&(d=!0,t(Ar.setFieldError(["exitWeight","Exit weight seems too low?"]))),!d}),[JSON.stringify(n.fields),t]),d=a.useCallback((function(){var e,a,l,i,o,u,d,m,f,p,g,v,b;return we.a.async((function(y){for(;;)switch(y.prev=y.next){case 0:if(e=n.fields,a=e.name,l=e.license,i=e.phone,o=e.email,u=e.exitWeight,!c()){y.next=12;break}return y.prev=2,y.next=5,we.a.awrap(s({variables:{id:Number(n.original.id),name:a.value,licenseId:null!=(d=l.value)&&d.id?Number(l.value.id):null,phone:i.value,exitWeight:parseFloat(u.value),email:o.value}}));case 5:p=y.sent,null!=(m=p.data)&&null!=(f=m.updateUser)&&f.user&&(g=p.data.updateUser,v=g.fieldErrors,b=g.errors,v?null==v||v.map((function(e){var n=e.field,r=e.message;switch(n){case"name":return t(fe.setFieldError(["name",r]));case"exit_weight":return t(fe.setFieldError(["exitWeight",r]));case"license_id":return t(fe.setFieldError(["license",r]));case"phone":return t(fe.setFieldError(["phone",r]));case"email":return t(fe.setFieldError(["email",r]))}})):null!=b&&b.length?b.map((function(e){return t(zt.showSnackbar({message:e,variant:"error"}))})):(t(zt.showSnackbar({message:"Profile has been updated",variant:"success"})),r.goBack(),t(fe.reset()))),y.next=12;break;case 9:y.prev=9,y.t0=y.catch(2),t(zt.showSnackbar({message:y.t0.message,variant:"error"}));case 12:case"end":return y.stop()}}),null,null,[[2,9]],Promise)}),[JSON.stringify(n.fields),t,s]);return a.createElement(Bn,{style:Wr.container},a.createElement(Nr,null),a.createElement(Bn,{style:Wr.fields},a.createElement(un.a,{mode:"contained",disabled:u.loading,onPress:d,loading:u.loading},"Save")))}var Wr=Fe.a.create({container:{flex:1,alignItems:"center",paddingTop:56},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fields:{width:"70%",marginBottom:16},field:{marginBottom:8}}),Br=Object(We.a)();function Rr(){var e,n=Se((function(e){return e.global})).currentDropzone;return a.createElement(Br.Navigator,{screenOptions:{headerShown:!0,header:function(e){return a.createElement(Qt,e)},cardStyle:{flex:1}}},a.createElement(Br.Screen,{name:"ProfileScreen",component:Ir,options:{title:"Profile"},initialParams:{userId:null==n||null==(e=n.currentUser)?void 0:e.id}}),a.createElement(Br.Screen,{name:"UpdateUserScreen",component:qr,options:{title:"Edit profile"}}),a.createElement(Br.Screen,{name:"RigScreen",component:Or,options:{title:"Rig"}}))}function Lr(){var e=Object(Xe.useNavigation)(),n=Se((function(e){return e.global}));return a.createElement(Bn,{style:Hr.container},a.createElement(pn.a.Section,{title:"Dropzone"},a.createElement(pn.a.Item,{title:"Configuration",onPress:function(){return e.navigate("UpdateDropzoneScreen",{dropzone:n.currentDropzone})},left:function(){return a.createElement(pn.a.Icon,{color:"#000",icon:"information-outline"})}}),a.createElement(pn.a.Item,{title:"Planes",onPress:function(){return e.navigate("PlanesScreen")},left:function(){return a.createElement(pn.a.Icon,{color:"#000",icon:"airplane"})}}),a.createElement(pn.a.Item,{title:"Rigs",left:function(){return a.createElement(pn.a.Icon,{color:"#000",icon:"parachute"})},description:"Coming soon"})),a.createElement(pn.a.Section,{title:"Tickets"},a.createElement(pn.a.Item,{title:"Ticket types",onPress:function(){return e.navigate("TicketTypesScreen")},left:function(){return a.createElement(pn.a.Icon,{color:"#000",icon:"ticket"})}}),a.createElement(pn.a.Item,{title:"Ticket add-ons",onPress:function(){return e.navigate("ExtrasScreen")},left:function(){return a.createElement(pn.a.Icon,{color:"#000",icon:"plus"})}})))}var Hr=Fe.a.create({container:{flex:1,padding:8,display:"flex"},fab:{position:"absolute",margin:16,right:0,bottom:0},empty:{flex:1,alignItems:"center",justifyContent:"center",width:"100%",height:"100%"}});function Qr(){return a.createElement(Bn,{style:Gr.container},a.createElement(Wn,{style:Gr.title},"Tab One"),a.createElement(Bn,{style:Gr.separator,lightColor:"#eee",darkColor:"rgba(255,255,255,0.1)"}),a.createElement(ht,{path:"/screens/DropzoneSettingsScreen.tsx"}))}var Vr,Jr,Gr=Fe.a.create({container:{flex:1,alignItems:"center",justifyContent:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"}}),_r=t(130),Yr=t(299),Zr=Object(nn.a)(Vr||(Vr=Ke()(["\n  query QueryTicketType(\n    $dropzoneId: Int!\n  ) {\n    ticketTypes(dropzoneId: $dropzoneId) {\n      id\n      cost\n      currency\n      name\n      altitude\n      allowManifestingSelf\n\n      extras {\n        id\n        name\n      }\n    }\n  }\n"]))),Kr=Object(nn.a)(Jr||(Jr=Ke()(["\n  mutation UpdateTicketTypePublic(\n    $id: Int!,\n    $allowManifestingSelf: Boolean\n  ){\n    updateTicketType(input: {\n      id: $id\n      attributes: {\n        allowManifestingSelf: $allowManifestingSelf\n      }\n    }) {\n      ticketType {\n        id\n        name\n        altitude\n        cost\n        allowManifestingSelf\n        extras {\n          id\n          name\n          cost\n        }\n      }\n    }\n  }\n"])));function Xr(){var e,n,t=Se((function(e){return e.global})),r=Object(g.useQuery)(Zr,{variables:{dropzoneId:Number(null==(e=t.currentDropzone)?void 0:e.id)}}),l=r.data,i=r.loading,o=r.refetch,s=Object(Xe.useNavigation)(),u=Object(Xe.useRoute)(),c=Object(g.useMutation)(Kr),d=W()(c,2),m=d[0];d[1];return a.useEffect((function(){"TicketTypesScreen"===u.name&&o()}),[u.name]),a.createElement(rn.b,{style:ea.container,contentContainerStyle:[ea.content,{backgroundColor:"white"}],refreshControl:a.createElement(_r.a,{refreshing:i,onRefresh:o})},a.createElement(an.a,{visible:i,color:t.theme.colors.accent}),a.createElement(_n.a,null,a.createElement(_n.a.Header,null,a.createElement(_n.a.Title,null,"Name"),a.createElement(_n.a.Title,{numeric:!0},"Cost"),a.createElement(_n.a.Title,{numeric:!0},"Altitude"),a.createElement(_n.a.Title,{numeric:!0},"Public")),null==l||null==(n=l.ticketTypes)?void 0:n.map((function(e){return a.createElement(_n.a.Row,{onPress:function(){return s.navigate("UpdateTicketTypeScreen",{ticketType:e})}},a.createElement(_n.a.Cell,null,e.name),a.createElement(_n.a.Cell,{numeric:!0},"$",e.cost),a.createElement(_n.a.Cell,{numeric:!0},e.altitude),a.createElement(_n.a.Cell,{numeric:!0},a.createElement(Yr.a,{onValueChange:function(){m({variables:{id:Number(e.id),allowManifestingSelf:!e.allowManifestingSelf}})},value:!!e.allowManifestingSelf})))}))),a.createElement(ln.a,{style:ea.fab,small:!0,icon:"plus",onPress:function(){return s.navigate("CreateTicketTypeScreen")},label:"New ticket type"}))}var ea=Fe.a.create({container:{flex:1,display:"flex"},content:{flexGrow:1},fab:{position:"absolute",margin:16,right:0,bottom:0},empty:{flex:1,alignItems:"center",justifyContent:"center",width:"100%",height:"100%"}}),na=G.actions;function ta(){var e,n,t,r,l=Se((function(e){return e.planeForm})),i=Ee();return a.createElement(mn.a,{style:aa.fields,contentContainerStyle:{paddingTop:200}},a.createElement(bn.a,{style:aa.field,mode:"outlined",label:"Name",error:!!l.fields.name.error,value:l.fields.name.value,onChangeText:function(e){return i(na.setField(["name",e]))}}),a.createElement(fn.a,{type:l.fields.name.error?"error":"info"},l.fields.name.error||""),a.createElement(bn.a,{style:aa.field,mode:"outlined",label:"Registration",error:!!l.fields.registration.error,value:l.fields.registration.value,onChangeText:function(e){return i(na.setField(["registration",e]))}}),a.createElement(fn.a,{type:l.fields.registration.error?"error":"info"},l.fields.registration.error||""),a.createElement(bn.a,{style:aa.field,mode:"outlined",label:"hours",error:!!l.fields.hours.error,value:null==(e=l.fields.hours)||null==(n=e.value)?void 0:n.toString(),placeholder:"Optional",onChangeText:function(e){return i(na.setField(["hours",Number(e)]))}}),a.createElement(fn.a,{type:l.fields.hours.error?"error":"info"},l.fields.hours.error||""),a.createElement(bn.a,{style:aa.field,mode:"outlined",label:"Min slots",error:!!l.fields.minSlots.error,value:null==(t=l.fields.minSlots.value)?void 0:t.toString(),keyboardType:"number-pad",onChangeText:function(e){return i(na.setField(["minSlots",Number(e)]))}}),a.createElement(fn.a,{type:l.fields.minSlots.error?"error":"info"},l.fields.minSlots.error||"Minimum tickets required to send it"),a.createElement(bn.a,{style:aa.field,mode:"outlined",label:"Max slots",error:!!l.fields.maxSlots.error,value:null==(r=l.fields.maxSlots)?void 0:r.value.toString(),keyboardType:"number-pad",onChangeText:function(e){return i(na.setField(["maxSlots",Number(e)]))}}),a.createElement(fn.a,{type:l.fields.maxSlots.error?"error":"info"},l.fields.maxSlots.error||"Maximum amount of jumpers who can be manifested on one load"))}var ra,aa=Fe.a.create({fields:{width:"70%",flex:1},field:{marginBottom:8}}),la=G.actions,ia=(N.actions,Object(g.gql)(ra||(ra=Ke()(["\n  mutation CreatePlane(\n    $name: String!,\n    $registration: String!,\n    $dropzoneId: Int!\n    $minSlots: Int!\n    $maxSlots: Int!\n    $hours: Int\n    $nextMaintenanceHours: Int\n  ){\n    createPlane(input: {\n      attributes: {\n        name: $name,\n        registration: $registration,\n        dropzoneId: $dropzoneId\n        minSlots: $minSlots\n        maxSlots: $maxSlots\n        hours: $hours\n        nextMaintenanceHours: $nextMaintenanceHours\n      }\n    }) {\n      plane {\n        id\n        name\n        registration\n        minSlots\n        maxSlots\n        hours\n        nextMaintenanceHours\n\n        dropzone {\n          id\n          name\n          planes {\n            id\n            name\n            registration\n            minSlots\n            maxSlots\n            hours\n            nextMaintenanceHours\n          }\n        }\n      }\n    }\n  }\n"]))));function oa(){var e=Se((function(e){return e})),n=e.planeForm,t=e.global,r=Ee(),l=Object(Xe.useNavigation)(),i=Object(g.useMutation)(ia),o=W()(i,2),s=o[0],u=o[1],c=a.useCallback((function(){var e=!1;return n.fields.name.value.length<3&&(e=!0,r(la.setFieldError(["name","Name is too short"]))),n.fields.registration.value.length<3&&(e=!0,r(la.setFieldError(["registration","Registration is too short"]))),n.fields.maxSlots.value||(e=!0,r(la.setFieldError(["maxSlots","Max slots must be specified"]))),!e}),[JSON.stringify(n.fields),r]),d=a.useCallback((function(){var e,a,i,o,u,d,m,f,p,g,v,b;return we.a.async((function(y){for(;;)switch(y.prev=y.next){case 0:if(e=n.fields,a=e.name,i=e.registration,o=e.maxSlots,u=e.minSlots,d=e.hours,m=e.nextMaintenanceHours,!c()){y.next=12;break}return y.prev=2,y.next=5,we.a.awrap(s({variables:{dropzoneId:Number(null==(f=t.currentDropzone)?void 0:f.id),name:a.value,registration:i.value,minSlots:u.value,maxSlots:o.value,hours:d.value,nextMaintenanceHours:m.value}}));case 5:v=y.sent,null!=(p=v.data)&&null!=(g=p.createPlane)&&g.plane&&(b=v.data.createPlane.plane,r(zt.showSnackbar({message:"Added plane "+b.name,variant:"success"})),l.goBack()),y.next=12;break;case 9:y.prev=9,y.t0=y.catch(2),r(zt.showSnackbar({message:y.t0.message,variant:"error"}));case 12:case"end":return y.stop()}}),null,null,[[2,9]],Promise)}),[JSON.stringify(n.fields),r,s]);return a.createElement(Bn,{style:ua.container},a.createElement(ta,null),a.createElement(Bn,{style:ua.fields},a.createElement(un.a,{mode:"contained",disabled:u.loading,onPress:d,loading:u.loading},"Save")))}var sa,ua=Fe.a.create({container:{flex:1,alignItems:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fields:{width:"70%",marginBottom:16},field:{marginBottom:8}}),ca=G.actions,da=(N.actions,Object(g.gql)(sa||(sa=Ke()(["\n  mutation UpdatePlane(\n    $id: Int!,\n    $name: String!,\n    $registration: String!,\n    $minSlots: Int!\n    $maxSlots: Int!\n    $hours: Int\n    $nextMaintenanceHours: Int\n  ){\n    updatePlane(input: {\n      id: $id\n      attributes: {\n        name: $name,\n        registration: $registration,\n        minSlots: $minSlots\n        maxSlots: $maxSlots\n        hours: $hours\n        nextMaintenanceHours: $nextMaintenanceHours\n      }\n    }) {\n      plane {\n        id\n        name\n        registration\n        minSlots\n        maxSlots\n        hours\n        nextMaintenanceHours\n\n        dropzone {\n          id\n          name\n          planes {\n            id\n            name\n            registration\n            minSlots\n            maxSlots\n            hours\n            nextMaintenanceHours\n          }\n        }\n      }\n    }\n  }\n"]))));function ma(){var e=Se((function(e){return e})),n=e.planeForm,t=(e.global,Ee()),r=Object(Xe.useNavigation)(),l=Object(Xe.useRoute)().params.plane;a.useEffect((function(){t(ca.setOriginal(l))}),[null==l?void 0:l.id]);var i=Object(g.useMutation)(da),o=W()(i,2),s=o[0],u=o[1],c=a.useCallback((function(){var e=!1;return n.fields.name.value.length<3&&(e=!0,t(ca.setFieldError(["name","Name is too short"]))),n.fields.registration.value.length<3&&(e=!0,t(ca.setFieldError(["registration","Registration is too short"]))),n.fields.maxSlots.value||(e=!0,t(ca.setFieldError(["maxSlots","Max slots must be specified"]))),!e}),[JSON.stringify(n.fields),t]),d=a.useCallback((function(){var e,a,l,i,o,u,d,m,f,p,g;return we.a.async((function(v){for(;;)switch(v.prev=v.next){case 0:if(e=n.fields,a=e.name,l=e.registration,i=e.maxSlots,o=e.minSlots,u=e.hours,d=e.nextMaintenanceHours,!c()){v.next=12;break}return v.prev=2,v.next=5,we.a.awrap(s({variables:{id:Number(n.original.id),name:a.value,registration:l.value,minSlots:o.value,maxSlots:i.value,hours:u.value,nextMaintenanceHours:d.value}}));case 5:p=v.sent,null!=(m=p.data)&&null!=(f=m.updatePlane)&&f.plane&&(g=p.data.updatePlane.plane,t(zt.showSnackbar({message:"Saved plane "+g.name,variant:"success"})),r.goBack()),v.next=12;break;case 9:v.prev=9,v.t0=v.catch(2),t(zt.showSnackbar({message:v.t0.message,variant:"error"}));case 12:case"end":return v.stop()}}),null,null,[[2,9]],Promise)}),[JSON.stringify(n.fields),t,s]);return a.createElement(Bn,{style:pa.container},a.createElement(ta,null),a.createElement(Bn,{style:pa.fields},a.createElement(un.a,{mode:"contained",disabled:u.loading,onPress:d,loading:u.loading},"Save")))}var fa,pa=Fe.a.create({container:{flex:1,alignItems:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fields:{width:"70%",marginBottom:16},field:{marginBottom:8}}),ga=t(378),va=t(376),ba=t(370),ya=t.n(ba),ha=V.actions,Ea=Object(g.gql)(fa||(fa=Ke()(["\n  query QueryFederations {\n    federations {\n      id\n      name\n    }\n  }\n"])));function Sa(){var e,n,t,r,i=Se((function(e){return e})),o=i.dropzoneForm,s=i.global,u=Ee(),c=Object(g.useQuery)(Ea),d=c.data,m=(c.loading,Object(a.useState)(!1)),f=W()(m,2),p=f[0],v=f[1],b=Object(a.useState)(null),y=W()(b,2),h=y[0],E=y[1];Object(a.useEffect)((function(){var e,n;null==d||null==(e=d.federations)||!e.length||null!=(n=o.fields.federation)&&n.value||u(ha.setField(["federation",d.federations[0]]))}),[JSON.stringify(null==d?void 0:d.federations)]);var S=Object(a.useCallback)((function(){var e;return we.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,we.a.awrap(Object(ga.a)({multiple:!1,type:"image"}));case 3:e=n.sent,u(ha.setField(["banner",e.uri])),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),console.log(n.t0);case 10:case"end":return n.stop()}}),null,null,[[0,7]],Promise)}),[u]);return l.a.createElement(l.a.Fragment,null,l.a.createElement(on.a,null,l.a.createElement(sn.a,{visible:!!h,onDismiss:function(){return E(null)}},l.a.createElement(sn.a.Title,null,"Pick a ","primary"===h?"primary color":"secondary color"),l.a.createElement(sn.a.Content,{style:{padding:20,height:400}},l.a.createElement(va.a,{onColorSelected:function(e){u("primary"===h?ha.setField(["primaryColor",e]):ha.setField(["secondaryColor",e]))},style:{flex:1},sliderComponent:ya.a,defaultColor:("primary"===h?o.fields.primaryColor.value:o.fields.secondaryColor.value)||void 0,hideSliders:!0})),l.a.createElement(sn.a.Actions,null,l.a.createElement(un.a,{onPress:function(){return E(null)}},"Cancel"),l.a.createElement(un.a,{disabled:"primary"===h&&!o.fields.primaryColor.value||"secondary"===h&&!o.fields.secondaryColor.value,onPress:function(){console.log({current:s.theme.colors.accent,next:o.fields.secondaryColor.value}),u("primary"===h?ue.setPrimaryColor(o.fields.primaryColor.value):ue.setAccentColor(o.fields.secondaryColor.value)),E(null)}},"Save")))),l.a.createElement(Gn.a,{style:{width:"100%",maxHeight:300}},l.a.createElement(Gn.a.Cover,{source:{uri:o.fields.banner.value||"https://picsum.photos/700"},resizeMode:"cover"}),l.a.createElement(Gn.a.Actions,{style:{justifyContent:"flex-end"}},l.a.createElement(un.a,{onPress:S},"Upload"))),l.a.createElement(Bn,{style:ka.fields},l.a.createElement(pn.a.Subheader,{style:ka.subheader},"Dropzone"),l.a.createElement(bn.a,{style:ka.field,mode:"outlined",label:"Name",error:!!o.fields.name.error,value:o.fields.name.value||"",onChangeText:function(e){return u(ha.setField(["name",e]))}}),l.a.createElement(fn.a,{type:"error"},o.fields.name.error||""),l.a.createElement(pn.a.Subheader,{style:ka.subheader},"Federation"),l.a.createElement(yn.a,{onDismiss:function(){return v(!1)},visible:p,anchor:l.a.createElement(yn.a.Item,{onPress:function(){return v(!0)},title:(null==(e=o.fields)||null==(n=e.federation)||null==(t=n.value)?void 0:t.name)||"",icon:"parachute"})},null==d||null==(r=d.federations)?void 0:r.map((function(e){return l.a.createElement(yn.a.Item,{title:e.name,onPress:function(){u(ha.setField(["federation",e])),v(!1)}})}))),l.a.createElement(fn.a,{type:"error"},o.fields.federation.error||""),l.a.createElement(pn.a.Subheader,{style:ka.subheader},"Branding"),l.a.createElement(pn.a.Item,{title:"Primary color",onPress:function(){return E("primary")},left:function(){return l.a.createElement(Bn,{style:{width:24,height:24,backgroundColor:s.theme.colors.primary}})}}),l.a.createElement(pn.a.Item,{title:"Secondary color",onPress:function(){return E("secondary")},left:function(){return l.a.createElement(Bn,{style:{width:24,height:24,backgroundColor:s.theme.colors.accent}})}}),l.a.createElement(pn.a.Item,{title:"Use credit system",description:"Users will be charged credits when a load is marked as landed and can't manifest with insufficient funds.",onPress:function(){return u(ha.setField(["isCreditSystemEnabled",!o.fields.isCreditSystemEnabled.value]))},left:function(){return l.a.createElement(wt.a,{onPress:function(){return u(ha.setField(["isCreditSystemEnabled",!o.fields.isCreditSystemEnabled.value]))},status:o.fields.isCreditSystemEnabled.value?"checked":"unchecked"})}}),l.a.createElement(pn.a.Item,{title:"Public",description:"Your dropzone will not be available in the app if this is disabled",onPress:function(){return u(ha.setField(["isPublic",!o.fields.isPublic.value]))},left:function(){return l.a.createElement(wt.a,{onPress:function(){return u(ha.setField(["isPublic",!o.fields.isPublic.value]))},status:o.fields.isPublic.value?"checked":"unchecked"})}})))}var xa,Ia,ka=Fe.a.create({fields:{flexGrow:1,display:"flex",width:"70%"},field:{marginBottom:8},subheader:{paddingLeft:0}});function Oa(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function za(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Oa(Object(t),!0).forEach((function(n){p()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Oa(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var wa=V.actions,Ca=N.actions,ja=Object(g.gql)(xa||(xa=Ke()(["\n  query QueryDropzoneDetails($dropzoneId: Int!) {\n    dropzone(id: $dropzoneId) {\n      id\n      name\n      primaryColor,\n      secondaryColor,\n      planes {\n        id\n        name\n        registration\n      }\n      ticketTypes {\n        id\n        name\n      }\n    }\n  }\n"]))),Pa=Object(g.gql)(Ia||(Ia=Ke()(["\n  mutation UpdateDropzone(\n    $id: Int!,\n    $name: String!,\n    $banner: String,\n    $federationId: Int!\n    $primaryColor: String\n    $secondaryColor: String\n    $isCreditSystemEnabled: Boolean,\n    $isPublic: Boolean\n  ){\n    updateDropzone(input: {\n      id: $id\n      attributes: {\n        name: $name,\n        banner: $banner,\n        federationId: $federationId\n        primaryColor: $primaryColor\n        secondaryColor: $secondaryColor\n        isCreditSystemEnabled: $isCreditSystemEnabled\n        isPublic: $isPublic\n      }\n    }) {\n      dropzone {\n        id\n        name\n        banner\n        primaryColor\n        secondaryColor,\n        isCreditSystemEnabled\n\n        planes {\n          id\n          name\n        }\n\n        federation {\n          id\n          name\n        }\n      }\n    }\n  }\n"])));function $a(){var e,n=Se((function(e){return e.dropzoneForm})),t=Se((function(e){return e.global})),r=Ee(),l=Object(Xe.useRoute)().params.dropzone,i=Object(Xe.useNavigation)(),o=Object(g.useQuery)(ja,{variables:{dropzoneId:Number(l.id)}}),s=o.data,u=o.loading;a.useEffect((function(){var e;null!=s&&null!=(e=s.dropzone)&&e.id&&r(wa.setOriginal(s.dropzone))}),[null==s||null==(e=s.dropzone)?void 0:e.id]);var c=Object(g.useMutation)(Pa),d=W()(c,2),m=d[0],f=d[1],p=a.useCallback((function(){var e,a,o,s,u,c,d,f,p,g,v,b,y,h,E,S,x,I,k,O,z,w,C,j,P,$,T,F;return we.a.async((function(N){for(;;)switch(N.prev=N.next){case 0:if(o=!1,s=n.fields,u=s.name,c=s.banner,d=s.federation,f=s.primaryColor,p=s.secondaryColor,g=s.isCreditSystemEnabled,v=s.isPublic,(null==(e=u.value)||!e.length||(null==(a=u.value)?void 0:a.length)<3)&&(o=!0,r(wa.setFieldError(["name","Name is too short"]))),o){N.next=19;break}return N.prev=4,N.next=7,we.a.awrap(m({variables:{id:Number(null==l?void 0:l.id),name:u.value,banner:c.value||null,primaryColor:f.value,secondaryColor:p.value,federationId:Number(null==d||null==(b=d.value)?void 0:b.id),isCreditSystemEnabled:!!g,isPublic:!!v}}));case 7:if(null==(w=N.sent)||null==(y=w.data)||null==(h=y.updateDropzone)||null==(E=h.fieldErrors)||E.map((function(e){var n=e.field,t=e.message;switch(n){case"federation":case"federation_id":return r(wa.setFieldError(["federation",t]));case"banner":return r(wa.setFieldError(["banner",t]));case"primary_color":return r(wa.setFieldError(["primaryColor",t]));case"secondary_color":return r(wa.setFieldError(["secondaryColor",t]));case"is_credit_system_enabled":return r(wa.setFieldError(["isCreditSystemEnabled",t]));case"name":return r(wa.setFieldError(["name",t]));case"is_public":return r(wa.setFieldError(["isPublic",t]))}})),null==w||null==(S=w.data)||null==(x=S.updateDropzone)||null==(I=x.errors)||!I.length){N.next=13;break}return N.abrupt("return",r(de.showSnackbar({message:null==w||null==(C=w.data)||null==(j=C.updateDropzone)?void 0:j.errors[0],variant:"error"})));case 13:null!=w&&null!=(k=w.data)&&null!=(O=k.updateDropzone)&&null!=(z=O.fieldErrors)&&z.length||null!=(P=w.data)&&null!=($=P.updateDropzone)&&$.dropzone&&(r(Ca.setDropzone(za(za({},t.currentDropzone||{}),null==w||null==(T=w.data)||null==(F=T.updateDropzone)?void 0:F.dropzone))),r(zt.showSnackbar({message:"Saved",variant:"success"})),i.goBack());case 14:N.next=19;break;case 16:N.prev=16,N.t0=N.catch(4),r(zt.showSnackbar({message:N.t0.message,variant:"error"}));case 19:case"end":return N.stop()}}),null,null,[[4,16]],Promise)}),[JSON.stringify(n.fields),r,m]);return a.createElement(a.Fragment,null,a.createElement(an.a,{indeterminate:!0,color:t.theme.colors.accent,visible:u}),a.createElement(mn.a,{style:Fa.container,contentContainerStyle:Fa.content},a.createElement(Sa,null),a.createElement(Bn,{style:Fa.fields},a.createElement(un.a,{mode:"contained",disabled:f.loading,onPress:p,loading:f.loading},"Save"))))}var Ta,Fa=Fe.a.create({container:{flex:1,backgroundColor:"white",display:"flex"},content:{display:"flex",flexGrow:1,alignItems:"center",paddingBottom:56},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fields:{width:"70%",marginBottom:16},field:{marginBottom:8}}),Na=t(96),Da=Object(nn.a)(Ta||(Ta=Ke()(["\n  query QueryPlanes(\n    $dropzoneId: Int!\n  ) {\n    planes(dropzoneId: $dropzoneId) {\n      id\n      name\n      registration\n      hours\n      minSlots\n      maxSlots\n      nextMaintenanceHours\n      createdAt\n    }\n  }\n"])));function Ma(){var e,n=Se((function(e){return e.global})),t=Object(g.useQuery)(Da,{variables:{dropzoneId:Number(null==(e=n.currentDropzone)?void 0:e.id)}}),r=t.data,l=t.loading,i=t.refetch,o=Object(Xe.useNavigation)();Object(Xe.useRoute)();return a.createElement(Bn,{style:Ua.container},a.createElement(Na.a,{data:(null==r?void 0:r.planes)||[],numColumns:1,refreshing:l,onRefresh:function(){return i()},style:{flex:1},contentContainerStyle:{flexGrow:1},ListEmptyComponent:function(){return a.createElement(Rn,{title:"No planes?",subtitle:"You need to have at least one plane to manifest loads"})},renderItem:function(e){var n=e.item;return a.createElement(pn.a.Item,{title:n.name,onPress:function(){return o.navigate("UpdatePlaneScreen",{plane:n})},left:function(){return a.createElement(pn.a.Icon,{color:"#000",icon:"airplane"})},right:function(){return a.createElement(pn.a.Icon,{color:"#000",icon:"pencil"})}})}}),a.createElement(ln.a,{style:Ua.fab,small:!0,icon:"plus",onPress:function(){return o.navigate("CreatePlaneScreen")},label:"New plane"}))}var Aa,Ua=Fe.a.create({container:{flex:1,padding:8,display:"flex"},fab:{position:"absolute",margin:16,right:0,bottom:0},empty:{flex:1,alignItems:"center",justifyContent:"center",width:"100%",height:"100%"}}),qa=t(221),Wa=Y.actions,Ba=Object(nn.a)(Aa||(Aa=Ke()(["\n  query QueryExtras(\n    $dropzoneId: Int!\n  ) {\n    extras(dropzoneId: $dropzoneId) {\n      id\n      cost\n      name\n\n      ticketTypes {\n        id\n        name\n      }\n    }\n  }\n"])));function Ra(){var e,n,t,r,l,i=Se((function(e){return e.ticketTypeForm})),o=Ee(),s=Se((function(e){return e.global})),u=a.useState(!1),c=W()(u,2),d=c[0],m=c[1],f=Object(g.useQuery)(Ba,{variables:{dropzoneId:Number(null==(e=s.currentDropzone)?void 0:e.id)}}),p=f.data;f.loading,f.refetch;return a.createElement(mn.a,{style:Ha.fields,contentContainerStyle:{paddingTop:200}},a.createElement(bn.a,{style:Ha.field,mode:"outlined",label:"Name",error:!!i.fields.name.error,value:i.fields.name.value,onChangeText:function(e){return o(Wa.setField(["name",e]))}}),a.createElement(fn.a,{type:i.fields.name.error?"error":"info"},i.fields.name.error||""),a.createElement(bn.a,{style:Ha.field,mode:"outlined",label:"Price",error:!!i.fields.cost.value,value:null==(n=i.fields.cost)||null==(t=n.value)?void 0:t.toString(),onChangeText:function(e){return o(Wa.setField(["cost",Number(e)]))}}),a.createElement(fn.a,{type:i.fields.cost.error?"error":"info"},i.fields.cost.error||""),a.createElement(yn.a,{onDismiss:function(){return m(!1)},visible:d,anchor:a.createElement(pn.a.Item,{onPress:function(){m(!0)},title:[4e3,14e3].includes(i.fields.altitude.value)?{14e3:"Height",4e3:"Hop n Pop"}[i.fields.altitude.value.toString()]:"Custom",right:function(){return a.createElement(pn.a.Icon,{icon:[4e3,14e3].includes(i.fields.altitude.value)?{14e3:"airplane",4e3:"parachute"}[i.fields.altitude.value.toString()]:"pencil-plus"})}})},a.createElement(pn.a.Item,{onPress:function(){o(Wa.setField(["altitude",4e3])),m(!1)},title:"Hop n Pop",right:function(){return a.createElement(pn.a.Icon,{icon:"parachute"})}}),a.createElement(pn.a.Item,{onPress:function(){o(Wa.setField(["altitude",14e3])),m(!1)},title:"Height",right:function(){return a.createElement(pn.a.Icon,{icon:"airplane-takeoff"})}}),a.createElement(pn.a.Item,{onPress:function(){o(Wa.setField(["altitude",7e3])),m(!1)},title:"Other",right:function(){return a.createElement(pn.a.Icon,{icon:"parachute"})}})),![4e3,14e3].includes(i.fields.altitude.value)&&a.createElement(bn.a,{style:Ha.field,mode:"outlined",label:"Custom altitude",error:!!i.fields.altitude.value,value:null==(r=i.fields.altitude)||null==(l=r.value)?void 0:l.toString(),onChangeText:function(e){return o(Wa.setField(["altitude",Number(e)]))}}),a.createElement(wt.a.Item,{label:"Public manifesting",status:i.fields.allowManifestingSelf.value?"checked":"unchecked",onPress:function(){return o(Wa.setField(["allowManifestingSelf",!i.fields.allowManifestingSelf.value]))}}),a.createElement(vn.a,null),a.createElement(pn.a.Subheader,null,"Enabled ticket add-ons"),null==p?void 0:p.extras.map((function(e){return a.createElement(wt.a.Item,{label:e.name,status:i.fields.extraIds.value.includes(Number(e.id))?"checked":"unchecked",onPress:function(){return o(Wa.setField(["extraIds",Object(qa.xor)(i.fields.extraIds.value,[Number(e.id)])]))}})})))}var La,Ha=Fe.a.create({fields:{width:"70%",flex:1},field:{marginBottom:8}}),Qa=Y.actions,Va=(N.actions,Object(g.gql)(La||(La=Ke()(["\n  mutation CreateTicketType(\n    $name: String,\n    $cost: Float,\n    $dropzoneId: Int!\n    $altitude: Int\n    $allowManifestingSelf: Boolean\n  ){\n    createTicketType(input: {\n      attributes: {\n        name: $name,\n        cost: $cost,\n        dropzoneId: $dropzoneId\n        altitude: $altitude\n        allowManifestingSelf: $allowManifestingSelf\n      }\n    }) {\n      ticketType {\n        id\n        name\n        altitude\n        cost\n        allowManifestingSelf\n        extras {\n          id\n          name\n          cost\n        }\n      }\n    }\n  }\n"]))));function Ja(){var e=Se((function(e){return e})),n=e.ticketTypeForm,t=e.global,r=Ee(),l=Object(Xe.useNavigation)(),i=Object(g.useMutation)(Va),o=W()(i,2),s=o[0],u=o[1],c=a.useCallback((function(){var e=!1;return n.fields.name.value.length<3&&(e=!0,r(Qa.setFieldError(["name","Name is too short"]))),n.fields.cost.value<1&&(e=!0,r(Qa.setFieldError(["cost","Cost must be at least $1"]))),n.fields.altitude.value||(e=!0,r(Qa.setFieldError(["altitude","Altitude must be specified"]))),!e}),[JSON.stringify(n.fields),r]),d=a.useCallback((function(){var e,a,i,o,u,d,m,f,p,g,v;return we.a.async((function(b){for(;;)switch(b.prev=b.next){case 0:if(e=n.fields,a=e.name,i=e.cost,o=e.allowManifestingSelf,u=e.altitude,d=e.extraIds,!c()){b.next=12;break}return b.prev=2,b.next=5,we.a.awrap(s({variables:{dropzoneId:Number(null==(m=t.currentDropzone)?void 0:m.id),name:a.value,cost:i.value,altitude:u.value,allowManifestingSelf:o.value,extraIds:d.value}}));case 5:g=b.sent,null!=(f=g.data)&&null!=(p=f.createTicketType)&&p.ticketType&&(v=g.data.createTicketType.ticketType,r(zt.showSnackbar({message:"Added ticket "+v.name,variant:"success"})),l.goBack()),b.next=12;break;case 9:b.prev=9,b.t0=b.catch(2),r(zt.showSnackbar({message:b.t0.message,variant:"error"}));case 12:case"end":return b.stop()}}),null,null,[[2,9]],Promise)}),[JSON.stringify(n.fields),r,s]);return a.createElement(Bn,{style:_a.container},a.createElement(Ra,null),a.createElement(Bn,{style:_a.fields},a.createElement(un.a,{mode:"contained",disabled:u.loading,onPress:d,loading:u.loading},"Save")))}var Ga,_a=Fe.a.create({container:{flex:1,alignItems:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fields:{width:"70%",marginBottom:16},field:{marginBottom:8}}),Ya=Y.actions,Za=(N.actions,Object(g.gql)(Ga||(Ga=Ke()(["\n  mutation UpdateTicketType(\n    $id: Int!,\n    $name: String,\n    $cost: Float,\n    $dropzoneId: Int!\n    $altitude: Int\n    $allowManifestingSelf: Boolean\n  ){\n    updateTicketType(input: {\n      id: $id\n      attributes: {\n        name: $name,\n        cost: $cost,\n        dropzoneId: $dropzoneId\n        altitude: $altitude\n        allowManifestingSelf: $allowManifestingSelf\n      }\n    }) {\n      ticketType {\n        id\n        name\n        altitude\n        cost\n        allowManifestingSelf\n        extras {\n          id\n          name\n          cost\n        }\n      }\n    }\n  }\n"]))));function Ka(){var e=Se((function(e){return e})),n=e.ticketTypeForm,t=(e.global,Ee()),r=Object(Xe.useNavigation)(),l=Object(Xe.useRoute)().params.ticketType;a.useEffect((function(){t(Ya.setOriginal(l))}),[null==l?void 0:l.id]);var i=Object(g.useMutation)(Za),o=W()(i,2),s=o[0],u=o[1],c=a.useCallback((function(){var e=!1;return n.fields.name.value.length<3&&(e=!0,t(Ya.setFieldError(["name","Name is too short"]))),n.fields.cost.value<1&&(e=!0,t(Ya.setFieldError(["cost","Cost must be at least $1"]))),n.fields.altitude.value||(e=!0,t(Ya.setFieldError(["altitude","Altitude must be specified"]))),!e}),[JSON.stringify(n.fields),t]),d=a.useCallback((function(){var e,a,l,i,o,u,d,m,f;return we.a.async((function(p){for(;;)switch(p.prev=p.next){case 0:if(e=n.fields,a=e.name,l=e.cost,i=e.allowManifestingSelf,o=e.altitude,u=e.extraIds,!c()){p.next=12;break}return p.prev=2,p.next=5,we.a.awrap(s({variables:{id:Number(n.original.id),name:a.value,cost:l.value,altitude:o.value,allowManifestingSelf:i.value,extraIds:u.value}}));case 5:f=p.sent,null!=(d=f.data)&&null!=(m=d.updateTicketType)&&m.ticketType&&(t(zt.showSnackbar({message:"Saved",variant:"success"})),r.goBack()),p.next=12;break;case 9:p.prev=9,p.t0=p.catch(2),t(zt.showSnackbar({message:p.t0.message,variant:"error"}));case 12:case"end":return p.stop()}}),null,null,[[2,9]],Promise)}),[JSON.stringify(n.fields),t,s]);return a.createElement(Bn,{style:el.container},a.createElement(Ra,null),a.createElement(Bn,{style:el.fields},a.createElement(un.a,{mode:"contained",disabled:u.loading,onPress:d,loading:u.loading},"Save")))}var Xa,el=Fe.a.create({container:{flex:1,alignItems:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fields:{width:"70%",marginBottom:16},field:{marginBottom:8}}),nl=K.actions,tl=Object(nn.a)(Xa||(Xa=Ke()(["\n  query QueryTicketType(\n    $dropzoneId: Int!\n  ) {\n    ticketTypes(dropzoneId: $dropzoneId) {\n      id\n      cost\n      currency\n      name\n      allowManifestingSelf\n\n      extras {\n        id\n        name\n      }\n    }\n  }\n"])));function rl(){var e,n,t,r=Se((function(e){return e.extraForm})),l=Ee(),i=Se((function(e){return e.global})),o=Object(g.useQuery)(tl,{variables:{dropzoneId:Number(null==(e=i.currentDropzone)?void 0:e.id)}}),s=o.data;o.loading,o.refetch;return a.createElement(mn.a,{style:ll.fields,contentContainerStyle:{paddingTop:200}},a.createElement(bn.a,{style:ll.field,mode:"outlined",label:"Name",error:!!r.fields.name.error,value:r.fields.name.value,onChangeText:function(e){return l(nl.setField(["name",e]))}}),a.createElement(fn.a,{type:r.fields.name.error?"error":"info"},r.fields.name.error||""),a.createElement(bn.a,{style:ll.field,mode:"outlined",label:"Price",error:!!r.fields.cost.value,value:null==(n=r.fields.cost)||null==(t=n.value)?void 0:t.toString(),onChangeText:function(e){return l(nl.setField(["cost",Number(e)]))}}),a.createElement(fn.a,{type:r.fields.cost.error?"error":"info"},r.fields.cost.error||""),a.createElement(pn.a.Subheader,null,"Compatible tickets"),null==s?void 0:s.ticketTypes.map((function(e){return a.createElement(wt.a.Item,{label:e.name,status:r.fields.ticketTypeIds.value.includes(Number(e.id))?"checked":"unchecked",onPress:function(){return l(nl.setField(["ticketTypeIds",Object(qa.xor)(r.fields.ticketTypeIds.value,[Number(e.id)])]))}})})))}var al,ll=Fe.a.create({fields:{width:"70%",flex:1},field:{marginBottom:8}}),il=K.actions,ol=(N.actions,Object(g.gql)(al||(al=Ke()(["\n  mutation CreateExtra(\n    $name: String,\n    $ticketTypeIds: [Int!]\n    $cost: Float\n    $dropzoneId: Int\n  ){\n    createExtra(input: {\n      attributes: {\n        name: $name,\n        ticketTypeIds: $ticketTypeIds\n        cost: $cost\n        dropzoneId: $dropzoneId\n      }\n    }) {\n      extra {\n        id\n        name\n\n        ticketTypes {\n          id\n          name\n          cost\n          altitude\n          allowManifestingSelf\n        }\n      }\n    }\n  }\n"]))));function sl(){var e=Se((function(e){return e})),n=e.extraForm,t=e.global,r=Ee(),l=Object(Xe.useNavigation)(),i=Object(g.useMutation)(ol),o=W()(i,2),s=o[0],u=o[1],c=a.useCallback((function(){var e=!1;return n.fields.name.value.length<3&&(e=!0,r(il.setFieldError(["name","Name is too short"]))),Number(n.fields.cost.value)<0&&(e=!0,r(il.setFieldError(["cost","Price must be a number"]))),!e}),[JSON.stringify(n.fields),r]),d=a.useCallback((function(){var e,a,i,o,u,d,m,f,p;return we.a.async((function(g){for(;;)switch(g.prev=g.next){case 0:if(e=n.fields,a=e.name,i=e.cost,o=e.ticketTypeIds,!c()){g.next=12;break}return g.prev=2,g.next=5,we.a.awrap(s({variables:{dropzoneId:Number(null==(u=t.currentDropzone)?void 0:u.id),name:a.value,cost:i.value,ticketTypeIds:o.value}}));case 5:f=g.sent,null!=(d=f.data)&&null!=(m=d.createExtra)&&m.extra&&(p=f.data.createExtra.extra,r(zt.showSnackbar({message:"Added extra "+p.name,variant:"success"})),l.goBack()),g.next=12;break;case 9:g.prev=9,g.t0=g.catch(2),r(zt.showSnackbar({message:g.t0.message,variant:"error"}));case 12:case"end":return g.stop()}}),null,null,[[2,9]],Promise)}),[JSON.stringify(n.fields),r,s]);return a.createElement(Bn,{style:cl.container},a.createElement(rl,null),a.createElement(Bn,{style:cl.fields},a.createElement(un.a,{mode:"contained",disabled:u.loading,onPress:d,loading:u.loading},"Save")))}var ul,cl=Fe.a.create({container:{flex:1,alignItems:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fields:{width:"70%",marginBottom:16},field:{marginBottom:8}}),dl=K.actions,ml=(N.actions,Object(g.gql)(ul||(ul=Ke()(["\n  mutation UpdateExtra(\n    $id: Int!,\n    $name: String,\n    $ticketTypeIds: [Int!]\n    $cost: Float\n    $dropzoneId: Int\n  ){\n    updateExtra(input: {\n      id: $id\n      attributes: {\n        name: $name,\n        ticketTypeIds: $ticketTypeIds\n        cost: $cost\n        dropzoneId: $dropzoneId\n      }\n    }) {\n      extra {\n        id\n        name\n\n        ticketTypes {\n          id\n          name\n          cost\n          altitude\n          allowManifestingSelf\n        }\n      }\n    }\n  }\n"]))));function fl(){var e=Se((function(e){return e})),n=e.extraForm,t=e.global,r=Ee(),l=Object(Xe.useNavigation)(),i=Object(Xe.useRoute)().params.extra;a.useEffect((function(){r(dl.setOriginal(i))}),[null==i?void 0:i.id]);var o=Object(g.useMutation)(ml),s=W()(o,2),u=s[0],c=s[1],d=a.useCallback((function(){var e=!1;return n.fields.name.value.length<3&&(e=!0,r(dl.setFieldError(["name","Name is too short"]))),Number(n.fields.cost.value)<0&&(e=!0,r(dl.setFieldError(["cost","Price must be a number"]))),!e}),[JSON.stringify(n.fields),r]),m=a.useCallback((function(){var e,a,i,o,s,c,m,f;return we.a.async((function(p){for(;;)switch(p.prev=p.next){case 0:if(e=n.fields,a=e.name,i=e.cost,o=e.ticketTypeIds,!d()){p.next=12;break}return p.prev=2,p.next=5,we.a.awrap(u({variables:{id:Number(n.original.id),dropzoneId:Number(null==(s=t.currentDropzone)?void 0:s.id),name:a.value,cost:i.value,ticketTypeIds:o.value}}));case 5:f=p.sent,null!=(c=f.data)&&null!=(m=c.updateExtra)&&m.extra&&(r(zt.showSnackbar({message:"Saved",variant:"success"})),l.goBack()),p.next=12;break;case 9:p.prev=9,p.t0=p.catch(2),r(zt.showSnackbar({message:p.t0.message,variant:"error"}));case 12:case"end":return p.stop()}}),null,null,[[2,9]],Promise)}),[JSON.stringify(n.fields),r,u]);return a.createElement(Bn,{style:gl.container},a.createElement(rl,null),a.createElement(Bn,{style:gl.fields},a.createElement(un.a,{mode:"contained",disabled:c.loading,onPress:m,loading:c.loading},"Save")))}var pl,gl=Fe.a.create({container:{flex:1,alignItems:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fields:{width:"70%",marginBottom:16},field:{marginBottom:8}}),vl=Object(nn.a)(pl||(pl=Ke()(["\n  query QueryExtra(\n    $dropzoneId: Int!\n  ) {\n    extras(dropzoneId: $dropzoneId) {\n      id\n      cost\n      name\n\n      ticketTypes {\n        id\n        altitude\n        name\n      }\n    }\n  }\n"])));function bl(){var e,n,t,r=Se((function(e){return e.global})),l=Object(g.useQuery)(vl,{variables:{dropzoneId:Number(null==(e=r.currentDropzone)?void 0:e.id)}}),i=l.data,o=l.loading,s=(l.refetch,Object(Xe.useNavigation)());Object(Xe.useRoute)();return a.createElement(a.Fragment,null,a.createElement(an.a,{visible:o,indeterminate:!0,color:r.theme.colors.accent}),a.createElement(Bn,{style:hl.container},a.createElement(_n.a,null,a.createElement(_n.a.Header,null,a.createElement(_n.a.Title,null,"Name"),a.createElement(_n.a.Title,{numeric:!0},"Cost")),null==i||null==(n=i.extras)?void 0:n.map((function(e){return a.createElement(_n.a.Row,null,a.createElement(_n.a.Cell,{onPress:function(){return s.navigate("UpdateExtraScreen",{extra:e})}},e.name),a.createElement(_n.a.Cell,{numeric:!0},e.cost))}))),!o&&!(null!=i&&null!=(t=i.extras)&&t.length)&&a.createElement(Rn,{title:"No ticket addons",subtitle:"You can add multiple addons to assign to tickets, e.g outside camera, or coach"}),a.createElement(ln.a,{style:hl.fab,small:!0,icon:"plus",onPress:function(){return s.navigate("CreateExtraScreen")},label:"New ticket addon"})))}var yl,hl=Fe.a.create({container:{flex:1,padding:8,display:"flex"},fab:{position:"absolute",margin:16,right:0,bottom:0},empty:{flex:1,alignItems:"center",justifyContent:"center",width:"100%",height:"100%"}}),El=Object(We.a)();function Sl(){return a.createElement(El.Navigator,{screenOptions:{headerShown:!0,header:function(e){return a.createElement(Qt,e)},cardStyle:{flex:1}}},a.createElement(El.Screen,{name:"SettingsScreen",component:Lr,options:{title:"Settings"}}),a.createElement(El.Screen,{name:"DropzoneSettingsScreen",component:Qr}),a.createElement(El.Screen,{name:"UpdateDropzoneScreen",component:$a}),a.createElement(El.Screen,{name:"PlanesScreen",component:Ma,options:{title:"Planes"}}),a.createElement(El.Screen,{name:"CreatePlaneScreen",component:oa,options:{title:"New plane"}}),a.createElement(El.Screen,{name:"UpdatePlaneScreen",component:ma,options:{title:"Edit plane"}}),a.createElement(El.Screen,{name:"TicketTypesScreen",component:Xr,options:{title:"Ticket types"}}),a.createElement(El.Screen,{name:"CreateTicketTypeScreen",component:Ja,options:{title:"New ticket type"}}),a.createElement(El.Screen,{name:"UpdateTicketTypeScreen",component:Ka,options:{title:"Edit ticket type"}}),a.createElement(El.Screen,{name:"CreateExtraScreen",component:sl,options:{title:"Create ticket add-on"}}),a.createElement(El.Screen,{name:"UpdateExtraScreen",component:fl,options:{title:"Update ticket add-on"}}),a.createElement(El.Screen,{name:"ExtrasScreen",component:bl,options:{title:"Ticket add-ons"}}))}var xl=Object(nn.a)(yl||(yl=Ke()(["\n  query QueryDropzoneUsersSearch(\n    $dropzoneId: Int!\n    $search: String\n  ) {\n    dropzone(id: $dropzoneId) {\n      id\n      name\n\n      dropzoneUsers(search: $search) {\n        edges {\n          node {\n            id\n            role {\n              id\n              name\n            }\n            user {\n              id\n              name\n            }\n          }\n        }\n      }\n    }\n  }\n"])));function Il(){var e,n,t,r,l,i,o,s=Se((function(e){return e})),u=s.global,c=s.usersScreen,d=Ee(),m=Object(g.useQuery)(xl,{variables:{dropzoneId:Number(null==(e=u.currentDropzone)?void 0:e.id),search:c.searchText}}),f=m.data,p=m.loading,v=Object(Xe.useNavigation)(),b=Object(Xe.useIsFocused)();return a.useEffect((function(){c.isSearchVisible&&d(ce.setSearchVisible(!1))}),[b]),a.createElement(Bn,{style:kl.container},a.createElement(an.a,{indeterminate:!0,color:u.theme.colors.accent,visible:p}),!(null!=f&&null!=(n=f.dropzone)&&null!=(t=n.dropzoneUsers)&&null!=(r=t.edges)&&r.length)&&a.createElement(Rn,{title:"No users",subtitle:""}),null==f||null==(l=f.dropzone)||null==(i=l.dropzoneUsers)||null==(o=i.edges)?void 0:o.map((function(e){var n,t,r;return a.createElement(pn.a.Item,{title:null==e||null==(n=e.node)?void 0:n.user.name,description:null==e||null==(t=e.node)||null==(r=t.role)?void 0:r.name,left:function(){return a.createElement(pn.a.Icon,{icon:"account"})},onPress:function(){var n;return v.navigate("UserProfileScreen",{userId:null==e||null==(n=e.node)?void 0:n.id})}})})))}var kl=Fe.a.create({container:{flex:1},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"}}),Ol=t(485);var zl=Fe.a.create({inputContainer:{flexGrow:1},input:{backgroundColor:"transparent",height:"100%",color:"white",borderColor:"none"},icon:{marginHorizontal:8}}),wl=function(e){var n=e.navigation,t=e.previous,r=e.scene,a=e.onSearch,i=e.searchText,o=e.searchVisible,s=e.setSearchVisible,u=Se((function(e){return e.global}));return u.currentDropzone,u.theme,Ee(),l.a.createElement(Bt.a.Header,null,t?l.a.createElement(Bt.a.BackAction,{onPress:n.goBack}):null,o?l.a.createElement(Bt.a.BackAction,{onPress:function(){return s(!1)}}):null,o?l.a.createElement(d.a,{style:zl.inputContainer},l.a.createElement(bn.a,{style:zl.input,value:i,onChangeText:function(e){return a(e)}})):l.a.createElement(Bt.a.Content,{title:r.descriptor.options.title}),l.a.createElement(Ol.a,{name:"search",onPress:function(){return s(!o)},color:"#FFFFFF",size:24,style:zl.icon}))};function Cl(){return a.createElement(Bn,{style:jl.container},a.createElement(Wn,{style:jl.title},"Tab One"),a.createElement(Bn,{style:jl.separator,lightColor:"#eee",darkColor:"rgba(255,255,255,0.1)"}),a.createElement(ht,{path:"/screens/UserRigScreen.tsx"}))}var jl=Fe.a.create({container:{flex:1,alignItems:"center",justifyContent:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"}}),Pl=Object(We.a)();function $l(){var e=Se((function(e){return e.usersScreen})),n=e.isSearchVisible,t=e.searchText,r=Ee();return a.createElement(Pl.Navigator,{screenOptions:{headerShown:!0,header:function(e){return a.createElement(wl,Ge()({},e,{searchText:t,searchVisible:n,setSearchVisible:function(e){return r(ce.setSearchVisible(e))},onSearch:function(e){return r(ce.setSearchText(e))}}))},cardStyle:{flex:1}}},a.createElement(Pl.Screen,{name:"UsersScreen",component:Il,options:{title:"Dropzone users"}}),a.createElement(Pl.Screen,{name:"UserProfileScreen",component:Ir,options:{title:"User"}}),a.createElement(Pl.Screen,{name:"UserRigScreen",component:Cl}))}var Tl,Fl=Object(Ye.a)();function Nl(){Object(_e.b)();var e=zn("readUser"),n=(zn("createPackjob"),zn("updateDropzone"));return a.createElement(Fl.Navigator,{initialRouteName:"Manifest"},a.createElement(Fl.Screen,{name:"Manifest",component:Jt,options:{tabBarIcon:"airplane"}}),a.createElement(Fl.Screen,{name:"Profile",component:Rr,options:{tabBarIcon:"account-circle"}}),!1,e&&a.createElement(Fl.Screen,{name:"Users",component:$l,options:{tabBarIcon:"account-group"}}),n&&a.createElement(Fl.Screen,{name:"Settings",component:Sl,options:{tabBarIcon:"account-cog"}}))}var Dl=Object(nn.a)(Tl||(Tl=Ke()(["\n  query QueryDropzones {\n    dropzones {\n      edges {\n        node {\n          id\n          name\n          banner\n          ticketTypes {\n            id\n            name\n            cost\n            allowManifestingSelf\n            currency\n          }\n          planes {\n            id\n            name,\n            registration,\n            minSlots,\n            maxSlots,\n          }\n        }\n      }\n    }\n  }\n"])));function Ml(){var e,n=Ee(),t=Object(g.useQuery)(Dl),r=t.data,l=t.loading,i=t.refetch,o=Object(Xe.useNavigation)();return a.createElement(Bn,{style:Ul.container},a.createElement(Na.a,{data:(null==r||null==(e=r.dropzones)?void 0:e.edges)||[],numColumns:2,refreshing:l,onRefresh:function(){return i()},style:{flex:1},contentContainerStyle:{flexGrow:1},ListEmptyComponent:function(){return a.createElement(Bn,{style:Ul.empty},a.createElement(Dn.a,null,"No dropzones?"),a.createElement(Mn.a,null,"You can set one up!"))},renderItem:function(e){var t,r,l=e.item;return a.createElement(Gn.a,{style:{width:tn.a.get("window").width/2-32,margin:8},onPress:function(){return we.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:null!=l&&l.node&&n(ue.setDropzone(l.node));case 1:case"end":return e.stop()}}),null,null,null,Promise)}},a.createElement(Gn.a.Cover,{source:{uri:null==l||null==(t=l.node)?void 0:t.banner}}),a.createElement(Gn.a.Content,null,a.createElement(Dn.a,null,null==l||null==(r=l.node)?void 0:r.name)))}}),a.createElement(ln.a,{style:Ul.fab,small:!0,icon:"plus",onPress:function(){return o.navigate("CreateDropzoneScreen")},label:"Create dropzone"}))}var Al,Ul=Fe.a.create({container:{flex:1,padding:8,display:"flex"},fab:{position:"absolute",margin:16,right:0,bottom:0},empty:{flex:1,alignItems:"center",justifyContent:"center",width:"100%",height:"100%"}});function ql(e){return{message:e,pattern:/.{1,}/}}function Wl(e,n){return{message:e,callback:n}}function Bl(e,n){var t=n.getPayload,r=n.fieldErrorMap,l=n.validates;return function(i){var o=i.onFieldError,s=i.onSuccess,u=i.onError,c=Object(g.useMutation)(e),d=W()(c,2),m=d[0],f=d[1],p=f.data,v=f.loading;f.error;return{loading:v,mutate:Object(a.useCallback)((function(e){var a,c,d,f,p,g;return we.a.async((function(v){for(;;)switch(v.prev=v.next){case 0:if(function(){var t=!1;return l&&Object.keys(e).forEach((function(r){var a,i=r;i in(n.validates||{})&&(null==(a=l[i])||a.forEach((function(n){n.pattern?n.pattern.test(""+e[i])||(t=!0,o&&o(i,n.message)):n.callback&&!n.callback(e)&&(t=!0,o&&o(i,n.message))})))})),!t}()){v.next=3;break}return v.abrupt("return");case 3:return v.prev=3,v.next=6,we.a.awrap(m({variables:e}));case 6:if(f=v.sent,null==(p=t(f.data))||null==(a=p.fieldErrors)||a.map((function(e){var t=e.field,a=e.message,l=t in(r||{})?n.fieldErrorMap[t]:t;i.onFieldError&&i.onFieldError(""+l,a)})),null==p||null==(c=p.errors)||!c.length||!u){v.next=12;break}return null==(g=p.errors)||g.map((function(e){return u(e)})),v.abrupt("return");case 12:return null!=p&&null!=(d=p.fieldErrors)&&d.length||s(p),v.abrupt("return",p);case 16:v.prev=16,v.t0=v.catch(3),u&&u(v.t0.message);case 19:return v.abrupt("return");case 20:case"end":return v.stop()}}),null,null,[[3,16]],Promise)}),[o,u,s,,m,t,JSON.stringify(p)])}}}var Rl=Bl(Object(nn.a)(Al||(Al=Ke()(["\nmutation CreateDropzone(\n  $name: String!,\n  $banner: String!,\n  $federationId: Int!\n){\n  createDropzone(input: { attributes: { name: $name, banner: $banner, federationId: $federationId }}) {\n    dropzone {\n      id\n      name\n      banner\n\n      federation {\n        id\n        name\n      }\n    }\n  }\n}\n"]))),{getPayload:function(e){return e.createDropzone},fieldErrorMap:{federation:"federationId"},validates:{name:[ql("Name is required")]}}),Ll=V.actions,Hl=N.actions;function Ql(){var e=Se((function(e){return e.dropzoneForm})),n=Ee(),t=(Object(Xe.useNavigation)(),Rl({onError:function(e){return n(de.showSnackbar({message:e,variant:"error"}))},onFieldError:function(e,t){return n(Ll.setFieldError([e,t]))},onSuccess:function(e){return n(Hl.setDropzone(e.dropzone))}}));return a.createElement(Bn,{style:Vl.container},a.createElement(Sa,null),a.createElement(Bn,{style:Vl.fields},a.createElement(un.a,{mode:"contained",disabled:t.loading,loading:t.loading,onPress:function(){return t.mutate({name:e.fields.name.value,banner:e.fields.banner.value,federationId:Number(e.fields.federation.value.id)})}},"Save")))}var Vl=Fe.a.create({container:{flex:1,alignItems:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fields:{width:"70%"},field:{marginBottom:8}}),Jl=Object(We.a)();function Gl(){return a.createElement(Jl.Navigator,{screenOptions:{headerShown:!1,cardStyle:{flex:1}},initialRouteName:"Dropzones"},a.createElement(Jl.Screen,{name:"DropzonesScreen",component:Ml}),a.createElement(Jl.Screen,{name:"CreateDropzoneScreen",component:Ql}))}var _l,Yl=t(45),Zl=U.actions,Kl=Object(g.gql)(_l||(_l=Ke()(["\n  mutation UserLogin($email: String!, $password: String!) {\n    userLogin(email: $email, password: $password) {\n      authenticatable {\n        id\n        email\n        name\n        phone\n        createdAt\n        updatedAt\n      }\n      credentials {\n        accessToken\n        tokenType\n        client\n        expiry\n        uid\n      }\n    }\n  }\n"])));function Xl(){var e=Se((function(e){return e.login})),n=Ee(),t=Object(Yl.useNavigation)(),r=Object(g.useMutation)(Kl),i=W()(r,2),o=i[0],s=i[1],u=Object(a.useCallback)((function(){var t,r,a,l,i,s,u;return we.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:if(t=new RegExp(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/),r=!1,e.fields.email.value||(r=!0,n(Zl.setEmailError("Email is required"))),e.fields.password.value||(r=!0,n(Zl.setPasswordError("Password is required"))),t.test(e.fields.email.value)||(r=!0,n(Zl.setEmailError("Please enter a valid email"))),r){c.next=17;break}return c.prev=6,c.next=9,we.a.awrap(o({variables:{email:e.fields.email.value,password:e.fields.password.value}}));case 9:u=c.sent,console.log({result:u}),null!=u&&null!=(a=u.data)&&null!=(l=a.userLogin)&&l.authenticatable&&null!=u&&null!=(i=u.data)&&null!=(s=i.userLogin)&&s.credentials&&(n(ue.setCredentials(u.data.userLogin.credentials)),n(ue.setUser(u.data.userLogin.authenticatable))),c.next=17;break;case 14:c.prev=14,c.t0=c.catch(6),n(de.showSnackbar({message:c.t0.message,variant:"error"}));case 17:case"end":return c.stop()}}),null,null,[[6,14]],Promise)}),[o,JSON.stringify(e.fields)]);return l.a.createElement(Bn,{style:ti.container},l.a.createElement(Wn,{style:ti.title},"Sign in"),l.a.createElement(Bn,{style:ti.fields},l.a.createElement(bn.a,{label:"Email",mode:"outlined",value:e.fields.email.value,onChangeText:function(e){n(Zl.setEmail(e))}}),l.a.createElement(fn.a,{type:"error"},e.fields.email.error||" "),l.a.createElement(bn.a,{label:"Password",mode:"outlined",value:e.fields.password.value,secureTextEntry:!0,onChangeText:function(e){n(Zl.setPassword(e))},error:!!e.fields.password.error}),l.a.createElement(fn.a,{type:"error"},e.fields.password.error||" "),l.a.createElement(un.a,{mode:"contained",style:ti.button,onPress:u,loading:s.loading},"Log in"),l.a.createElement(un.a,{style:ti.button,onPress:function(){return t.navigate("SignUpScreen")}},"Sign up")))}var ei,ni,ti=Fe.a.create({container:{flex:1,alignItems:"center",justifyContent:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fields:{marginBottom:10},button:{marginTop:10,width:"100%"}}),ri=Bl(Object(nn.a)(ei||(ei=Ke()(["\n  mutation UserSignUp(\n    $email: String!,\n    $password: String!,\n    $passwordConfirmation: String!\n    $name: String!\n    $phone: String!\n    $exitWeight: Float!\n    $licenseId: Int\n  ){\n    userSignUp(\n      email: $email,\n      password: $password,\n      passwordConfirmation: $passwordConfirmation,\n      exitWeight: $exitWeight,\n      name: $name,\n      phone: $phone,\n      licenseId: $licenseId\n    ) {\n      authenticatable {\n        createdAt,\n        email,\n        id,\n        name,\n        phone,\n      }\n      credentials {\n        accessToken\n        tokenType\n        client\n        expiry\n        uid\n      }\n    }\n  }\n"]))),{getPayload:function(e){return e.userSignUp},fieldErrorMap:{license:"licenseId"},validates:{name:[ql("Name is required")],email:[(ni="Please enter a valid email",{message:ni,pattern:new RegExp(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)})],passwordConfirmation:[Wl("Password must have 1 uppercase, 1 lowercase, 1 digit and be at least 8 characters",(function(e){return/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{8,}.*$/.test(e.passwordConfirmation)})),Wl("Passwords don't match",(function(e){return e.password===e.passwordConfirmation}))]}}),ai=R.actions,li=N.actions;function ii(){var e,n,t=Se((function(e){return e.signup})),r=Ee(),l=ri({onSuccess:function(e){e.credentials&&(r(li.setCredentials(e.credentials)),r(li.setUser(e.authenticatable)))},onFieldError:function(e,n){return r(ai.setFieldError([e,n]))}}),i=l.loading,o=l.mutate;return a.createElement(Bn,{style:oi.container},a.createElement(Wn,{style:oi.title},"Sign up"),a.createElement(Bn,{style:oi.fields},a.createElement(bn.a,{style:oi.field,mode:"outlined",label:"Name",error:!!t.fields.name.error,value:t.fields.name.value,onChangeText:function(e){return r(ai.setField(["name",e]))}}),a.createElement(fn.a,{type:"error"},t.fields.name.error||""),a.createElement(bn.a,{style:oi.field,mode:"outlined",label:"Exit weight",error:!!t.fields.exitWeight.error,value:(null==(e=t.fields.exitWeight)||null==(n=e.value)?void 0:n.toString())||"",keyboardType:"numbers-and-punctuation",right:function(){return a.createElement(bn.a.Affix,{text:"kg"})},onChangeText:function(e){return r(ai.setField(["exitWeight",parseFloat(e)]))}}),a.createElement(fn.a,{type:t.fields.exitWeight.error?"error":"info"},t.fields.exitWeight.error||""),a.createElement(bn.a,{style:oi.field,mode:"outlined",label:"Email",error:!!t.fields.email.error,value:t.fields.email.value,onChangeText:function(e){return r(ai.setField(["email",e]))}}),a.createElement(fn.a,{type:"error"},t.fields.email.error||""),a.createElement(bn.a,{style:oi.field,mode:"outlined",label:"Phone",error:!!t.fields.phone.error,value:t.fields.phone.value,onChangeText:function(e){return r(ai.setField(["phone",e]))}}),a.createElement(fn.a,{type:"error"},t.fields.phone.error||""),a.createElement(bn.a,{style:oi.field,mode:"outlined",label:"Password",error:Boolean(t.fields.password.error||t.fields.passwordConfirmation.error),textContentType:"newPassword",secureTextEntry:!0,passwordRules:"required: upper; required: lower; required: digit; minlength: 8;",value:t.fields.password.value,onChangeText:function(e){return r(ai.setField(["password",e]))}}),a.createElement(fn.a,{type:"error"},t.fields.password.error||""),a.createElement(bn.a,{style:oi.field,mode:"outlined",label:"Repeat password",error:Boolean(t.fields.password.error||t.fields.passwordConfirmation.error),textContentType:"newPassword",secureTextEntry:!0,passwordRules:"required: upper; required: lower; required: digit; minlength: 8;",value:t.fields.passwordConfirmation.value,onChangeText:function(e){return r(ai.setField(["passwordConfirmation",e]))}}),a.createElement(fn.a,{type:"error"},t.fields.passwordConfirmation.error||""),a.createElement(un.a,{mode:"contained",onPress:function(){var e,n;return o({email:t.fields.email.value,name:t.fields.name.value,exitWeight:t.fields.exitWeight.value,password:t.fields.password.value,passwordConfirmation:t.fields.passwordConfirmation.value,licenseId:Number(null==(e=t.fields.license)||null==(n=e.value)?void 0:n.id)||null,phone:t.fields.phone.value})},loading:i},"Sign up")))}var oi=Fe.a.create({container:{flex:1,alignItems:"center",justifyContent:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fields:{width:"70%"},field:{marginBottom:8}}),si=Object(We.a)();function ui(){return a.createElement(si.Navigator,{screenOptions:{headerShown:!1,cardStyle:{flex:1}},initialRouteName:"LoginScreen"},a.createElement(si.Screen,{name:"LoginScreen",component:Xl}),a.createElement(si.Screen,{name:"SignUpScreen",component:ii}))}var ci=Object(We.a)();function di(){var e=Se((function(e){return e.global}));return a.createElement(ci.Navigator,{screenOptions:{headerShown:!1,cardStyle:{flex:1}}},e.credentials?e.currentDropzone?a.createElement(ci.Screen,{name:"Authenticated",component:Nl}):a.createElement(ci.Screen,{name:"Dropzones",component:Gl}):a.createElement(ci.Screen,{name:"Unauthenticated",component:ui}),a.createElement(ci.Screen,{name:"NotFound",component:Le,options:{title:"Oops!"}}))}function mi(){var e=Se((function(e){return e.global}));return l.a.createElement(Oe,null,l.a.createElement(u.a,{theme:e.theme},l.a.createElement(i.b,null,l.a.createElement(m.a,{linking:qe,theme:e.theme},l.a.createElement(di,null)),l.a.createElement(r.a,null),l.a.createElement(Ue,null))))}function fi(){return function(){var e=a.useState(!1),n=W()(e,2),r=n[0],l=n[1];return a.useEffect((function(){we.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,Pe.b(),e.next=4,we.a.awrap(je.b(Te(Te({},Ce.a.font),{},{"space-mono":t(429)})));case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.warn(e.t0);case 9:return e.prev=9,l(!0),Pe.a(),e.finish(9);case 13:case"end":return e.stop()}}),null,null,[[0,6,9,13]],Promise)}),[]),r}()?l.a.createElement(o.a,{store:ye},l.a.createElement(s.a,{persistor:he,loading:l.a.createElement(d.a,{style:{flex:1,justifyContent:"center",alignItems:"center"}},l.a.createElement(c.a,{size:"large"}))},l.a.createElement(mi,null))):null}},393:function(e,n,t){e.exports=t(477)},429:function(e,n,t){e.exports=t.p+"./fonts/SpaceMono-Regular.ttf"},445:function(e,n){}},[[393,1,2]]]);
//# sourceMappingURL=app.73575822.chunk.js.map