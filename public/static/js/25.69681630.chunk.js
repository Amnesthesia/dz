(this.webpackJsonp=this.webpackJsonp||[]).push([[25],{483:function(e,n,r){"use strict";r.d(n,"a",(function(){return o}));var t=r(143),a=r(257),o=t.a.actions;a.a},526:function(e,n,r){"use strict";r.r(n),r.d(n,"default",(function(){return F}));var t,a,o=r(6),l=r.n(o),i=r(9),s=r.n(i),d=r(71),u=r.n(d),c=r(11),p=r.n(c),b=r(0),m=r(1),f=r(312),y=r(116),g=r(49),v=r(21),O=r(36),C=r(483),E=r(112),h=r(114),z=r(310),j=r(40),S=r(169);function w(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function $(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?w(Object(r),!0).forEach((function(n){l()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var D=h.a.actions,P=E.a.actions,k=Object(g.gql)(t||(t=u()(["\n  query QueryDropzoneDetails($dropzoneId: Int!) {\n    dropzone(id: $dropzoneId) {\n      id\n      name\n      primaryColor,\n      secondaryColor,\n      planes {\n        id\n        name\n        registration\n      }\n      ticketTypes {\n        id\n        name\n      }\n    }\n  }\n"]))),I=Object(g.gql)(a||(a=u()(["\n  mutation UpdateDropzone(\n    $id: Int!,\n    $name: String!,\n    $banner: String,\n    $federationId: Int!\n    $primaryColor: String\n    $secondaryColor: String\n    $isCreditSystemEnabled: Boolean,\n    $isPublic: Boolean\n  ){\n    updateDropzone(input: {\n      id: $id\n      attributes: {\n        name: $name,\n        banner: $banner,\n        federationId: $federationId\n        primaryColor: $primaryColor\n        secondaryColor: $secondaryColor\n        isCreditSystemEnabled: $isCreditSystemEnabled\n        isPublic: $isPublic\n      }\n    }) {\n      dropzone {\n        id\n        name\n        banner\n        primaryColor\n        secondaryColor,\n        isCreditSystemEnabled\n\n        planes {\n          id\n          name\n        }\n\n        federation {\n          id\n          name\n        }\n      }\n    }\n  }\n"])));function F(){var e,n=Object(v.l)((function(e){return e.dropzoneForm})),r=Object(v.l)((function(e){return e.global})),t=Object(v.k)(),a=Object(j.useRoute)().params.dropzone,o=Object(j.useNavigation)(),l=Object(g.useQuery)(k,{variables:{dropzoneId:Number(a.id)}}),i=l.data,d=l.loading;b.useEffect((function(){var e;null!=i&&null!=(e=i.dropzone)&&e.id&&t(D.setOriginal(i.dropzone))}),[null==i||null==(e=i.dropzone)?void 0:e.id]);var u=Object(g.useMutation)(I),c=s()(u,2),m=c[0],E=c[1],h=b.useCallback((function(){var e,l,i,s,d,u,c,b,f,y,g,O,E,h,z,j,S,w,k,I,F,x,_,N,B,q,J,Q;return p.a.async((function(G){for(;;)switch(G.prev=G.next){case 0:if(i=!1,s=n.fields,d=s.name,u=s.banner,c=s.federation,b=s.primaryColor,f=s.secondaryColor,y=s.isCreditSystemEnabled,g=s.isPublic,(null==(e=d.value)||!e.length||(null==(l=d.value)?void 0:l.length)<3)&&(i=!0,t(D.setFieldError(["name","Name is too short"]))),i){G.next=19;break}return G.prev=4,G.next=7,p.a.awrap(m({variables:{id:Number(null==a?void 0:a.id),name:d.value,banner:u.value||null,primaryColor:b.value,secondaryColor:f.value,federationId:Number(null==c||null==(O=c.value)?void 0:O.id),isCreditSystemEnabled:!!y,isPublic:!!g}}));case 7:if(null==(x=G.sent)||null==(E=x.data)||null==(h=E.updateDropzone)||null==(z=h.fieldErrors)||z.map((function(e){var n=e.field,r=e.message;switch(n){case"federation":case"federation_id":return t(D.setFieldError(["federation",r]));case"banner":return t(D.setFieldError(["banner",r]));case"primary_color":return t(D.setFieldError(["primaryColor",r]));case"secondary_color":return t(D.setFieldError(["secondaryColor",r]));case"is_credit_system_enabled":return t(D.setFieldError(["isCreditSystemEnabled",r]));case"name":return t(D.setFieldError(["name",r]));case"is_public":return t(D.setFieldError(["isPublic",r]))}})),null==x||null==(j=x.data)||null==(S=j.updateDropzone)||null==(w=S.errors)||!w.length){G.next=13;break}return G.abrupt("return",t(v.j.showSnackbar({message:null==x||null==(_=x.data)||null==(N=_.updateDropzone)?void 0:N.errors[0],variant:"error"})));case 13:null!=x&&null!=(k=x.data)&&null!=(I=k.updateDropzone)&&null!=(F=I.fieldErrors)&&F.length||null!=(B=x.data)&&null!=(q=B.updateDropzone)&&q.dropzone&&(t(P.setDropzone($($({},r.currentDropzone||{}),null==x||null==(J=x.data)||null==(Q=J.updateDropzone)?void 0:Q.dropzone))),t(C.a.showSnackbar({message:"Saved",variant:"success"})),o.goBack());case 14:G.next=19;break;case 16:G.prev=16,G.t0=G.catch(4),t(C.a.showSnackbar({message:G.t0.message,variant:"error"}));case 19:case"end":return G.stop()}}),null,null,[[4,16]],Promise)}),[JSON.stringify(n.fields),t,m]);return b.createElement(b.Fragment,null,b.createElement(f.a,{indeterminate:!0,color:r.theme.colors.accent,visible:d}),b.createElement(S.a,{contentContainerStyle:x.content},b.createElement(z.a,null),b.createElement(O.b,{style:x.fields},b.createElement(y.a,{mode:"contained",disabled:E.loading,onPress:h,loading:E.loading},"Save"))))}var x=m.a.create({container:{flex:1,backgroundColor:"white",display:"flex"},content:{display:"flex",flexGrow:1,alignItems:"center",padding:48},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fields:{width:"70%",marginBottom:16},field:{marginBottom:8}})}}]);
//# sourceMappingURL=25.69681630.chunk.js.map