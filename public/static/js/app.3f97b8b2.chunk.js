(this.webpackJsonp=this.webpackJsonp||[]).push([[0],{371:function(e,n,t){"use strict";t.d(n,"a",(function(){return wi}));var r=t(373),a=t(0),l=t.n(a),i=t(491),o=t(172),s=t(314),u=t(302),c=t(134),d=t(2),m=t(312),f=t(4),p=t.n(f),g=t(16),v=t(179),b=t(318),h=t(319),y=t(58),E=t(41),S=t(240),x=t(245),I=t(328),k=t.n(I),z=t(129),O=t(260),w=t(107),C=t(130);function j(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function T(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?j(Object(t),!0).forEach((function(n){p()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):j(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var P=T(T(T({},w.a),z.a),{},{colors:T(T({},w.a.colors),z.a.colors)}),F=T(T(T({},C.a),O.a),{},{colors:T(T({},C.a.colors),O.a.colors)}),$={currentUser:null,currentDropzone:null,permissions:[],credentials:null,theme:P,isDarkMode:!1},N=Object(E.b)({name:"global",initialState:$,reducers:{setCredentials:function(e,n){e.credentials=n.payload},setUser:function(e,n){e.currentUser=n.payload},setPermissions:function(e,n){e.permissions=n.payload},setPrimaryColor:function(e,n){e.theme.colors.primary=n.payload},setAccentColor:function(e,n){e.theme.colors.accent=n.payload},setDropzone:function(e,n){var t,r,a,l;(e.currentDropzone=n.payload,null!=(t=e.currentDropzone)&&t.primaryColor)&&(e.theme.colors.primary=null==(a=e.currentDropzone)?void 0:a.primaryColor);null!=(r=e.currentDropzone)&&r.secondaryColor&&(e.theme.colors.accent=null==(l=e.currentDropzone)?void 0:l.secondaryColor)},toggleDarkMode:function(e){var n,t,r,a;(e.isDarkMode=!e.isDarkMode,e.theme=e.isDarkMode?F:P,null!=(n=e.currentDropzone)&&n.primaryColor)&&(e.theme.colors.primary=null==(r=e.currentDropzone)?void 0:r.primaryColor);null!=(t=e.currentDropzone)&&t.secondaryColor&&(e.theme.colors.accent=null==(a=e.currentDropzone)?void 0:a.secondaryColor)},logout:function(e){for(var n in $){var t=n;n in e&&(e[t]=$[t])}}}}),D=t(13),M=Object(E.b)({name:"notifications",initialState:{queue:[]},reducers:{hideSnackbar:function(e){e.queue=e.queue.slice(1)},showSnackbar:function(e,n){e.queue.push(n.payload)}}}),A={fields:{email:{value:"",error:null},password:{value:"",error:null}}},U=Object(E.b)({name:"login",initialState:A,reducers:{setEmail:function(e,n){e.fields.email.value=n.payload},setPassword:function(e,n){e.fields.password.value=n.payload},setEmailError:function(e,n){e.fields.email.error=n.payload},setPasswordError:function(e,n){e.fields.password.error=n.payload},reset:function(e){e.fields=A.fields}}}),q=t(7),R=t.n(q),B={federation:null,fields:{email:{value:"",error:null},password:{value:"",error:null},passwordConfirmation:{value:"",error:null},exitWeight:{value:50,error:null},name:{value:"",error:null},phone:{value:"",error:null},license:{value:null,error:null}}},W=Object(E.b)({name:"login",initialState:B,reducers:{setFederation:function(e,n){e.federation=n.payload},setField:function(e,n){var t=R()(n.payload,2),r=t[0],a=t[1];e.fields[r].value=a,e.fields[r].error=null},setFieldError:function(e,n){var t=R()(n.payload,2),r=t[0],a=t[1];e.fields[r].error=a},reset:function(e){e.fields=B.fields}}}),L={isSearchVisible:!1,searchText:""},H=Object(E.b)({name:"usersScreen",initialState:L,reducers:{setSearchText:function(e,n){e.searchText=n.payload},setSearchVisible:function(e,n){e.isSearchVisible=n.payload},reset:function(e){e.isSearchVisible=L.isSearchVisible,e.searchText=L.searchText}}}),V={original:null,fields:{federation:{value:null,error:null},name:{value:"",error:null},secondaryColor:{value:"",error:null},primaryColor:{value:"",error:null},banner:{value:"",error:null},isCreditSystemEnabled:{value:!1,error:null},isPublic:{value:!1,error:null}}},Q=Object(E.b)({name:"dropzone",initialState:V,reducers:{setField:function(e,n){var t=R()(n.payload,2),r=t[0],a=t[1];e.fields[r].value=a,e.fields[r].error=null},setFieldError:function(e,n){var t=R()(n.payload,2),r=t[0],a=t[1];r in e.fields&&e.fields[r].error&&(e.fields[r].error=a)},setOriginal:function(e,n){for(var t in e.original=n.payload,n.payload)if(t in e.fields){var r=t;e.fields[r].value=n.payload[r]}},reset:function(e){e.fields=V.fields,e.original=null}}}),J={original:null,fields:{name:{value:"",error:null},registration:{value:"",error:null},minSlots:{value:0,error:null},maxSlots:{value:4,error:null},hours:{value:null,error:null},nextMaintenanceHours:{value:null,error:null}}},_=Object(E.b)({name:"Plane",initialState:J,reducers:{setField:function(e,n){var t=R()(n.payload,2),r=t[0],a=t[1];e.fields[r].value=a,e.fields.name.error=null},setFieldError:function(e,n){var t=R()(n.payload,2),r=t[0],a=t[1];e.fields[r].error=a},setOriginal:function(e,n){e.original=n.payload,e.fields.hours.value=n.payload.hours,e.fields.minSlots.value=n.payload.minSlots,e.fields.maxSlots.value=n.payload.maxSlots,e.fields.name.value=n.payload.name,e.fields.registration.value=n.payload.registration,e.fields.nextMaintenanceHours.value=n.payload.nextMaintenanceHours},reset:function(e){e.fields=J.fields,e.original=null}}}),G={original:null,fields:{name:{value:"",error:null},cost:{value:null,error:null},altitude:{value:14e3,error:null},allowManifestingSelf:{value:!1,error:null},isTandem:{value:!1,error:null},extras:{value:[],error:null}}},Y=Object(E.b)({name:"ticketTypeForm",initialState:G,reducers:{setField:function(e,n){var t=R()(n.payload,2),r=t[0],a=t[1];e.fields[r].value=a,e.fields[r].error=null},setFieldError:function(e,n){var t=R()(n.payload,2),r=t[0],a=t[1];e.fields[r].error=a},setOriginal:function(e,n){e.original=n.payload,e.fields.altitude.value=n.payload.altitude,e.fields.cost.value=n.payload.cost,e.fields.allowManifestingSelf.value=n.payload.allowManifestingSelf,e.fields.name.value=n.payload.name},reset:function(e){e.fields=G.fields,e.original=null}}}),Z={original:null,fields:{name:{value:"",error:null},cost:{value:null,error:null},ticketTypeIds:{value:[],error:null}}},K=Object(E.b)({name:"ExtraForm",initialState:Z,reducers:{setField:function(e,n){var t=R()(n.payload,2),r=t[0],a=t[1];e.fields[r].value=a,e.fields.name.error=null},setFieldError:function(e,n){var t=R()(n.payload,2),r=t[0],a=t[1];e.fields[r].error=a},setOriginal:function(e,n){e.original=n.payload,e.fields.ticketTypeIds.value=n.payload.ticketTypes.map((function(e){var n=e.id;return Number(n)})),e.fields.cost.value=n.payload.cost,e.fields.name.value=n.payload.name},reset:function(e){e.fields=Z.fields,e.original=null}}}),X={original:null,fields:{name:{value:"",error:null},gca:{value:null,error:null},dispatchAt:{value:null,error:null},isOpen:{value:!0,error:null},loadMaster:{value:null,error:null},pilot:{value:null,error:null},plane:{value:null,error:null},maxSlots:{value:4,error:null}}},ee=Object(E.b)({name:"loadForm",initialState:X,reducers:{setField:function(e,n){var t=R()(n.payload,2),r=t[0],a=t[1];e.fields[r].value=a,e.fields[r].error=null},setFieldError:function(e,n){var t=R()(n.payload,2),r=t[0],a=t[1];e.fields[r].error=a},setOriginal:function(e,n){for(var t in e.original=n.payload,n.payload)if(t in e.fields){var r=t;e.fields[r].value=n.payload[r]}},reset:function(e){e.fields=X.fields,e.original=null}}}),ne={original:null,fields:{jumpType:{value:null,error:null},extras:{value:[],error:null},load:{value:null,error:null},rig:{value:null,error:null},ticketType:{value:null,error:null},user:{value:null,error:null},exitWeight:{value:null,error:null}}},te=Object(E.b)({name:"slotForm",initialState:ne,reducers:{setField:function(e,n){var t=R()(n.payload,2),r=t[0],a=t[1];e.fields[r].value=a,e.fields[r].error=null},setFieldError:function(e,n){var t=R()(n.payload,2),r=t[0],a=t[1];e.fields[r].error=a},setOriginal:function(e,n){for(var t in e.original=n.payload,n.payload)if(t in e.fields){var r=t;e.fields[r].value=n.payload[r]}},reset:function(e){e.fields=ne.fields,e.original=null}}}),re={original:null,federation:{value:null,error:null},fields:{exitWeight:{value:"",error:null},email:{value:"",error:null},phone:{value:"",error:null},name:{value:null,error:null},rigs:{value:[],error:null},license:{value:null,error:null}}},ae=Object(E.b)({name:"userForm",initialState:re,reducers:{setFederation:function(e,n){e.federation.value=n.payload},setField:function(e,n){var t=R()(n.payload,2),r=t[0],a=t[1];e.fields[r].value=a,e.fields[r].error=null},setFieldError:function(e,n){var t=R()(n.payload,2),r=t[0],a=t[1];e.fields[r].error=a},setOriginal:function(e,n){var t;for(var r in e.original=n.payload,e.federation.value=null==(t=n.payload.license)?void 0:t.federation,n.payload)if(r in e.fields){var a=r;e.fields[a].value=n.payload[a]}},reset:function(e){e.fields=re.fields,e.original=null}}}),le={original:null,fields:{role:{value:null,error:null},credits:{value:0,error:null},expiresAt:{value:null,error:null}}},ie=Object(E.b)({name:"dropzoneUserForm",initialState:le,reducers:{setField:function(e,n){var t=R()(n.payload,2),r=t[0],a=t[1];e.fields[r].value=a,e.fields[r].error=null},setFieldError:function(e,n){var t=R()(n.payload,2),r=t[0],a=t[1];e.fields[r].error=a},setOriginal:function(e,n){for(var t in e.original=n.payload,n.payload)if(t in e.fields){var r=t;e.fields[r].value=n.payload[r]}},reset:function(e){e.fields=le.fields,e.original=null}}}),oe={original:null,fields:{make:{value:"",error:null},model:{value:"",error:null},serial:{value:"",error:null},repackExpiresAt:{value:null,error:null},canopySize:{value:null,error:null}}},se=Object(E.b)({name:"rigForm",initialState:oe,reducers:{setField:function(e,n){var t=R()(n.payload,2),r=t[0],a=t[1];e.fields[r].value=a,e.fields[r].error=null},setFieldError:function(e,n){var t=R()(n.payload,2),r=t[0],a=t[1];e.fields[r].error=a},setOriginal:function(e,n){for(var t in e.original=n.payload,n.payload)if(t in e.fields){var r=t;e.fields[r].value=n.payload[r]}},reset:function(e){e.fields=oe.fields,e.original=null}}}),ue=t(31),ce=t.n(ue),de={original:null,fields:[]},me=Object(E.b)({name:"rigInspectionForm",initialState:de,reducers:{setItem:function(e,n){e.fields=[].concat(ce()(e.fields.filter((function(e){return e.checklistItem.id!==n.payload.checklistItem.id}))),[n.payload])},setOriginal:function(e,n){e.original=n.payload,e.fields=n.payload.checklistValues},reset:function(e){e.fields=de.fields,e.original=null}}}),fe=(U.actions,W.actions,N.actions),pe=H.actions,ge=M.actions,ve=(_.actions,Q.actions,Y.actions,K.actions,ee.actions,te.actions),be=ae.actions,he=ie.actions,ye=se.actions,Ee=me.actions,Se={key:"root",storage:"web"===D.a.OS?k.a:Object(S.a)(),whitelist:["global","notifications"]};console.log({localStorage:localStorage,MMKV:S.a});var xe=Object(x.a)(Se,{global:N.reducer,notifications:M.reducer,login:U.reducer,signup:W.reducer,dropzoneForm:Q.reducer,planeForm:_.reducer,ticketTypeForm:Y.reducer,extraForm:K.reducer,loadForm:ee.reducer,slotForm:te.reducer,userForm:ae.reducer,dropzoneUserForm:ie.reducer,rigForm:se.reducer,rigInspectionForm:me.reducer,usersScreen:H.reducer}),Ie=Object(E.a)({reducer:xe}),ke=Object(x.b)(Ie),ze=function(){return Object(o.b)()},Oe=o.c;function we(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function Ce(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?we(Object(t),!0).forEach((function(n){p()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):we(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var je=Object(g.createHttpLink)({uri:y.a.manifest.extra.url});function Te(e){var n=e.children,t=Oe((function(e){return e.global.credentials})),r=ze(),i=Object(a.useMemo)((function(){return Object(h.a)((function(e){var n=e.graphQLErrors,t=e.networkError;if(null!=n&&n.some((function(e){var n;return"AUTHENTICATION_ERROR"===(null==(n=e.extensions)?void 0:n.code)})))return r(ge.showSnackbar({message:"Session expires",variant:"error"})),void r(fe.logout());n&&n.map((function(e){var n=e.message,t=e.locations,a=e.path;return r(ge.showSnackbar({message:"[GraphQL error]: "+n+", "+t+", "+a,variant:"error"}))})),t&&r(ge.showSnackbar({message:"[Network error]: "+t,variant:"error"}))}))}),[r]),o=Object(a.useMemo)((function(){return Object(b.a)((function(e,n){return{headers:Ce(Ce({},n.headers),null!=t&&t.accessToken?Ce({Authorization:"Bearer "+t.accessToken,"access-token":t.accessToken,"token-type":t.tokenType},t):{})}}))}),[JSON.stringify(t)]),s=Object(a.useMemo)((function(){return new g.ApolloClient({link:i.concat(o).concat(je),cache:new g.InMemoryCache})}),[o]);return l.a.createElement(v.ApolloProvider,{client:s},n)}var Pe=t(3),Fe=t.n(Pe),$e=t(484),Ne=t(490),De=t(246);function Me(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function Ae(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Me(Object(t),!0).forEach((function(n){p()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Me(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var Ue=t(1),qe=t(270);var Re={light:{text:"#000",background:"#fff",tint:"#2f95dc",tabIconDefault:"#ccc",tabIconSelected:"#2f95dc",success:"#00C851",error:"#ff4444",warning:"#FF8800",info:"#0099CC"},dark:{text:"#fff",background:"#000",tint:"#fff",tabIconDefault:"#ccc",tabIconSelected:"#fff",success:"#00C851",error:"#ff4444",warning:"#FF8800",info:"#0099CC"}};var Be=function(){return Re.light},We=M.actions,Le=(Ue.a.create({container:{flex:1,justifyContent:"space-between"}}),function(){var e=Oe((function(e){return e.notifications})),n=ze(),t=Be(),r=e.queue.length?e.queue[0]:null,l={info:{backgroundColor:t.info},success:{backgroundColor:t.success},error:{backgroundColor:t.error},warning:{backgroundColor:t.warning}};return a.createElement(qe.a,{visible:!!r,onDismiss:function(){return n(We.hideSnackbar())},duration:3e3,action:null==r?void 0:r.action,style:!(null==r||!r.variant)&&l[r.variant]},null==r?void 0:r.message)}),He={prefixes:[t(374).a("/"),"dz://"],config:{screens:{Authenticated:{screens:{HomeScreen:"/home",LoadScreen:"/load/:load_id",PackingScreen:"/packing",ProfileScreen:"/user/:id",SetupScreen:"/dropzone/setup"}},Limbo:{screens:{DropzonesScreen:"/dropzones",CreateDropzoneScreen:"/dropzone/create"}},Unauthenticated:{screens:{LoginScreen:"/login",SignUpScreen:"/signup"}}}}},Ve=t(488),Qe=t(49),Je=t(70);function _e(e){var n=e.navigation;return a.createElement(d.a,{style:Ze.container},a.createElement(Qe.a,{style:Ze.title},"This screen doesn't exist."),a.createElement(Je.a,{onPress:function(){return n.replace("Root")},style:Ze.link},a.createElement(Qe.a,{style:Ze.linkText},"Go to home screen!")))}var Ge,Ye,Ze=Ue.a.create({container:{flex:1,backgroundColor:"#fff",alignItems:"center",justifyContent:"center",padding:20},title:{fontSize:20,fontWeight:"bold"},link:{marginTop:15,paddingVertical:15},linkText:{fontSize:14,color:"#2e78b7"}}),Ke=t(17),Xe=t(489),en=t(354),nn=t(22),tn=t.n(nn),rn=t(25),an=t(485),ln=t(30),on=t(32),sn=t(372),un=t(291),cn=t(310),dn=t(197),mn=t(308),fn=t(182),pn=t(66),gn=t(288),vn=t(10),bn=t(289),hn=t(290),yn=t(305),En=t(287),Sn=Object(ln.a)(Ge||(Ge=tn()(["\n  query JumpTypes($allowedForUserId: Int) {\n    jumpTypes(allowedForUserId: $allowedForUserId) {\n      id\n      name\n    }\n  }\n"])));function xn(e){var n,t,r=Object(a.useState)(!1),i=R()(r,2),o=i[0],s=i[1],u=(Oe((function(e){return e.global})),Object(g.useQuery)(Sn,{variables:{allowedForUserId:e.userId}})),c=u.data;u.loading,u.refetch;return l.a.createElement(l.a.Fragment,null,l.a.createElement(vn.a.Subheader,null,"Jump type"),l.a.createElement(En.a,{onDismiss:function(){return s(!1)},visible:o,anchor:l.a.createElement(vn.a.Item,{onPress:function(){s(!0)},title:(null==(n=e.value)?void 0:n.name)||"Please select jump type",description:e.required?null:"Optional"})},null==c||null==(t=c.jumpTypes)?void 0:t.map((function(n){return l.a.createElement(vn.a.Item,{onPress:function(){s(!1),e.onSelect(n)},title:n.name||"-"})}))))}var In,kn=Object(ln.a)(Ye||(Ye=tn()(["\n  query TicketTypes($allowManifestingSelf: Boolean, $dropzoneId: Int!) {\n    ticketTypes(allowManifestingSelf: $allowManifestingSelf, dropzoneId: $dropzoneId) {\n      id\n      name\n\n      extras {\n        id\n        name\n        cost\n      }\n    }\n  }\n"])));function zn(e){var n,t,r,i=Object(a.useState)(!1),o=R()(i,2),s=o[0],u=o[1],c=Oe((function(e){return e.global})),d=Object(g.useQuery)(kn,{variables:{dropzoneId:Number(null==(n=c.currentDropzone)?void 0:n.id),allowManifestingSelf:e.allowManifestingSelf}}),m=d.data;d.loading,d.refetch;return l.a.createElement(l.a.Fragment,null,l.a.createElement(vn.a.Subheader,null,"Ticket"),l.a.createElement(En.a,{onDismiss:function(){return u(!1)},visible:s,anchor:l.a.createElement(vn.a.Item,{onPress:function(){u(!0)},title:(null==(t=e.value)?void 0:t.name)||"Please select ticket type",description:e.required?null:"Optional"})},null==m||null==(r=m.ticketTypes)?void 0:r.map((function(n){return l.a.createElement(vn.a.Item,{onPress:function(){u(!1),e.onSelect(n)},title:n.name||"-"})}))))}var On,wn=Object(ln.a)(In||(In=tn()(["\nquery QueryPermissions($dropzoneId: Int!) {\n    dropzone(id: $dropzoneId) {\n      id\n      name\n      primaryColor\n      secondaryColor\n      \n      currentUser {\n        id\n        role {\n          id\n          name\n        }\n        permissions\n      }\n\n    }\n  }"])));function Cn(e){var n,t,r,a=Oe((function(e){return e.global})).currentDropzone,l=Object(g.useQuery)(wn,{variables:{dropzoneId:Number(null==a?void 0:a.id)},fetchPolicy:"cache-first"}).data;return(null==l||null==(n=l.dropzone)||null==(t=n.currentUser)||null==(r=t.permissions)?void 0:r.includes(e))||!1}var jn=Object(ln.a)(On||(On=tn()(["\n  query QueryRigs(\n    $dropzoneId: Int\n    $userId: Int\n  ) {\n    rigs(dropzoneId: $dropzoneId, userId: $userId) {\n      id\n      make\n      model\n      canopySize\n      serial\n    }\n  }\n"])));function Tn(e){var n,t,r,i,o,s=Object(a.useState)(!1),u=R()(s,2),c=u[0],d=u[1],m=Oe((function(e){return e.global})),f=Object(g.useQuery)(jn,{variables:{dropzoneId:Number(null==(n=m.currentDropzone)?void 0:n.id)}}).data;return l.a.createElement(En.a,{onDismiss:function(){return d(!1)},visible:c,anchor:l.a.createElement(vn.a.Item,{onPress:function(){d(!0)},title:e.value?(null==(t=e.value)?void 0:t.make)+" "+(null==(r=e.value)?void 0:r.model)+" ("+((null==(i=e.value)?void 0:i.canopySize)||"?")+"sqft)":"Select rig",description:e.required?null:"Optional",left:function(){return l.a.createElement(vn.a.Icon,{icon:"parachute"})}})},null==f||null==(o=f.rigs)?void 0:o.map((function(n){var t,r,a;return l.a.createElement(vn.a.Item,{onPress:function(){d(!1),e.onSelect(n)},title:(null==(t=e.value)?void 0:t.make)+" "+(null==(r=e.value)?void 0:r.model),description:(null==(a=e.value)?void 0:a.canopySize)+" sqft"})})))}var Pn=te.actions;function Fn(){var e,n,t,r,l,i,o,s,u,c,d,m,f,p,g,v,b,h,y,E,S,x,I,k,z=Oe((function(e){return e.slotForm})),O=ze(),w=Oe((function(e){return e.global}));a.useEffect((function(){var e,n;null!=(e=z.fields.user)&&e.value&&(z.fields.exitWeight.value||O(Pn.setField(["exitWeight",Number(z.fields.user.value.exitWeight||60)])),!z.fields.rig.value&&null!=(n=z.fields.user.value.rigs)&&n.length&&O(Pn.setField(["rig",z.fields.user.value.rigs[0]])))}),[null==(e=z.fields)||null==(n=e.user)||null==(t=n.value)?void 0:t.id]);var C=null==z||null==(r=z.original)?void 0:r.id,j=(null==z||null==(l=z.fields)||null==(i=l.user)||null==(o=i.value)||o.id,null==(s=w.currentUser)||s.id,Cn(C?"updateSlot":"createSlot"),Cn(C?"updateUserSlot":"createUserSlot"));return console.log("Fields",z.fields),a.createElement(a.Fragment,null,a.createElement(xn,{value:z.fields.jumpType.value,required:!0,userId:Number(null==z||null==(u=z.fields)||null==(c=u.user)||null==(d=c.value)?void 0:d.id)||null,onSelect:function(e){return O(Pn.setField(["jumpType",e]))}}),a.createElement(gn.a,{type:z.fields.jumpType.error?"error":"info"},z.fields.jumpType.error||""),a.createElement(zn,{value:z.fields.ticketType.value,required:!0,allowManifestingSelf:!j,onSelect:function(e){return O(Pn.setField(["ticketType",e]))}}),a.createElement(gn.a,{type:z.fields.ticketType.error?"error":"info"},z.fields.ticketType.error||""),(null==z||null==(m=z.fields)||null==(f=m.ticketType)||null==(p=f.value)||null==(g=p.extras)?void 0:g.length)&&a.createElement(vn.a.Subheader,null,"Ticket addons"),a.createElement(pn.a,{horizontal:!0,style:Nn.ticketAddons},null==z||null==(v=z.fields)||null==(b=v.ticketType)||null==(h=b.value)||null==(y=h.extras)?void 0:y.map((function(e){var n,t,r,l;return a.createElement(bn.a,{selected:null==z||null==(n=z.fields)||null==(t=n.extras.value)?void 0:t.some((function(n){return n.id===e.id})),onPress:null!=z&&null!=(r=z.fields)&&null!=(l=r.extras.value)&&l.some((function(n){return n.id===e.id}))?function(){var n,t;return O(Pn.setField(["extras",null==z||null==(n=z.fields)||null==(t=n.extras.value)?void 0:t.filter((function(n){return n.id!==e.id}))]))}:function(){var n,t;return O(Pn.setField(["extras",[].concat(ce()((null==z||null==(n=z.fields)||null==(t=n.extras)?void 0:t.value)||[]),[e])]))}},e.name+" ($"+e.cost+")")}))),a.createElement(gn.a,{type:z.fields.extras.error?"error":"info"},z.fields.extras.error||""),a.createElement(hn.a,null),a.createElement(Tn,{value:z.fields.rig.value,userId:Number(null==(E=z.fields.user)||null==(S=E.value)?void 0:S.id),dropzoneId:Number(null==(x=w.currentDropzone)?void 0:x.id),onSelect:function(e){return O(Pn.setField(["jumpType",e]))}}),a.createElement(gn.a,{type:z.fields.rig.error?"error":"info"},z.fields.rig.error||""),a.createElement(yn.a,{style:Nn.field,mode:"outlined",label:"Exit weight",error:!!z.fields.exitWeight.error,value:(null==(I=z.fields.exitWeight)||null==(k=I.value)?void 0:k.toString())||"",keyboardType:"numbers-and-punctuation",right:function(){return a.createElement(yn.a.Affix,{text:"kg"})},onChangeText:function(e){return O(Pn.setField(["exitWeight",Number(e)]))}}),a.createElement(gn.a,{type:z.fields.exitWeight.error?"error":"info"},z.fields.exitWeight.error||""))}var $n,Nn=Ue.a.create({fields:{flex:1},field:{marginBottom:8},ticketAddons:{marginBottom:8}}),Dn=Object(g.gql)($n||($n=tn()(["\n  mutation CreateSlot(\n    $jumpTypeId: Int\n    $extraIds: [Int!]\n    $loadId: Int\n    $rigId: Int\n    $ticketTypeId: Int\n    $userId: Int\n    $exitWeight: Float\n  ) {\n    createSlot(\n      input: {\n        attributes: {\n          jumpTypeId: $jumpTypeId\n          extraIds: $extraIds\n          loadId: $loadId\n          rigId: $rigId\n          ticketTypeId: $ticketTypeId\n          userId: $userId\n          exitWeight: $exitWeight\n        }\n      }\n    ) {\n      errors\n      fieldErrors {\n        field\n        message\n      }\n      slot {\n        id\n        jumpType {\n          id\n          name\n        }\n        extras {\n          id\n          name\n        }\n        exitWeight\n        load {\n          id\n          name\n          createdAt\n          dispatchAt\n          hasLanded\n          maxSlots\n          isFull\n          isOpen\n          plane {\n            id\n            name\n          }\n          gca {\n            id\n            user {\n              id\n              name\n            }\n          }\n          pilot {\n            id\n            user {\n              id\n              name\n            }\n          }\n          loadMaster {\n            id\n            user {\n              id\n              name\n            }\n          }\n          slots {\n            id\n            createdAt\n            user {\n              id\n              name\n            }\n            ticketType {\n              id\n              name\n              altitude\n            }\n            jumpType {\n              id\n              name\n            }\n            extras {\n              id\n              name\n            }\n          }\n        }\n      }\n    }\n  }\n"])));function Mn(e){var n,t,r,i,o,s=ze(),u=Oe((function(e){return e.slotForm})),c=Oe((function(e){return e.global})),d=Object(g.useMutation)(Dn),m=R()(d,2),f=m[0],p=m[1],v=Object(a.useCallback)((function(){var e,n,t=!1;return null!=(e=u.fields.jumpType.value)&&e.id||(t=!0,s(ve.setFieldError(["jumpType","You must specify the type of jump"]))),null!=(n=u.fields.ticketType.value)&&n.id||(t=!0,s(ve.setFieldError(["ticketType","You must select a ticket type to manifest"]))),!t}),[JSON.stringify(u.fields)]),b=Object(a.useCallback)((function(){var n,t,r,a,l,i,o,c,d,m,p,g,b,h,y,E,S,x,I,k,z,O;return Fe.a.async((function(w){for(;;)switch(w.prev=w.next){case 0:if(v()){w.next=2;break}return w.abrupt("return");case 2:return w.prev=2,w.next=5,Fe.a.awrap(f({variables:{jumpTypeId:Number(null==(n=u.fields.jumpType.value)?void 0:n.id),extraIds:null==(t=u.fields.extras)||null==(r=t.value)?void 0:r.map((function(e){var n=e.id;return Number(n)})),loadId:Number(null==(a=u.fields.load.value)?void 0:a.id),rigId:null!=(l=u.fields.rig.value)&&l.id?Number(null==(i=u.fields.rig.value)?void 0:i.id):null,ticketTypeId:Number(null==(o=u.fields.ticketType)||null==(c=o.value)?void 0:c.id),userId:Number(null==(d=u.fields.user)||null==(m=d.value)?void 0:m.id),exitWeight:u.fields.exitWeight.value}}));case 5:if(k=w.sent,null==(p=k.data)||null==(g=p.createSlot)||null==(b=g.fieldErrors)||b.map((function(e){var n=e.field,t=e.message;switch(n){case"jump_type":return s(ve.setFieldError(["jumpType",t]));case"load":return s(ve.setFieldError(["load",t]));case"credits":case"extras":case"extra_ids":return s(ve.setFieldError(["extras",t]));case"ticket_type":return s(ve.setFieldError(["ticketType",t]));case"rig":return s(ve.setFieldError(["rig",t]));case"user":return s(ve.setFieldError(["user",t]));case"exit_weight":return s(ve.setFieldError(["exitWeight",t]))}})),null==k||null==(h=k.data)||null==(y=h.createSlot)||null==(E=y.errors)||!E.length){w.next=9;break}return w.abrupt("return",s(ge.showSnackbar({message:null==k||null==(z=k.data)||null==(O=z.createSlot)?void 0:O.errors[0],variant:"error"})));case 9:null!=(S=k.data)&&null!=(x=S.createSlot)&&null!=(I=x.fieldErrors)&&I.length||e.onSuccess(),w.next=15;break;case 12:w.prev=12,w.t0=w.catch(2),s(ge.showSnackbar({message:w.t0.message,variant:"error"}));case 15:case"end":return w.stop()}}),null,null,[[2,12]],Promise)}),[JSON.stringify(u.fields),f,e.onSuccess]);return l.a.createElement(dn.a,null,l.a.createElement(mn.a,{visible:!!e.open},l.a.createElement(un.a,{indeterminate:!0,visible:p.loading,color:c.theme.colors.accent}),l.a.createElement(mn.a.Title,null,"Manifest "+(null==u||null==(n=u.fields)||null==(t=n.user)||null==(r=t.value)?void 0:r.name)+" on "+(null==(i=u.fields.load)||null==(o=i.value)?void 0:o.name)),l.a.createElement(mn.a.Content,null,l.a.createElement(Fn,null)),l.a.createElement(mn.a.Actions,{style:{justifyContent:"flex-end"}},l.a.createElement(fn.a,{onPress:function(){s(ve.reset()),e.onClose()}},"Cancel"),l.a.createElement(fn.a,{onPress:b},"Manifest"))))}var An=t(137),Un=t(292),qn=t(26),Rn=t.n(qn),Bn=t(8),Wn=t.n(Bn);function Ln(e,n){var t=e.light;return t||Re.light[n]}function Hn(e){var n=e.style,t=e.lightColor,r=e.darkColor,l=Wn()(e,["style","lightColor","darkColor"]),i=Ln({light:t,dark:r},"text");return a.createElement(Qe.a,Rn()({style:[{color:i},n]},l))}function Vn(e){var n=e.style,t=e.lightColor,r=e.darkColor,l=Wn()(e,["style","lightColor","darkColor"]),i=Ln({light:t,dark:r},"background");return a.createElement(d.a,Rn()({style:[{backgroundColor:i},n]},l))}function Qn(e){var n=e.title,t=e.subtitle;return l.a.createElement(Vn,{style:Jn.empty},l.a.createElement(An.a,null,n),l.a.createElement(Un.a,{style:{textAlign:"center"}},t))}var Jn=Ue.a.create({container:{flex:1,padding:8,display:"flex"},fab:{position:"absolute",margin:16,right:0,bottom:0},empty:{flex:1,alignItems:"center",justifyContent:"center",width:"100%",height:"100%"}});function _n(e){var n=e.hasPlanes,t=e.hasTicketTypes,r=(e.isPublic,Be());return a.createElement(Vn,{style:{width:"70%"}},a.createElement(Hn,{style:Zn.title},"Set up dropzone"),a.createElement(Vn,{style:Zn.separator,lightColor:"#eee",darkColor:"rgba(255,255,255,0.1)"}),a.createElement(vn.a.Item,{title:"Create dropzone",left:function(){return a.createElement(vn.a.Icon,{color:r.success,icon:"check"})}}),a.createElement(vn.a.Item,{title:"Add a plane",left:function(){return n?a.createElement(vn.a.Icon,{color:r.success,icon:"check"}):a.createElement(vn.a.Icon,{color:r.error,icon:"close"})}}),a.createElement(vn.a.Item,{title:"Configure jump tickets",left:function(){return t?a.createElement(vn.a.Icon,{color:r.success,icon:"check"}):a.createElement(vn.a.Icon,{color:r.error,icon:"close"})}}))}var Gn,Yn,Zn=Ue.a.create({container:{flex:1,alignItems:"center",justifyContent:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"}}),Kn=t(194),Xn=t(307),et=t(363),nt=t(379),tt=Object(ln.a)(Gn||(Gn=tn()(["\n  query QueryDropzoneUsers(\n    $dropzoneId: Int!\n    $permissions: [Permission!]\n  ) {\n    dropzone(id: $dropzoneId) {\n      id\n      name\n\n      dropzoneUsers(permissions: $permissions) {\n        edges {\n          node {\n            id\n            role {\n              id\n              name\n            }\n            user {\n              id\n              name\n            }\n          }\n        }\n      }\n    }\n  }\n"])));function rt(e){var n,t,r,i,o,s,u,c=Object(a.useState)(!1),d=R()(c,2),m=d[0],f=d[1],p=Oe((function(e){return e.global})),v=Object(g.useQuery)(tt,{variables:{dropzoneId:Number(null==(n=p.currentDropzone)?void 0:n.id),permissions:["actAsGCA"]}}).data;return Cn("updateLoad")?l.a.createElement(En.a,{onDismiss:function(){return f(!1)},visible:m,anchor:l.a.createElement(bn.a,{mode:"outlined",icon:"radio-handheld",style:{marginHorizontal:4},onPress:function(){return f(!0)}},null!=(r=e.value)&&r.id?null==(i=e.value)?void 0:i.name:"No gca")},null==v||null==(o=v.dropzone)||null==(s=o.dropzoneUsers)||null==(u=s.edges)?void 0:u.map((function(n){var t,r;return l.a.createElement(vn.a.Item,{onPress:function(){var t;f(!1),e.onSelect(null==n||null==(t=n.node)?void 0:t.user)},title:null==n||null==(t=n.node)||null==(r=t.user)?void 0:r.name})}))):l.a.createElement(bn.a,{mode:"outlined",icon:"radio-handheld"},(null==(t=e.value)?void 0:t.name)||"No gca")}function at(e){var n,t,r,i,o=Object(a.useState)(!1),s=R()(o,2),u=s[0],c=s[1],d=Cn("updateLoad");return d?l.a.createElement(En.a,{onDismiss:function(){return c(!1)},visible:u,anchor:l.a.createElement(bn.a,{mode:"outlined",icon:"parachute",style:{marginHorizontal:4},onPress:function(){return d&&c(!0)}},null!=(t=e.value)&&t.id?null==(r=e.value)?void 0:r.name:"No loadmaster")},null==(i=e.slots)?void 0:i.map((function(n){var t;return l.a.createElement(vn.a.Item,{onPress:function(){c(!1),e.onSelect(n.user)},title:null==n||null==(t=n.user)?void 0:t.name})}))):l.a.createElement(bn.a,{mode:"outlined",icon:"radio-handheld"},(null==(n=e.value)?void 0:n.name)||"No loadmaster")}var lt,it=Object(ln.a)(Yn||(Yn=tn()(["\n  query QueryDropzoneUsers(\n    $dropzoneId: Int!\n    $permissions: [Permission!]\n  ) {\n    dropzone(id: $dropzoneId) {\n      id\n      name\n\n      dropzoneUsers(permissions: $permissions) {\n        edges {\n          node {\n            id\n            role {\n              id\n              name\n            }\n            user {\n              id\n              name\n            }\n          }\n        }\n      }\n    }\n  }\n"])));function ot(e){var n,t,r,i,o,s,u,c=Object(a.useState)(!1),d=R()(c,2),m=d[0],f=d[1],p=Oe((function(e){return e.global})),v=Object(g.useQuery)(it,{variables:{dropzoneId:Number(null==(n=p.currentDropzone)?void 0:n.id),permissions:["actAsPilot"]}}).data;return Cn("updateLoad")?l.a.createElement(En.a,{onDismiss:function(){return f(!1)},visible:m,anchor:l.a.createElement(bn.a,{mode:"outlined",icon:"airplane-takeoff",style:{marginHorizontal:4},onPress:function(){return f(!0)}},null!=(r=e.value)&&r.id?null==(i=e.value)?void 0:i.name:"No pilot")},null==v||null==(o=v.dropzone)||null==(s=o.dropzoneUsers)||null==(u=s.edges)?void 0:u.map((function(n){var t,r;return l.a.createElement(vn.a.Item,{onPress:function(){var t;f(!1),e.onSelect(null==n||null==(t=n.node)?void 0:t.user)},title:null==n||null==(t=n.node)||null==(r=t.user)?void 0:r.name})}))):l.a.createElement(bn.a,{mode:"outlined",icon:"radio-handheld"},(null==(t=e.value)?void 0:t.name)||"No pilot")}var st,ut,ct=Object(ln.a)(lt||(lt=tn()(["\n  query QueryPlanes(\n    $dropzoneId: Int!\n  ) {\n    planes(dropzoneId: $dropzoneId) {\n      id\n      name\n      registration\n      hours\n      minSlots\n      maxSlots\n      nextMaintenanceHours\n      createdAt\n    }\n  }\n"])));function dt(e){var n,t,r,i,o=Object(a.useState)(!1),s=R()(o,2),u=s[0],c=s[1],d=Oe((function(e){return e.global})),m=Object(g.useQuery)(ct,{variables:{dropzoneId:Number(null==(n=d.currentDropzone)?void 0:n.id)}}).data,f=Cn("updateLoad");return f?l.a.createElement(En.a,{onDismiss:function(){return c(!1)},visible:u,anchor:l.a.createElement(bn.a,{mode:"outlined",icon:"airplane",style:{marginHorizontal:4},onPress:function(){return f&&c(!0)}},(null==(r=e.value)?void 0:r.name)||"No plane")},null==m||null==(i=m.planes)?void 0:i.map((function(n){return l.a.createElement(vn.a.Item,{onPress:function(){c(!1),e.onSelect(n)},title:n.name})}))):l.a.createElement(bn.a,{mode:"outlined",icon:"airplane-takeoff"},(null==(t=e.value)?void 0:t.name)||"No plane")}var mt=Object(g.gql)(st||(st=tn()(["\n  query QueryLoad($id: Int!) {\n    load(id: $id) {\n      id\n      name\n      createdAt\n      dispatchAt\n      hasLanded\n      maxSlots\n      loadNumber\n      isFull\n      isOpen\n      plane {\n        id\n        name\n      }\n      gca {\n        id\n        user {\n          id\n          name\n        }\n      }\n      pilot {\n        id\n        user {\n          id\n          name\n        }\n      }\n      loadMaster {\n        id\n        user {\n          id\n          name\n        }\n      }\n      slots {\n        id\n        createdAt\n        exitWeight\n        user {\n          id\n          name\n        }\n        ticketType {\n          id\n          name\n          altitude\n\n          extras {\n            id\n            name\n            cost\n          }\n        }\n        jumpType {\n          id\n          name\n        }\n        extras {\n          id\n          name\n        }\n      }\n    }\n  }\n"]))),ft=Object(g.gql)(ut||(ut=tn()(["\n  mutation UpdateLoad(\n    $id: Int!,\n    $pilotId: Int,\n    $gcaId: Int,\n    $planeId: Int,\n    $isOpen: Boolean,\n    $loadMasterId: Int,\n    $dispatchAt: Int,\n    $hasLanded: Boolean,\n  ){\n    updateLoad(input: {\n      id: $id\n      attributes: {\n        pilotId: $pilotId,\n        gcaId: $gcaId,\n        planeId: $planeId,\n        isOpen: $isOpen,\n        loadMasterId: $loadMasterId\n        dispatchAt: $dispatchAt\n        hasLanded: $hasLanded\n      }\n    }) {\n      load {\n        id\n        name\n        createdAt\n        loadNumber\n        dispatchAt\n        hasLanded\n        maxSlots\n        isFull\n        isOpen\n        plane {\n          id\n          name\n        }\n        gca {\n          id\n          user {\n            id\n            name\n          }\n        }\n        pilot {\n          id\n          user {\n            id\n            name\n          }\n        }\n        loadMaster {\n          id\n          user {\n            id\n            name\n          }\n        }\n        slots {\n          id\n          createdAt\n          exitWeight\n          user {\n            id\n            name\n          }\n          ticketType {\n            id\n            name\n            altitude\n          }\n          jumpType {\n            id\n            name\n          }\n          extras {\n            id\n            name\n          }\n        }\n      }\n    }\n  }\n"])));function pt(e){var n,t,r,l,i,o,s,u,c,d,m,f,p,v,b,h,y,E,S,x,I,k,z,O,w,C,j=Oe((function(e){return e.global})),T=a.useState(!1),P=R()(T,2),F=P[0],$=P[1],N=a.useState(!1),D=R()(N,2),M=D[0],A=D[1],U=(Object(rn.useNavigation)(),e.load),q=(e.loadNumber,e.onManifest),B=e.canManifest,W=Object(g.useQuery)(mt,{variables:{id:Number(U.id)}}),L=W.data,H=W.loading,V=Object(g.useMutation)(ft),Q=R()(V,2),J=Q[0],_=Q[1],G=a.useCallback((function(e){return Fe.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Fe.a.awrap(J({variables:{id:Number(U.id),pilotId:Number(e.id)}}));case 3:n.next=7;break;case 5:n.prev=5,n.t0=n.catch(0);case 7:case"end":return n.stop()}}),null,null,[[0,5]],Promise)}),[J,JSON.stringify(U)]),Y=a.useCallback((function(e){return Fe.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Fe.a.awrap(J({variables:{id:Number(U.id),gcaId:Number(e.id)}}));case 3:n.next=7;break;case 5:n.prev=5,n.t0=n.catch(0);case 7:case"end":return n.stop()}}),null,null,[[0,5]],Promise)}),[J,JSON.stringify(U)]),Z=a.useCallback((function(e){return Fe.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Fe.a.awrap(J({variables:{id:Number(U.id),planeId:Number(e.id)}}));case 3:n.next=7;break;case 5:n.prev=5,n.t0=n.catch(0);case 7:case"end":return n.stop()}}),null,null,[[0,5]],Promise)}),[J,JSON.stringify(U)]),K=a.useCallback((function(e){return Fe.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Fe.a.awrap(J({variables:{id:Number(U.id),loadMasterId:Number(e.id)}}));case 3:n.next=7;break;case 5:n.prev=5,n.t0=n.catch(0);case 7:case"end":return n.stop()}}),null,null,[[0,5]],Promise)}),[J,JSON.stringify(U)]),X=a.useCallback((function(e){var n;return Fe.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e?Object(et.a)(new Date,e).getTime()/1e3:null,t.prev=1,t.next=4,Fe.a.awrap(J({variables:{id:Number(U.id),dispatchAt:n?Math.ceil(n):null}}));case 4:t.next=8;break;case 6:t.prev=6,t.t0=t.catch(1);case 8:case"end":return t.stop()}}),null,null,[[1,6]],Promise)}),[J,JSON.stringify(U)]),ee=a.useCallback((function(){return Fe.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Fe.a.awrap(J({variables:{id:Number(U.id),hasLanded:!0}}));case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:case"end":return e.stop()}}),null,null,[[0,5]],Promise)}),[J,JSON.stringify(U)]),ne=Cn("updateLoad"),te=Cn("updateSlot"),re=Cn("updateUserSlot"),ae=a.useCallback((function(n){var t,r;if((null==n||null==(t=n.user)?void 0:t.id)===(null==(r=j.currentUser)?void 0:r.id)||re)return function(){var t,r;(null==(t=n.user)?void 0:t.id)===(null==(r=j.currentUser)?void 0:r.id)?te&&e.onSlotPress(n):re&&e.onSlotPress(n)}}),[JSON.stringify(U),re,e.onSlotPress]);return a.useEffect((function(){var e,n;null!=L&&null!=(e=L.load)&&e.maxSlots&&(null==L||null==(n=L.load)?void 0:n.maxSlots)<5&&!F&&$(!0)}),[null==L||null==(n=L.load)?void 0:n.maxSlots]),a.createElement(Kn.a,{style:{margin:16},elevation:3},a.createElement(Kn.a.Title,{title:"Load "+(null==L||null==(t=L.load)?void 0:t.loadNumber),subtitle:U.name}),a.createElement(un.a,{visible:H||_.loading,color:j.theme.colors.accent}),a.createElement(Kn.a.Content,{style:{marginVertical:8,height:F?void 0:300,overflow:"hidden"}},a.createElement(Vn,{style:{flexDirection:"row"}},a.createElement(pn.a,{horizontal:!0},a.createElement(dt,{dropzoneId:Number(null==(r=j.currentDropzone)?void 0:r.id),value:null==L||null==(l=L.load)?void 0:l.plane,onSelect:Z}),a.createElement(rt,{dropzoneId:Number(null==(i=j.currentDropzone)?void 0:i.id),value:null==L||null==(o=L.load)||null==(s=o.gca)?void 0:s.user,onSelect:Y}),a.createElement(ot,{dropzoneId:Number(null==(u=j.currentDropzone)?void 0:u.id),value:null==L||null==(c=L.load)||null==(d=c.pilot)?void 0:d.user,onSelect:G}),a.createElement(at,{dropzoneId:Number(null==(m=j.currentDropzone)?void 0:m.id),value:null==L||null==(f=L.load)||null==(p=f.loadMaster)?void 0:p.user,slots:(null==L?void 0:L.load.slots)||[],onSelect:K}))),a.createElement(Xn.a,null,a.createElement(Xn.a.Header,{style:{width:"100%"}},a.createElement(Xn.a.Title,null,"Name"),a.createElement(Xn.a.Title,{numeric:!0},"Exit weight"),a.createElement(Xn.a.Title,{numeric:!0},"Jump type"),a.createElement(Xn.a.Title,{numeric:!0},"Altitude")),null==L||null==(v=L.load)||null==(b=v.slots)?void 0:b.map((function(e){var n,t,r;return a.createElement(Xn.a.Row,{onPress:ae(e),pointerEvents:"none"},a.createElement(Xn.a.Cell,null,null==e||null==(n=e.user)?void 0:n.name),a.createElement(Xn.a.Cell,{numeric:!0},null==e?void 0:e.exitWeight),a.createElement(Xn.a.Cell,{numeric:!0},null==e||null==(t=e.jumpType)?void 0:t.name),a.createElement(Xn.a.Cell,{numeric:!0},null==e||null==(r=e.ticketType)?void 0:r.altitude))})),Array.from({length:((null==U?void 0:U.maxSlots)||0)-((null==U||null==(h=U.slots)?void 0:h.length)||0)},(function(e,n){return n})).map((function(){return a.createElement(Xn.a.Row,null,a.createElement(Xn.a.Cell,null,"- Available -"),a.createElement(Xn.a.Cell,{numeric:!0},"-"),a.createElement(Xn.a.Cell,{numeric:!0},"-"),a.createElement(Xn.a.Cell,{numeric:!0},"-"))})))),!(null==L||null==(y=L.load)||!y.dispatchAt)&&(null==L||null==(E=L.load)?void 0:E.dispatchAt)>(new Date).getTime()/1e3&&a.createElement(Vn,{style:{flex:1,backgroundColor:"#FF8800",padding:8}},a.createElement(Un.a,null,"Take-off in "+Object(nt.a)(new Date,1e3*(null==L||null==(S=L.load)?void 0:S.dispatchAt))+" min")),a.createElement(Kn.a.Actions,null,null!=L&&null!=(x=L.load)&&x.maxSlots&&(null==L||null==(I=L.load)?void 0:I.maxSlots)<5?null:a.createElement(fn.a,{onPress:function(){return $(!F)}},F?"Show less":"Show more"),a.createElement(Vn,{style:{flexGrow:1}}),!ne||null!=L&&null!=(k=L.load)&&k.hasLanded?null:null!=L&&null!=(z=L.load)&&z.dispatchAt?a.createElement(fn.a,{mode:"outlined",onPress:function(){return X(null)}},"Cancel"):a.createElement(En.a,{onDismiss:function(){return A(!1)},visible:M,anchor:a.createElement(fn.a,{mode:"outlined",onPress:function(){return A(!0)}},"Dispatch")},a.createElement(vn.a.Item,{onPress:function(){A(!1),X(20)},title:"20 minute call"}),a.createElement(vn.a.Item,{onPress:function(){A(!1),X(15)},title:"15 minute call"}),a.createElement(vn.a.Item,{onPress:function(){A(!1),X(10)},title:"10 minute call"}),a.createElement(vn.a.Item,{onPress:function(){A(!1),X(5)},title:"5 minute call"})),null!=L&&null!=(O=L.load)&&O.hasLanded?null:null!=L&&null!=(w=L.load)&&w.dispatchAt&&(null==L?void 0:L.load.dispatchAt)<(new Date).getTime()/1e3&&ne?a.createElement(fn.a,{style:{marginLeft:8},mode:"contained",onPress:function(){return ee()}},"Mark as landed"):a.createElement(fn.a,{style:{marginLeft:8},mode:"contained",onPress:function(){return q()},disabled:!B||Boolean((null==L||null==(C=L.load)?void 0:C.dispatchAt)&&L.load.dispatchAt<(new Date).getTime()/1e3)},"Manifest")))}var gt;Ue.a.create({container:{flex:1,alignItems:"center",justifyContent:"center",marginVertical:8},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fab:{position:"absolute",margin:16,right:0,bottom:0}});function vt(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function bt(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?vt(Object(t),!0).forEach((function(n){p()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):vt(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var ht=Object(ln.a)(gt||(gt=tn()(["\n  query QueryDropzone($dropzoneId: Int!, $earliestTimestamp: Int) {\n    dropzone(id: $dropzoneId) {\n      id\n      name\n      primaryColor,\n      secondaryColor,\n      planes {\n        id\n        name\n        registration\n      }\n      ticketTypes {\n        id\n        name\n      }\n\n      currentUser {\n        id\n        user {\n          id\n          name\n          exitWeight\n          email\n          phone\n          rigs {\n            id\n            model\n            make\n            serial\n            canopySize\n            repackExpiresAt\n          }\n          jumpTypes {\n            id\n            name\n          }\n          license {\n            id\n            name\n          }\n        }\n      }\n\n      loads(earliestTimestamp: $earliestTimestamp) {\n        edges {\n          node {\n            id\n            name\n            isOpen\n            maxSlots\n            isFull\n          }\n        }\n      }\n    }\n  }\n"])));function yt(){var e,n,t,r,l,i,o,s,u,c,d,m,f,p=Oe((function(e){return e.global})),v=a.useState(!1),b=R()(v,2),h=b[0],y=b[1],E=ze(),S=Object(g.useQuery)(ht,{variables:{dropzoneId:Number(null==(e=p.currentDropzone)?void 0:e.id),earliestTimestamp:Object(an.a)(new Date).getTime()/1e3},fetchPolicy:"no-cache"}),x=S.data,I=S.loading,k=S.refetch,z=Object(rn.useNavigation)(),O=Object(rn.useIsFocused)();a.useEffect((function(){O&&k()}),[O]);var w=!(null==x||null==(n=x.dropzone)||null==(t=n.planes)||!t.length),C=!(null==x||null==(r=x.dropzone)||null==(l=r.ticketTypes)||!l.length),j=!(null==x||null==(i=x.dropzone)||!i.isPublic),T=w&&C;a.useEffect((function(){var e,n;null!=x&&null!=(e=x.dropzone)&&e.id&&(E(fe.setDropzone(x.dropzone)),E(fe.setUser(bt(bt({},null==p?void 0:p.currentUser),(null==x||null==(n=x.dropzone)?void 0:n.currentUser.user)||{}))))}),[JSON.stringify(null==x?void 0:x.dropzone)]),a.useEffect((function(){var e,n,t,r,a,l,i,o;null!=x&&null!=(e=x.dropzone)&&e.primaryColor&&(null==x||null==(n=x.dropzone)?void 0:n.primaryColor)!==(null==(t=p.theme)||null==(r=t.colors)?void 0:r.primary)&&E(fe.setPrimaryColor(x.dropzone.primaryColor)),null!=x&&null!=(a=x.dropzone)&&a.secondaryColor&&(null==x||null==(l=x.dropzone)?void 0:l.secondaryColor)!==(null==(i=p.theme)||null==(o=i.colors)?void 0:o.accent)&&E(fe.setPrimaryColor(x.dropzone.secondaryColor))}),[null==x||null==(o=x.dropzone)?void 0:o.primaryColor,null==x||null==(s=x.dropzone)?void 0:s.secondaryColor]);var P=Cn("createSlot"),F=Cn("createLoad");return a.createElement(a.Fragment,null,a.createElement(Mn,{open:h,onClose:function(){return y(!1)},onSuccess:function(){return y(!1)}}),a.createElement(un.a,{visible:I,indeterminate:!0,color:p.theme.colors.accent}),a.createElement(Vn,{style:Et.container},!I&&(T?a.createElement(Vn,{style:{width:"100%",flex:1,height:on.a.get("window").height}},((null==x||null==(u=x.dropzone)||null==(c=u.loads)||null==(d=c.edges)?void 0:d.length)||0)<1?a.createElement(Qn,{title:"No loads so far today",subtitle:"How's the weather?"}):a.createElement(sn.a,{style:{flex:1,height:on.a.get("window").height},contentContainerStyle:{flexGrow:1},numColumns:1,data:(null==x||null==(m=x.dropzone)||null==(f=m.loads)?void 0:f.edges)||[],refreshing:I,onRefresh:k,renderItem:function(e){var n,t,r,l,i,o=e.item,s=e.index;return null!=o&&o.node?a.createElement(pt,{key:"load-"+o.node.id,load:o.node,canManifest:P&&(null==o||null==(n=o.node)?void 0:n.isOpen)&&!(null!=o&&null!=(t=o.node)&&t.isFull),loadNumber:((null==x||null==(r=x.dropzone)||null==(l=r.loads)||null==(i=l.edges)?void 0:i.length)||0)-s,onSlotPress:function(e){E(ve.setOriginal(e)),E(ve.setField(["load",o.node])),y(!0)},onManifest:function(){E(ve.setField(["user",p.currentUser])),E(ve.setField(["load",o.node])),y(!0)}}):null}})):a.createElement(_n,{hasPlanes:w,hasTicketTypes:C,isPublic:j})),F&&T&&a.createElement(cn.a,{style:Et.fab,small:!0,icon:"plus",onPress:function(){return z.navigate("CreateLoadScreen")},label:"New load"})))}var Et=Ue.a.create({container:{flex:1,alignItems:"center",justifyContent:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fab:{position:"absolute",margin:16,right:0,bottom:0}}),St=t(376);function xt(e){return a.createElement(Hn,Rn()({},e,{style:[e.style,{fontFamily:"space-mono"}]}))}function It(e){var n=e.path;return l.a.createElement(Vn,null,l.a.createElement(Vn,{style:zt.getStartedContainer},l.a.createElement(Hn,{style:zt.getStartedText,lightColor:"rgba(0,0,0,0.8)",darkColor:"rgba(255,255,255,0.8)"},"Open up the code for this screen:"),l.a.createElement(Vn,{style:[zt.codeHighlightContainer,zt.homeScreenFilename],darkColor:"rgba(255,255,255,0.05)",lightColor:"rgba(0,0,0,0.05)"},l.a.createElement(xt,null,n)),l.a.createElement(Hn,{style:zt.getStartedText,lightColor:"rgba(0,0,0,0.8)",darkColor:"rgba(255,255,255,0.8)"},"Change any of the text, save the file, and your app will automatically update.")),l.a.createElement(Vn,{style:zt.helpContainer},l.a.createElement(Je.a,{onPress:kt,style:zt.helpLink},l.a.createElement(Hn,{style:zt.helpLinkText,lightColor:Re.light.tint},"Tap here if your app doesn't automatically update after making changes"))))}function kt(){St.a("https://docs.expo.io/get-started/create-a-new-app/#opening-the-app-on-your-phonetablet")}var zt=Ue.a.create({container:{flex:1,backgroundColor:"#fff"},developmentModeText:{marginBottom:20,fontSize:14,lineHeight:19,textAlign:"center"},contentContainer:{paddingTop:30},welcomeContainer:{alignItems:"center",marginTop:10,marginBottom:20},welcomeImage:{width:100,height:80,resizeMode:"contain",marginTop:3,marginLeft:-10},getStartedContainer:{alignItems:"center",marginHorizontal:50},homeScreenFilename:{marginVertical:7},codeHighlightText:{color:"rgba(96,100,109, 0.8)"},codeHighlightContainer:{borderRadius:3,paddingHorizontal:4},getStartedText:{fontSize:17,lineHeight:24,textAlign:"center"},helpContainer:{marginTop:15,marginHorizontal:20,alignItems:"center"},helpLink:{paddingVertical:15},helpLinkText:{textAlign:"center"}});function Ot(){return a.createElement(Vn,{style:jt.container},a.createElement(Hn,{style:jt.title},"Tab One"),a.createElement(Vn,{style:jt.separator,lightColor:"#eee",darkColor:"rgba(255,255,255,0.1)"}),a.createElement(It,{path:"/screens/LoadScreen.tsx"}))}var wt,Ct,jt=Ue.a.create({container:{flex:1,alignItems:"center",justifyContent:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"}}),Tt=M.actions,Pt=t(309),Ft=Object(ln.a)(wt||(wt=tn()(["\n  query QueryPlanes(\n    $dropzoneId: Int!\n  ) {\n    planes(dropzoneId: $dropzoneId) {\n      id\n      name\n      registration\n      hours\n      minSlots\n      maxSlots\n      nextMaintenanceHours\n      createdAt\n    }\n  }\n"])));function $t(e){var n,t,r,i=Object(a.useState)(!1),o=R()(i,2),s=o[0],u=o[1],c=Oe((function(e){return e.global})),d=Object(g.useQuery)(Ft,{variables:{dropzoneId:Number(null==(n=c.currentDropzone)?void 0:n.id)}}),m=d.data;d.loading,d.refetch;return l.a.createElement(En.a,{onDismiss:function(){return u(!1)},visible:s,anchor:l.a.createElement(vn.a.Item,{onPress:function(){u(!0)},title:(null==(t=e.value)?void 0:t.name)||"No plane selected",description:e.required?null:"Optional",right:function(){return l.a.createElement(vn.a.Icon,{icon:"airplane"})}})},null==m||null==(r=m.planes)?void 0:r.map((function(n){return l.a.createElement(vn.a.Item,{onPress:function(){u(!1),e.onSelect(n)},title:n.name||"-",description:n.registration})})))}var Nt=function(e,n){var t=n.getPayload;return function(n){var r=n.variables,l=n.onError,i=ze(),o=Object(g.useQuery)(e,{variables:r}),s=o.data,u=o.loading,c=o.previousData,d=o.refetch,m=o.error,f=Object(a.useMemo)((function(){return t(s)}),[JSON.stringify(s)]);return Object(a.useEffect)((function(){JSON.stringify(c),JSON.stringify(s);null!=m&&m.message&&(!1!==n.showSnackbarErrors&&i(ge.showSnackbar({message:m.message,variant:"error"})),l(m.message))}),[n.onError,null==m?void 0:m.message]),{loading:u,data:f,refetch:d}}}(Object(ln.a)(Ct||(Ct=tn()(["\nquery QueryDropzoneUsers(\n  $dropzoneId: Int!\n  $permissions: [Permission!]\n) {\n  dropzone(id: $dropzoneId) {\n    id\n    name\n\n    dropzoneUsers(permissions: $permissions) {\n      edges {\n        node {\n          id\n          role {\n            id\n            name\n          }\n          user {\n            id\n            name\n          }\n        }\n      }\n    }\n  }\n}\n"]))),{getPayload:function(e){var n;return null==e||null==(n=e.dropzone)?void 0:n.dropzoneUsers}});function Dt(e){var n,t,r,i,o,s=Object(a.useState)(!1),u=R()(s,2),c=u[0],d=u[1],m=Oe((function(e){return e.global})),f=Nt({variables:{dropzoneId:Number(null==(n=m.currentDropzone)?void 0:n.id),permissions:e.requiredPermissions}}),p=f.data;f.loading,f.refetch;return l.a.createElement(l.a.Fragment,null,l.a.createElement(An.a,null,e.label),l.a.createElement(En.a,{onDismiss:function(){return d(!1)},visible:c,anchor:l.a.createElement(vn.a.Item,{onPress:function(){d(!0)},title:null!=(t=e.value)&&null!=(r=t.user)&&r.id?null==(i=e.value)?void 0:i.user.name:"No user selected",style:{width:"100%"},right:function(){return l.a.createElement(vn.a.Icon,{icon:"account"})},description:e.required?null:"Optional"})},null==p||null==(o=p.edges)?void 0:o.map((function(n){var t,r,a,i;return l.a.createElement(vn.a.Item,{style:{width:"100%"},onPress:function(){d(!1),e.onSelect(null==n?void 0:n.node)},title:(null==n||null==(t=n.node)||null==(r=t.user)?void 0:r.name)||"-",description:(null==n||null==(a=n.node)||null==(i=a.role)?void 0:i.name)||null})}))))}var Mt=ee.actions;function At(){var e,n,t,r,l,i=Oe((function(e){return e.loadForm})),o=ze(),s=Oe((function(e){return e.global}));return a.createElement(a.Fragment,null,a.createElement(yn.a,{style:Ut.field,mode:"outlined",label:"Name",error:!!i.fields.name.error,placeholder:"Optional",value:i.fields.name.value||"",onChangeText:function(e){return o(Mt.setField(["name",e]))}}),a.createElement(gn.a,{type:i.fields.name.error?"error":"info"},i.fields.name.error||"e.g Starcrest load, Tandem load"),a.createElement(yn.a,{style:Ut.field,mode:"outlined",label:"Slots",error:!!i.fields.maxSlots.error,value:null==(e=i.fields.maxSlots)||null==(n=e.value)?void 0:n.toString(),onChangeText:function(e){return o(Mt.setField(["maxSlots",Number(e)]))}}),a.createElement(gn.a,{type:i.fields.maxSlots.error?"error":"info"},i.fields.maxSlots.error||""),a.createElement(d.a,{style:{width:"100%"}},a.createElement($t,{value:i.fields.plane.value,required:!0,onSelect:function(e){o(Mt.setField(["plane",e])),o(Mt.setField(["maxSlots",e.maxSlots]))},dropzoneId:Number(null==(t=s.currentDropzone)?void 0:t.id)}),a.createElement(gn.a,{type:i.fields.plane.error?"error":"info"},i.fields.plane.error||""),a.createElement(Pt.a.Item,{label:"Allow public manifesting",status:i.fields.isOpen.value?"checked":"unchecked",onPress:function(){return o(Mt.setField(["isOpen",!i.fields.isOpen.value]))}}),a.createElement(hn.a,{style:{marginVertical:8}}),a.createElement(Dt,{label:"GCA",onSelect:function(e){return o(Mt.setField(["gca",e]))},dropzoneId:Number(null==(r=s.currentDropzone)?void 0:r.id),value:i.fields.gca.value||null,requiredPermissions:["actAsGCA"],required:!0}),a.createElement(gn.a,{type:i.fields.gca.error?"error":"info"},i.fields.gca.error||""),a.createElement(Dt,{label:"Pilot",onSelect:function(e){return o(Mt.setField(["pilot",e]))},dropzoneId:Number(null==(l=s.currentDropzone)?void 0:l.id),value:i.fields.pilot.value||null,requiredPermissions:["actAsPilot"]}),a.createElement(gn.a,{type:i.fields.pilot.error?"error":"info"},i.fields.pilot.error||"")))}var Ut=Ue.a.create({fields:{flex:1,width:"100%"},field:{marginBottom:8,width:"100%"}}),qt=t(186);function Rt(e){var n=Object(qt.a)().height,t=Oe((function(e){return e.global})).theme;return l.a.createElement(pn.a,{style:[Wt.container,{backgroundColor:t.colors.surface,height:n-112},e.style],contentContainerStyle:[Wt.content,e.contentContainerStyle]},e.children)}var Bt,Wt=Ue.a.create({container:{flex:1},content:{paddingHorizontal:16,alignItems:"flex-start",flexGrow:1,paddingBottom:50}}),Lt=ee.actions,Ht=(N.actions,Object(g.gql)(Bt||(Bt=tn()(["\n  mutation CreateLoad(\n    $name: String,\n    $pilotId: Int,\n    $gcaId: Int,\n    $maxSlots: Int!,\n    $planeId: Int,\n    $isOpen: Boolean,\n  ){\n    createLoad(input: {\n      attributes: {\n        name: $name,\n        pilotId: $pilotId,\n        gcaId: $gcaId,\n        maxSlots: $maxSlots,\n        planeId: $planeId,\n        isOpen: $isOpen,\n      }\n    }) {\n      load {\n        id\n        name\n        pilot {\n          id\n          user {\n            id \n            name\n          }\n        }\n        gca {\n          id\n          user {\n            id \n            name\n          }\n        }\n        maxSlots\n        isOpen\n      }\n      fieldErrors {\n        field,\n        message\n      }\n      errors\n    }\n  }\n"]))));function Vt(){var e=Oe((function(e){return e})),n=e.loadForm,t=e.global,r=ze(),l=Object(rn.useNavigation)(),i=Object(g.useMutation)(Ht),o=R()(i,2),s=o[0],u=o[1],c=a.useCallback((function(){var e=!1;return n.fields.maxSlots.value<1&&(e=!0,r(Lt.setFieldError(["maxSlots","Please specify amount of allowed jumpers"]))),n.fields.plane.value||(e=!0,r(Lt.setFieldError(["plane","What plane is flying this load?"]))),n.fields.gca.value||(e=!0,r(Lt.setFieldError(["gca","You must have a GCA for this load"]))),!e}),[JSON.stringify(n.fields),r]),d=a.useCallback((function(){var e,a,i,o,u,d,m,f,p,g,v,b,h,y,E,S,x,I,k,z,O,w,C,j,T,P,F,$;return Fe.a.async((function(N){for(;;)switch(N.prev=N.next){case 0:if(e=n.fields,a=e.name,i=e.gca,e.loadMaster,o=e.plane,u=e.maxSlots,d=e.pilot,m=e.isOpen,!c()){N.next=15;break}return N.prev=2,N.next=5,Fe.a.awrap(s({variables:{dropzoneId:Number(null==(f=t.currentDropzone)?void 0:f.id),name:a.value,maxSlots:u.value,planeId:null!=(p=o.value)&&p.id?Number(null==(g=o.value)?void 0:g.id):null,pilotId:null!=(v=d.value)&&v.id?Number(null==(b=o.value)?void 0:b.id):null,gcaId:null!=(h=i.value)&&null!=(y=h.user)&&y.id?Number(null==(E=i.value)||null==(S=E.user)?void 0:S.id):null,isOpen:!!m.value}}));case 5:if(T=N.sent,null==(x=T.data)||null==(I=x.createLoad)||null==(k=I.fieldErrors)||k.map((function(e){var n=e.field,t=e.message;switch(n){case"name":return r(Lt.setFieldError(["name",t]));case"maxSlots":return r(Lt.setFieldError(["maxSlots",t]));case"plane":return r(Lt.setFieldError(["plane",t]));case"gca":return r(Lt.setFieldError(["gca",t]));case"is_open":return r(Lt.setFieldError(["isOpen",t]));case"pilot":return r(Lt.setFieldError(["pilot",t]))}})),null==T||null==(z=T.data)||null==(O=z.createLoad)||null==(w=O.errors)||!w.length){N.next=9;break}return N.abrupt("return",r(Tt.showSnackbar({message:T.data.createLoad.errors[0],variant:"error"})));case 9:null!=(C=T.data)&&null!=(j=C.createLoad)&&j.load&&($=T.data.createLoad.load,r(Tt.showSnackbar({message:"Load "+$.name+" created",variant:"success"})),null!=(P=T.data)&&null!=(F=P.createLoad)&&F.fieldErrors||l.goBack()),N.next=15;break;case 12:N.prev=12,N.t0=N.catch(2),r(Tt.showSnackbar({message:N.t0.message,variant:"error"}));case 15:case"end":return N.stop()}}),null,null,[[2,12]],Promise)}),[JSON.stringify(n.fields),r,s]);return a.createElement(Rt,{contentContainerStyle:Jt.content},a.createElement(en.a,{name:"airplane-takeoff",size:100,color:"#999999",style:{alignSelf:"center",marginTop:32}}),a.createElement(At,null),a.createElement(Vn,{style:Jt.fields},a.createElement(fn.a,{mode:"contained",style:Jt.button,disabled:u.loading,onPress:d,loading:u.loading},"Save")))}var Qt,Jt=Ue.a.create({content:{paddingHorizontal:48},button:{},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fields:{marginVertical:16,width:"100%"},field:{marginBottom:8}}),_t=t(306),Gt=t(38),Yt=Object(g.gql)(Qt||(Qt=tn()(["\n  query QueryDropzonesCompact {\n    dropzones {\n      edges {\n        node {\n          id\n          name\n        }\n      }\n    }\n  }\n"])));var Zt=Ue.a.create({warning:{flexDirection:"row",alignItems:"center",height:56,width:"100%",backgroundColor:"#ffbb33",justifyContent:"space-between",paddingHorizontal:32}}),Kt=function(e){var n,t,r,i,o,s,u,c=e.navigation,m=e.previous,f=e.scene,p=Object(a.useState)(!1),v=R()(p,2),b=v[0],h=v[1],y=Object(g.useQuery)(Yt).data,E=Oe((function(e){return e.global})),S=E.currentDropzone,x=(E.theme,ze()),I=!(null==S||null==(n=S.currentUser)||null==(t=n.user)||null==(r=t.rigs)||!r.length),k=!(null==S||null==(i=S.currentUser)||null==(o=i.user)||!o.exitWeight),z=!I||!k;return l.a.createElement(l.a.Fragment,null,l.a.createElement(_t.a.Header,null,m?l.a.createElement(_t.a.BackAction,{onPress:c.goBack}):null,l.a.createElement(_t.a.Content,{title:f.descriptor.options.title}),l.a.createElement(En.a,{onDismiss:function(){return h(!1)},visible:b,anchor:l.a.createElement(Gt.a,{onPress:function(){return h(!0)},style:{color:"white",marginRight:8}},null==S?void 0:S.name)},null==y||null==(s=y.dropzones)||null==(u=s.edges)?void 0:u.map((function(e){var n;return l.a.createElement(En.a.Item,{title:null==e||null==(n=e.node)?void 0:n.name,onPress:function(){x(fe.setDropzone(null==e?void 0:e.node)),h(!1)}})})))),z&&l.a.createElement(d.a,{style:Zt.warning},l.a.createElement(Un.a,null,"You need to complete your profile"),l.a.createElement(fn.a,{color:"black",mode:"outlined",onPress:function(){return c.navigate("Profile")}},"Take me there")))},Xt=Object(Ve.a)();function er(){var e=Oe((function(e){return e.global}));return a.createElement(Xt.Navigator,{screenOptions:{headerShown:!(!e.credentials||!e.currentDropzone),header:function(e){return a.createElement(Kt,e)},cardStyle:{flex:1}}},a.createElement(Xt.Screen,{name:"DropzoneScreen",component:yt,options:{title:"Manifest"}}),a.createElement(Xt.Screen,{name:"LoadScreen",component:Ot,options:{title:"Loads"}}),a.createElement(Xt.Screen,{name:"CreateLoadScreen",component:Vt,options:{title:"Create load"}}))}Ue.a.create({container:{flex:1,alignItems:"center",justifyContent:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"}}),Object(Ve.a)();var nr=t(171),tr=t(366),rr=t.n(tr);t(472);function ar(e){var n=a.useState(!1),t=R()(n,2),r=t[0],l=t[1];a.useCallback((function(){l(!1)}),[l]),a.useCallback((function(n){var t=n.date;l(!1),e.onChange(t.getTime()/1e3)}),[l,e.onChange]);return a.createElement(a.Fragment,null,a.createElement(En.a,{onDismiss:function(){return l(!1)},visible:r,anchor:a.createElement(vn.a.Item,{onPress:function(){return l(!0)},disabled:!!e.disabled,title:e.label,description:e.timestamp?Object(nr.a)(1e3*e.timestamp,"yyyy/MM/dd"):"No date selected",left:function(){return a.createElement(vn.a.Icon,{icon:"calendar"})}})},a.createElement(rr.a,{selectedDays:e.timestamp?[new Date(1e3*e.timestamp)]:[],onDayClick:function(n){e.onChange(n.getTime()/1e3),l(!1)}})))}var lr=se.actions;function ir(){var e,n=Oe((function(e){return e.rigForm})),t=ze(),r=a.useState(!1),l=R()(r,2);l[0],l[1];return a.createElement(a.Fragment,null,a.createElement(yn.a,{style:ur.field,mode:"outlined",label:"Make",error:!!n.fields.make.error,value:n.fields.make.value||"",onChangeText:function(e){return t(lr.setField(["make",e]))}}),a.createElement(gn.a,{type:n.fields.make.error?"error":"info"},n.fields.make.error||"e.g Javelin, Mirage"),a.createElement(yn.a,{style:ur.field,mode:"outlined",label:"Model",error:!!n.fields.model.error,value:n.fields.model.value||"",onChangeText:function(e){return t(lr.setField(["model",e]))}}),a.createElement(gn.a,{type:n.fields.model.error?"error":"info"},n.fields.model.error||"e.g G4.1"),a.createElement(yn.a,{style:ur.field,mode:"outlined",label:"Serial",error:!!n.fields.serial.error,value:n.fields.serial.value||"",onChangeText:function(e){return t(lr.setField(["serial",e]))}}),a.createElement(gn.a,{type:n.fields.serial.error?"error":"info"},n.fields.serial.error||""),a.createElement(yn.a,{style:ur.field,mode:"outlined",label:"Current canopy size",error:!!n.fields.canopySize.error,value:(null==(e=n.fields.canopySize.value)?void 0:e.toString())||"",keyboardType:"number-pad",onChangeText:function(e){return t(lr.setField(["canopySize",Number(e)]))}}),a.createElement(gn.a,{type:n.fields.canopySize.error?"error":"info"},n.fields.canopySize.error||"Size of canopy in container"),a.createElement(ar,{timestamp:n.fields.repackExpiresAt.value||(new Date).getTime()/1e3,onChange:function(e){return t(lr.setField(["repackExpiresAt",e]))},label:"Reserve repack expiry date"}))}var or,sr,ur=Ue.a.create({fields:{flex:1},field:{marginBottom:8}});function cr(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function dr(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?cr(Object(t),!0).forEach((function(n){p()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):cr(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var mr,fr=Object(g.gql)(or||(or=tn()(["\n  mutation CreateRig(\n    $make: String,\n    $model: String,\n    $serial: String,\n    $canopySize: Int,\n    $repackExpiresAt: Int\n    $userId: Int\n    $dropzoneId: Int\n  ) {\n    createRig(\n      input: {\n        attributes: {\n          make: $make\n          model: $model\n          serial: $serial\n          repackExpiresAt: $repackExpiresAt\n          dropzoneId: $dropzoneId\n          userId: $userId\n          canopySize: $canopySize\n        }\n      }\n    ) {\n      errors\n      fieldErrors {\n        field\n        message\n      }\n      rig {\n        id\n        make\n        model\n        serial\n        canopySize\n        repackExpiresAt\n        packValue\n        maintainedAt\n\n        user {\n          id\n          rigs {\n            id\n            make\n            model\n            serial\n            canopySize\n            repackExpiresAt\n            packValue\n            maintainedAt\n          }\n        }\n      }\n    }\n  }\n"]))),pr=Object(g.gql)(sr||(sr=tn()(["\n  mutation UpdateRig(\n    $id: Int!\n    $make: String,\n    $model: String,\n    $serial: String,\n    $canopySize: Int,\n    $repackExpiresAt: Int\n    $userId: Int\n    $dropzoneId: Int\n  ) {\n    updateRig(\n      input: {\n        id: $id,\n        attributes: {\n          make: $make\n          model: $model\n          serial: $serial\n          repackExpiresAt: $repackExpiresAt\n          dropzoneId: $dropzoneId\n          userId: $userId\n          canopySize: $canopySize\n        }\n      }\n    ) {\n      errors\n      fieldErrors {\n        field\n        message\n      }\n      rig {\n        id\n        make\n        model\n        serial\n        canopySize\n        repackExpiresAt\n        packValue\n        maintainedAt\n\n        user {\n          id\n          rigs {\n            id\n            make\n            model\n            serial\n            canopySize\n            repackExpiresAt\n            packValue\n            maintainedAt\n          }\n        }\n      }\n    }\n  }\n"])));function gr(e){var n,t=ze(),r=Oe((function(e){return e.rigForm})),i=Oe((function(e){return e.global})),o=Object(g.useMutation)(fr),s=R()(o,2),u=s[0],c=s[1],d=Object(g.useMutation)(pr),m=R()(d,2),f=m[0],p=m[1],v=Object(a.useCallback)((function(){var e=!1;return r.fields.make.value||(e=!0,t(ye.setFieldError(["make","Required"]))),r.fields.model.value||(e=!0,t(ye.setFieldError(["model","Required"]))),r.fields.serial.value||(e=!0,t(ye.setFieldError(["serial","Required"]))),r.fields.canopySize.value||(e=!0,t(ye.setFieldError(["canopySize","Required"]))),r.fields.repackExpiresAt.value||(e=!0,t(ye.setFieldError(["repackExpiresAt","Required"]))),!e}),[JSON.stringify(r.fields)]),b=Object(a.useCallback)((function(){var n,a,l,i,o,s,c,d,m,p,g,b;return Fe.a.async((function(h){for(;;)switch(h.prev=h.next){case 0:if(v()){h.next=2;break}return h.abrupt("return");case 2:return h.prev=2,p=null!=(n=r.original)&&n.id?f:u,h.next=6,Fe.a.awrap(p({variables:dr(dr({},null!=(a=r.original)&&a.id?{id:null==(l=r.original)?void 0:l.id}:{}),{},{make:r.fields.make.value,model:r.fields.model.value,serial:r.fields.serial.value,canopySize:r.fields.canopySize.value,repackExpiresAt:r.fields.repackExpiresAt.value,userId:e.userId?Number(e.userId):null,dropzoneId:e.dropzoneId?Number(e.dropzoneId):null})}));case 6:if(g=h.sent,null==(b=null!=(i=r.original)&&i.id?null==(o=g.data)?void 0:o.updateRig:null==(s=g.data)?void 0:s.createRig)||null==(c=b.fieldErrors)||c.map((function(e){var n=e.field,r=e.message;switch(n){case"make":return t(ye.setFieldError(["make",r]));case"model":return t(ye.setFieldError(["model",r]));case"serial":return t(ye.setFieldError(["serial",r]));case"canopySize":return t(ye.setFieldError(["canopySize",r]));case"repack_expires_at":return t(ye.setFieldError(["repackExpiresAt",r]))}})),null==b||null==(d=b.errors)||!d.length){h.next=11;break}return h.abrupt("return",t(ge.showSnackbar({message:null==b?void 0:b.errors[0],variant:"error"})));case 11:null!=b&&null!=(m=b.fieldErrors)&&m.length||e.onSuccess(),h.next=17;break;case 14:h.prev=14,h.t0=h.catch(2),t(ge.showSnackbar({message:h.t0.message,variant:"error"}));case 17:case"end":return h.stop()}}),null,null,[[2,14]],Promise)}),[JSON.stringify(r.fields),u,e.onSuccess]);return l.a.createElement(dn.a,null,l.a.createElement(mn.a,{visible:!!e.open},l.a.createElement(un.a,{indeterminate:!0,visible:c.loading||p.loading,color:i.theme.colors.accent}),l.a.createElement(mn.a.Title,null,(null!=r&&null!=(n=r.original)&&n.id?"Edit":"New")+" rig"),l.a.createElement(mn.a.Content,null,l.a.createElement(ir,null)),l.a.createElement(mn.a.Actions,{style:{justifyContent:"flex-end"}},l.a.createElement(fn.a,{onPress:function(){t(ye.reset()),e.onClose()}},"Cancel"),l.a.createElement(fn.a,{onPress:b},"Save"))))}var vr=Object(ln.a)(mr||(mr=tn()(["\n  query RolesQuery($dropzoneId: Int!) {\n    dropzone(id: $dropzoneId) {\n      id\n      roles {\n        id\n        name\n      }\n    }\n  }\n"])));function br(e){var n,t,r,i,o=Object(a.useState)(!1),s=R()(o,2),u=s[0],c=s[1],d=Oe((function(e){return e.global})),m=Object(g.useQuery)(vr,{variables:{dropzoneId:Number(null==(n=d.currentDropzone)?void 0:n.id)}}),f=m.data;m.loading,m.refetch;return l.a.createElement(l.a.Fragment,null,l.a.createElement(vn.a.Subheader,{style:{paddingLeft:0}},"Access level"),l.a.createElement(En.a,{onDismiss:function(){return c(!1)},visible:!e.disabled&&u,anchor:l.a.createElement(vn.a.Item,{left:function(){return l.a.createElement(vn.a.Icon,{icon:"lock"})},onPress:e.disabled?void 0:function(){c(!0)},title:(null==(t=e.value)?void 0:t.name)||"Access level",description:e.required?null:"Optional"})},null==f||null==(r=f.dropzone)||null==(i=r.roles)?void 0:i.map((function(n){return l.a.createElement(vn.a.Item,{onPress:function(){c(!1),e.onSelect(n)},title:n.name||"-"})}))))}var hr=ie.actions;function yr(){var e,n,t=Oe((function(e){return e})),r=t.dropzoneUserForm,l=(t.global,ze()),i=Cn("updatePermission");return a.createElement(a.Fragment,null,a.createElement(br,{value:r.fields.role.value,onSelect:function(e){return l(hr.setField(["role",e]))},disabled:!i,required:!0}),a.createElement(gn.a,{type:r.fields.role.error?"error":"info"},r.fields.role.error),a.createElement(vn.a.Subheader,{style:{paddingLeft:0}},"Financial"),a.createElement(ar,{timestamp:r.fields.expiresAt.value||(new Date).getTime()/1e3,onChange:function(e){return l(hr.setField(["expiresAt",e]))},label:"Membership expires"}),a.createElement(gn.a,{type:r.fields.expiresAt.error?"error":"info"},r.fields.expiresAt.error),a.createElement(yn.a,{style:Sr.field,mode:"outlined",label:"Credits",error:!!r.fields.credits.error,value:(null==(e=r.fields.credits.value)?void 0:e.toString())||"",keyboardType:"number-pad",onChangeText:function(e){return l(hr.setField(["credits",Number(e)]))}}),a.createElement(gn.a,{type:r.fields.credits.error?"error":"info"},r.fields.credits.error||"Current balance: $"+((null==(n=r.original)?void 0:n.credits)||0)))}var Er,Sr=Ue.a.create({fields:{flex:1},field:{marginBottom:8}});function xr(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function Ir(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?xr(Object(t),!0).forEach((function(n){p()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):xr(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var kr,zr=Object(g.gql)(Er||(Er=tn()(["\n  mutation UpdateDropzoneUser(\n    $credits: Float,\n    $userRoleId: Int,\n    $expiresAt: Int,\n    $dropzoneUserId: Int\n  ) {\n    updateDropzoneUser(\n      input: {\n        id: $dropzoneUserId,\n        attributes: {\n          credits: $credits,\n          userRoleId: $userRoleId,\n          expiresAt: $expiresAt,\n        }\n      }\n    ) {\n      errors\n      fieldErrors {\n        field\n        message\n      }\n      dropzoneUser {\n        id\n        credits\n        expiresAt\n        role {\n          id\n          name\n        }\n\n        user {\n          id\n          name\n        }\n      }\n    }\n  }\n"])));function Or(e){var n,t=ze(),r=Oe((function(e){return e.dropzoneUserForm})),i=Oe((function(e){return e.global})),o=Object(g.useMutation)(zr),s=R()(o,2),u=s[0],c=s[1],d=Object(a.useCallback)((function(){var e=!1;return r.fields.credits.value||(e=!0,t(he.setFieldError(["credits","Required"]))),r.fields.role.value||(e=!0,t(he.setFieldError(["role","User must have an access level"]))),r.fields.expiresAt.value||(e=!0,t(he.setFieldError(["expiresAt","Membership expiry must be set"]))),!e}),[JSON.stringify(r.fields)]),m=Object(a.useCallback)((function(){var n,a,l,i,o,s,c,m,f,p,g,v;return Fe.a.async((function(b){for(;;)switch(b.prev=b.next){case 0:if(d()){b.next=2;break}return b.abrupt("return");case 2:return b.prev=2,b.next=5,Fe.a.awrap(u({variables:Ir(Ir({},null!=(n=r.original)&&n.id?{id:null==(a=r.original)?void 0:a.id}:{}),{},{credits:r.fields.credits.value,userRoleId:Number(null==(l=r.fields.role.value)?void 0:l.id),expiresAt:r.fields.expiresAt.value,dropzoneUserId:Number(null==(i=r.original)?void 0:i.id)})}));case 5:if(g=b.sent,null==(v=null!=(o=r.original)&&o.id?null==(s=g.data)?void 0:s.updateRig:null==(c=g.data)?void 0:c.createRig)||null==(m=v.fieldErrors)||m.map((function(e){var n=e.field,r=e.message;switch(n){case"user_role":return t(he.setFieldError(["role",r]));case"credits":return t(he.setFieldError(["credits",r]));case"expires_at":return t(he.setFieldError(["expiresAt",r]))}})),null==v||null==(f=v.errors)||!f.length){b.next=10;break}return b.abrupt("return",t(ge.showSnackbar({message:null==v?void 0:v.errors[0],variant:"error"})));case 10:null!=v&&null!=(p=v.fieldErrors)&&p.length||e.onSuccess(),b.next=16;break;case 13:b.prev=13,b.t0=b.catch(2),t(ge.showSnackbar({message:b.t0.message,variant:"error"}));case 16:case"end":return b.stop()}}),null,null,[[2,13]],Promise)}),[JSON.stringify(r.fields),u,e.onSuccess]);return l.a.createElement(dn.a,null,l.a.createElement(mn.a,{visible:!!e.open},l.a.createElement(un.a,{indeterminate:!0,visible:c.loading,color:i.theme.colors.accent}),l.a.createElement(mn.a.Title,null,(null!=r&&null!=(n=r.original)&&n.id?"Edit":"New")+" dropzone user"),l.a.createElement(mn.a.Content,null,l.a.createElement(yr,null)),l.a.createElement(mn.a.Actions,{style:{justifyContent:"flex-end"}},l.a.createElement(fn.a,{onPress:function(){t(he.reset()),e.onClose()}},"Cancel"),l.a.createElement(fn.a,{onPress:m},"Save"))))}var wr=Object(ln.a)(kr||(kr=tn()(["\n  query QueryDropzoneUser($dropzoneId: Int!, $dropzoneUserId: Int!) {\n    dropzone(id: $dropzoneId) {\n      id\n      name\n\n      dropzoneUser(id: $dropzoneUserId) {\n        id\n        credits\n        expiresAt\n        role {\n          id\n          name\n        }\n        user {\n          id\n          name\n          exitWeight\n          email\n          phone\n          rigs {\n            id\n            model\n            make\n            serial\n            canopySize\n            repackExpiresAt\n          }\n          jumpTypes {\n            id\n            name\n          }\n          license {\n            id\n            name\n          }\n        }\n      }\n    }\n  }\n"])));function Cr(){var e,n,t,r,l,i,o,s,u,c,d,m,f,p,v,b,h,y,E,S,x,I,k,z,O,w,C,j,T,P,F,$,N,D,M,A,U,q,B=Oe((function(e){return e.global})),W=ze(),L=Object(rn.useNavigation)(),H=a.useState(!1),V=R()(H,2),Q=V[0],J=V[1],_=a.useState(!1),G=R()(_,2),Y=G[0],Z=G[1],K=Object(rn.useRoute)(),X=(null==(e=B.currentUser)?void 0:e.id)===K.params.userId,ee=Cn("actAsRigInspector"),ne=Object(g.useQuery)(wr,{variables:{dropzoneId:Number(null==(n=B.currentDropzone)?void 0:n.id),dropzoneUserId:Number(K.params.userId)}}),te=ne.data,re=ne.loading,ae=a.useCallback((function(e){return function(){X?ee&&L.navigate("RigInspectionScreen",{dropzoneUserId:Number(K.params.userId),rig:e}):(W(ye.setOriginal(e)),J(!0))}}),[W,J]);return a.createElement(a.Fragment,null,a.createElement(un.a,{color:B.theme.colors.accent,indeterminate:!0,visible:re}),a.createElement(Rt,{contentContainerStyle:jr.content},a.createElement(Kn.a,{elevation:3,style:jr.card},a.createElement(Kn.a.Title,{title:"Basic information"}),a.createElement(Kn.a.Content,null,a.createElement(vn.a.Item,{title:"Name",left:function(){return a.createElement(vn.a.Icon,{icon:"account-outline"})},description:(null==te||null==(t=te.dropzone)||null==(r=t.dropzoneUser)||null==(l=r.user)?void 0:l.name)||"-"}),a.createElement(vn.a.Item,{title:"Email",left:function(){return a.createElement(vn.a.Icon,{icon:"at"})},description:(null==te||null==(i=te.dropzone)||null==(o=i.dropzoneUser)||null==(s=o.user)?void 0:s.email)||"-"}),a.createElement(vn.a.Item,{title:"Phone",left:function(){return a.createElement(vn.a.Icon,{icon:"phone"})},description:(null==te||null==(u=te.dropzone)||null==(c=u.dropzoneUser)||null==(d=c.user)?void 0:d.phone)||"-"}),a.createElement(vn.a.Item,{title:"License",left:function(){return a.createElement(vn.a.Icon,{icon:"ticket-account"})},description:(null==te||null==(m=te.dropzone)||null==(f=m.dropzoneUser)||null==(p=f.user)||null==(v=p.license)?void 0:v.name)||"-"}),a.createElement(vn.a.Item,{title:"Exit weight",left:function(){return a.createElement(vn.a.Icon,{icon:"scale"})},description:(null==te||null==(b=te.dropzone)||null==(h=b.dropzoneUser)||null==(y=h.user)?void 0:y.exitWeight)||"-"})),X&&a.createElement(Kn.a.Actions,{style:{justifyContent:"flex-end"}},a.createElement(fn.a,{icon:"pencil",onPress:function(){var e,n;return L.navigate("UpdateUserScreen",{user:null==(e=B.currentDropzone)||null==(n=e.currentUser)?void 0:n.user})}},"Edit"))),a.createElement(Kn.a,{elevation:3,style:jr.card},a.createElement(Kn.a.Title,{title:null==(E=B.currentDropzone)?void 0:E.name}),a.createElement(Kn.a.Content,null,a.createElement(vn.a.Item,{title:"Role",description:null==te||null==(S=te.dropzone)||null==(x=S.dropzoneUser)||null==(I=x.role)?void 0:I.name,left:function(){return a.createElement(vn.a.Icon,{icon:"lock"})}}),a.createElement(vn.a.Item,{title:"Credits",description:null==te||null==(k=te.dropzone)||null==(z=k.dropzoneUser)?void 0:z.credits,left:function(){return a.createElement(vn.a.Icon,{icon:"cash-multiple"})}}),a.createElement(vn.a.Item,{title:"Membership",description:null!=te&&null!=(O=te.dropzone)&&null!=(w=O.dropzoneUser)&&w.expiresAt?Object(nr.a)(1e3*((null==te||null==(C=te.dropzone)||null==(j=C.dropzoneUser)?void 0:j.expiresAt)||0),"yyyy/MM/dd"):a.createElement("span",null,"Not a member"),left:function(){var e,n,t,r;return a.createElement(vn.a.Icon,{icon:"card-account-details",color:null!=te&&null!=(e=te.dropzone)&&null!=(n=e.dropzoneUser)&&n.expiresAt&&1e3*(null==te||null==(t=te.dropzone)||null==(r=t.dropzoneUser)?void 0:r.expiresAt)>(new Date).getTime()?void 0:"#B00020"})}})),a.createElement(Kn.a.Actions,{style:{justifyContent:"flex-end"}},a.createElement(fn.a,{icon:"pencil",onPress:function(){var e;W(he.setOriginal(null==te||null==(e=te.dropzone)?void 0:e.dropzoneUser)),Z(!0)}},"Edit"))),a.createElement(Kn.a,{elevation:3,style:jr.card},a.createElement(Kn.a.Title,{title:"Rigs"}),a.createElement(Kn.a.Content,null,a.createElement(Xn.a,null,a.createElement(Xn.a.Header,null,a.createElement(Xn.a.Title,null,"Container"),a.createElement(Xn.a.Title,{numeric:!0},"Repack due"),a.createElement(Xn.a.Title,{numeric:!0},"Canopy size")),null==te||null==(T=te.dropzone)||null==(P=T.dropzoneUser)||null==(F=P.user)||null==($=F.rigs)?void 0:$.map((function(e){return a.createElement(Xn.a.Row,{onPress:ae(e),pointerEvents:"none"},a.createElement(Xn.a.Cell,null,[null==e?void 0:e.make,null==e?void 0:e.model,"#"+(null==e?void 0:e.serial)].join(" ")),a.createElement(Xn.a.Cell,{numeric:!0},null!=e&&e.repackExpiresAt?Object(nr.a)(1e3*e.repackExpiresAt,"yyyy/MM/dd"):"-"),a.createElement(Xn.a.Cell,{numeric:!0},""+(null==e?void 0:e.canopySize)))})))),X&&a.createElement(Kn.a.Actions,{style:{justifyContent:"flex-end"}},a.createElement(fn.a,{onPress:function(){return J(!0)}},"Add rig"))),(null==te||null==(N=te.dropzone)||null==(D=N.dropzoneUser)?void 0:D.id)===(null==(M=B.currentUser)?void 0:M.id)&&a.createElement(fn.a,{color:"#B00020",onPress:function(){return W(fe.logout())}},"Log out")),a.createElement(gr,{onClose:function(){return J(!1)},onSuccess:function(){return J(!1)},userId:Number(null==te||null==(A=te.dropzone)||null==(U=A.dropzoneUser)||null==(q=U.user)?void 0:q.id),open:Q}),a.createElement(Or,{onClose:function(){return Z(!1)},onSuccess:function(){return Z(!1)},open:Y}))}var jr=Ue.a.create({container:{flex:1},content:{alignItems:"center",flexGrow:1,paddingBottom:56},card:{margin:8,width:"100%"},fields:{width:"80%",display:"flex"},spacer:{width:"100%",height:32},title:{fontSize:20,fontWeight:"bold"},fab:{position:"absolute",margin:16,right:0,bottom:0},separator:{marginVertical:30,height:1,width:"80%"}});function Tr(){return a.createElement(Vn,{style:$r.container},a.createElement(Hn,{style:$r.title},"Tab One"),a.createElement(Vn,{style:$r.separator,lightColor:"#eee",darkColor:"rgba(255,255,255,0.1)"}),a.createElement(It,{path:"/screens/RigScreen.tsx"}))}var Pr,Fr,$r=Ue.a.create({container:{flex:1,alignItems:"center",justifyContent:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"}}),Nr=Object(ln.a)(Pr||(Pr=tn()(["\n  query Licenses($federationId: Int) {\n    licenses(federationId: $federationId) {\n      id\n      name\n\n      federation {\n        id\n        name\n      }\n\n    }\n  }\n"])));function Dr(e){var n,t,r=Object(a.useState)(!1),i=R()(r,2),o=i[0],s=i[1],u=(Oe((function(e){return e.global})),Object(g.useQuery)(Nr,{variables:{federationId:e.federationId}})),c=u.data;u.loading,u.refetch;return l.a.createElement(l.a.Fragment,null,l.a.createElement(vn.a.Subheader,null,"License"),l.a.createElement(En.a,{onDismiss:function(){return s(!1)},visible:o,anchor:l.a.createElement(vn.a.Item,{onPress:function(){s(!0)},title:(null==(n=e.value)?void 0:n.name)||"Please select a license",description:e.required?null:"Optional"})},null==c||null==(t=c.licenses)?void 0:t.map((function(n){return l.a.createElement(vn.a.Item,{onPress:function(){s(!1),e.onSelect(n)},title:n.name||"-"})}))))}var Mr=Object(ln.a)(Fr||(Fr=tn()(["\n  query Federations {\n    federations {\n      id\n      name\n    }\n  }\n"])));function Ar(e){var n,t,r=Object(a.useState)(!1),i=R()(r,2),o=i[0],s=i[1],u=Object(g.useQuery)(Mr).data;return Object(a.useEffect)((function(){var n;1!==(null==u||null==(n=u.federations)?void 0:n.length)||e.value||e.onSelect(u.federations[0])}),[JSON.stringify(null==u?void 0:u.federations)]),l.a.createElement(l.a.Fragment,null,l.a.createElement(vn.a.Subheader,null,"Federation"),l.a.createElement(En.a,{onDismiss:function(){return s(!1)},visible:o,anchor:l.a.createElement(vn.a.Item,{onPress:function(){s(!0)},title:(null==(n=e.value)?void 0:n.name)||"Please select federation",description:e.required?null:"Optional"})},null==u||null==(t=u.federations)?void 0:t.map((function(n){return l.a.createElement(vn.a.Item,{onPress:function(){s(!1),e.onSelect(n)},title:n.name||"-"})}))))}var Ur=ae.actions;function qr(){var e,n,t,r,l,i,o,s,u,c,d,m,f,p,g,v,b,h,y,E,S,x,I,k,z,O,w,C=Oe((function(e){return e.userForm})),j=ze(),T=Oe((function(e){return e.global}));a.useEffect((function(){var e;C.original&&(C.fields.exitWeight.value||j(Ur.setField(["exitWeight",C.original.exitWeight||"60"])),!C.fields.rigs.value&&null!=(e=C.original)&&e.id&&j(Ur.setField(["rigs",C.original.rigs])))}),[null==(e=C.original)?void 0:e.id]);null==C||null==(n=C.original)||n.id,null==C||null==(t=C.original)||t.id,null==(r=T.currentUser)||r.id;return a.createElement(a.Fragment,null,a.createElement(yn.a,{style:Br.field,mode:"outlined",label:"Name",error:!!C.fields.name.error,value:(null==(l=C.fields.name)||null==(i=l.value)?void 0:i.toString())||"",onChangeText:function(e){return j(Ur.setField(["name",e]))}}),a.createElement(gn.a,{type:C.fields.name.error?"error":"info"},C.fields.name.error||" "),a.createElement(yn.a,{style:Br.field,mode:"outlined",label:"Email",error:!!C.fields.email.error,value:(null==(o=C.fields.email)||null==(s=o.value)?void 0:s.toString())||"",onChangeText:function(e){return j(Ur.setField(["email",e]))}}),a.createElement(gn.a,{type:C.fields.email.error?"error":"info"},C.fields.email.error||" "),a.createElement(yn.a,{style:Br.field,mode:"outlined",label:"Phone",error:!!C.fields.phone.error,value:(null==(u=C.fields.phone)||null==(c=u.value)?void 0:c.toString())||"",onChangeText:function(e){return j(Ur.setField(["phone",e]))}}),a.createElement(gn.a,{type:C.fields.phone.error?"error":"info"},C.fields.phone.error||""),a.createElement(yn.a,{style:Br.field,mode:"outlined",label:"Exit weight",error:!!C.fields.exitWeight.error,value:(null==(d=C.fields.exitWeight)||null==(m=d.value)?void 0:m.toString())||"",keyboardType:"numbers-and-punctuation",right:function(){return a.createElement(yn.a.Affix,{text:"kg"})},onChangeText:function(e){return j(Ur.setField(["exitWeight",e]))}}),a.createElement(gn.a,{type:C.fields.exitWeight.error?"error":"info"},C.fields.exitWeight.error||""),a.createElement(hn.a,null),a.createElement(Ar,{value:(null==C||null==(f=C.fields)||null==(p=f.license)||null==(g=p.value)?void 0:g.federation)||C.federation.value,onSelect:function(e){return j(Ur.setFederation(e))},required:!0}),a.createElement(gn.a,{type:C.federation.error?"error":"info"},C.federation.error||""),((null==C||null==(v=C.fields)||null==(b=v.license)||null==(h=b.value)||null==(y=h.federation)?void 0:y.id)||(null==C||null==(E=C.federation)||null==(S=E.value)?void 0:S.id))&&a.createElement(a.Fragment,null,a.createElement(Dr,{value:C.fields.license.value,federationId:Number((null==C||null==(x=C.fields)||null==(I=x.license)||null==(k=I.value)||null==(z=k.federation)?void 0:z.id)||(null==(O=C.federation)||null==(w=O.value)?void 0:w.id)),onSelect:function(e){return j(Ur.setField(["license",e]))},required:!0}),a.createElement(gn.a,{type:C.fields.license.error?"error":"info"},C.fields.license.error||"")))}var Rr,Br=Ue.a.create({fields:{flex:1,width:"100%",paddingTop:32},field:{marginBottom:8,width:"100%"},ticketAddons:{marginBottom:8}}),Wr=ae.actions,Lr=(N.actions,Object(g.gql)(Rr||(Rr=tn()(["\n  mutation UpdateUser(\n    $id: Int,\n    $name: String,\n    $phone: String,\n    $email: String,\n    $licenseId: Int,\n    $exitWeight: Float,\n  ){\n    updateUser(input: {\n      id: $id\n      attributes: {\n        name: $name,\n        phone: $phone,\n        email: $email,\n        licenseId: $licenseId,\n        exitWeight: $exitWeight,\n      }\n    }) {\n      user {\n        id\n        name\n        exitWeight\n        email\n        phone\n        rigs {\n          id\n          model\n          make\n          serial\n          canopySize\n        }\n        jumpTypes {\n          id\n          name\n        }\n        license {\n          id\n          name\n\n          federation {\n            id\n            name\n          }\n        }\n      }\n    }\n  }\n"]))));function Hr(){var e=Oe((function(e){return e})),n=e.userForm,t=(e.global,ze()),r=Object(rn.useNavigation)(),l=Object(rn.useRoute)().params.user;a.useEffect((function(){t(Wr.setOriginal(l))}),[null==l?void 0:l.id]);var i=Object(g.useMutation)(Lr),o=R()(i,2),s=o[0],u=o[1],c=a.useCallback((function(){var e,r,a,l,i,o,s,u,c,d=!1,m=new RegExp(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/);return((null==(e=n.fields.name)||null==(r=e.value)?void 0:r.length)||0)<3&&(d=!0,t(Wr.setFieldError(["name","Name is too short"]))),((null==(a=n.fields.email)||null==(l=a.value)?void 0:l.length)||0)<3&&(d=!0,t(Wr.setFieldError(["email","Email is too short"]))),((null==(i=n.fields.phone)||null==(o=i.value)?void 0:o.length)||0)<3&&(d=!0,t(Wr.setFieldError(["phone","Phone number is too short"]))),m.test((null==(s=n.fields)||null==(u=s.email)?void 0:u.value)||"")||(d=!0,t(Wr.setFieldError(["email","Please enter a valid email"]))),((null==(c=n.fields.exitWeight)?void 0:c.value)||0)<30&&(d=!0,t(Wr.setFieldError(["exitWeight","Exit weight seems too low?"]))),!d}),[JSON.stringify(n.fields),t]),d=a.useCallback((function(){var e,a,l,i,o,u,d,m,f,p,g,v,b;return Fe.a.async((function(h){for(;;)switch(h.prev=h.next){case 0:if(e=n.fields,a=e.name,l=e.license,i=e.phone,o=e.email,u=e.exitWeight,!c()){h.next=12;break}return h.prev=2,h.next=5,Fe.a.awrap(s({variables:{id:Number(n.original.id),name:a.value,licenseId:null!=(d=l.value)&&d.id?Number(l.value.id):null,phone:i.value,exitWeight:parseFloat(u.value),email:o.value}}));case 5:p=h.sent,null!=(m=p.data)&&null!=(f=m.updateUser)&&f.user&&(g=p.data.updateUser,v=g.fieldErrors,b=g.errors,v?null==v||v.map((function(e){var n=e.field,r=e.message;switch(n){case"name":return t(be.setFieldError(["name",r]));case"exit_weight":return t(be.setFieldError(["exitWeight",r]));case"license_id":return t(be.setFieldError(["license",r]));case"phone":return t(be.setFieldError(["phone",r]));case"email":return t(be.setFieldError(["email",r]))}})):null!=b&&b.length?b.map((function(e){return t(Tt.showSnackbar({message:e,variant:"error"}))})):(t(Tt.showSnackbar({message:"Profile has been updated",variant:"success"})),r.goBack(),t(be.reset()))),h.next=12;break;case 9:h.prev=9,h.t0=h.catch(2),t(Tt.showSnackbar({message:h.t0.message,variant:"error"}));case 12:case"end":return h.stop()}}),null,null,[[2,9]],Promise)}),[JSON.stringify(n.fields),t,s]);return a.createElement(Rt,{contentContainerStyle:{paddingHorizontal:48}},a.createElement(qr,null),a.createElement(Vn,{style:Vr.fields},a.createElement(fn.a,{mode:"contained",disabled:u.loading,onPress:d,loading:u.loading},"Save")))}var Vr=Ue.a.create({container:{flex:1,alignItems:"center",paddingTop:56},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fields:{width:"100%",marginBottom:16},field:{marginBottom:8}}),Qr=Object(Ve.a)();function Jr(){var e,n=Oe((function(e){return e.global})).currentDropzone;return a.createElement(Qr.Navigator,{screenOptions:{headerShown:!0,header:function(e){return a.createElement(Kt,e)},cardStyle:{flex:1}}},a.createElement(Qr.Screen,{name:"ProfileScreen",component:Cr,options:{title:"Profile"},initialParams:{userId:null==n||null==(e=n.currentUser)?void 0:e.id}}),a.createElement(Qr.Screen,{name:"UpdateUserScreen",component:Hr,options:{title:"Edit profile"}}),a.createElement(Qr.Screen,{name:"RigScreen",component:Tr,options:{title:"Rig"}}))}function _r(){var e=Object(rn.useNavigation)(),n=Oe((function(e){return e.global}));return a.createElement(Vn,{style:Gr.container},a.createElement(vn.a.Section,{title:"Dropzone"},a.createElement(vn.a.Item,{title:"Configuration",onPress:function(){return e.navigate("UpdateDropzoneScreen",{dropzone:n.currentDropzone})},left:function(){return a.createElement(vn.a.Icon,{color:"#000",icon:"information-outline"})}}),a.createElement(vn.a.Item,{title:"Planes",onPress:function(){return e.navigate("PlanesScreen")},left:function(){return a.createElement(vn.a.Icon,{color:"#000",icon:"airplane"})}}),a.createElement(vn.a.Item,{title:"Rigs",left:function(){return a.createElement(vn.a.Icon,{color:"#000",icon:"parachute"})},description:"Coming soon"})),a.createElement(vn.a.Section,{title:"Tickets"},a.createElement(vn.a.Item,{title:"Ticket types",onPress:function(){return e.navigate("TicketTypesScreen")},left:function(){return a.createElement(vn.a.Icon,{color:"#000",icon:"ticket"})}}),a.createElement(vn.a.Item,{title:"Ticket add-ons",onPress:function(){return e.navigate("ExtrasScreen")},left:function(){return a.createElement(vn.a.Icon,{color:"#000",icon:"plus"})}})))}var Gr=Ue.a.create({container:{flex:1,padding:8,display:"flex"},fab:{position:"absolute",margin:16,right:0,bottom:0},empty:{flex:1,alignItems:"center",justifyContent:"center",width:"100%",height:"100%"}});function Yr(){return a.createElement(Vn,{style:Xr.container},a.createElement(Hn,{style:Xr.title},"Tab One"),a.createElement(Vn,{style:Xr.separator,lightColor:"#eee",darkColor:"rgba(255,255,255,0.1)"}),a.createElement(It,{path:"/screens/DropzoneSettingsScreen.tsx"}))}var Zr,Kr,Xr=Ue.a.create({container:{flex:1,alignItems:"center",justifyContent:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"}}),ea=t(114),na=t(297),ta=Object(ln.a)(Zr||(Zr=tn()(["\n  query QueryTicketType(\n    $dropzoneId: Int!\n  ) {\n    ticketTypes(dropzoneId: $dropzoneId) {\n      id\n      cost\n      currency\n      name\n      altitude\n      allowManifestingSelf\n\n      extras {\n        id\n        name\n      }\n    }\n  }\n"]))),ra=Object(ln.a)(Kr||(Kr=tn()(["\n  mutation UpdateTicketTypePublic(\n    $id: Int!,\n    $allowManifestingSelf: Boolean\n  ){\n    updateTicketType(input: {\n      id: $id\n      attributes: {\n        allowManifestingSelf: $allowManifestingSelf\n      }\n    }) {\n      ticketType {\n        id\n        name\n        altitude\n        cost\n        allowManifestingSelf\n        extras {\n          id\n          name\n          cost\n        }\n      }\n    }\n  }\n"])));function aa(){var e,n,t=Oe((function(e){return e.global})),r=Object(g.useQuery)(ta,{variables:{dropzoneId:Number(null==(e=t.currentDropzone)?void 0:e.id)}}),l=r.data,i=r.loading,o=r.refetch,s=Object(rn.useNavigation)(),u=Object(rn.useRoute)(),c=Object(rn.useIsFocused)();a.useEffect((function(){c&&o()}),[c]);var d=Object(g.useMutation)(ra),m=R()(d,2),f=m[0];m[1];return a.useEffect((function(){"TicketTypesScreen"===u.name&&o()}),[u.name]),a.createElement(Rt,{style:la.container,contentContainerStyle:[la.content,{backgroundColor:"white"}],refreshControl:a.createElement(ea.a,{refreshing:i,onRefresh:o})},a.createElement(un.a,{visible:i,color:t.theme.colors.accent}),a.createElement(Xn.a,null,a.createElement(Xn.a.Header,null,a.createElement(Xn.a.Title,null,"Name"),a.createElement(Xn.a.Title,{numeric:!0},"Cost"),a.createElement(Xn.a.Title,{numeric:!0},"Altitude"),a.createElement(Xn.a.Title,{numeric:!0},"Public")),null==l||null==(n=l.ticketTypes)?void 0:n.map((function(e){return a.createElement(Xn.a.Row,{onPress:function(){return s.navigate("UpdateTicketTypeScreen",{ticketType:e})},pointerEvents:"none"},a.createElement(Xn.a.Cell,null,e.name),a.createElement(Xn.a.Cell,{numeric:!0},"$",e.cost),a.createElement(Xn.a.Cell,{numeric:!0},e.altitude),a.createElement(Xn.a.Cell,{numeric:!0},a.createElement(na.a,{onValueChange:function(){f({variables:{id:Number(e.id),allowManifestingSelf:!e.allowManifestingSelf}})},value:!!e.allowManifestingSelf})))}))),a.createElement(cn.a,{style:la.fab,small:!0,icon:"plus",onPress:function(){return s.navigate("CreateTicketTypeScreen")},label:"New ticket type"}))}var la=Ue.a.create({container:{flex:1,display:"flex"},content:{flexGrow:1},fab:{position:"absolute",margin:16,right:0,bottom:0},empty:{flex:1,alignItems:"center",justifyContent:"center",width:"100%",height:"100%"}}),ia=_.actions;function oa(){var e,n,t,r,l=Oe((function(e){return e.planeForm})),i=ze();return a.createElement(a.Fragment,null,a.createElement(yn.a,{style:ua.field,mode:"outlined",label:"Name",error:!!l.fields.name.error,value:l.fields.name.value,onChangeText:function(e){return i(ia.setField(["name",e]))}}),a.createElement(gn.a,{type:l.fields.name.error?"error":"info"},l.fields.name.error||""),a.createElement(yn.a,{style:ua.field,mode:"outlined",label:"Registration",error:!!l.fields.registration.error,value:l.fields.registration.value,onChangeText:function(e){return i(ia.setField(["registration",e]))}}),a.createElement(gn.a,{type:l.fields.registration.error?"error":"info"},l.fields.registration.error||""),a.createElement(yn.a,{style:ua.field,mode:"outlined",label:"hours",error:!!l.fields.hours.error,value:null==(e=l.fields.hours)||null==(n=e.value)?void 0:n.toString(),placeholder:"Optional",onChangeText:function(e){return i(ia.setField(["hours",Number(e)]))}}),a.createElement(gn.a,{type:l.fields.hours.error?"error":"info"},l.fields.hours.error||""),a.createElement(yn.a,{style:ua.field,mode:"outlined",label:"Min slots",error:!!l.fields.minSlots.error,value:null==(t=l.fields.minSlots.value)?void 0:t.toString(),keyboardType:"number-pad",onChangeText:function(e){return i(ia.setField(["minSlots",Number(e)]))}}),a.createElement(gn.a,{type:l.fields.minSlots.error?"error":"info"},l.fields.minSlots.error||"Minimum tickets required to send it"),a.createElement(yn.a,{style:ua.field,mode:"outlined",label:"Max slots",error:!!l.fields.maxSlots.error,value:null==(r=l.fields.maxSlots)?void 0:r.value.toString(),keyboardType:"number-pad",onChangeText:function(e){return i(ia.setField(["maxSlots",Number(e)]))}}),a.createElement(gn.a,{type:l.fields.maxSlots.error?"error":"info"},l.fields.maxSlots.error||"Maximum amount of jumpers who can be manifested on one load"))}var sa,ua=Ue.a.create({fields:{width:"100%",flex:1},field:{width:"100%",marginBottom:8}}),ca=_.actions,da=(N.actions,Object(g.gql)(sa||(sa=tn()(["\n  mutation CreatePlane(\n    $name: String!,\n    $registration: String!,\n    $dropzoneId: Int!\n    $minSlots: Int!\n    $maxSlots: Int!\n    $hours: Int\n    $nextMaintenanceHours: Int\n  ){\n    createPlane(input: {\n      attributes: {\n        name: $name,\n        registration: $registration,\n        dropzoneId: $dropzoneId\n        minSlots: $minSlots\n        maxSlots: $maxSlots\n        hours: $hours\n        nextMaintenanceHours: $nextMaintenanceHours\n      }\n    }) {\n      plane {\n        id\n        name\n        registration\n        minSlots\n        maxSlots\n        hours\n        nextMaintenanceHours\n\n        dropzone {\n          id\n          name\n          planes {\n            id\n            name\n            registration\n            minSlots\n            maxSlots\n            hours\n            nextMaintenanceHours\n          }\n        }\n      }\n    }\n  }\n"]))));function ma(){var e=Oe((function(e){return e})),n=e.planeForm,t=e.global,r=ze(),l=Object(rn.useNavigation)(),i=Object(g.useMutation)(da),o=R()(i,2),s=o[0],u=o[1],c=Object(rn.useIsFocused)();a.useEffect((function(){c&&r(ca.reset())}),[c]);var d=a.useCallback((function(){var e=!1;return n.fields.name.value.length<3&&(e=!0,r(ca.setFieldError(["name","Name is too short"]))),n.fields.registration.value.length<3&&(e=!0,r(ca.setFieldError(["registration","Registration is too short"]))),n.fields.maxSlots.value||(e=!0,r(ca.setFieldError(["maxSlots","Max slots must be specified"]))),!e}),[JSON.stringify(n.fields),r]),m=a.useCallback((function(){var e,a,i,o,u,c,m,f,p,g,v,b;return Fe.a.async((function(h){for(;;)switch(h.prev=h.next){case 0:if(e=n.fields,a=e.name,i=e.registration,o=e.maxSlots,u=e.minSlots,c=e.hours,m=e.nextMaintenanceHours,!d()){h.next=12;break}return h.prev=2,h.next=5,Fe.a.awrap(s({variables:{dropzoneId:Number(null==(f=t.currentDropzone)?void 0:f.id),name:a.value,registration:i.value,minSlots:u.value,maxSlots:o.value,hours:c.value,nextMaintenanceHours:m.value}}));case 5:v=h.sent,null!=(p=v.data)&&null!=(g=p.createPlane)&&g.plane&&(b=v.data.createPlane.plane,r(Tt.showSnackbar({message:"Added plane "+b.name,variant:"success"})),l.goBack()),h.next=12;break;case 9:h.prev=9,h.t0=h.catch(2),r(Tt.showSnackbar({message:h.t0.message,variant:"error"}));case 12:case"end":return h.stop()}}),null,null,[[2,9]],Promise)}),[JSON.stringify(n.fields),r,s]);return a.createElement(Rt,{contentContainerStyle:pa.content},a.createElement(en.a,{name:"airplane",size:100,color:"#999999",style:{alignSelf:"center"}}),a.createElement(oa,null),a.createElement(Vn,{style:pa.fields},a.createElement(fn.a,{mode:"contained",disabled:u.loading,onPress:m,loading:u.loading},"Save")))}var fa,pa=Ue.a.create({content:{paddingHorizontal:48},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fields:{width:"100%",marginBottom:16},field:{marginBottom:8}}),ga=_.actions,va=(N.actions,Object(g.gql)(fa||(fa=tn()(["\n  mutation UpdatePlane(\n    $id: Int!,\n    $name: String!,\n    $registration: String!,\n    $minSlots: Int!\n    $maxSlots: Int!\n    $hours: Int\n    $nextMaintenanceHours: Int\n  ){\n    updatePlane(input: {\n      id: $id\n      attributes: {\n        name: $name,\n        registration: $registration,\n        minSlots: $minSlots\n        maxSlots: $maxSlots\n        hours: $hours\n        nextMaintenanceHours: $nextMaintenanceHours\n      }\n    }) {\n      plane {\n        id\n        name\n        registration\n        minSlots\n        maxSlots\n        hours\n        nextMaintenanceHours\n\n        dropzone {\n          id\n          name\n          planes {\n            id\n            name\n            registration\n            minSlots\n            maxSlots\n            hours\n            nextMaintenanceHours\n          }\n        }\n      }\n    }\n  }\n"]))));function ba(){var e=Oe((function(e){return e})),n=e.planeForm,t=(e.global,ze()),r=Object(rn.useNavigation)(),l=Object(rn.useRoute)().params.plane;a.useEffect((function(){t(ga.setOriginal(l))}),[null==l?void 0:l.id]);var i=Object(g.useMutation)(va),o=R()(i,2),s=o[0],u=o[1],c=a.useCallback((function(){var e=!1;return n.fields.name.value.length<3&&(e=!0,t(ga.setFieldError(["name","Name is too short"]))),n.fields.registration.value.length<3&&(e=!0,t(ga.setFieldError(["registration","Registration is too short"]))),n.fields.maxSlots.value||(e=!0,t(ga.setFieldError(["maxSlots","Max slots must be specified"]))),!e}),[JSON.stringify(n.fields),t]),d=a.useCallback((function(){var e,a,l,i,o,u,d,m,f,p,g;return Fe.a.async((function(v){for(;;)switch(v.prev=v.next){case 0:if(e=n.fields,a=e.name,l=e.registration,i=e.maxSlots,o=e.minSlots,u=e.hours,d=e.nextMaintenanceHours,!c()){v.next=12;break}return v.prev=2,v.next=5,Fe.a.awrap(s({variables:{id:Number(n.original.id),name:a.value,registration:l.value,minSlots:o.value,maxSlots:i.value,hours:u.value,nextMaintenanceHours:d.value}}));case 5:p=v.sent,null!=(m=p.data)&&null!=(f=m.updatePlane)&&f.plane&&(g=p.data.updatePlane.plane,t(Tt.showSnackbar({message:"Saved plane "+g.name,variant:"success"})),r.goBack()),v.next=12;break;case 9:v.prev=9,v.t0=v.catch(2),t(Tt.showSnackbar({message:v.t0.message,variant:"error"}));case 12:case"end":return v.stop()}}),null,null,[[2,9]],Promise)}),[JSON.stringify(n.fields),t,s]);return a.createElement(Rt,{contentContainerStyle:ya.content},a.createElement(en.a,{name:"airplane",size:100,color:"#999999",style:{alignSelf:"center"}}),a.createElement(oa,null),a.createElement(Vn,{style:ya.actions},a.createElement(fn.a,{mode:"contained",disabled:u.loading,onPress:d,loading:u.loading},"Save")))}var ha,ya=Ue.a.create({content:{paddingHorizontal:48},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},actions:{width:"100%",marginBottom:16},field:{marginBottom:8}}),Ea=t(377),Sa=t(375),xa=t(367),Ia=t.n(xa),ka=Q.actions,za=Object(g.gql)(ha||(ha=tn()(["\n  query QueryFederations {\n    federations {\n      id\n      name\n    }\n  }\n"])));function Oa(){var e,n,t,r,i=Oe((function(e){return e})),o=i.dropzoneForm,s=i.global,u=ze(),c=Object(g.useQuery)(za),d=c.data,m=(c.loading,Object(a.useState)(!1)),f=R()(m,2),p=f[0],v=f[1],b=Object(a.useState)(null),h=R()(b,2),y=h[0],E=h[1];Object(a.useEffect)((function(){var e,n;null==d||null==(e=d.federations)||!e.length||null!=(n=o.fields.federation)&&n.value||u(ka.setField(["federation",d.federations[0]]))}),[JSON.stringify(null==d?void 0:d.federations)]);var S=Object(a.useCallback)((function(){var e;return Fe.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Fe.a.awrap(Object(Ea.a)({multiple:!1,type:"image"}));case 3:e=n.sent,u(ka.setField(["banner",e.uri])),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),console.log(n.t0);case 10:case"end":return n.stop()}}),null,null,[[0,7]],Promise)}),[u]);return l.a.createElement(l.a.Fragment,null,l.a.createElement(dn.a,null,l.a.createElement(mn.a,{visible:!!y,onDismiss:function(){return E(null)}},l.a.createElement(mn.a.Title,null,"Pick a ","primary"===y?"primary color":"secondary color"),l.a.createElement(mn.a.Content,{style:{padding:20,height:400}},l.a.createElement(Sa.a,{onColorSelected:function(e){u("primary"===y?ka.setField(["primaryColor",e]):ka.setField(["secondaryColor",e]))},style:{flex:1},sliderComponent:Ia.a,defaultColor:("primary"===y?o.fields.primaryColor.value:o.fields.secondaryColor.value)||void 0,hideSliders:!0})),l.a.createElement(mn.a.Actions,null,l.a.createElement(fn.a,{onPress:function(){return E(null)}},"Cancel"),l.a.createElement(fn.a,{disabled:"primary"===y&&!o.fields.primaryColor.value||"secondary"===y&&!o.fields.secondaryColor.value,onPress:function(){console.log({current:s.theme.colors.accent,next:o.fields.secondaryColor.value}),u("primary"===y?fe.setPrimaryColor(o.fields.primaryColor.value):fe.setAccentColor(o.fields.secondaryColor.value)),E(null)}},"Save")))),l.a.createElement(Kn.a,{style:{width:"100%",maxHeight:300,marginVertical:16}},l.a.createElement(Kn.a.Cover,{source:{uri:o.fields.banner.value||"https://picsum.photos/700"},resizeMode:"cover"}),l.a.createElement(Kn.a.Actions,{style:{justifyContent:"flex-end"}},l.a.createElement(fn.a,{onPress:S},"Upload"))),l.a.createElement(Kn.a,{style:{width:"100%",marginVertical:16,paddingHorizontal:16}},l.a.createElement(vn.a.Subheader,{style:ja.subheader},"Dropzone"),l.a.createElement(yn.a,{style:ja.field,mode:"outlined",label:"Name",error:!!o.fields.name.error,value:o.fields.name.value||"",onChangeText:function(e){return u(ka.setField(["name",e]))}}),l.a.createElement(gn.a,{type:"error"},o.fields.name.error||""),l.a.createElement(vn.a.Subheader,{style:ja.subheader},"Federation"),l.a.createElement(En.a,{onDismiss:function(){return v(!1)},visible:p,anchor:l.a.createElement(En.a.Item,{onPress:function(){return v(!0)},title:(null==(e=o.fields)||null==(n=e.federation)||null==(t=n.value)?void 0:t.name)||"",icon:"parachute"})},null==d||null==(r=d.federations)?void 0:r.map((function(e){return l.a.createElement(En.a.Item,{title:e.name,onPress:function(){u(ka.setField(["federation",e])),v(!1)}})}))),l.a.createElement(gn.a,{type:"error"},o.fields.federation.error||""),l.a.createElement(vn.a.Subheader,{style:ja.subheader},"Branding"),l.a.createElement(vn.a.Item,{title:"Primary color",onPress:function(){return E("primary")},left:function(){return l.a.createElement(Vn,{style:{width:24,height:24,backgroundColor:s.theme.colors.primary}})}}),l.a.createElement(vn.a.Item,{title:"Secondary color",onPress:function(){return E("secondary")},left:function(){return l.a.createElement(Vn,{style:{width:24,height:24,backgroundColor:s.theme.colors.accent}})}}),l.a.createElement(vn.a.Item,{title:"Use credit system",description:"Users will be charged credits when a load is marked as landed and can't manifest with insufficient funds.",onPress:function(){return u(ka.setField(["isCreditSystemEnabled",!o.fields.isCreditSystemEnabled.value]))},left:function(){return l.a.createElement(Pt.a,{onPress:function(){return u(ka.setField(["isCreditSystemEnabled",!o.fields.isCreditSystemEnabled.value]))},status:o.fields.isCreditSystemEnabled.value?"checked":"unchecked"})}}),l.a.createElement(vn.a.Item,{title:"Public",description:"Your dropzone will not be available in the app if this is disabled",onPress:function(){return u(ka.setField(["isPublic",!o.fields.isPublic.value]))},left:function(){return l.a.createElement(Pt.a,{onPress:function(){return u(ka.setField(["isPublic",!o.fields.isPublic.value]))},status:o.fields.isPublic.value?"checked":"unchecked"})}})))}var wa,Ca,ja=Ue.a.create({fields:{flexGrow:1,display:"flex",width:"100%"},field:{marginBottom:8,width:"100%"},subheader:{paddingLeft:0}});function Ta(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function Pa(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Ta(Object(t),!0).forEach((function(n){p()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Ta(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var Fa=Q.actions,$a=N.actions,Na=Object(g.gql)(wa||(wa=tn()(["\n  query QueryDropzoneDetails($dropzoneId: Int!) {\n    dropzone(id: $dropzoneId) {\n      id\n      name\n      primaryColor,\n      secondaryColor,\n      planes {\n        id\n        name\n        registration\n      }\n      ticketTypes {\n        id\n        name\n      }\n    }\n  }\n"]))),Da=Object(g.gql)(Ca||(Ca=tn()(["\n  mutation UpdateDropzone(\n    $id: Int!,\n    $name: String!,\n    $banner: String,\n    $federationId: Int!\n    $primaryColor: String\n    $secondaryColor: String\n    $isCreditSystemEnabled: Boolean,\n    $isPublic: Boolean\n  ){\n    updateDropzone(input: {\n      id: $id\n      attributes: {\n        name: $name,\n        banner: $banner,\n        federationId: $federationId\n        primaryColor: $primaryColor\n        secondaryColor: $secondaryColor\n        isCreditSystemEnabled: $isCreditSystemEnabled\n        isPublic: $isPublic\n      }\n    }) {\n      dropzone {\n        id\n        name\n        banner\n        primaryColor\n        secondaryColor,\n        isCreditSystemEnabled\n\n        planes {\n          id\n          name\n        }\n\n        federation {\n          id\n          name\n        }\n      }\n    }\n  }\n"])));function Ma(){var e,n=Oe((function(e){return e.dropzoneForm})),t=Oe((function(e){return e.global})),r=ze(),l=Object(rn.useRoute)().params.dropzone,i=Object(rn.useNavigation)(),o=Object(g.useQuery)(Na,{variables:{dropzoneId:Number(l.id)}}),s=o.data,u=o.loading;a.useEffect((function(){var e;null!=s&&null!=(e=s.dropzone)&&e.id&&r(Fa.setOriginal(s.dropzone))}),[null==s||null==(e=s.dropzone)?void 0:e.id]);var c=Object(g.useMutation)(Da),d=R()(c,2),m=d[0],f=d[1],p=a.useCallback((function(){var e,a,o,s,u,c,d,f,p,g,v,b,h,y,E,S,x,I,k,z,O,w,C,j,T,P,F,$;return Fe.a.async((function(N){for(;;)switch(N.prev=N.next){case 0:if(o=!1,s=n.fields,u=s.name,c=s.banner,d=s.federation,f=s.primaryColor,p=s.secondaryColor,g=s.isCreditSystemEnabled,v=s.isPublic,(null==(e=u.value)||!e.length||(null==(a=u.value)?void 0:a.length)<3)&&(o=!0,r(Fa.setFieldError(["name","Name is too short"]))),o){N.next=19;break}return N.prev=4,N.next=7,Fe.a.awrap(m({variables:{id:Number(null==l?void 0:l.id),name:u.value,banner:c.value||null,primaryColor:f.value,secondaryColor:p.value,federationId:Number(null==d||null==(b=d.value)?void 0:b.id),isCreditSystemEnabled:!!g,isPublic:!!v}}));case 7:if(null==(w=N.sent)||null==(h=w.data)||null==(y=h.updateDropzone)||null==(E=y.fieldErrors)||E.map((function(e){var n=e.field,t=e.message;switch(n){case"federation":case"federation_id":return r(Fa.setFieldError(["federation",t]));case"banner":return r(Fa.setFieldError(["banner",t]));case"primary_color":return r(Fa.setFieldError(["primaryColor",t]));case"secondary_color":return r(Fa.setFieldError(["secondaryColor",t]));case"is_credit_system_enabled":return r(Fa.setFieldError(["isCreditSystemEnabled",t]));case"name":return r(Fa.setFieldError(["name",t]));case"is_public":return r(Fa.setFieldError(["isPublic",t]))}})),null==w||null==(S=w.data)||null==(x=S.updateDropzone)||null==(I=x.errors)||!I.length){N.next=13;break}return N.abrupt("return",r(ge.showSnackbar({message:null==w||null==(C=w.data)||null==(j=C.updateDropzone)?void 0:j.errors[0],variant:"error"})));case 13:null!=w&&null!=(k=w.data)&&null!=(z=k.updateDropzone)&&null!=(O=z.fieldErrors)&&O.length||null!=(T=w.data)&&null!=(P=T.updateDropzone)&&P.dropzone&&(r($a.setDropzone(Pa(Pa({},t.currentDropzone||{}),null==w||null==(F=w.data)||null==($=F.updateDropzone)?void 0:$.dropzone))),r(Tt.showSnackbar({message:"Saved",variant:"success"})),i.goBack());case 14:N.next=19;break;case 16:N.prev=16,N.t0=N.catch(4),r(Tt.showSnackbar({message:N.t0.message,variant:"error"}));case 19:case"end":return N.stop()}}),null,null,[[4,16]],Promise)}),[JSON.stringify(n.fields),r,m]);return a.createElement(a.Fragment,null,a.createElement(un.a,{indeterminate:!0,color:t.theme.colors.accent,visible:u}),a.createElement(Rt,{contentContainerStyle:Ua.content},a.createElement(Oa,null),a.createElement(Vn,{style:Ua.fields},a.createElement(fn.a,{mode:"contained",disabled:f.loading,onPress:p,loading:f.loading},"Save"))))}var Aa,Ua=Ue.a.create({container:{flex:1,backgroundColor:"white",display:"flex"},content:{display:"flex",flexGrow:1,alignItems:"center",padding:48},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fields:{width:"70%",marginBottom:16},field:{marginBottom:8}}),qa=Object(ln.a)(Aa||(Aa=tn()(["\n  query QueryPlanes(\n    $dropzoneId: Int!\n  ) {\n    planes(dropzoneId: $dropzoneId) {\n      id\n      name\n      registration\n      hours\n      minSlots\n      maxSlots\n      nextMaintenanceHours\n      createdAt\n    }\n  }\n"])));function Ra(){var e,n,t,r,l=Oe((function(e){return e.global})),i=Object(g.useQuery)(qa,{variables:{dropzoneId:Number(null==(e=l.currentDropzone)?void 0:e.id)}}),o=i.data,s=i.loading,u=i.refetch,c=Object(rn.useNavigation)(),d=Object(rn.useIsFocused)();return a.useEffect((function(){d&&u()}),[d]),a.createElement(Rt,{refreshControl:a.createElement(ea.a,{refreshing:s,onRefresh:u})},a.createElement(un.a,{visible:s,color:l.theme.colors.accent}),!(null!=o&&null!=(n=o.planes)&&n.length)&&a.createElement(Qn,{title:"No planes?",subtitle:"You need to have at least one plane to manifest loads"}),(null==o||null==(t=o.planes)?void 0:t.length)&&a.createElement(Xn.a,null,a.createElement(Xn.a.Header,null,a.createElement(Xn.a.Title,null,"Name"),a.createElement(Xn.a.Title,{numeric:!0},"Registration"),a.createElement(Xn.a.Title,{numeric:!0},"Slots")),null==o||null==(r=o.planes)?void 0:r.map((function(e){return a.createElement(Xn.a.Row,{pointerEvents:"none",onPress:function(){return c.navigate("UpdatePlaneScreen",{plane:e})}},a.createElement(Xn.a.Cell,null,e.name),a.createElement(Xn.a.Cell,{numeric:!0},e.registration),a.createElement(Xn.a.Cell,{numeric:!0},e.maxSlots))}))),a.createElement(cn.a,{style:Wa.fab,small:!0,icon:"plus",onPress:function(){return c.navigate("CreatePlaneScreen")},label:"New plane"}))}var Ba,Wa=Ue.a.create({content:{flexGrow:1},fab:{position:"absolute",margin:16,right:0,bottom:0},empty:{flex:1,alignItems:"center",justifyContent:"center",width:"100%",height:"100%"}}),La=Y.actions,Ha=Object(ln.a)(Ba||(Ba=tn()(["\n  query QueryExtras(\n    $dropzoneId: Int!\n  ) {\n    extras(dropzoneId: $dropzoneId) {\n      id\n      cost\n      name\n\n      ticketTypes {\n        id\n        name\n      }\n    }\n  }\n"])));function Va(){var e,n,t,r,l,i=Oe((function(e){return e.ticketTypeForm})),o=ze(),s=Oe((function(e){return e.global})),u=a.useState(!1),c=R()(u,2),m=c[0],f=c[1],p=Object(g.useQuery)(Ha,{variables:{dropzoneId:Number(null==(e=s.currentDropzone)?void 0:e.id)}}),v=p.data;p.loading,p.refetch;return a.createElement(a.Fragment,null,a.createElement(yn.a,{style:Ja.field,mode:"outlined",label:"Name",error:!!i.fields.name.error,value:i.fields.name.value||"",onChangeText:function(e){return o(La.setField(["name",e]))}}),a.createElement(gn.a,{type:i.fields.name.error?"error":"info"},i.fields.name.error||"Name of the ticket users will see"),a.createElement(yn.a,{style:Ja.field,mode:"outlined",label:"Price",error:!!i.fields.cost.error,value:null==(n=i.fields.cost)||null==(t=n.value)?void 0:t.toString(),onChangeText:function(e){return o(La.setField(["cost",Number(e)]))}}),a.createElement(gn.a,{type:i.fields.cost.error?"error":"info"},i.fields.cost.error||"Base cost without extra ticket addons"),a.createElement(d.a,{style:{width:"100%"}},a.createElement(En.a,{onDismiss:function(){return f(!1)},visible:m,style:{position:"absolute",right:"10%",left:"10%",flex:1},anchor:a.createElement(vn.a.Item,{onPress:function(){f(!0)},title:i.fields.altitude.value&&[4e3,14e3].includes(i.fields.altitude.value)?{14e3:"Height",4e3:"Hop n Pop"}[i.fields.altitude.value.toString()]:"Custom",style:{width:"100%",flex:1},right:function(){return a.createElement(vn.a.Icon,{icon:i.fields.altitude.value&&[4e3,14e3].includes(i.fields.altitude.value)?{14e3:"airplane",4e3:"parachute"}[i.fields.altitude.value.toString()]:"pencil-plus"})}})},a.createElement(vn.a.Item,{onPress:function(){o(La.setField(["altitude",4e3])),f(!1)},title:"Hop n Pop",right:function(){return a.createElement(vn.a.Icon,{icon:"parachute"})}}),a.createElement(vn.a.Item,{onPress:function(){o(La.setField(["altitude",14e3])),f(!1)},title:"Height",right:function(){return a.createElement(vn.a.Icon,{icon:"airplane-takeoff"})}}),a.createElement(vn.a.Item,{onPress:function(){o(La.setField(["altitude",7e3])),f(!1)},title:"Other",right:function(){return a.createElement(vn.a.Icon,{icon:"parachute"})}})),(!i.fields.altitude.value||![4e3,14e3].includes(i.fields.altitude.value))&&a.createElement(yn.a,{style:Ja.field,mode:"outlined",label:"Custom altitude",error:!!i.fields.altitude.error,value:null==(r=i.fields.altitude)||null==(l=r.value)?void 0:l.toString(),onChangeText:function(e){return o(La.setField(["altitude",Number(e)]))}}),a.createElement(Pt.a.Item,{label:"Tandem",style:{width:"100%"},status:i.fields.isTandem.value?"checked":"unchecked",onPress:function(){return o(La.setField(["isTandem",!i.fields.isTandem.value]))}}),a.createElement(gn.a,{type:i.fields.isTandem.error?"error":"info"},i.fields.isTandem.error||"Allow also manifesting a passenger when using this ticket type"),a.createElement(Pt.a.Item,{label:"Public manifesting",style:{width:"100%"},status:i.fields.allowManifestingSelf.value?"checked":"unchecked",onPress:function(){return o(La.setField(["allowManifestingSelf",!i.fields.allowManifestingSelf.value]))}}),a.createElement(gn.a,{type:i.fields.allowManifestingSelf.error?"error":"info"},i.fields.allowManifestingSelf.error||"Allow users to manifest themselves with this ticket"),a.createElement(hn.a,null),a.createElement(vn.a.Subheader,null,"Enabled ticket add-ons"),null==v?void 0:v.extras.map((function(e){var n;return a.createElement(Pt.a.Item,{label:e.name,status:null!=(n=i.fields.extras.value)&&n.map((function(e){return e.id})).includes(e.id)?"checked":"unchecked",onPress:function(){var n,t;return o(La.setField(["extras",null!=(n=i.fields.extras.value)&&n.map((function(e){return e.id})).includes(e.id)?null==(t=i.fields.extras.value)?void 0:t.filter((function(n){return n.id!==e.id})):[].concat(ce()(i.fields.extras.value),[e])]))}})}))))}var Qa,Ja=Ue.a.create({field:{marginBottom:8,width:"100%"}}),_a=Y.actions,Ga=(N.actions,Object(g.gql)(Qa||(Qa=tn()(["\n  mutation CreateTicketType(\n    $name: String,\n    $cost: Float,\n    $dropzoneId: Int!\n    $altitude: Int\n    $allowManifestingSelf: Boolean\n  ){\n    createTicketType(input: {\n      attributes: {\n        name: $name,\n        cost: $cost,\n        dropzoneId: $dropzoneId\n        altitude: $altitude\n        allowManifestingSelf: $allowManifestingSelf\n      }\n    }) {\n      ticketType {\n        id\n        name\n        altitude\n        cost\n        allowManifestingSelf\n        extras {\n          id\n          name\n          cost\n        }\n      }\n    }\n  }\n"]))));function Ya(){var e=Oe((function(e){return e})),n=e.ticketTypeForm,t=e.global,r=ze(),l=Object(rn.useNavigation)(),i=Object(g.useMutation)(Ga),o=R()(i,2),s=o[0],u=o[1],c=Object(rn.useIsFocused)();a.useEffect((function(){c&&r(_a.reset())}),[c]);var d=a.useCallback((function(){var e=!1;return(!n.fields.name.value||n.fields.name.value.length<3)&&(e=!0,r(_a.setFieldError(["name","Name is too short"]))),n.fields.cost.value<1&&(e=!0,r(_a.setFieldError(["cost","Cost must be at least $1"]))),n.fields.altitude.value||(e=!0,r(_a.setFieldError(["altitude","Altitude must be specified"]))),!e}),[JSON.stringify(n.fields),r]),m=a.useCallback((function(){var e,a,i,o,u,c,m,f,p,g,v,b,h,y,E,S,x,I,k,z;return Fe.a.async((function(O){for(;;)switch(O.prev=O.next){case 0:if(e=n.fields,a=e.name,i=e.cost,o=e.allowManifestingSelf,u=e.altitude,c=e.extras,m=e.isTandem,!d()){O.next=15;break}return O.prev=2,O.next=5,Fe.a.awrap(s({variables:{dropzoneId:Number(null==(f=t.currentDropzone)?void 0:f.id),name:a.value,cost:i.value,altitude:u.value,allowManifestingSelf:o.value,extraIds:null==c||null==(p=c.value)?void 0:p.map((function(e){return e.id})),isTandem:!!m.value}}));case 5:if(null==(I=O.sent)||null==(g=I.data)||null==(v=g.createTicketType)||null==(b=v.fieldErrors)||b.map((function(e){var n=e.field,t=e.message;switch(n){case"name":return r(_a.setFieldError(["name",t]));case"altitude":return r(_a.setFieldError(["altitude",t]));case"cost":return r(_a.setFieldError(["cost",t]));case"allow_manifesting_self":return r(_a.setFieldError(["allowManifestingSelf",t]));case"extras":return r(_a.setFieldError(["extras",t]))}})),null==I||null==(h=I.data)||null==(y=h.createTicketType)||null==(E=y.errors)||!E.length){O.next=9;break}return O.abrupt("return",r(ge.showSnackbar({message:null==I||null==(k=I.data)||null==(z=k.createTicketType)?void 0:z.errors[0],variant:"error"})));case 9:null!=(S=I.data)&&null!=(x=S.createTicketType)&&x.ticketType&&(r(Tt.showSnackbar({message:"Saved",variant:"success"})),l.goBack()),O.next=15;break;case 12:O.prev=12,O.t0=O.catch(2),r(Tt.showSnackbar({message:O.t0.message,variant:"error"}));case 15:case"end":return O.stop()}}),null,null,[[2,12]],Promise)}),[JSON.stringify(n.fields),r,s]);return a.createElement(Rt,{contentContainerStyle:{paddingHorizontal:48}},a.createElement(en.a,{name:"ticket",size:100,color:"#999999",style:{alignSelf:"center"}}),a.createElement(Va,null),a.createElement(Vn,{style:Ka.actions},a.createElement(fn.a,{mode:"contained",disabled:u.loading,onPress:m,loading:u.loading},"Save")))}var Za,Ka=Ue.a.create({separator:{marginVertical:30,height:1,width:"80%"},actions:{marginVertical:16,width:"100%"}}),Xa=Y.actions,el=(N.actions,Object(g.gql)(Za||(Za=tn()(["\n  mutation UpdateTicketType(\n    $id: Int!,\n    $name: String,\n    $cost: Float,\n    $dropzoneId: Int!\n    $altitude: Int\n    $allowManifestingSelf: Boolean\n  ){\n    updateTicketType(input: {\n      id: $id\n      attributes: {\n        name: $name,\n        cost: $cost,\n        dropzoneId: $dropzoneId\n        altitude: $altitude\n        allowManifestingSelf: $allowManifestingSelf\n      }\n    }) {\n      ticketType {\n        id\n        name\n        altitude\n        cost\n        allowManifestingSelf\n        extras {\n          id\n          name\n          cost\n        }\n      }\n    }\n  }\n"]))));function nl(){var e=Oe((function(e){return e})),n=e.ticketTypeForm,t=(e.global,ze()),r=Object(rn.useNavigation)(),l=Object(rn.useRoute)().params.ticketType;a.useEffect((function(){t(Xa.setOriginal(l))}),[null==l?void 0:l.id]);var i=Object(g.useMutation)(el),o=R()(i,2),s=o[0],u=o[1],c=a.useCallback((function(){var e=!1;return(!n.fields.name.value||n.fields.name.value.length<3)&&(e=!0,t(Xa.setFieldError(["name","Name is too short"]))),n.fields.cost.value<1&&(e=!0,t(Xa.setFieldError(["cost","Cost must be at least $1"]))),n.fields.altitude.value||(e=!0,t(Xa.setFieldError(["altitude","Altitude must be specified"]))),!e}),[JSON.stringify(n.fields),t]),d=a.useCallback((function(){var e,a,l,i,o,u,d,m,f,p,g,v,b,h,y,E,S,x,I;return Fe.a.async((function(k){for(;;)switch(k.prev=k.next){case 0:if(e=n.fields,a=e.name,l=e.cost,i=e.allowManifestingSelf,o=e.altitude,u=e.extras,d=e.isTandem,!c()){k.next=15;break}return k.prev=2,k.next=5,Fe.a.awrap(s({variables:{id:Number(n.original.id),name:a.value,cost:l.value,altitude:o.value,allowManifestingSelf:i.value,extraIds:null==u||null==(m=u.value)?void 0:m.map((function(e){return e.id})),isTandem:!!d.value}}));case 5:if(null==(S=k.sent)||null==(f=S.data)||null==(p=f.updateTicketType)||null==(g=p.fieldErrors)||g.map((function(e){var n=e.field,r=e.message;switch(n){case"name":return t(Xa.setFieldError(["name",r]));case"altitude":return t(Xa.setFieldError(["altitude",r]));case"cost":return t(Xa.setFieldError(["cost",r]));case"allow_manifesting_self":return t(Xa.setFieldError(["allowManifestingSelf",r]));case"extras":return t(Xa.setFieldError(["extras",r]))}})),null==S||null==(v=S.data)||null==(b=v.updateTicketType)||null==(h=b.errors)||!h.length){k.next=9;break}return k.abrupt("return",t(ge.showSnackbar({message:null==S||null==(x=S.data)||null==(I=x.updateTicketType)?void 0:I.errors[0],variant:"error"})));case 9:null!=(y=S.data)&&null!=(E=y.updateTicketType)&&E.ticketType&&(t(Tt.showSnackbar({message:"Saved",variant:"success"})),r.goBack()),k.next=15;break;case 12:k.prev=12,k.t0=k.catch(2),t(Tt.showSnackbar({message:k.t0.message,variant:"error"}));case 15:case"end":return k.stop()}}),null,null,[[2,12]],Promise)}),[JSON.stringify(n.fields),t,s]);return a.createElement(Rt,{contentContainerStyle:{paddingHorizontal:48}},a.createElement(en.a,{name:"ticket",size:100,color:"#999999",style:{alignSelf:"center"}}),a.createElement(Va,null),a.createElement(Vn,{style:rl.fields},a.createElement(fn.a,{mode:"contained",disabled:u.loading,onPress:d,loading:u.loading},"Save")))}var tl,rl=Ue.a.create({container:{flex:1,alignItems:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fields:{width:"100%",marginVertical:16},field:{marginBottom:8}}),al=t(368),ll=K.actions,il=Object(ln.a)(tl||(tl=tn()(["\n  query QueryTicketType(\n    $dropzoneId: Int!\n  ) {\n    ticketTypes(dropzoneId: $dropzoneId) {\n      id\n      cost\n      currency\n      name\n      allowManifestingSelf\n\n      extras {\n        id\n        name\n      }\n    }\n  }\n"])));function ol(){var e,n,t,r=Oe((function(e){return e.extraForm})),l=ze(),i=Oe((function(e){return e.global})),o=Object(g.useQuery)(il,{variables:{dropzoneId:Number(null==(e=i.currentDropzone)?void 0:e.id)}}),s=o.data;o.loading,o.refetch;return a.createElement(a.Fragment,null,a.createElement(yn.a,{style:ul.field,mode:"outlined",label:"Name",error:!!r.fields.name.error,value:r.fields.name.value,onChangeText:function(e){return l(ll.setField(["name",e]))}}),a.createElement(gn.a,{type:r.fields.name.error?"error":"info"},r.fields.name.error||""),a.createElement(yn.a,{style:ul.field,mode:"outlined",label:"Price",error:!!r.fields.cost.error,value:null==(n=r.fields.cost)||null==(t=n.value)?void 0:t.toString(),onChangeText:function(e){return l(ll.setField(["cost",Number(e)]))}}),a.createElement(gn.a,{type:r.fields.cost.error?"error":"info"},r.fields.cost.error||""),a.createElement(d.a,{style:{width:"100%"}},a.createElement(vn.a.Subheader,null,"Compatible tickets"),null==s?void 0:s.ticketTypes.map((function(e){return a.createElement(Pt.a.Item,{label:e.name,status:r.fields.ticketTypeIds.value.includes(Number(e.id))?"checked":"unchecked",onPress:function(){return l(ll.setField(["ticketTypeIds",Object(al.xor)(r.fields.ticketTypeIds.value,[Number(e.id)])]))}})}))))}var sl,ul=Ue.a.create({fields:{width:"100%",flex:1},field:{marginBottom:8,width:"100%"}}),cl=K.actions,dl=(N.actions,Object(g.gql)(sl||(sl=tn()(["\n  mutation CreateExtra(\n    $name: String,\n    $ticketTypeIds: [Int!]\n    $cost: Float\n    $dropzoneId: Int\n  ){\n    createExtra(input: {\n      attributes: {\n        name: $name,\n        ticketTypeIds: $ticketTypeIds\n        cost: $cost\n        dropzoneId: $dropzoneId\n      }\n    }) {\n      extra {\n        id\n        name\n\n        ticketTypes {\n          id\n          name\n          cost\n          altitude\n          allowManifestingSelf\n        }\n      }\n    }\n  }\n"]))));function ml(){var e=Oe((function(e){return e})),n=e.extraForm,t=e.global,r=ze(),l=Object(rn.useNavigation)(),i=Object(rn.useIsFocused)();a.useEffect((function(){i&&r(cl.reset())}),[i]);var o=Object(g.useMutation)(dl),s=R()(o,2),u=s[0],c=s[1],d=a.useCallback((function(){var e=!1;return n.fields.name.value.length<3&&(e=!0,r(cl.setFieldError(["name","Name is too short"]))),Number(n.fields.cost.value)<0&&(e=!0,r(cl.setFieldError(["cost","Price must be a number"]))),!e}),[JSON.stringify(n.fields),r]),m=a.useCallback((function(){var e,a,i,o,s,c,m,f,p;return Fe.a.async((function(g){for(;;)switch(g.prev=g.next){case 0:if(e=n.fields,a=e.name,i=e.cost,o=e.ticketTypeIds,!d()){g.next=12;break}return g.prev=2,g.next=5,Fe.a.awrap(u({variables:{dropzoneId:Number(null==(s=t.currentDropzone)?void 0:s.id),name:a.value,cost:i.value,ticketTypeIds:o.value}}));case 5:f=g.sent,null!=(c=f.data)&&null!=(m=c.createExtra)&&m.extra&&(p=f.data.createExtra.extra,r(Tt.showSnackbar({message:"Added extra "+p.name,variant:"success"})),l.goBack()),g.next=12;break;case 9:g.prev=9,g.t0=g.catch(2),r(Tt.showSnackbar({message:g.t0.message,variant:"error"}));case 12:case"end":return g.stop()}}),null,null,[[2,9]],Promise)}),[JSON.stringify(n.fields),r,u]);return a.createElement(Rt,{contentContainerStyle:{paddingHorizontal:48}},a.createElement(en.a,{name:"ticket-percent",size:100,color:"#999999",style:{alignSelf:"center"}}),a.createElement(ol,null),a.createElement(Vn,{style:pl.fields},a.createElement(fn.a,{mode:"contained",disabled:c.loading,onPress:m,loading:c.loading},"Save")))}var fl,pl=Ue.a.create({container:{flex:1,alignItems:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fields:{width:"100%",marginBottom:16},field:{width:"100%",marginBottom:8}}),gl=K.actions,vl=(N.actions,Object(g.gql)(fl||(fl=tn()(["\n  mutation UpdateExtra(\n    $id: Int!,\n    $name: String,\n    $ticketTypeIds: [Int!]\n    $cost: Float\n    $dropzoneId: Int\n  ){\n    updateExtra(input: {\n      id: $id\n      attributes: {\n        name: $name,\n        ticketTypeIds: $ticketTypeIds\n        cost: $cost\n        dropzoneId: $dropzoneId\n      }\n    }) {\n      extra {\n        id\n        name\n\n        ticketTypes {\n          id\n          name\n          cost\n          altitude\n          allowManifestingSelf\n        }\n      }\n    }\n  }\n"]))));function bl(){var e=Oe((function(e){return e})),n=e.extraForm,t=e.global,r=ze(),l=Object(rn.useNavigation)(),i=Object(rn.useRoute)().params.extra;a.useEffect((function(){r(gl.setOriginal(i))}),[null==i?void 0:i.id]);var o=Object(g.useMutation)(vl),s=R()(o,2),u=s[0],c=s[1],d=a.useCallback((function(){var e=!1;return n.fields.name.value.length<3&&(e=!0,r(gl.setFieldError(["name","Name is too short"]))),Number(n.fields.cost.value)<0&&(e=!0,r(gl.setFieldError(["cost","Price must be a number"]))),!e}),[JSON.stringify(n.fields),r]),m=a.useCallback((function(){var e,a,i,o,s,c,m,f;return Fe.a.async((function(p){for(;;)switch(p.prev=p.next){case 0:if(e=n.fields,a=e.name,i=e.cost,o=e.ticketTypeIds,!d()){p.next=12;break}return p.prev=2,p.next=5,Fe.a.awrap(u({variables:{id:Number(n.original.id),dropzoneId:Number(null==(s=t.currentDropzone)?void 0:s.id),name:a.value,cost:i.value,ticketTypeIds:o.value}}));case 5:f=p.sent,null!=(c=f.data)&&null!=(m=c.updateExtra)&&m.extra&&(r(Tt.showSnackbar({message:"Saved",variant:"success"})),l.goBack()),p.next=12;break;case 9:p.prev=9,p.t0=p.catch(2),r(Tt.showSnackbar({message:p.t0.message,variant:"error"}));case 12:case"end":return p.stop()}}),null,null,[[2,9]],Promise)}),[JSON.stringify(n.fields),r,u]);return a.createElement(Rt,{contentContainerStyle:{paddingHorizontal:48}},a.createElement(en.a,{name:"ticket-percent",size:100,color:"#999999",style:{alignSelf:"center"}}),a.createElement(ol,null),a.createElement(Vn,{style:yl.fields},a.createElement(fn.a,{mode:"contained",disabled:c.loading,onPress:m,loading:c.loading},"Save")))}var hl,yl=Ue.a.create({container:{flex:1},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fields:{width:"100%",marginBottom:16},field:{marginBottom:8}}),El=Object(ln.a)(hl||(hl=tn()(["\n  query QueryExtra(\n    $dropzoneId: Int!\n  ) {\n    extras(dropzoneId: $dropzoneId) {\n      id\n      cost\n      name\n\n      ticketTypes {\n        id\n        altitude\n        name\n      }\n    }\n  }\n"])));function Sl(){var e,n,t,r=Oe((function(e){return e.global})),l=Object(g.useQuery)(El,{variables:{dropzoneId:Number(null==(e=r.currentDropzone)?void 0:e.id)}}),i=l.data,o=l.loading,s=(l.refetch,Object(rn.useNavigation)());Object(rn.useRoute)();return a.createElement(a.Fragment,null,a.createElement(un.a,{visible:o,indeterminate:!0,color:r.theme.colors.accent}),a.createElement(Vn,{style:Il.container},a.createElement(Xn.a,null,a.createElement(Xn.a.Header,null,a.createElement(Xn.a.Title,null,"Name"),a.createElement(Xn.a.Title,{numeric:!0},"Cost")),null==i||null==(n=i.extras)?void 0:n.map((function(e){return a.createElement(Xn.a.Row,null,a.createElement(Xn.a.Cell,{onPress:function(){return s.navigate("UpdateExtraScreen",{extra:e})}},e.name),a.createElement(Xn.a.Cell,{numeric:!0},e.cost))}))),!o&&!(null!=i&&null!=(t=i.extras)&&t.length)&&a.createElement(Qn,{title:"No ticket addons",subtitle:"You can add multiple addons to assign to tickets, e.g outside camera, or coach"}),a.createElement(cn.a,{style:Il.fab,small:!0,icon:"plus",onPress:function(){return s.navigate("CreateExtraScreen")},label:"New ticket addon"})))}var xl,Il=Ue.a.create({container:{flex:1,padding:8,display:"flex"},fab:{position:"absolute",margin:16,right:0,bottom:0},empty:{flex:1,alignItems:"center",justifyContent:"center",width:"100%",height:"100%"}}),kl=Object(Ve.a)();function zl(){return a.createElement(kl.Navigator,{screenOptions:{headerShown:!0,header:function(e){return a.createElement(Kt,e)},cardStyle:{flex:1}}},a.createElement(kl.Screen,{name:"SettingsScreen",component:_r,options:{title:"Settings"}}),a.createElement(kl.Screen,{name:"DropzoneSettingsScreen",component:Yr}),a.createElement(kl.Screen,{name:"UpdateDropzoneScreen",component:Ma}),a.createElement(kl.Screen,{name:"PlanesScreen",component:Ra,options:{title:"Planes"}}),a.createElement(kl.Screen,{name:"CreatePlaneScreen",component:ma,options:{title:"New plane"}}),a.createElement(kl.Screen,{name:"UpdatePlaneScreen",component:ba,options:{title:"Edit plane"}}),a.createElement(kl.Screen,{name:"TicketTypesScreen",component:aa,options:{title:"Ticket types"}}),a.createElement(kl.Screen,{name:"CreateTicketTypeScreen",component:Ya,options:{title:"New ticket type"}}),a.createElement(kl.Screen,{name:"UpdateTicketTypeScreen",component:nl,options:{title:"Edit ticket type"}}),a.createElement(kl.Screen,{name:"CreateExtraScreen",component:ml,options:{title:"Create ticket add-on"}}),a.createElement(kl.Screen,{name:"UpdateExtraScreen",component:bl,options:{title:"Update ticket add-on"}}),a.createElement(kl.Screen,{name:"ExtrasScreen",component:Sl,options:{title:"Ticket add-ons"}}))}var Ol=Object(ln.a)(xl||(xl=tn()(["\n  query QueryDropzoneUsersSearch(\n    $dropzoneId: Int!\n    $search: String\n  ) {\n    dropzone(id: $dropzoneId) {\n      id\n      name\n\n      dropzoneUsers(search: $search) {\n        edges {\n          node {\n            id\n            role {\n              id\n              name\n            }\n            user {\n              id\n              name\n            }\n          }\n        }\n      }\n    }\n  }\n"])));function wl(){var e,n,t,r,l,i,o,s=Oe((function(e){return e})),u=s.global,c=s.usersScreen,d=ze(),m=Object(g.useQuery)(Ol,{variables:{dropzoneId:Number(null==(e=u.currentDropzone)?void 0:e.id),search:c.searchText}}),f=m.data,p=m.loading,v=Object(rn.useNavigation)(),b=Object(rn.useIsFocused)();return a.useEffect((function(){c.isSearchVisible&&d(pe.setSearchVisible(!1))}),[b]),a.createElement(Vn,{style:Cl.container},a.createElement(un.a,{indeterminate:!0,color:u.theme.colors.accent,visible:p}),!(null!=f&&null!=(n=f.dropzone)&&null!=(t=n.dropzoneUsers)&&null!=(r=t.edges)&&r.length)&&a.createElement(Qn,{title:"No users",subtitle:""}),null==f||null==(l=f.dropzone)||null==(i=l.dropzoneUsers)||null==(o=i.edges)?void 0:o.map((function(e){var n,t,r;return a.createElement(vn.a.Item,{title:null==e||null==(n=e.node)?void 0:n.user.name,description:null==e||null==(t=e.node)||null==(r=t.role)?void 0:r.name,left:function(){return a.createElement(vn.a.Icon,{icon:"account"})},onPress:function(){var n;return v.navigate("UserProfileScreen",{userId:null==e||null==(n=e.node)?void 0:n.id})}})})))}var Cl=Ue.a.create({container:{flex:1},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"}}),jl=t(487);var Tl,Pl=Ue.a.create({inputContainer:{flexGrow:1},input:{backgroundColor:"transparent",height:"100%",color:"white",borderColor:"none"},icon:{marginHorizontal:8}}),Fl=function(e){var n=e.navigation,t=e.previous,r=e.scene,a=e.onSearch,i=e.searchText,o=e.searchVisible,s=e.setSearchVisible,u=Oe((function(e){return e.global}));return u.currentDropzone,u.theme,ze(),l.a.createElement(_t.a.Header,null,t?l.a.createElement(_t.a.BackAction,{onPress:n.goBack}):null,o?l.a.createElement(_t.a.BackAction,{onPress:function(){return s(!1)}}):null,o?l.a.createElement(d.a,{style:Pl.inputContainer},l.a.createElement(yn.a,{style:Pl.input,value:i,onChangeText:function(e){return a(e)}})):l.a.createElement(_t.a.Content,{title:r.descriptor.options.title}),l.a.createElement(jl.a,{name:"search",onPress:function(){return s(!o)},color:"#FFFFFF",size:24,style:Pl.icon}))};function $l(e){var n,t,r,a,i,o,s,u,c=Cn("actAsRigInspector");return null!=(n=e.config)&&n.valueType&&"string"===(null==(t=e.config)?void 0:t.valueType)?l.a.createElement(yn.a,{mode:"outlined",disabled:!c,style:{marginVertical:8},value:e.value,onChangeText:function(n){return e.onChange(n)},label:e.config.name||""}):null!=(r=e.config)&&r.valueType&&"boolean"===(null==(a=e.config)?void 0:a.valueType)?l.a.createElement(Pt.a.Item,{label:e.config.name||"",disabled:!c,style:{marginVertical:8},status:"true"===e.value?"checked":"unchecked",onPress:function(){return e.onChange("true"===e.value?"false":"true")}}):null!=(i=e.config)&&i.valueType&&"integer"===(null==(o=e.config)?void 0:o.valueType)?l.a.createElement(yn.a,{disabled:!c,value:e.value,mode:"outlined",onChangeText:function(n){return e.onChange(n)},label:e.config.name||"",keyboardType:"number-pad",style:{marginVertical:8}}):null!=(s=e.config)&&s.valueType&&"date"===(null==(u=e.config)?void 0:u.valueType)?l.a.createElement(ar,{disabled:!c,timestamp:Number(e.value),onChange:function(n){return e.onChange(n.toString())},label:e.config.name||""}):null}var Nl=Object(ln.a)(Tl||(Tl=tn()(["\n  query RigInspection($dropzoneId: Int!) {\n    dropzone(id: $dropzoneId) {\n      rigInspectionChecklist {\n        checklistItems {\n          id\n          isRequired\n          name\n          valueType\n          description\n        }\n      }\n    }\n  }\n"])));function Dl(){var e,n,t,r,l=Oe((function(e){return e})),i=l.global,o=l.rigInspectionForm,s=ze(),u=Object(g.useQuery)(Nl,{variables:{dropzoneId:Number(null==i||null==(e=i.currentDropzone)?void 0:e.id)}}),c=u.data;u.loading;return a.createElement(a.Fragment,null,null==c||null==(n=c.dropzone)||null==(t=n.rigInspectionChecklist)||null==(r=t.checklistItems)?void 0:r.map((function(e){var n=o.fields.find((function(n){return(null==n?void 0:n.checklistItem.id)===e.id}));return a.createElement($l,{config:e,value:(null==n?void 0:n.value)||"",onChange:function(t){return s(Ee.setItem({checklistItem:e,value:t,id:(null==n?void 0:n.id)||null}))}})})))}Ue.a.create({fields:{flex:1},field:{marginBottom:8}});var Ml,Al,Ul,ql=Object(ln.a)(Ml||(Ml=tn()(["\n  query RigInspections($dropzoneUserId: Int!, $dropzoneId: Int!) {\n    dropzone(id: $dropzoneId) {\n      id\n      dropzoneUser(id: $dropzoneUserId) {\n        id\n        rigInspections {\n          id\n          rig {\n            id\n          }\n          inspectedBy {\n            id\n            name\n          }\n          checklistValues {\n            id\n            value\n            checklistItem {\n              id\n              name\n              valueType\n              isRequired\n              description\n            }\n          }\n        }\n      }\n    }\n  }\n"]))),Rl=Object(ln.a)(Al||(Al=tn()(["\n  mutation CreateRigInspection(\n    $dropzoneId: Int,\n    $rigId: Int,\n  ) {\n    createRigInspection(input: {\n      attributes: {\n        dropzoneId: $dropzoneId,\n        rigId: $rigId,\n      }\n    }) {\n      rigInspection {\n        id\n        inspectedBy {\n          id\n          name\n        }\n        rig {\n          id\n        }\n        checklistValues {\n          id\n          value\n          checklistItem {\n            id\n            name\n            valueType\n            isRequired\n            description\n          }\n        }\n      }\n      fieldErrors {\n        field\n        message\n      }\n      errors\n    }\n  }\n"]))),Bl=Object(ln.a)(Ul||(Ul=tn()(["\n  mutation SetValue(\n    $checklistItemId: Int,\n    $rigInspectionId: Int,\n    $value: String,\n  ) {\n    updateChecklistValue(input: {\n      attributes: {\n        checklistItemId: $checklistItemId,\n        rigInspectionId: $rigInspectionId,\n        value: $value\n      }\n    }) {\n      checklistValue {\n        id,\n        value,\n        checklistItem {\n          id\n          name\n          valueType,\n          description\n        }\n      }\n      fieldErrors {\n        field\n        message\n      }\n      errors\n    }\n  }\n"])));function Wl(){var e,n,t,r,l=Oe((function(e){return e})),i=l.global,o=l.rigInspectionForm,s=ze(),u=Object(rn.useRoute)().params,c=u.rig,d=u.dropzoneUserId,m=Object(g.useQuery)(ql,{variables:{dropzoneId:Number(i.currentDropzone.id),dropzoneUserId:d}}),f=m.data,p=(m.loading,Cn("actAsRigInspector")),v=Object(g.useMutation)(Rl),b=R()(v,1)[0],h=Object(g.useMutation)(Bl),y=R()(h,1)[0];a.useEffect((function(){var e,n,t;if(null!=f&&null!=(e=f.dropzone)&&null!=(n=e.dropzoneUser)&&null!=(t=n.rigInspections)&&t.some((function(e){var n;return(null==(n=e.rig)?void 0:n.id.toString())===c.id.toString()}))){var r,a,l,i=null==f||null==(r=f.dropzone)||null==(a=r.dropzoneUser)||null==(l=a.rigInspections)?void 0:l.find((function(e){var n;return(null==(n=e.rig)?void 0:n.id)===c.id}));console.log({inspection:i}),s(Ee.setOriginal(i))}}),[JSON.stringify(null==f||null==(e=f.dropzone)||null==(n=e.dropzoneUser)?void 0:n.rigInspections)]);var E=a.useCallback((function(){var e,n,t,r,a;return Fe.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:if(l.prev=0,n=null==(e=o.original)?void 0:e.id){l.next=7;break}return l.next=5,Fe.a.awrap(b({variables:{dropzoneId:Number(i.currentDropzone.id),rigId:Number(c.id)}}));case 5:a=l.sent,n=null==a||null==(t=a.data)||null==(r=t.createRigInspection)?void 0:r.rigInspection.id;case 7:return l.next=9,Fe.a.awrap(Promise.all(o.fields.map((function(e){return y({variables:{rigInspectionId:Number(n),checklistItemId:Number(e.checklistItem.id),value:e.value}})}))));case 9:l.next=14;break;case 11:l.prev=11,l.t0=l.catch(0),s(ge.showSnackbar({message:l.t0.message,variant:"error"}));case 14:case"end":return l.stop()}}),null,null,[[0,11]],Promise)}),[JSON.stringify(o.fields),null==o||null==(t=o.original)?void 0:t.id,null==i||null==(r=i.currentDropzone)?void 0:r.id]);return a.createElement(Rt,null,a.createElement(Kn.a,{style:{width:"100%"}},a.createElement(Kn.a.Title,{title:"Rig"}),a.createElement(Kn.a.Content,null,a.createElement(vn.a.Item,{title:"Make",description:c.make}),a.createElement(vn.a.Item,{title:"Model",description:c.model}),a.createElement(vn.a.Item,{title:"Serial",description:c.serial}),a.createElement(vn.a.Item,{title:"Repack due",description:null!=c&&c.repackExpiresAt?Object(nr.a)(1e3*c.repackExpiresAt,"yyyy/MM/dd"):"-"}))),a.createElement(Kn.a,{style:{width:"100%"}},a.createElement(Kn.a.Title,{title:"Inspection"}),a.createElement(Kn.a.Content,null,a.createElement(Dl,null)),a.createElement(Kn.a.Actions,null,a.createElement(fn.a,{disabled:!p,mode:"contained",onPress:function(){return E()},style:{width:"100%"}},"Mark as inspected"))))}var Ll=Object(Ve.a)();function Hl(){var e=Oe((function(e){return e.usersScreen})),n=e.isSearchVisible,t=e.searchText,r=ze();return a.createElement(Ll.Navigator,{screenOptions:{headerShown:!0,header:function(e){return a.createElement(Fl,Rn()({},e,{searchText:t,searchVisible:n,setSearchVisible:function(e){return r(pe.setSearchVisible(e))},onSearch:function(e){return r(pe.setSearchText(e))}}))},cardStyle:{flex:1}}},a.createElement(Ll.Screen,{name:"UsersScreen",component:wl,options:{title:"Dropzone users"}}),a.createElement(Ll.Screen,{name:"UserProfileScreen",component:Cr,options:{title:"User"}}),a.createElement(Ll.Screen,{name:"RigInspectionScreen",component:Wl,options:{title:"Inspection"}}))}var Vl=Object(Xe.a)();function Ql(){var e=Object(Ke.b)(),n=Cn("readUser"),t=(Cn("createPackjob"),Cn("updateDropzone"));return a.createElement(Vl.Navigator,{initialRouteName:"Manifest",tabBarOptions:{activeTintColor:"#FFFFFF",inactiveBackgroundColor:e.colors.primary,activeBackgroundColor:e.colors.primary,inactiveTintColor:"#CCCCCC",showLabel:!1}},a.createElement(Vl.Screen,{name:"Manifest",component:er,options:{tabBarIcon:function(e){e.focused;var n=e.color,t=e.size;return a.createElement(en.a,{name:"airplane",color:n,size:t})},unmountOnBlur:!0}}),a.createElement(Vl.Screen,{name:"Profile",component:Jr,options:{tabBarIcon:function(e){var n=e.size,t=e.color;e.focused;return a.createElement(en.a,{size:n,color:t,name:"account-circle"})},unmountOnBlur:!0}}),!1,n&&a.createElement(Vl.Screen,{name:"Users",component:Hl,options:{tabBarIcon:function(e){var n=e.size,t=e.color;e.focused;return a.createElement(en.a,{size:n,color:t,name:"account-group"})},unmountOnBlur:!0}}),t&&a.createElement(Vl.Screen,{name:"Settings",component:zl,options:{tabBarIcon:function(e){var n=e.size,t=e.color;e.focused;return a.createElement(en.a,{size:n,color:t,name:"account-cog"})}}}))}var Jl,_l=t(117),Gl=Object(ln.a)(Jl||(Jl=tn()(["\n  query QueryDropzones {\n    dropzones {\n      edges {\n        node {\n          id\n          name\n          banner\n          ticketTypes {\n            id\n            name\n            cost\n            allowManifestingSelf\n            currency\n          }\n          planes {\n            id\n            name,\n            registration,\n            minSlots,\n            maxSlots,\n          }\n        }\n      }\n    }\n  }\n"])));function Yl(){var e,n=ze(),t=Object(g.useQuery)(Gl),r=t.data,l=t.loading,i=t.refetch,o=Object(rn.useNavigation)();return a.createElement(Vn,{style:Kl.container},a.createElement(_l.a,{data:(null==r||null==(e=r.dropzones)?void 0:e.edges)||[],numColumns:2,refreshing:l,onRefresh:function(){return i()},style:{flex:1},contentContainerStyle:{flexGrow:1},ListEmptyComponent:function(){return a.createElement(Vn,{style:Kl.empty},a.createElement(An.a,null,"No dropzones?"),a.createElement(Un.a,null,"You can set one up!"))},renderItem:function(e){var t,r,l=e.item;return a.createElement(Kn.a,{style:{width:on.a.get("window").width/2-32,margin:8},onPress:function(){return Fe.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:null!=l&&l.node&&n(fe.setDropzone(l.node));case 1:case"end":return e.stop()}}),null,null,null,Promise)}},a.createElement(Kn.a.Cover,{source:{uri:null==l||null==(t=l.node)?void 0:t.banner}}),a.createElement(Kn.a.Content,null,a.createElement(An.a,null,null==l||null==(r=l.node)?void 0:r.name)))}}),a.createElement(cn.a,{style:Kl.fab,small:!0,icon:"plus",onPress:function(){return o.navigate("CreateDropzoneScreen")},label:"Create dropzone"}))}var Zl,Kl=Ue.a.create({container:{flex:1,padding:8,display:"flex"},fab:{position:"absolute",margin:16,right:0,bottom:0},empty:{flex:1,alignItems:"center",justifyContent:"center",width:"100%",height:"100%"}});function Xl(e){return{message:e,pattern:/.{1,}/}}function ei(e,n){return{message:e,callback:n}}function ni(e,n){var t=n.getPayload,r=n.fieldErrorMap,l=n.validates;return function(i){var o=i.onFieldError,s=i.onSuccess,u=i.onError,c=Object(g.useMutation)(e),d=R()(c,2),m=d[0],f=d[1],p=f.data,v=f.loading;f.error;return{loading:v,mutate:Object(a.useCallback)((function(e){var a,c,d,f,p,g;return Fe.a.async((function(v){for(;;)switch(v.prev=v.next){case 0:if(function(){var t=!1;return l&&Object.keys(e).forEach((function(r){var a,i=r;i in(n.validates||{})&&(null==(a=l[i])||a.forEach((function(n){n.pattern?n.pattern.test(""+e[i])||(t=!0,o&&o(i,n.message)):n.callback&&!n.callback(e)&&(t=!0,o&&o(i,n.message))})))})),!t}()){v.next=3;break}return v.abrupt("return");case 3:return v.prev=3,v.next=6,Fe.a.awrap(m({variables:e}));case 6:if(f=v.sent,null==(p=t(f.data))||null==(a=p.fieldErrors)||a.map((function(e){var t=e.field,a=e.message,l=t in(r||{})?n.fieldErrorMap[t]:t;i.onFieldError&&i.onFieldError(""+l,a)})),null==p||null==(c=p.errors)||!c.length||!u){v.next=12;break}return null==(g=p.errors)||g.map((function(e){return u(e)})),v.abrupt("return");case 12:return null!=p&&null!=(d=p.fieldErrors)&&d.length||s(p),v.abrupt("return",p);case 16:v.prev=16,v.t0=v.catch(3),u&&u(v.t0.message);case 19:return v.abrupt("return");case 20:case"end":return v.stop()}}),null,null,[[3,16]],Promise)}),[o,u,s,,m,t,JSON.stringify(p)])}}}var ti=ni(Object(ln.a)(Zl||(Zl=tn()(["\nmutation CreateDropzone(\n  $name: String!,\n  $banner: String!,\n  $federationId: Int!\n){\n  createDropzone(input: { attributes: { name: $name, banner: $banner, federationId: $federationId }}) {\n    dropzone {\n      id\n      name\n      banner\n\n      federation {\n        id\n        name\n      }\n    }\n  }\n}\n"]))),{getPayload:function(e){return e.createDropzone},fieldErrorMap:{federation:"federationId"},validates:{name:[Xl("Name is required")]}}),ri=Q.actions,ai=N.actions;function li(){var e=Oe((function(e){return e.dropzoneForm})),n=ze(),t=(Object(rn.useNavigation)(),ti({onError:function(e){return n(ge.showSnackbar({message:e,variant:"error"}))},onFieldError:function(e,t){return n(ri.setFieldError([e,t]))},onSuccess:function(e){return n(ai.setDropzone(e.dropzone))}}));return a.createElement(Rt,{contentContainerStyle:{paddingHorizontal:32}},a.createElement(Oa,null),a.createElement(Vn,{style:ii.fields},a.createElement(fn.a,{mode:"contained",disabled:t.loading,loading:t.loading,onPress:function(){return t.mutate({name:e.fields.name.value,banner:e.fields.banner.value,federationId:Number(e.fields.federation.value.id)})}},"Save")))}var ii=Ue.a.create({container:{flex:1,alignItems:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fields:{width:"100%"},field:{marginBottom:8}}),oi=Object(Ve.a)();function si(){return a.createElement(oi.Navigator,{screenOptions:{headerShown:!1,cardStyle:{flex:1}},initialRouteName:"Dropzones"},a.createElement(oi.Screen,{name:"DropzonesScreen",component:Yl}),a.createElement(oi.Screen,{name:"CreateDropzoneScreen",component:li}))}var ui,ci=t(39),di=U.actions,mi=Object(g.gql)(ui||(ui=tn()(["\n  mutation UserLogin($email: String!, $password: String!) {\n    userLogin(email: $email, password: $password) {\n      authenticatable {\n        id\n        email\n        name\n        phone\n        createdAt\n        updatedAt\n      }\n      credentials {\n        accessToken\n        tokenType\n        client\n        expiry\n        uid\n      }\n    }\n  }\n"])));function fi(){var e=Oe((function(e){return e.login})),n=ze(),t=Object(ci.useNavigation)(),r=Object(g.useMutation)(mi),i=R()(r,2),o=i[0],s=i[1],u=Object(a.useCallback)((function(){var t,r,a,l,i,s,u;return Fe.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:if(t=new RegExp(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/),r=!1,e.fields.email.value||(r=!0,n(di.setEmailError("Email is required"))),e.fields.password.value||(r=!0,n(di.setPasswordError("Password is required"))),t.test(e.fields.email.value)||(r=!0,n(di.setEmailError("Please enter a valid email"))),r){c.next=17;break}return c.prev=6,c.next=9,Fe.a.awrap(o({variables:{email:e.fields.email.value,password:e.fields.password.value}}));case 9:u=c.sent,console.log({result:u}),null!=u&&null!=(a=u.data)&&null!=(l=a.userLogin)&&l.authenticatable&&null!=u&&null!=(i=u.data)&&null!=(s=i.userLogin)&&s.credentials&&(n(fe.setCredentials(u.data.userLogin.credentials)),n(fe.setUser(u.data.userLogin.authenticatable))),c.next=17;break;case 14:c.prev=14,c.t0=c.catch(6),n(ge.showSnackbar({message:c.t0.message,variant:"error"}));case 17:case"end":return c.stop()}}),null,null,[[6,14]],Promise)}),[o,JSON.stringify(e.fields)]);return l.a.createElement(Vn,{style:vi.container},l.a.createElement(Hn,{style:vi.title},"Sign in"),l.a.createElement(Vn,{style:vi.fields},l.a.createElement(yn.a,{label:"Email",mode:"outlined",value:e.fields.email.value,onChangeText:function(e){n(di.setEmail(e))}}),l.a.createElement(gn.a,{type:"error"},e.fields.email.error||" "),l.a.createElement(yn.a,{label:"Password",mode:"outlined",value:e.fields.password.value,secureTextEntry:!0,onChangeText:function(e){n(di.setPassword(e))},error:!!e.fields.password.error}),l.a.createElement(gn.a,{type:"error"},e.fields.password.error||" "),l.a.createElement(fn.a,{mode:"contained",style:vi.button,onPress:u,loading:s.loading},"Log in"),l.a.createElement(fn.a,{style:vi.button,onPress:function(){return t.navigate("SignUpScreen")}},"Sign up")))}var pi,gi,vi=Ue.a.create({container:{flex:1,alignItems:"center",justifyContent:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fields:{marginBottom:10},button:{marginTop:10,width:"100%"}}),bi=ni(Object(ln.a)(pi||(pi=tn()(["\n  mutation UserSignUp(\n    $email: String!,\n    $password: String!,\n    $passwordConfirmation: String!\n    $name: String!\n    $phone: String!\n    $exitWeight: Float!\n    $licenseId: Int\n  ){\n    userSignUp(\n      email: $email,\n      password: $password,\n      passwordConfirmation: $passwordConfirmation,\n      exitWeight: $exitWeight,\n      name: $name,\n      phone: $phone,\n      licenseId: $licenseId\n    ) {\n      authenticatable {\n        createdAt,\n        email,\n        id,\n        name,\n        phone,\n      }\n      credentials {\n        accessToken\n        tokenType\n        client\n        expiry\n        uid\n      }\n    }\n  }\n"]))),{getPayload:function(e){return e.userSignUp},fieldErrorMap:{license:"licenseId"},validates:{name:[Xl("Name is required")],email:[(gi="Please enter a valid email",{message:gi,pattern:new RegExp(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)})],passwordConfirmation:[ei("Password must have 1 uppercase, 1 lowercase, 1 digit and be at least 8 characters",(function(e){return/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{8,}.*$/.test(e.passwordConfirmation)})),ei("Passwords don't match",(function(e){return e.password===e.passwordConfirmation}))]}}),hi=W.actions,yi=N.actions;function Ei(){var e,n,t=Oe((function(e){return e.signup})),r=ze(),l=bi({onSuccess:function(e){e.credentials&&(r(yi.setCredentials(e.credentials)),r(yi.setUser(e.authenticatable)))},onFieldError:function(e,n){return r(hi.setFieldError([e,n]))}}),i=l.loading,o=l.mutate;return a.createElement(Rt,{style:Si.container},a.createElement(Hn,{style:Si.title},"Sign up"),a.createElement(Vn,{style:Si.fields},a.createElement(yn.a,{style:Si.field,mode:"outlined",label:"Name",error:!!t.fields.name.error,value:t.fields.name.value,onChangeText:function(e){return r(hi.setField(["name",e]))}}),a.createElement(gn.a,{type:"error"},t.fields.name.error||""),a.createElement(yn.a,{style:Si.field,mode:"outlined",label:"Exit weight",error:!!t.fields.exitWeight.error,value:(null==(e=t.fields.exitWeight)||null==(n=e.value)?void 0:n.toString())||"",keyboardType:"numbers-and-punctuation",right:function(){return a.createElement(yn.a.Affix,{text:"kg"})},onChangeText:function(e){return r(hi.setField(["exitWeight",parseFloat(e)]))}}),a.createElement(gn.a,{type:t.fields.exitWeight.error?"error":"info"},t.fields.exitWeight.error||""),a.createElement(yn.a,{style:Si.field,mode:"outlined",label:"Email",error:!!t.fields.email.error,value:t.fields.email.value,onChangeText:function(e){return r(hi.setField(["email",e]))}}),a.createElement(gn.a,{type:"error"},t.fields.email.error||""),a.createElement(yn.a,{style:Si.field,mode:"outlined",label:"Phone",error:!!t.fields.phone.error,value:t.fields.phone.value,onChangeText:function(e){return r(hi.setField(["phone",e]))}}),a.createElement(gn.a,{type:"error"},t.fields.phone.error||""),a.createElement(yn.a,{style:Si.field,mode:"outlined",label:"Password",error:Boolean(t.fields.password.error||t.fields.passwordConfirmation.error),textContentType:"newPassword",secureTextEntry:!0,passwordRules:"required: upper; required: lower; required: digit; minlength: 8;",value:t.fields.password.value,onChangeText:function(e){return r(hi.setField(["password",e]))}}),a.createElement(gn.a,{type:"error"},t.fields.password.error||""),a.createElement(yn.a,{style:Si.field,mode:"outlined",label:"Repeat password",error:Boolean(t.fields.password.error||t.fields.passwordConfirmation.error),textContentType:"newPassword",secureTextEntry:!0,passwordRules:"required: upper; required: lower; required: digit; minlength: 8;",value:t.fields.passwordConfirmation.value,onChangeText:function(e){return r(hi.setField(["passwordConfirmation",e]))}}),a.createElement(gn.a,{type:"error"},t.fields.passwordConfirmation.error||""),a.createElement(fn.a,{mode:"contained",onPress:function(){var e,n;return o({email:t.fields.email.value,name:t.fields.name.value,exitWeight:t.fields.exitWeight.value,password:t.fields.password.value,passwordConfirmation:t.fields.passwordConfirmation.value,licenseId:Number(null==(e=t.fields.license)||null==(n=e.value)?void 0:n.id)||null,phone:t.fields.phone.value})},loading:i},"Sign up")))}var Si=Ue.a.create({container:{flex:1,alignItems:"center",justifyContent:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fields:{width:"70%"},field:{marginBottom:8}}),xi=Object(Ve.a)();function Ii(){return a.createElement(xi.Navigator,{screenOptions:{headerShown:!1,cardStyle:{flex:1}},initialRouteName:"LoginScreen"},a.createElement(xi.Screen,{name:"LoginScreen",component:fi}),a.createElement(xi.Screen,{name:"SignUpScreen",component:Ei}))}var ki=Object(Ve.a)();function zi(){var e=Oe((function(e){return e.global}));return a.createElement(ki.Navigator,{screenOptions:{headerShown:!1,cardStyle:{flex:1}}},e.credentials?e.currentDropzone?a.createElement(ki.Screen,{name:"Authenticated",component:Ql}):a.createElement(ki.Screen,{name:"Dropzones",component:si}):a.createElement(ki.Screen,{name:"Unauthenticated",component:Ii}),a.createElement(ki.Screen,{name:"NotFound",component:_e,options:{title:"Oops!"}}))}function Oi(){var e=Oe((function(e){return e.global}));return l.a.createElement(Te,null,l.a.createElement(u.a,{theme:e.theme},l.a.createElement(i.b,null,l.a.createElement(m.a,{linking:He,theme:e.theme},l.a.createElement(zi,null)),l.a.createElement(r.a,null),l.a.createElement(Le,null))))}function wi(){return function(){var e=a.useState(!1),n=R()(e,2),r=n[0],l=n[1];return a.useEffect((function(){Fe.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,De.b(),e.next=4,Fe.a.awrap(Ne.b(Ae(Ae({},$e.a.font),{},{"space-mono":t(431)})));case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.warn(e.t0);case 9:return e.prev=9,l(!0),De.a(),e.finish(9);case 13:case"end":return e.stop()}}),null,null,[[0,6,9,13]],Promise)}),[]),r}()?l.a.createElement(o.a,{store:Ie},l.a.createElement(s.a,{persistor:ke,loading:l.a.createElement(d.a,{style:{flex:1,justifyContent:"center",alignItems:"center"}},l.a.createElement(c.a,{size:"large"}))},l.a.createElement(Oi,null))):null}},395:function(e,n,t){e.exports=t(479)},431:function(e,n,t){e.exports=t.p+"./fonts/SpaceMono-Regular.ttf"},448:function(e,n){}},[[395,1,2]]]);
//# sourceMappingURL=app.3f97b8b2.chunk.js.map