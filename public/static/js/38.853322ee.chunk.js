(this.webpackJsonp=this.webpackJsonp||[]).push([[38],{404:function(e,n,t){"use strict";t.d(n,"a",(function(){return p})),t.d(n,"b",(function(){return f}));var l=t(27),r=t.n(l),a=t(13),i=t.n(a),o=t(0),u=t(59),s=t(5),d=t(197),c=t(200);function m(e,n){var t=Object(c.a)(),l=e[t];return l||d.a[t][n]}function p(e){var n=e.style,t=e.lightColor,l=e.darkColor,a=i()(e,["style","lightColor","darkColor"]),s=m({light:t,dark:l},"text");return o.createElement(u.a,r()({style:[{color:s},n]},a))}function f(e){var n=e.style,t=e.lightColor,l=e.darkColor,a=i()(e,["style","lightColor","darkColor"]),u=m({light:t,dark:l},"background");return o.createElement(s.a,r()({style:[{backgroundColor:u},n]},a))}},448:function(e,n,t){"use strict";t.d(n,"a",(function(){return s}));var l=t(0),r=t.n(l),a=t(4),i=t(407),o=t(421),u=t(404);function s(e){var n=e.title,t=e.subtitle;return r.a.createElement(u.b,{style:d.empty},r.a.createElement(i.a,null,n),r.a.createElement(o.a,{style:{textAlign:"center"}},t))}var d=a.a.create({container:{flex:1,padding:8,display:"flex"},fab:{position:"absolute",margin:16,right:0,bottom:0},empty:{flex:1,alignItems:"center",justifyContent:"center",width:"100%",height:"100%"}})},529:function(e,n,t){"use strict";t.r(n),t.d(n,"default",(function(){return ke}));var l,r,a=t(7),i=t.n(a),o=t(6),u=t.n(o),s=t(405),d=t.n(s),c=t(120),m=t(73),p=t(537),f=t(88),v=t(0),b=t.n(v),g=t(53),h=t(4),y=t(528),E=t(390),I=t(417),j=t(10),x=t.n(j),O=t(413),S=t(429),z=t(203),k=t(60),T=t(16),w=t.n(T),P=t(89),C=t(412),N=t(194),$=t(425),F=t(420),A=t(428),D=t(183),M=t(419),L=Object(f.a)(l||(l=d()(["\n  query JumpTypes($allowedForUserId: Int) {\n    jumpTypes(allowedForUserId: $allowedForUserId) {\n      id\n      name\n    }\n  }\n"])));function U(e){var n,t,l=Object(v.useState)(!1),r=u()(l,2),a=r[0],i=r[1],o=(Object(k.h)((function(e){return e.global})),Object(c.useQuery)(L,{variables:{allowedForUserId:e.userId}})),s=o.data;o.loading,o.refetch;return b.a.createElement(b.a.Fragment,null,b.a.createElement(N.a.Subheader,null,"Jump type"),b.a.createElement(M.a,{onDismiss:function(){return i(!1)},visible:a,anchor:b.a.createElement(N.a.Item,{onPress:function(){i(!0)},title:(null==(n=e.value)?void 0:n.name)||"Please select jump type",description:e.required?null:"Optional"})},null==s||null==(t=s.jumpTypes)?void 0:t.map((function(n){return b.a.createElement(N.a.Item,{onPress:function(){i(!1),e.onSelect(n)},title:n.name||"-"})}))))}var W=Object(f.a)(r||(r=d()(["\n  query TicketTypes($allowManifestingSelf: Boolean, $dropzoneId: Int!) {\n    ticketTypes(allowManifestingSelf: $allowManifestingSelf, dropzoneId: $dropzoneId) {\n      id\n      name\n\n      extras {\n        id\n        name\n        cost\n      }\n    }\n  }\n"])));function q(e){var n,t,l,r=Object(v.useState)(!1),a=u()(r,2),i=a[0],o=a[1],s=Object(k.h)((function(e){return e.global})),d=Object(c.useQuery)(W,{variables:{dropzoneId:Number(null==(n=s.currentDropzone)?void 0:n.id),allowManifestingSelf:e.allowManifestingSelf}}),m=d.data;d.loading,d.refetch;return b.a.createElement(b.a.Fragment,null,b.a.createElement(N.a.Subheader,null,"Ticket"),b.a.createElement(M.a,{onDismiss:function(){return o(!1)},visible:i,anchor:b.a.createElement(N.a.Item,{onPress:function(){o(!0)},title:(null==(t=e.value)?void 0:t.name)||"Please select ticket type",description:e.required?null:"Optional"})},null==m||null==(l=m.ticketTypes)?void 0:l.map((function(n){return b.a.createElement(N.a.Item,{onPress:function(){o(!1),e.onSelect(n)},title:n.name||"-"})}))))}var J,Q=t(441),H=Object(f.a)(J||(J=d()(["\n  query QueryRigs(\n    $dropzoneId: Int\n    $userId: Int\n  ) {\n    rigs(dropzoneId: $dropzoneId, userId: $userId) {\n      id\n      make\n      model\n      canopySize\n      serial\n    }\n  }\n"])));function B(e){var n,t,l,r,a,i=Object(v.useState)(!1),o=u()(i,2),s=o[0],d=o[1],m=Object(k.h)((function(e){return e.global})),p=Object(c.useQuery)(H,{variables:{dropzoneId:Number(null==(n=m.currentDropzone)?void 0:n.id)}}).data;return b.a.createElement(M.a,{onDismiss:function(){return d(!1)},visible:s,anchor:b.a.createElement(N.a.Item,{onPress:function(){d(!0)},title:e.value?(null==(t=e.value)?void 0:t.make)+" "+(null==(l=e.value)?void 0:l.model)+" ("+((null==(r=e.value)?void 0:r.canopySize)||"?")+"sqft)":"Select rig",description:e.required?null:"Optional",left:function(){return b.a.createElement(N.a.Icon,{icon:"parachute"})}})},null==p||null==(a=p.rigs)?void 0:a.map((function(n){var t,l,r;return b.a.createElement(N.a.Item,{onPress:function(){d(!1),e.onSelect(n)},title:(null==(t=e.value)?void 0:t.make)+" "+(null==(l=e.value)?void 0:l.model),description:(null==(r=e.value)?void 0:r.canopySize)+" sqft"})})))}var V=D.a.actions;function R(){var e,n,t,l,r,a,i,o,u,s,d,c,m,p,f,b,g,h,y,E,I,j,x,O,S=Object(k.h)((function(e){return e.slotForm})),z=Object(k.g)(),T=Object(k.h)((function(e){return e.global}));v.useEffect((function(){var e,n;null!=(e=S.fields.user)&&e.value&&(S.fields.exitWeight.value||z(V.setField(["exitWeight",Number(S.fields.user.value.exitWeight||60)])),!S.fields.rig.value&&null!=(n=S.fields.user.value.rigs)&&n.length&&z(V.setField(["rig",S.fields.user.value.rigs[0]])))}),[null==(e=S.fields)||null==(n=e.user)||null==(t=n.value)?void 0:t.id]);var D=null==S||null==(l=S.original)?void 0:l.id,M=(null==S||null==(r=S.fields)||null==(a=r.user)||null==(i=a.value)||i.id,null==(o=T.currentUser)||o.id,Object(Q.a)(D?"updateSlot":"createSlot"),Object(Q.a)(D?"updateUserSlot":"createUserSlot"));return console.log("Fields",S.fields),v.createElement(v.Fragment,null,v.createElement(U,{value:S.fields.jumpType.value,required:!0,userId:Number(null==S||null==(u=S.fields)||null==(s=u.user)||null==(d=s.value)?void 0:d.id)||null,onSelect:function(e){return z(V.setField(["jumpType",e]))}}),v.createElement(C.a,{type:S.fields.jumpType.error?"error":"info"},S.fields.jumpType.error||""),v.createElement(q,{value:S.fields.ticketType.value,required:!0,allowManifestingSelf:!M,onSelect:function(e){return z(V.setField(["ticketType",e]))}}),v.createElement(C.a,{type:S.fields.ticketType.error?"error":"info"},S.fields.ticketType.error||""),(null==S||null==(c=S.fields)||null==(m=c.ticketType)||null==(p=m.value)||null==(f=p.extras)?void 0:f.length)&&v.createElement(N.a.Subheader,null,"Ticket addons"),v.createElement(P.a,{horizontal:!0,style:G.ticketAddons},null==S||null==(b=S.fields)||null==(g=b.ticketType)||null==(h=g.value)||null==(y=h.extras)?void 0:y.map((function(e){var n,t,l,r;return v.createElement($.a,{selected:null==S||null==(n=S.fields)||null==(t=n.extras.value)?void 0:t.some((function(n){return n.id===e.id})),onPress:null!=S&&null!=(l=S.fields)&&null!=(r=l.extras.value)&&r.some((function(n){return n.id===e.id}))?function(){var n,t;return z(V.setField(["extras",null==S||null==(n=S.fields)||null==(t=n.extras.value)?void 0:t.filter((function(n){return n.id!==e.id}))]))}:function(){var n,t;return z(V.setField(["extras",[].concat(w()((null==S||null==(n=S.fields)||null==(t=n.extras)?void 0:t.value)||[]),[e])]))}},e.name+" ($"+e.cost+")")}))),v.createElement(C.a,{type:S.fields.extras.error?"error":"info"},S.fields.extras.error||""),v.createElement(F.a,null),v.createElement(B,{value:S.fields.rig.value,userId:Number(null==(E=S.fields.user)||null==(I=E.value)?void 0:I.id),dropzoneId:Number(null==(j=T.currentDropzone)?void 0:j.id),onSelect:function(e){return z(V.setField(["jumpType",e]))}}),v.createElement(C.a,{type:S.fields.rig.error?"error":"info"},S.fields.rig.error||""),v.createElement(A.a,{style:G.field,mode:"outlined",label:"Exit weight",error:!!S.fields.exitWeight.error,value:(null==(x=S.fields.exitWeight)||null==(O=x.value)?void 0:O.toString())||"",keyboardType:"numbers-and-punctuation",right:function(){return v.createElement(A.a.Affix,{text:"kg"})},onChangeText:function(e){return z(V.setField(["exitWeight",Number(e)]))}}),v.createElement(C.a,{type:S.fields.exitWeight.error?"error":"info"},S.fields.exitWeight.error||""))}var _,G=h.a.create({fields:{flex:1},field:{marginBottom:8},ticketAddons:{marginBottom:8}}),Y=Object(c.gql)(_||(_=d()(["\n  mutation CreateSlot(\n    $jumpTypeId: Int\n    $extraIds: [Int!]\n    $loadId: Int\n    $rigId: Int\n    $ticketTypeId: Int\n    $userId: Int\n    $exitWeight: Float\n  ) {\n    createSlot(\n      input: {\n        attributes: {\n          jumpTypeId: $jumpTypeId\n          extraIds: $extraIds\n          loadId: $loadId\n          rigId: $rigId\n          ticketTypeId: $ticketTypeId\n          userId: $userId\n          exitWeight: $exitWeight\n        }\n      }\n    ) {\n      errors\n      fieldErrors {\n        field\n        message\n      }\n      slot {\n        id\n        jumpType {\n          id\n          name\n        }\n        extras {\n          id\n          name\n        }\n        exitWeight\n        load {\n          id\n          name\n          createdAt\n          dispatchAt\n          hasLanded\n          maxSlots\n          isFull\n          isOpen\n          plane {\n            id\n            name\n          }\n          gca {\n            id\n            user {\n              id\n              name\n            }\n          }\n          pilot {\n            id\n            user {\n              id\n              name\n            }\n          }\n          loadMaster {\n            id\n            user {\n              id\n              name\n            }\n          }\n          slots {\n            id\n            createdAt\n            user {\n              id\n              name\n            }\n            ticketType {\n              id\n              name\n              altitude\n            }\n            jumpType {\n              id\n              name\n            }\n            extras {\n              id\n              name\n            }\n          }\n        }\n      }\n    }\n  }\n"])));function K(e){var n,t,l,r,a,i=Object(k.g)(),o=Object(k.h)((function(e){return e.slotForm})),s=Object(k.h)((function(e){return e.global})),d=Object(c.useMutation)(Y),m=u()(d,2),p=m[0],f=m[1],g=Object(v.useCallback)((function(){var e,n,t=!1;return null!=(e=o.fields.jumpType.value)&&e.id||(t=!0,i(k.e.setFieldError(["jumpType","You must specify the type of jump"]))),null!=(n=o.fields.ticketType.value)&&n.id||(t=!0,i(k.e.setFieldError(["ticketType","You must select a ticket type to manifest"]))),!t}),[JSON.stringify(o.fields)]),h=Object(v.useCallback)((function(){var n,t,l,r,a,u,s,d,c,m,f,v,b,h,y,E,I,j,O,S,z,T;return x.a.async((function(w){for(;;)switch(w.prev=w.next){case 0:if(g()){w.next=2;break}return w.abrupt("return");case 2:return w.prev=2,w.next=5,x.a.awrap(p({variables:{jumpTypeId:Number(null==(n=o.fields.jumpType.value)?void 0:n.id),extraIds:null==(t=o.fields.extras)||null==(l=t.value)?void 0:l.map((function(e){var n=e.id;return Number(n)})),loadId:Number(null==(r=o.fields.load.value)?void 0:r.id),rigId:null!=(a=o.fields.rig.value)&&a.id?Number(null==(u=o.fields.rig.value)?void 0:u.id):null,ticketTypeId:Number(null==(s=o.fields.ticketType)||null==(d=s.value)?void 0:d.id),userId:Number(null==(c=o.fields.user)||null==(m=c.value)?void 0:m.id),exitWeight:o.fields.exitWeight.value}}));case 5:if(S=w.sent,null==(f=S.data)||null==(v=f.createSlot)||null==(b=v.fieldErrors)||b.map((function(e){var n=e.field,t=e.message;switch(n){case"jump_type":return i(k.e.setFieldError(["jumpType",t]));case"load":return i(k.e.setFieldError(["load",t]));case"credits":case"extras":case"extra_ids":return i(k.e.setFieldError(["extras",t]));case"ticket_type":return i(k.e.setFieldError(["ticketType",t]));case"rig":return i(k.e.setFieldError(["rig",t]));case"user":return i(k.e.setFieldError(["user",t]));case"exit_weight":return i(k.e.setFieldError(["exitWeight",t]))}})),null==S||null==(h=S.data)||null==(y=h.createSlot)||null==(E=y.errors)||!E.length){w.next=9;break}return w.abrupt("return",i(k.f.showSnackbar({message:null==S||null==(z=S.data)||null==(T=z.createSlot)?void 0:T.errors[0],variant:"error"})));case 9:null!=(I=S.data)&&null!=(j=I.createSlot)&&null!=(O=j.fieldErrors)&&O.length||e.onSuccess(),w.next=15;break;case 12:w.prev=12,w.t0=w.catch(2),i(k.f.showSnackbar({message:w.t0.message,variant:"error"}));case 15:case"end":return w.stop()}}),null,null,[[2,12]],Promise)}),[JSON.stringify(o.fields),p,e.onSuccess]);return b.a.createElement(O.a,null,b.a.createElement(S.a,{visible:!!e.open},b.a.createElement(E.a,{indeterminate:!0,visible:f.loading,color:s.theme.colors.accent}),b.a.createElement(S.a.Title,null,"Manifest "+(null==o||null==(n=o.fields)||null==(t=n.user)||null==(l=t.value)?void 0:l.name)+" on "+(null==(r=o.fields.load)||null==(a=r.value)?void 0:a.name)),b.a.createElement(S.a.Content,null,b.a.createElement(R,null)),b.a.createElement(S.a.Actions,{style:{justifyContent:"flex-end"}},b.a.createElement(z.a,{onPress:function(){i(k.e.reset()),e.onClose()}},"Cancel"),b.a.createElement(z.a,{onPress:h},"Manifest"))))}var X=t(448),Z=t(404),ee=t(242);function ne(e){var n=e.hasPlanes,t=e.hasTicketTypes,l=(e.isPublic,Object(ee.a)());return v.createElement(Z.b,{style:{width:"70%"}},v.createElement(Z.a,{style:re.title},"Set up dropzone"),v.createElement(Z.b,{style:re.separator,lightColor:"#eee",darkColor:"rgba(255,255,255,0.1)"}),v.createElement(N.a.Item,{title:"Create dropzone",left:function(){return v.createElement(N.a.Icon,{color:l.success,icon:"check"})}}),v.createElement(N.a.Item,{title:"Add a plane",left:function(){return n?v.createElement(N.a.Icon,{color:l.success,icon:"check"}):v.createElement(N.a.Icon,{color:l.error,icon:"close"})}}),v.createElement(N.a.Item,{title:"Configure jump tickets",left:function(){return t?v.createElement(N.a.Icon,{color:l.success,icon:"check"}):v.createElement(N.a.Icon,{color:l.error,icon:"close"})}}))}var te,le,re=h.a.create({container:{flex:1,alignItems:"center",justifyContent:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"}}),ae=t(411),ie=t(415),oe=t(421),ue=t(506),se=t(534),de=Object(f.a)(te||(te=d()(["\n  query QueryDropzoneUsers(\n    $dropzoneId: Int!\n    $permissions: [Permission!]\n  ) {\n    dropzone(id: $dropzoneId) {\n      id\n      name\n\n      dropzoneUsers(permissions: $permissions) {\n        edges {\n          node {\n            id\n            role {\n              id\n              name\n            }\n            user {\n              id\n              name\n            }\n          }\n        }\n      }\n    }\n  }\n"])));function ce(e){var n,t,l,r,a,i,o,s=Object(v.useState)(!1),d=u()(s,2),m=d[0],p=d[1],f=Object(k.h)((function(e){return e.global})),g=Object(c.useQuery)(de,{variables:{dropzoneId:Number(null==(n=f.currentDropzone)?void 0:n.id),permissions:["actAsGCA"]}}).data;return Object(Q.a)("updateLoad")?b.a.createElement(M.a,{onDismiss:function(){return p(!1)},visible:m,anchor:b.a.createElement($.a,{mode:"outlined",icon:"radio-handheld",style:{marginHorizontal:4},onPress:function(){return p(!0)}},null!=(l=e.value)&&l.id?null==(r=e.value)?void 0:r.name:"No gca")},null==g||null==(a=g.dropzone)||null==(i=a.dropzoneUsers)||null==(o=i.edges)?void 0:o.map((function(n){var t,l;return b.a.createElement(N.a.Item,{onPress:function(){var t;p(!1),e.onSelect(null==n||null==(t=n.node)?void 0:t.user)},title:null==n||null==(t=n.node)||null==(l=t.user)?void 0:l.name})}))):b.a.createElement($.a,{mode:"outlined",icon:"radio-handheld"},(null==(t=e.value)?void 0:t.name)||"No gca")}function me(e){var n,t,l,r,a=Object(v.useState)(!1),i=u()(a,2),o=i[0],s=i[1],d=Object(Q.a)("updateLoad");return d?b.a.createElement(M.a,{onDismiss:function(){return s(!1)},visible:o,anchor:b.a.createElement($.a,{mode:"outlined",icon:"parachute",style:{marginHorizontal:4},onPress:function(){return d&&s(!0)}},null!=(t=e.value)&&t.id?null==(l=e.value)?void 0:l.name:"No loadmaster")},null==(r=e.slots)?void 0:r.map((function(n){var t;return b.a.createElement(N.a.Item,{onPress:function(){s(!1),e.onSelect(n.user)},title:null==n||null==(t=n.user)?void 0:t.name})}))):b.a.createElement($.a,{mode:"outlined",icon:"radio-handheld"},(null==(n=e.value)?void 0:n.name)||"No loadmaster")}var pe,fe=Object(f.a)(le||(le=d()(["\n  query QueryDropzoneUsers(\n    $dropzoneId: Int!\n    $permissions: [Permission!]\n  ) {\n    dropzone(id: $dropzoneId) {\n      id\n      name\n\n      dropzoneUsers(permissions: $permissions) {\n        edges {\n          node {\n            id\n            role {\n              id\n              name\n            }\n            user {\n              id\n              name\n            }\n          }\n        }\n      }\n    }\n  }\n"])));function ve(e){var n,t,l,r,a,i,o,s=Object(v.useState)(!1),d=u()(s,2),m=d[0],p=d[1],f=Object(k.h)((function(e){return e.global})),g=Object(c.useQuery)(fe,{variables:{dropzoneId:Number(null==(n=f.currentDropzone)?void 0:n.id),permissions:["actAsPilot"]}}).data;return Object(Q.a)("updateLoad")?b.a.createElement(M.a,{onDismiss:function(){return p(!1)},visible:m,anchor:b.a.createElement($.a,{mode:"outlined",icon:"airplane-takeoff",style:{marginHorizontal:4},onPress:function(){return p(!0)}},null!=(l=e.value)&&l.id?null==(r=e.value)?void 0:r.name:"No pilot")},null==g||null==(a=g.dropzone)||null==(i=a.dropzoneUsers)||null==(o=i.edges)?void 0:o.map((function(n){var t,l;return b.a.createElement(N.a.Item,{onPress:function(){var t;p(!1),e.onSelect(null==n||null==(t=n.node)?void 0:t.user)},title:null==n||null==(t=n.node)||null==(l=t.user)?void 0:l.name})}))):b.a.createElement($.a,{mode:"outlined",icon:"radio-handheld"},(null==(t=e.value)?void 0:t.name)||"No pilot")}var be,ge,he=Object(f.a)(pe||(pe=d()(["\n  query QueryPlanes(\n    $dropzoneId: Int!\n  ) {\n    planes(dropzoneId: $dropzoneId) {\n      id\n      name\n      registration\n      hours\n      minSlots\n      maxSlots\n      nextMaintenanceHours\n      createdAt\n    }\n  }\n"])));function ye(e){var n,t,l,r,a=Object(v.useState)(!1),i=u()(a,2),o=i[0],s=i[1],d=Object(k.h)((function(e){return e.global})),m=Object(c.useQuery)(he,{variables:{dropzoneId:Number(null==(n=d.currentDropzone)?void 0:n.id)}}).data,p=Object(Q.a)("updateLoad");return p?b.a.createElement(M.a,{onDismiss:function(){return s(!1)},visible:o,anchor:b.a.createElement($.a,{mode:"outlined",icon:"airplane",style:{marginHorizontal:4},onPress:function(){return p&&s(!0)}},(null==(l=e.value)?void 0:l.name)||"No plane")},null==m||null==(r=m.planes)?void 0:r.map((function(n){return b.a.createElement(N.a.Item,{onPress:function(){s(!1),e.onSelect(n)},title:n.name})}))):b.a.createElement($.a,{mode:"outlined",icon:"airplane-takeoff"},(null==(t=e.value)?void 0:t.name)||"No plane")}var Ee=Object(c.gql)(be||(be=d()(["\n  query QueryLoad($id: Int!) {\n    load(id: $id) {\n      id\n      name\n      createdAt\n      dispatchAt\n      hasLanded\n      maxSlots\n      loadNumber\n      isFull\n      isOpen\n      plane {\n        id\n        name\n      }\n      gca {\n        id\n        user {\n          id\n          name\n        }\n      }\n      pilot {\n        id\n        user {\n          id\n          name\n        }\n      }\n      loadMaster {\n        id\n        user {\n          id\n          name\n        }\n      }\n      slots {\n        id\n        createdAt\n        exitWeight\n        user {\n          id\n          name\n        }\n        ticketType {\n          id\n          name\n          altitude\n\n          extras {\n            id\n            name\n            cost\n          }\n        }\n        jumpType {\n          id\n          name\n        }\n        extras {\n          id\n          name\n        }\n      }\n    }\n  }\n"]))),Ie=Object(c.gql)(ge||(ge=d()(["\n  mutation UpdateLoad(\n    $id: Int!,\n    $pilotId: Int,\n    $gcaId: Int,\n    $planeId: Int,\n    $isOpen: Boolean,\n    $loadMasterId: Int,\n    $dispatchAt: Int,\n    $hasLanded: Boolean,\n  ){\n    updateLoad(input: {\n      id: $id\n      attributes: {\n        pilotId: $pilotId,\n        gcaId: $gcaId,\n        planeId: $planeId,\n        isOpen: $isOpen,\n        loadMasterId: $loadMasterId\n        dispatchAt: $dispatchAt\n        hasLanded: $hasLanded\n      }\n    }) {\n      load {\n        id\n        name\n        createdAt\n        loadNumber\n        dispatchAt\n        hasLanded\n        maxSlots\n        isFull\n        isOpen\n        plane {\n          id\n          name\n        }\n        gca {\n          id\n          user {\n            id\n            name\n          }\n        }\n        pilot {\n          id\n          user {\n            id\n            name\n          }\n        }\n        loadMaster {\n          id\n          user {\n            id\n            name\n          }\n        }\n        slots {\n          id\n          createdAt\n          exitWeight\n          user {\n            id\n            name\n          }\n          ticketType {\n            id\n            name\n            altitude\n          }\n          jumpType {\n            id\n            name\n          }\n          extras {\n            id\n            name\n          }\n        }\n      }\n    }\n  }\n"])));function je(e){var n,t,l,r,a,i,o,s,d,p,f,b,g,h,y,I,j,O,S,T,w,C,$,F,A,D,L=Object(k.h)((function(e){return e.global})),U=v.useState(!1),W=u()(U,2),q=W[0],J=W[1],H=v.useState(!1),B=u()(H,2),V=B[0],R=B[1],_=(Object(m.useNavigation)(),e.load),G=(e.loadNumber,e.onManifest),Y=e.canManifest,K=Object(c.useQuery)(Ee,{variables:{id:Number(_.id)}}),X=K.data,ee=K.loading,ne=Object(c.useMutation)(Ie),te=u()(ne,2),le=te[0],re=te[1],de=v.useCallback((function(e){return x.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,x.a.awrap(le({variables:{id:Number(_.id),pilotId:Number(e.id)}}));case 3:n.next=7;break;case 5:n.prev=5,n.t0=n.catch(0);case 7:case"end":return n.stop()}}),null,null,[[0,5]],Promise)}),[le,JSON.stringify(_)]),pe=v.useCallback((function(e){return x.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,x.a.awrap(le({variables:{id:Number(_.id),gcaId:Number(e.id)}}));case 3:n.next=7;break;case 5:n.prev=5,n.t0=n.catch(0);case 7:case"end":return n.stop()}}),null,null,[[0,5]],Promise)}),[le,JSON.stringify(_)]),fe=v.useCallback((function(e){return x.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,x.a.awrap(le({variables:{id:Number(_.id),planeId:Number(e.id)}}));case 3:n.next=7;break;case 5:n.prev=5,n.t0=n.catch(0);case 7:case"end":return n.stop()}}),null,null,[[0,5]],Promise)}),[le,JSON.stringify(_)]),be=v.useCallback((function(e){return x.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,x.a.awrap(le({variables:{id:Number(_.id),loadMasterId:Number(e.id)}}));case 3:n.next=7;break;case 5:n.prev=5,n.t0=n.catch(0);case 7:case"end":return n.stop()}}),null,null,[[0,5]],Promise)}),[le,JSON.stringify(_)]),ge=v.useCallback((function(e){var n;return x.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e?Object(ue.a)(new Date,e).getTime()/1e3:null,t.prev=1,t.next=4,x.a.awrap(le({variables:{id:Number(_.id),dispatchAt:n?Math.ceil(n):null}}));case 4:t.next=8;break;case 6:t.prev=6,t.t0=t.catch(1);case 8:case"end":return t.stop()}}),null,null,[[1,6]],Promise)}),[le,JSON.stringify(_)]),he=v.useCallback((function(){return x.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.a.awrap(le({variables:{id:Number(_.id),hasLanded:!0}}));case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:case"end":return e.stop()}}),null,null,[[0,5]],Promise)}),[le,JSON.stringify(_)]),je=Object(Q.a)("updateLoad"),xe=Object(Q.a)("updateSlot"),Oe=Object(Q.a)("updateUserSlot"),Se=v.useCallback((function(n){var t,l;if((null==n||null==(t=n.user)?void 0:t.id)===(null==(l=L.currentUser)?void 0:l.id)||Oe)return function(){var t,l;(null==(t=n.user)?void 0:t.id)===(null==(l=L.currentUser)?void 0:l.id)?xe&&e.onSlotPress(n):Oe&&e.onSlotPress(n)}}),[JSON.stringify(_),Oe,e.onSlotPress]);return v.useEffect((function(){var e,n;null!=X&&null!=(e=X.load)&&e.maxSlots&&(null==X||null==(n=X.load)?void 0:n.maxSlots)<5&&!q&&J(!0)}),[null==X||null==(n=X.load)?void 0:n.maxSlots]),v.createElement(ae.a,{style:{margin:16},elevation:3},v.createElement(ae.a.Title,{title:"Load "+(null==X||null==(t=X.load)?void 0:t.loadNumber),subtitle:_.name}),v.createElement(E.a,{visible:ee||re.loading,color:L.theme.colors.accent}),v.createElement(ae.a.Content,{style:{marginVertical:8,height:q?void 0:300,overflow:"hidden"}},v.createElement(Z.b,{style:{flexDirection:"row"}},v.createElement(P.a,{horizontal:!0},v.createElement(ye,{dropzoneId:Number(null==(l=L.currentDropzone)?void 0:l.id),value:null==X||null==(r=X.load)?void 0:r.plane,onSelect:fe}),v.createElement(ce,{dropzoneId:Number(null==(a=L.currentDropzone)?void 0:a.id),value:null==X||null==(i=X.load)||null==(o=i.gca)?void 0:o.user,onSelect:pe}),v.createElement(ve,{dropzoneId:Number(null==(s=L.currentDropzone)?void 0:s.id),value:null==X||null==(d=X.load)||null==(p=d.pilot)?void 0:p.user,onSelect:de}),v.createElement(me,{dropzoneId:Number(null==(f=L.currentDropzone)?void 0:f.id),value:null==X||null==(b=X.load)||null==(g=b.loadMaster)?void 0:g.user,slots:(null==X?void 0:X.load.slots)||[],onSelect:be}))),v.createElement(ie.a,null,v.createElement(ie.a.Header,{style:{width:"100%"}},v.createElement(ie.a.Title,null,"Name"),v.createElement(ie.a.Title,{numeric:!0},"Exit weight"),v.createElement(ie.a.Title,{numeric:!0},"Jump type"),v.createElement(ie.a.Title,{numeric:!0},"Altitude")),null==X||null==(h=X.load)||null==(y=h.slots)?void 0:y.map((function(e){var n,t,l;return v.createElement(ie.a.Row,{onPress:Se(e),pointerEvents:"none"},v.createElement(ie.a.Cell,null,null==e||null==(n=e.user)?void 0:n.name),v.createElement(ie.a.Cell,{numeric:!0},null==e?void 0:e.exitWeight),v.createElement(ie.a.Cell,{numeric:!0},null==e||null==(t=e.jumpType)?void 0:t.name),v.createElement(ie.a.Cell,{numeric:!0},null==e||null==(l=e.ticketType)?void 0:l.altitude))})),Array.from({length:((null==_?void 0:_.maxSlots)||0)-((null==_||null==(I=_.slots)?void 0:I.length)||0)},(function(e,n){return n})).map((function(){return v.createElement(ie.a.Row,null,v.createElement(ie.a.Cell,null,"- Available -"),v.createElement(ie.a.Cell,{numeric:!0},"-"),v.createElement(ie.a.Cell,{numeric:!0},"-"),v.createElement(ie.a.Cell,{numeric:!0},"-"))})))),!(null==X||null==(j=X.load)||!j.dispatchAt)&&(null==X||null==(O=X.load)?void 0:O.dispatchAt)>(new Date).getTime()/1e3&&v.createElement(Z.b,{style:{flex:1,backgroundColor:"#FF8800",padding:8}},v.createElement(oe.a,null,"Take-off in "+Object(se.a)(new Date,1e3*(null==X||null==(S=X.load)?void 0:S.dispatchAt))+" min")),v.createElement(ae.a.Actions,null,null!=X&&null!=(T=X.load)&&T.maxSlots&&(null==X||null==(w=X.load)?void 0:w.maxSlots)<5?null:v.createElement(z.a,{onPress:function(){return J(!q)}},q?"Show less":"Show more"),v.createElement(Z.b,{style:{flexGrow:1}}),!je||null!=X&&null!=(C=X.load)&&C.hasLanded?null:null!=X&&null!=($=X.load)&&$.dispatchAt?v.createElement(z.a,{mode:"outlined",onPress:function(){return ge(null)}},"Cancel"):v.createElement(M.a,{onDismiss:function(){return R(!1)},visible:V,anchor:v.createElement(z.a,{mode:"outlined",onPress:function(){return R(!0)}},"Dispatch")},v.createElement(N.a.Item,{onPress:function(){R(!1),ge(20)},title:"20 minute call"}),v.createElement(N.a.Item,{onPress:function(){R(!1),ge(15)},title:"15 minute call"}),v.createElement(N.a.Item,{onPress:function(){R(!1),ge(10)},title:"10 minute call"}),v.createElement(N.a.Item,{onPress:function(){R(!1),ge(5)},title:"5 minute call"})),null!=X&&null!=(F=X.load)&&F.hasLanded?null:null!=X&&null!=(A=X.load)&&A.dispatchAt&&(null==X?void 0:X.load.dispatchAt)<(new Date).getTime()/1e3&&je?v.createElement(z.a,{style:{marginLeft:8},mode:"contained",onPress:function(){return he()}},"Mark as landed"):v.createElement(z.a,{style:{marginLeft:8},mode:"contained",onPress:function(){return G()},disabled:!Y||Boolean((null==X||null==(D=X.load)?void 0:D.dispatchAt)&&X.load.dispatchAt<(new Date).getTime()/1e3)},"Manifest")))}var xe;h.a.create({container:{flex:1,alignItems:"center",justifyContent:"center",marginVertical:8},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fab:{position:"absolute",margin:16,right:0,bottom:0}});function Oe(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);n&&(l=l.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,l)}return t}function Se(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Oe(Object(t),!0).forEach((function(n){i()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Oe(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var ze=Object(f.a)(xe||(xe=d()(["\n  query QueryDropzone($dropzoneId: Int!, $earliestTimestamp: Int) {\n    dropzone(id: $dropzoneId) {\n      id\n      name\n      primaryColor,\n      secondaryColor,\n      planes {\n        id\n        name\n        registration\n      }\n      ticketTypes {\n        id\n        name\n      }\n\n      currentUser {\n        id\n        user {\n          id\n          name\n          exitWeight\n          email\n          phone\n          rigs {\n            id\n            model\n            make\n            serial\n            canopySize\n            repackExpiresAt\n          }\n          jumpTypes {\n            id\n            name\n          }\n          license {\n            id\n            name\n          }\n        }\n      }\n\n      loads(earliestTimestamp: $earliestTimestamp) {\n        edges {\n          node {\n            id\n            name\n            isOpen\n            maxSlots\n            isFull\n          }\n        }\n      }\n    }\n  }\n"])));function ke(){var e,n,t,l,r,a,i,o,s,d,f,b,h,j=Object(k.h)((function(e){return e.global})),x=v.useState(!1),O=u()(x,2),S=O[0],z=O[1],T=Object(k.g)(),w=Object(c.useQuery)(ze,{variables:{dropzoneId:Number(null==(e=j.currentDropzone)?void 0:e.id),earliestTimestamp:Object(p.a)(new Date).getTime()/1e3},fetchPolicy:"no-cache"}),P=w.data,C=w.loading,N=w.refetch,$=Object(m.useNavigation)(),F=Object(m.useIsFocused)();v.useEffect((function(){F&&N()}),[F]);var A=!(null==P||null==(n=P.dropzone)||null==(t=n.planes)||!t.length),D=!(null==P||null==(l=P.dropzone)||null==(r=l.ticketTypes)||!r.length),M=!(null==P||null==(a=P.dropzone)||!a.isPublic),L=A&&D;v.useEffect((function(){var e,n;null!=P&&null!=(e=P.dropzone)&&e.id&&(T(k.b.setDropzone(P.dropzone)),T(k.b.setUser(Se(Se({},null==j?void 0:j.currentUser),(null==P||null==(n=P.dropzone)?void 0:n.currentUser.user)||{}))))}),[JSON.stringify(null==P?void 0:P.dropzone)]),v.useEffect((function(){var e,n,t,l,r,a,i,o;null!=P&&null!=(e=P.dropzone)&&e.primaryColor&&(null==P||null==(n=P.dropzone)?void 0:n.primaryColor)!==(null==(t=j.theme)||null==(l=t.colors)?void 0:l.primary)&&T(k.b.setPrimaryColor(P.dropzone.primaryColor)),null!=P&&null!=(r=P.dropzone)&&r.secondaryColor&&(null==P||null==(a=P.dropzone)?void 0:a.secondaryColor)!==(null==(i=j.theme)||null==(o=i.colors)?void 0:o.accent)&&T(k.b.setPrimaryColor(P.dropzone.secondaryColor))}),[null==P||null==(i=P.dropzone)?void 0:i.primaryColor,null==P||null==(o=P.dropzone)?void 0:o.secondaryColor]);var U=Object(Q.a)("createSlot"),W=Object(Q.a)("createLoad");return v.createElement(v.Fragment,null,v.createElement(K,{open:S,onClose:function(){return z(!1)},onSuccess:function(){return z(!1)}}),v.createElement(E.a,{visible:C,indeterminate:!0,color:j.theme.colors.accent}),v.createElement(Z.b,{style:Te.container},!C&&(L?v.createElement(Z.b,{style:{width:"100%",flex:1,height:g.a.get("window").height}},((null==P||null==(s=P.dropzone)||null==(d=s.loads)||null==(f=d.edges)?void 0:f.length)||0)<1?v.createElement(X.a,{title:"No loads so far today",subtitle:"How's the weather?"}):v.createElement(y.a,{style:{flex:1,height:g.a.get("window").height},contentContainerStyle:{flexGrow:1},numColumns:1,data:(null==P||null==(b=P.dropzone)||null==(h=b.loads)?void 0:h.edges)||[],refreshing:C,onRefresh:N,renderItem:function(e){var n,t,l,r,a,i=e.item,o=e.index;return null!=i&&i.node?v.createElement(je,{key:"load-"+i.node.id,load:i.node,canManifest:U&&(null==i||null==(n=i.node)?void 0:n.isOpen)&&!(null!=i&&null!=(t=i.node)&&t.isFull),loadNumber:((null==P||null==(l=P.dropzone)||null==(r=l.loads)||null==(a=r.edges)?void 0:a.length)||0)-o,onSlotPress:function(e){T(k.e.setOriginal(e)),T(k.e.setField(["load",i.node])),z(!0)},onManifest:function(){T(k.e.setField(["user",j.currentUser])),T(k.e.setField(["load",i.node])),z(!0)}}):null}})):v.createElement(ne,{hasPlanes:A,hasTicketTypes:D,isPublic:M})),W&&L&&v.createElement(I.a,{style:Te.fab,small:!0,icon:"plus",onPress:function(){return $.navigate("CreateLoadScreen")},label:"New load"})))}var Te=h.a.create({container:{flex:1,alignItems:"center",justifyContent:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fab:{position:"absolute",margin:16,right:0,bottom:0}})}}]);
//# sourceMappingURL=38.853322ee.chunk.js.map