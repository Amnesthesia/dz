(this.webpackJsonp=this.webpackJsonp||[]).push([[14],{482:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(143),a=n(256),i=r.a.actions;a.a},499:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var r,a=n(71),i=n.n(a),o=n(49),l=n(72),c=n(0),s=n(1),d=n(2),u=n(249),m=n(221),f=n(52),b=n(222),p=n(489),v=n(20),g=n(229).a.actions,k=Object(l.a)(r||(r=i()(["\n  query QueryTicketType(\n    $dropzoneId: Int!\n  ) {\n    ticketTypes(dropzoneId: $dropzoneId) {\n      id\n      cost\n      currency\n      name\n      allowManifestingSelf\n\n      extras {\n        id\n        name\n      }\n    }\n  }\n"])));function y(){var e,t,n,r=Object(v.k)((function(e){return e.extraForm})),a=Object(v.j)(),i=Object(v.k)((function(e){return e.global})),l=Object(o.useQuery)(k,{variables:{dropzoneId:Number(null==(e=i.currentDropzone)?void 0:e.id)}}),s=l.data;l.loading,l.refetch;return c.createElement(c.Fragment,null,c.createElement(u.a,{style:h.field,mode:"outlined",label:"Name",error:!!r.fields.name.error,value:r.fields.name.value,onChangeText:function(e){return a(g.setField(["name",e]))}}),c.createElement(m.a,{type:r.fields.name.error?"error":"info"},r.fields.name.error||""),c.createElement(u.a,{style:h.field,mode:"outlined",label:"Price",error:!!r.fields.cost.error,value:null==(t=r.fields.cost)||null==(n=t.value)?void 0:n.toString(),onChangeText:function(e){return a(g.setField(["cost",Number(e)]))}}),c.createElement(m.a,{type:r.fields.cost.error?"error":"info"},r.fields.cost.error||""),c.createElement(d.a,{style:{width:"100%"}},c.createElement(f.b.Subheader,null,"Compatible tickets"),null==s?void 0:s.ticketTypes.map((function(e){return c.createElement(b.a.Item,{label:e.name,status:r.fields.ticketTypeIds.value.includes(Number(e.id))?"checked":"unchecked",onPress:function(){return a(g.setField(["ticketTypeIds",Object(p.xor)(r.fields.ticketTypeIds.value,[Number(e.id)])]))}})}))))}var h=s.a.create({fields:{width:"100%",flex:1},field:{marginBottom:8,width:"100%"}})},527:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return j}));var r,a=n(9),i=n.n(a),o=n(71),l=n.n(o),c=n(11),s=n.n(c),d=n(0),u=n(1),m=n(116),f=n(49),b=n(20),p=n(36),v=n(482),g=n(112),k=n(229),y=n(499),h=n(40),I=n(169),x=n(351),E=k.a.actions,T=(g.a.actions,Object(f.gql)(r||(r=l()(["\n  mutation CreateExtra(\n    $name: String,\n    $ticketTypeIds: [Int!]\n    $cost: Float\n    $dropzoneId: Int\n  ){\n    createExtra(input: {\n      attributes: {\n        name: $name,\n        ticketTypeIds: $ticketTypeIds\n        cost: $cost\n        dropzoneId: $dropzoneId\n      }\n    }) {\n      extra {\n        id\n        name\n\n        ticketTypes {\n          id\n          name\n          cost\n          altitude\n          allowManifestingSelf\n        }\n      }\n    }\n  }\n"]))));function j(){var e=Object(b.k)((function(e){return e})),t=e.extraForm,n=e.global,r=Object(b.j)(),a=Object(h.useNavigation)(),o=Object(h.useIsFocused)();d.useEffect((function(){o&&r(E.reset())}),[o]);var l=Object(f.useMutation)(T),c=i()(l,2),u=c[0],g=c[1],k=d.useCallback((function(){var e=!1;return t.fields.name.value.length<3&&(e=!0,r(E.setFieldError(["name","Name is too short"]))),Number(t.fields.cost.value)<0&&(e=!0,r(E.setFieldError(["cost","Price must be a number"]))),!e}),[JSON.stringify(t.fields),r]),j=d.useCallback((function(){var e,i,o,l,c,d,m,f,b;return s.a.async((function(p){for(;;)switch(p.prev=p.next){case 0:if(e=t.fields,i=e.name,o=e.cost,l=e.ticketTypeIds,!k()){p.next=12;break}return p.prev=2,p.next=5,s.a.awrap(u({variables:{dropzoneId:Number(null==(c=n.currentDropzone)?void 0:c.id),name:i.value,cost:o.value,ticketTypeIds:l.value}}));case 5:f=p.sent,null!=(d=f.data)&&null!=(m=d.createExtra)&&m.extra&&(b=f.data.createExtra.extra,r(v.a.showSnackbar({message:"Added extra "+b.name,variant:"success"})),a.goBack()),p.next=12;break;case 9:p.prev=9,p.t0=p.catch(2),r(v.a.showSnackbar({message:p.t0.message,variant:"error"}));case 12:case"end":return p.stop()}}),null,null,[[2,9]],Promise)}),[JSON.stringify(t.fields),r,u]);return d.createElement(I.a,{contentContainerStyle:{paddingHorizontal:48}},d.createElement(x.a,{name:"ticket-percent",size:100,color:"#999999",style:{alignSelf:"center"}}),d.createElement(y.a,null),d.createElement(p.b,{style:w.fields},d.createElement(m.a,{mode:"contained",disabled:g.loading,onPress:j,loading:g.loading},"Save")))}var w=u.a.create({container:{flex:1,alignItems:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fields:{width:"100%",marginBottom:16},field:{width:"100%",marginBottom:8}})}}]);
//# sourceMappingURL=14.156f77c2.chunk.js.map