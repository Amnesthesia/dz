(this.webpackJsonp=this.webpackJsonp||[]).push([[0],{358:function(e,n,t){"use strict";t.d(n,"a",(function(){return Oi}));var r=t(360),a=t(0),l=t.n(a),i=t(481),o=t(168),s=t(309),u=t(297),c=t(130),d=t(2),m=t(307),f=t(3),p=t.n(f),g=t(15),v=t(175),b=t(313),h=t(314),y=t(55),E=t(39),S=t(13),x=t(315),I=t.n(x),k=t(240),z=t(125),O=t(256),w=t(102),C=t(126);function j(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function T(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?j(Object(t),!0).forEach((function(n){p()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):j(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var P=T(T(T({},w.a),z.a),{},{colors:T(T({},w.a.colors),z.a.colors)}),F=T(T(T({},C.a),O.a),{},{colors:T(T({},C.a.colors),O.a.colors)}),$={currentUser:null,currentDropzone:null,permissions:[],credentials:null,theme:P,isDarkMode:!1},N=Object(E.b)({name:"global",initialState:$,reducers:{setCredentials:function(e,n){e.credentials=n.payload},setUser:function(e,n){e.currentUser=n.payload},setPermissions:function(e,n){e.permissions=n.payload},setPrimaryColor:function(e,n){e.theme.colors.primary=n.payload},setAccentColor:function(e,n){e.theme.colors.accent=n.payload},setDropzone:function(e,n){var t,r,a,l;(e.currentDropzone=n.payload,null!=(t=e.currentDropzone)&&t.primaryColor)&&(e.theme.colors.primary=null==(a=e.currentDropzone)?void 0:a.primaryColor);null!=(r=e.currentDropzone)&&r.secondaryColor&&(e.theme.colors.accent=null==(l=e.currentDropzone)?void 0:l.secondaryColor)},toggleDarkMode:function(e){var n,t,r,a;(e.isDarkMode=!e.isDarkMode,e.theme=e.isDarkMode?F:P,null!=(n=e.currentDropzone)&&n.primaryColor)&&(e.theme.colors.primary=null==(r=e.currentDropzone)?void 0:r.primaryColor);null!=(t=e.currentDropzone)&&t.secondaryColor&&(e.theme.colors.accent=null==(a=e.currentDropzone)?void 0:a.secondaryColor)},logout:function(e){for(var n in $){var t=n;n in e&&(e[t]=$[t])}}}}),D=Object(E.b)({name:"notifications",initialState:{queue:[]},reducers:{hideSnackbar:function(e){e.queue=e.queue.slice(1)},showSnackbar:function(e,n){e.queue.push(n.payload)}}}),A={fields:{email:{value:"",error:null},password:{value:"",error:null}}},M=Object(E.b)({name:"login",initialState:A,reducers:{setEmail:function(e,n){e.fields.email.value=n.payload},setPassword:function(e,n){e.fields.password.value=n.payload},setEmailError:function(e,n){e.fields.email.error=n.payload},setPasswordError:function(e,n){e.fields.password.error=n.payload},reset:function(e){e.fields=A.fields}}}),U=t(6),q=t.n(U),R={federation:null,fields:{email:{value:"",error:null},password:{value:"",error:null},passwordConfirmation:{value:"",error:null},exitWeight:{value:50,error:null},name:{value:"",error:null},phone:{value:"",error:null},license:{value:null,error:null}}},B=Object(E.b)({name:"login",initialState:R,reducers:{setFederation:function(e,n){e.federation=n.payload},setField:function(e,n){var t=q()(n.payload,2),r=t[0],a=t[1];e.fields[r].value=a,e.fields[r].error=null},setFieldError:function(e,n){var t=q()(n.payload,2),r=t[0],a=t[1];e.fields[r].error=a},reset:function(e){e.fields=R.fields}}}),W={isSearchVisible:!1,searchText:""},L=Object(E.b)({name:"usersScreen",initialState:W,reducers:{setSearchText:function(e,n){e.searchText=n.payload},setSearchVisible:function(e,n){e.isSearchVisible=n.payload},reset:function(e){e.isSearchVisible=W.isSearchVisible,e.searchText=W.searchText}}}),H={original:null,fields:{federation:{value:null,error:null},name:{value:"",error:null},secondaryColor:{value:"",error:null},primaryColor:{value:"",error:null},banner:{value:"",error:null},isCreditSystemEnabled:{value:!1,error:null},isPublic:{value:!1,error:null}}},V=Object(E.b)({name:"dropzone",initialState:H,reducers:{setField:function(e,n){var t=q()(n.payload,2),r=t[0],a=t[1];e.fields[r].value=a,e.fields[r].error=null},setFieldError:function(e,n){var t=q()(n.payload,2),r=t[0],a=t[1];r in e.fields&&e.fields[r].error&&(e.fields[r].error=a)},setOriginal:function(e,n){for(var t in e.original=n.payload,n.payload)if(t in e.fields){var r=t;e.fields[r].value=n.payload[r]}},reset:function(e){e.fields=H.fields,e.original=null}}}),Q={original:null,fields:{name:{value:"",error:null},registration:{value:"",error:null},minSlots:{value:0,error:null},maxSlots:{value:4,error:null},hours:{value:null,error:null},nextMaintenanceHours:{value:null,error:null}}},J=Object(E.b)({name:"Plane",initialState:Q,reducers:{setField:function(e,n){var t=q()(n.payload,2),r=t[0],a=t[1];e.fields[r].value=a,e.fields.name.error=null},setFieldError:function(e,n){var t=q()(n.payload,2),r=t[0],a=t[1];e.fields[r].error=a},setOriginal:function(e,n){e.original=n.payload,e.fields.hours.value=n.payload.hours,e.fields.minSlots.value=n.payload.minSlots,e.fields.maxSlots.value=n.payload.maxSlots,e.fields.name.value=n.payload.name,e.fields.registration.value=n.payload.registration,e.fields.nextMaintenanceHours.value=n.payload.nextMaintenanceHours},reset:function(e){e.fields=Q.fields,e.original=null}}}),_={original:null,fields:{name:{value:"",error:null},cost:{value:null,error:null},altitude:{value:14e3,error:null},allowManifestingSelf:{value:!1,error:null},isTandem:{value:!1,error:null},extras:{value:[],error:null}}},G=Object(E.b)({name:"ticketTypeForm",initialState:_,reducers:{setField:function(e,n){var t=q()(n.payload,2),r=t[0],a=t[1];e.fields[r].value=a,e.fields[r].error=null},setFieldError:function(e,n){var t=q()(n.payload,2),r=t[0],a=t[1];e.fields[r].error=a},setOriginal:function(e,n){e.original=n.payload,e.fields.altitude.value=n.payload.altitude,e.fields.cost.value=n.payload.cost,e.fields.allowManifestingSelf.value=n.payload.allowManifestingSelf,e.fields.name.value=n.payload.name},reset:function(e){e.fields=_.fields,e.original=null}}}),Y={original:null,fields:{name:{value:"",error:null},cost:{value:null,error:null},ticketTypeIds:{value:[],error:null}}},Z=Object(E.b)({name:"ExtraForm",initialState:Y,reducers:{setField:function(e,n){var t=q()(n.payload,2),r=t[0],a=t[1];e.fields[r].value=a,e.fields.name.error=null},setFieldError:function(e,n){var t=q()(n.payload,2),r=t[0],a=t[1];e.fields[r].error=a},setOriginal:function(e,n){e.original=n.payload,e.fields.ticketTypeIds.value=n.payload.ticketTypes.map((function(e){var n=e.id;return Number(n)})),e.fields.cost.value=n.payload.cost,e.fields.name.value=n.payload.name},reset:function(e){e.fields=Y.fields,e.original=null}}}),K={original:null,fields:{name:{value:"",error:null},gca:{value:null,error:null},dispatchAt:{value:null,error:null},isOpen:{value:!0,error:null},loadMaster:{value:null,error:null},pilot:{value:null,error:null},plane:{value:null,error:null},maxSlots:{value:4,error:null}}},X=Object(E.b)({name:"loadForm",initialState:K,reducers:{setField:function(e,n){var t=q()(n.payload,2),r=t[0],a=t[1];e.fields[r].value=a,e.fields[r].error=null},setFieldError:function(e,n){var t=q()(n.payload,2),r=t[0],a=t[1];e.fields[r].error=a},setOriginal:function(e,n){for(var t in e.original=n.payload,n.payload)if(t in e.fields){var r=t;e.fields[r].value=n.payload[r]}},reset:function(e){e.fields=K.fields,e.original=null}}}),ee={original:null,fields:{jumpType:{value:null,error:null},extras:{value:[],error:null},load:{value:null,error:null},rig:{value:null,error:null},ticketType:{value:null,error:null},user:{value:null,error:null},exitWeight:{value:null,error:null}}},ne=Object(E.b)({name:"slotForm",initialState:ee,reducers:{setField:function(e,n){var t=q()(n.payload,2),r=t[0],a=t[1];e.fields[r].value=a,e.fields[r].error=null},setFieldError:function(e,n){var t=q()(n.payload,2),r=t[0],a=t[1];e.fields[r].error=a},setOriginal:function(e,n){for(var t in e.original=n.payload,n.payload)if(t in e.fields){var r=t;e.fields[r].value=n.payload[r]}},reset:function(e){e.fields=ee.fields,e.original=null}}}),te={original:null,federation:{value:null,error:null},fields:{exitWeight:{value:"",error:null},email:{value:"",error:null},phone:{value:"",error:null},name:{value:null,error:null},rigs:{value:[],error:null},license:{value:null,error:null}}},re=Object(E.b)({name:"userForm",initialState:te,reducers:{setFederation:function(e,n){e.federation.value=n.payload},setField:function(e,n){var t=q()(n.payload,2),r=t[0],a=t[1];e.fields[r].value=a,e.fields[r].error=null},setFieldError:function(e,n){var t=q()(n.payload,2),r=t[0],a=t[1];e.fields[r].error=a},setOriginal:function(e,n){var t;for(var r in e.original=n.payload,e.federation.value=null==(t=n.payload.license)?void 0:t.federation,n.payload)if(r in e.fields){var a=r;e.fields[a].value=n.payload[a]}},reset:function(e){e.fields=te.fields,e.original=null}}}),ae={original:null,fields:{role:{value:null,error:null},credits:{value:0,error:null},expiresAt:{value:null,error:null}}},le=Object(E.b)({name:"dropzoneUserForm",initialState:ae,reducers:{setField:function(e,n){var t=q()(n.payload,2),r=t[0],a=t[1];e.fields[r].value=a,e.fields[r].error=null},setFieldError:function(e,n){var t=q()(n.payload,2),r=t[0],a=t[1];e.fields[r].error=a},setOriginal:function(e,n){for(var t in e.original=n.payload,n.payload)if(t in e.fields){var r=t;e.fields[r].value=n.payload[r]}},reset:function(e){e.fields=ae.fields,e.original=null}}}),ie={original:null,fields:{make:{value:"",error:null},model:{value:"",error:null},serial:{value:"",error:null},repackExpiresAt:{value:null,error:null},canopySize:{value:null,error:null}}},oe=Object(E.b)({name:"rigForm",initialState:ie,reducers:{setField:function(e,n){var t=q()(n.payload,2),r=t[0],a=t[1];e.fields[r].value=a,e.fields[r].error=null},setFieldError:function(e,n){var t=q()(n.payload,2),r=t[0],a=t[1];e.fields[r].error=a},setOriginal:function(e,n){for(var t in e.original=n.payload,n.payload)if(t in e.fields){var r=t;e.fields[r].value=n.payload[r]}},reset:function(e){e.fields=ie.fields,e.original=null}}}),se=t(31),ue=t.n(se),ce={original:null,fields:[]},de=Object(E.b)({name:"rigInspectionForm",initialState:ce,reducers:{setItem:function(e,n){e.fields=[].concat(ue()(e.fields.filter((function(e){return e.checklistItem.id!==n.payload.checklistItem.id}))),[n.payload])},setOriginal:function(e,n){e.original=n.payload,e.fields=n.payload.checklistValues},reset:function(e){e.fields=ce.fields,e.original=null}}}),me=(M.actions,B.actions,N.actions),fe=L.actions,pe=D.actions,ge=(J.actions,V.actions,G.actions,Z.actions,X.actions,ne.actions),ve=re.actions,be=le.actions,he=oe.actions,ye=de.actions,Ee={key:"root",storage:"web"===S.a.OS?t(407).default:I.a,whitelist:["global","notifications"]},Se=Object(k.a)(Ee,{global:N.reducer,notifications:D.reducer,login:M.reducer,signup:B.reducer,dropzoneForm:V.reducer,planeForm:J.reducer,ticketTypeForm:G.reducer,extraForm:Z.reducer,loadForm:X.reducer,slotForm:ne.reducer,userForm:re.reducer,dropzoneUserForm:le.reducer,rigForm:oe.reducer,rigInspectionForm:de.reducer,usersScreen:L.reducer}),xe=Object(E.a)({reducer:Se,middleware:Object(E.c)({serializableCheck:{ignoredActions:["persist/PERSIST"]}})}),Ie=Object(k.b)(xe),ke=function(){return Object(o.b)()},ze=o.c;function Oe(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function we(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Oe(Object(t),!0).forEach((function(n){p()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Oe(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var Ce=Object(g.createHttpLink)({uri:y.a.manifest.extra.url});function je(e){var n=e.children,t=ze((function(e){return e.global.credentials})),r=ke(),i=Object(a.useMemo)((function(){return Object(h.a)((function(e){var n=e.graphQLErrors,t=e.networkError;if(null!=n&&n.some((function(e){var n;return"AUTHENTICATION_ERROR"===(null==(n=e.extensions)?void 0:n.code)})))return r(pe.showSnackbar({message:"Session expires",variant:"error"})),void r(me.logout());n&&n.map((function(e){var n=e.message,t=e.locations,a=e.path;return r(pe.showSnackbar({message:"[GraphQL error]: "+n+", "+t+", "+a,variant:"error"}))})),t&&r(pe.showSnackbar({message:"[Network error]: "+t,variant:"error"}))}))}),[r]),o=Object(a.useMemo)((function(){return Object(b.a)((function(e,n){return{headers:we(we({},n.headers),null!=t&&t.accessToken?we({Authorization:"Bearer "+t.accessToken,"access-token":t.accessToken,"token-type":t.tokenType},t):{})}}))}),[JSON.stringify(t)]),s=Object(a.useMemo)((function(){return new g.ApolloClient({link:i.concat(o).concat(Ce),cache:new g.InMemoryCache})}),[o]);return l.a.createElement(v.ApolloProvider,{client:s},n)}var Te=t(7),Pe=t.n(Te),Fe=t(474),$e=t(480),Ne=t(241);function De(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function Ae(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?De(Object(t),!0).forEach((function(n){p()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):De(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var Me=t(1),Ue=t(266);var qe={light:{text:"#000",background:"#fff",tint:"#2f95dc",tabIconDefault:"#ccc",tabIconSelected:"#2f95dc",success:"#00C851",error:"#ff4444",warning:"#FF8800",info:"#0099CC"},dark:{text:"#fff",background:"#000",tint:"#fff",tabIconDefault:"#ccc",tabIconSelected:"#fff",success:"#00C851",error:"#ff4444",warning:"#FF8800",info:"#0099CC"}};var Re=function(){return qe.light},Be=D.actions,We=(Me.a.create({container:{flex:1,justifyContent:"space-between"}}),function(){var e=ze((function(e){return e.notifications})),n=ke(),t=Re(),r=e.queue.length?e.queue[0]:null,l={info:{backgroundColor:t.info},success:{backgroundColor:t.success},error:{backgroundColor:t.error},warning:{backgroundColor:t.warning}};return a.createElement(Ue.a,{visible:!!r,onDismiss:function(){return n(Be.hideSnackbar())},duration:3e3,action:null==r?void 0:r.action,style:!(null==r||!r.variant)&&l[r.variant]},null==r?void 0:r.message)}),Le={prefixes:[t(361).a("/"),"dz://"],config:{screens:{Authenticated:{screens:{HomeScreen:"/home",LoadScreen:"/load/:load_id",PackingScreen:"/packing",ProfileScreen:"/user/:id",SetupScreen:"/dropzone/setup"}},Limbo:{screens:{DropzonesScreen:"/dropzones",CreateDropzoneScreen:"/dropzone/create"}},Unauthenticated:{screens:{LoginScreen:"/login",SignUpScreen:"/signup"}}}}},He=t(478),Ve=t(47),Qe=t(66);function Je(e){var n=e.navigation;return a.createElement(d.a,{style:Ye.container},a.createElement(Ve.a,{style:Ye.title},"This screen doesn't exist."),a.createElement(Qe.a,{onPress:function(){return n.replace("Root")},style:Ye.link},a.createElement(Ve.a,{style:Ye.linkText},"Go to home screen!")))}var _e,Ge,Ye=Me.a.create({container:{flex:1,backgroundColor:"#fff",alignItems:"center",justifyContent:"center",padding:20},title:{fontSize:20,fontWeight:"bold"},link:{marginTop:15,paddingVertical:15},linkText:{fontSize:14,color:"#2e78b7"}}),Ze=t(16),Ke=t(479),Xe=t(341),en=t(21),nn=t.n(en),tn=t(25),rn=t(475),an=t(30),ln=t(32),on=t(359),sn=t(287),un=t(305),cn=t(193),dn=t(303),mn=t(178),fn=t(62),pn=t(284),gn=t(10),vn=t(285),bn=t(286),hn=t(300),yn=t(283),En=Object(an.a)(_e||(_e=nn()(["\n  query JumpTypes($allowedForUserId: Int) {\n    jumpTypes(allowedForUserId: $allowedForUserId) {\n      id\n      name\n    }\n  }\n"])));function Sn(e){var n,t,r=Object(a.useState)(!1),i=q()(r,2),o=i[0],s=i[1],u=(ze((function(e){return e.global})),Object(g.useQuery)(En,{variables:{allowedForUserId:e.userId}})),c=u.data;u.loading,u.refetch;return l.a.createElement(l.a.Fragment,null,l.a.createElement(gn.a.Subheader,null,"Jump type"),l.a.createElement(yn.a,{onDismiss:function(){return s(!1)},visible:o,anchor:l.a.createElement(gn.a.Item,{onPress:function(){s(!0)},title:(null==(n=e.value)?void 0:n.name)||"Please select jump type",description:e.required?null:"Optional"})},null==c||null==(t=c.jumpTypes)?void 0:t.map((function(n){return l.a.createElement(gn.a.Item,{onPress:function(){s(!1),e.onSelect(n)},title:n.name||"-"})}))))}var xn,In=Object(an.a)(Ge||(Ge=nn()(["\n  query TicketTypes($allowManifestingSelf: Boolean, $dropzoneId: Int!) {\n    ticketTypes(allowManifestingSelf: $allowManifestingSelf, dropzoneId: $dropzoneId) {\n      id\n      name\n\n      extras {\n        id\n        name\n        cost\n      }\n    }\n  }\n"])));function kn(e){var n,t,r,i=Object(a.useState)(!1),o=q()(i,2),s=o[0],u=o[1],c=ze((function(e){return e.global})),d=Object(g.useQuery)(In,{variables:{dropzoneId:Number(null==(n=c.currentDropzone)?void 0:n.id),allowManifestingSelf:e.allowManifestingSelf}}),m=d.data;d.loading,d.refetch;return l.a.createElement(l.a.Fragment,null,l.a.createElement(gn.a.Subheader,null,"Ticket"),l.a.createElement(yn.a,{onDismiss:function(){return u(!1)},visible:s,anchor:l.a.createElement(gn.a.Item,{onPress:function(){u(!0)},title:(null==(t=e.value)?void 0:t.name)||"Please select ticket type",description:e.required?null:"Optional"})},null==m||null==(r=m.ticketTypes)?void 0:r.map((function(n){return l.a.createElement(gn.a.Item,{onPress:function(){u(!1),e.onSelect(n)},title:n.name||"-"})}))))}var zn,On=Object(an.a)(xn||(xn=nn()(["\nquery QueryPermissions($dropzoneId: Int!) {\n    dropzone(id: $dropzoneId) {\n      id\n      name\n      primaryColor\n      secondaryColor\n      \n      currentUser {\n        id\n        role {\n          id\n          name\n        }\n        permissions\n      }\n\n    }\n  }"])));function wn(e){var n,t,r,a=ze((function(e){return e.global})).currentDropzone,l=Object(g.useQuery)(On,{variables:{dropzoneId:Number(null==a?void 0:a.id)},fetchPolicy:"cache-first"}).data;return(null==l||null==(n=l.dropzone)||null==(t=n.currentUser)||null==(r=t.permissions)?void 0:r.includes(e))||!1}var Cn=Object(an.a)(zn||(zn=nn()(["\n  query QueryRigs(\n    $dropzoneId: Int\n    $userId: Int\n  ) {\n    rigs(dropzoneId: $dropzoneId, userId: $userId) {\n      id\n      make\n      model\n      canopySize\n      serial\n    }\n  }\n"])));function jn(e){var n,t,r,i,o,s=Object(a.useState)(!1),u=q()(s,2),c=u[0],d=u[1],m=ze((function(e){return e.global})),f=Object(g.useQuery)(Cn,{variables:{dropzoneId:Number(null==(n=m.currentDropzone)?void 0:n.id)}}).data;return l.a.createElement(yn.a,{onDismiss:function(){return d(!1)},visible:c,anchor:l.a.createElement(gn.a.Item,{onPress:function(){d(!0)},title:e.value?(null==(t=e.value)?void 0:t.make)+" "+(null==(r=e.value)?void 0:r.model)+" ("+((null==(i=e.value)?void 0:i.canopySize)||"?")+"sqft)":"Select rig",description:e.required?null:"Optional",left:function(){return l.a.createElement(gn.a.Icon,{icon:"parachute"})}})},null==f||null==(o=f.rigs)?void 0:o.map((function(n){var t,r,a;return l.a.createElement(gn.a.Item,{onPress:function(){d(!1),e.onSelect(n)},title:(null==(t=e.value)?void 0:t.make)+" "+(null==(r=e.value)?void 0:r.model),description:(null==(a=e.value)?void 0:a.canopySize)+" sqft"})})))}var Tn=ne.actions;function Pn(){var e,n,t,r,l,i,o,s,u,c,d,m,f,p,g,v,b,h,y,E,S,x,I,k,z=ze((function(e){return e.slotForm})),O=ke(),w=ze((function(e){return e.global}));a.useEffect((function(){var e,n;null!=(e=z.fields.user)&&e.value&&(z.fields.exitWeight.value||O(Tn.setField(["exitWeight",Number(z.fields.user.value.exitWeight||60)])),!z.fields.rig.value&&null!=(n=z.fields.user.value.rigs)&&n.length&&O(Tn.setField(["rig",z.fields.user.value.rigs[0]])))}),[null==(e=z.fields)||null==(n=e.user)||null==(t=n.value)?void 0:t.id]);var C=null==z||null==(r=z.original)?void 0:r.id,j=(null==z||null==(l=z.fields)||null==(i=l.user)||null==(o=i.value)||o.id,null==(s=w.currentUser)||s.id,wn(C?"updateSlot":"createSlot"),wn(C?"updateUserSlot":"createUserSlot"));return console.log("Fields",z.fields),a.createElement(a.Fragment,null,a.createElement(Sn,{value:z.fields.jumpType.value,required:!0,userId:Number(null==z||null==(u=z.fields)||null==(c=u.user)||null==(d=c.value)?void 0:d.id)||null,onSelect:function(e){return O(Tn.setField(["jumpType",e]))}}),a.createElement(pn.a,{type:z.fields.jumpType.error?"error":"info"},z.fields.jumpType.error||""),a.createElement(kn,{value:z.fields.ticketType.value,required:!0,allowManifestingSelf:!j,onSelect:function(e){return O(Tn.setField(["ticketType",e]))}}),a.createElement(pn.a,{type:z.fields.ticketType.error?"error":"info"},z.fields.ticketType.error||""),(null==z||null==(m=z.fields)||null==(f=m.ticketType)||null==(p=f.value)||null==(g=p.extras)?void 0:g.length)&&a.createElement(gn.a.Subheader,null,"Ticket addons"),a.createElement(fn.a,{horizontal:!0,style:$n.ticketAddons},null==z||null==(v=z.fields)||null==(b=v.ticketType)||null==(h=b.value)||null==(y=h.extras)?void 0:y.map((function(e){var n,t,r,l;return a.createElement(vn.a,{selected:null==z||null==(n=z.fields)||null==(t=n.extras.value)?void 0:t.some((function(n){return n.id===e.id})),onPress:null!=z&&null!=(r=z.fields)&&null!=(l=r.extras.value)&&l.some((function(n){return n.id===e.id}))?function(){var n,t;return O(Tn.setField(["extras",null==z||null==(n=z.fields)||null==(t=n.extras.value)?void 0:t.filter((function(n){return n.id!==e.id}))]))}:function(){var n,t;return O(Tn.setField(["extras",[].concat(ue()((null==z||null==(n=z.fields)||null==(t=n.extras)?void 0:t.value)||[]),[e])]))}},e.name+" ($"+e.cost+")")}))),a.createElement(pn.a,{type:z.fields.extras.error?"error":"info"},z.fields.extras.error||""),a.createElement(bn.a,null),a.createElement(jn,{value:z.fields.rig.value,userId:Number(null==(E=z.fields.user)||null==(S=E.value)?void 0:S.id),dropzoneId:Number(null==(x=w.currentDropzone)?void 0:x.id),onSelect:function(e){return O(Tn.setField(["jumpType",e]))}}),a.createElement(pn.a,{type:z.fields.rig.error?"error":"info"},z.fields.rig.error||""),a.createElement(hn.a,{style:$n.field,mode:"outlined",label:"Exit weight",error:!!z.fields.exitWeight.error,value:(null==(I=z.fields.exitWeight)||null==(k=I.value)?void 0:k.toString())||"",keyboardType:"numbers-and-punctuation",right:function(){return a.createElement(hn.a.Affix,{text:"kg"})},onChangeText:function(e){return O(Tn.setField(["exitWeight",Number(e)]))}}),a.createElement(pn.a,{type:z.fields.exitWeight.error?"error":"info"},z.fields.exitWeight.error||""))}var Fn,$n=Me.a.create({fields:{flex:1},field:{marginBottom:8},ticketAddons:{marginBottom:8}}),Nn=Object(g.gql)(Fn||(Fn=nn()(["\n  mutation CreateSlot(\n    $jumpTypeId: Int\n    $extraIds: [Int!]\n    $loadId: Int\n    $rigId: Int\n    $ticketTypeId: Int\n    $userId: Int\n    $exitWeight: Float\n  ) {\n    createSlot(\n      input: {\n        attributes: {\n          jumpTypeId: $jumpTypeId\n          extraIds: $extraIds\n          loadId: $loadId\n          rigId: $rigId\n          ticketTypeId: $ticketTypeId\n          userId: $userId\n          exitWeight: $exitWeight\n        }\n      }\n    ) {\n      errors\n      fieldErrors {\n        field\n        message\n      }\n      slot {\n        id\n        jumpType {\n          id\n          name\n        }\n        extras {\n          id\n          name\n        }\n        exitWeight\n        load {\n          id\n          name\n          createdAt\n          dispatchAt\n          hasLanded\n          maxSlots\n          isFull\n          isOpen\n          plane {\n            id\n            name\n          }\n          gca {\n            id\n            user {\n              id\n              name\n            }\n          }\n          pilot {\n            id\n            user {\n              id\n              name\n            }\n          }\n          loadMaster {\n            id\n            user {\n              id\n              name\n            }\n          }\n          slots {\n            id\n            createdAt\n            user {\n              id\n              name\n            }\n            ticketType {\n              id\n              name\n              altitude\n            }\n            jumpType {\n              id\n              name\n            }\n            extras {\n              id\n              name\n            }\n          }\n        }\n      }\n    }\n  }\n"])));function Dn(e){var n,t,r,i,o,s=ke(),u=ze((function(e){return e.slotForm})),c=ze((function(e){return e.global})),d=Object(g.useMutation)(Nn),m=q()(d,2),f=m[0],p=m[1],v=Object(a.useCallback)((function(){var e,n,t=!1;return null!=(e=u.fields.jumpType.value)&&e.id||(t=!0,s(ge.setFieldError(["jumpType","You must specify the type of jump"]))),null!=(n=u.fields.ticketType.value)&&n.id||(t=!0,s(ge.setFieldError(["ticketType","You must select a ticket type to manifest"]))),!t}),[JSON.stringify(u.fields)]),b=Object(a.useCallback)((function(){var n,t,r,a,l,i,o,c,d,m,p,g,b,h,y,E,S,x,I,k,z,O;return Pe.a.async((function(w){for(;;)switch(w.prev=w.next){case 0:if(v()){w.next=2;break}return w.abrupt("return");case 2:return w.prev=2,w.next=5,Pe.a.awrap(f({variables:{jumpTypeId:Number(null==(n=u.fields.jumpType.value)?void 0:n.id),extraIds:null==(t=u.fields.extras)||null==(r=t.value)?void 0:r.map((function(e){var n=e.id;return Number(n)})),loadId:Number(null==(a=u.fields.load.value)?void 0:a.id),rigId:null!=(l=u.fields.rig.value)&&l.id?Number(null==(i=u.fields.rig.value)?void 0:i.id):null,ticketTypeId:Number(null==(o=u.fields.ticketType)||null==(c=o.value)?void 0:c.id),userId:Number(null==(d=u.fields.user)||null==(m=d.value)?void 0:m.id),exitWeight:u.fields.exitWeight.value}}));case 5:if(k=w.sent,null==(p=k.data)||null==(g=p.createSlot)||null==(b=g.fieldErrors)||b.map((function(e){var n=e.field,t=e.message;switch(n){case"jump_type":return s(ge.setFieldError(["jumpType",t]));case"load":return s(ge.setFieldError(["load",t]));case"credits":case"extras":case"extra_ids":return s(ge.setFieldError(["extras",t]));case"ticket_type":return s(ge.setFieldError(["ticketType",t]));case"rig":return s(ge.setFieldError(["rig",t]));case"user":return s(ge.setFieldError(["user",t]));case"exit_weight":return s(ge.setFieldError(["exitWeight",t]))}})),null==k||null==(h=k.data)||null==(y=h.createSlot)||null==(E=y.errors)||!E.length){w.next=9;break}return w.abrupt("return",s(pe.showSnackbar({message:null==k||null==(z=k.data)||null==(O=z.createSlot)?void 0:O.errors[0],variant:"error"})));case 9:null!=(S=k.data)&&null!=(x=S.createSlot)&&null!=(I=x.fieldErrors)&&I.length||e.onSuccess(),w.next=15;break;case 12:w.prev=12,w.t0=w.catch(2),s(pe.showSnackbar({message:w.t0.message,variant:"error"}));case 15:case"end":return w.stop()}}),null,null,[[2,12]],Promise)}),[JSON.stringify(u.fields),f,e.onSuccess]);return l.a.createElement(cn.a,null,l.a.createElement(dn.a,{visible:!!e.open},l.a.createElement(sn.a,{indeterminate:!0,visible:p.loading,color:c.theme.colors.accent}),l.a.createElement(dn.a.Title,null,"Manifest "+(null==u||null==(n=u.fields)||null==(t=n.user)||null==(r=t.value)?void 0:r.name)+" on "+(null==(i=u.fields.load)||null==(o=i.value)?void 0:o.name)),l.a.createElement(dn.a.Content,null,l.a.createElement(Pn,null)),l.a.createElement(dn.a.Actions,{style:{justifyContent:"flex-end"}},l.a.createElement(mn.a,{onPress:function(){s(ge.reset()),e.onClose()}},"Cancel"),l.a.createElement(mn.a,{onPress:b},"Manifest"))))}var An=t(133),Mn=t(288),Un=t(26),qn=t.n(Un),Rn=t(8),Bn=t.n(Rn);function Wn(e,n){var t=e.light;return t||qe.light[n]}function Ln(e){var n=e.style,t=e.lightColor,r=e.darkColor,l=Bn()(e,["style","lightColor","darkColor"]),i=Wn({light:t,dark:r},"text");return a.createElement(Ve.a,qn()({style:[{color:i},n]},l))}function Hn(e){var n=e.style,t=e.lightColor,r=e.darkColor,l=Bn()(e,["style","lightColor","darkColor"]),i=Wn({light:t,dark:r},"background");return a.createElement(d.a,qn()({style:[{backgroundColor:i},n]},l))}function Vn(e){var n=e.title,t=e.subtitle;return l.a.createElement(Hn,{style:Qn.empty},l.a.createElement(An.a,null,n),l.a.createElement(Mn.a,{style:{textAlign:"center"}},t))}var Qn=Me.a.create({container:{flex:1,padding:8,display:"flex"},fab:{position:"absolute",margin:16,right:0,bottom:0},empty:{flex:1,alignItems:"center",justifyContent:"center",width:"100%",height:"100%"}});function Jn(e){var n=e.hasPlanes,t=e.hasTicketTypes,r=(e.isPublic,Re());return a.createElement(Hn,{style:{width:"70%"}},a.createElement(Ln,{style:Yn.title},"Set up dropzone"),a.createElement(Hn,{style:Yn.separator,lightColor:"#eee",darkColor:"rgba(255,255,255,0.1)"}),a.createElement(gn.a.Item,{title:"Create dropzone",left:function(){return a.createElement(gn.a.Icon,{color:r.success,icon:"check"})}}),a.createElement(gn.a.Item,{title:"Add a plane",left:function(){return n?a.createElement(gn.a.Icon,{color:r.success,icon:"check"}):a.createElement(gn.a.Icon,{color:r.error,icon:"close"})}}),a.createElement(gn.a.Item,{title:"Configure jump tickets",left:function(){return t?a.createElement(gn.a.Icon,{color:r.success,icon:"check"}):a.createElement(gn.a.Icon,{color:r.error,icon:"close"})}}))}var _n,Gn,Yn=Me.a.create({container:{flex:1,alignItems:"center",justifyContent:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"}}),Zn=t(190),Kn=t(302),Xn=t(350),et=t(366),nt=Object(an.a)(_n||(_n=nn()(["\n  query QueryDropzoneUsers(\n    $dropzoneId: Int!\n    $permissions: [Permission!]\n  ) {\n    dropzone(id: $dropzoneId) {\n      id\n      name\n\n      dropzoneUsers(permissions: $permissions) {\n        edges {\n          node {\n            id\n            role {\n              id\n              name\n            }\n            user {\n              id\n              name\n            }\n          }\n        }\n      }\n    }\n  }\n"])));function tt(e){var n,t,r,i,o,s,u,c=Object(a.useState)(!1),d=q()(c,2),m=d[0],f=d[1],p=ze((function(e){return e.global})),v=Object(g.useQuery)(nt,{variables:{dropzoneId:Number(null==(n=p.currentDropzone)?void 0:n.id),permissions:["actAsGCA"]}}).data;return wn("updateLoad")?l.a.createElement(yn.a,{onDismiss:function(){return f(!1)},visible:m,anchor:l.a.createElement(vn.a,{mode:"outlined",icon:"radio-handheld",style:{marginHorizontal:4},onPress:function(){return f(!0)}},null!=(r=e.value)&&r.id?null==(i=e.value)?void 0:i.name:"No gca")},null==v||null==(o=v.dropzone)||null==(s=o.dropzoneUsers)||null==(u=s.edges)?void 0:u.map((function(n){var t,r;return l.a.createElement(gn.a.Item,{onPress:function(){var t;f(!1),e.onSelect(null==n||null==(t=n.node)?void 0:t.user)},title:null==n||null==(t=n.node)||null==(r=t.user)?void 0:r.name})}))):l.a.createElement(vn.a,{mode:"outlined",icon:"radio-handheld"},(null==(t=e.value)?void 0:t.name)||"No gca")}function rt(e){var n,t,r,i,o=Object(a.useState)(!1),s=q()(o,2),u=s[0],c=s[1],d=wn("updateLoad");return d?l.a.createElement(yn.a,{onDismiss:function(){return c(!1)},visible:u,anchor:l.a.createElement(vn.a,{mode:"outlined",icon:"parachute",style:{marginHorizontal:4},onPress:function(){return d&&c(!0)}},null!=(t=e.value)&&t.id?null==(r=e.value)?void 0:r.name:"No loadmaster")},null==(i=e.slots)?void 0:i.map((function(n){var t;return l.a.createElement(gn.a.Item,{onPress:function(){c(!1),e.onSelect(n.user)},title:null==n||null==(t=n.user)?void 0:t.name})}))):l.a.createElement(vn.a,{mode:"outlined",icon:"radio-handheld"},(null==(n=e.value)?void 0:n.name)||"No loadmaster")}var at,lt=Object(an.a)(Gn||(Gn=nn()(["\n  query QueryDropzoneUsers(\n    $dropzoneId: Int!\n    $permissions: [Permission!]\n  ) {\n    dropzone(id: $dropzoneId) {\n      id\n      name\n\n      dropzoneUsers(permissions: $permissions) {\n        edges {\n          node {\n            id\n            role {\n              id\n              name\n            }\n            user {\n              id\n              name\n            }\n          }\n        }\n      }\n    }\n  }\n"])));function it(e){var n,t,r,i,o,s,u,c=Object(a.useState)(!1),d=q()(c,2),m=d[0],f=d[1],p=ze((function(e){return e.global})),v=Object(g.useQuery)(lt,{variables:{dropzoneId:Number(null==(n=p.currentDropzone)?void 0:n.id),permissions:["actAsPilot"]}}).data;return wn("updateLoad")?l.a.createElement(yn.a,{onDismiss:function(){return f(!1)},visible:m,anchor:l.a.createElement(vn.a,{mode:"outlined",icon:"airplane-takeoff",style:{marginHorizontal:4},onPress:function(){return f(!0)}},null!=(r=e.value)&&r.id?null==(i=e.value)?void 0:i.name:"No pilot")},null==v||null==(o=v.dropzone)||null==(s=o.dropzoneUsers)||null==(u=s.edges)?void 0:u.map((function(n){var t,r;return l.a.createElement(gn.a.Item,{onPress:function(){var t;f(!1),e.onSelect(null==n||null==(t=n.node)?void 0:t.user)},title:null==n||null==(t=n.node)||null==(r=t.user)?void 0:r.name})}))):l.a.createElement(vn.a,{mode:"outlined",icon:"radio-handheld"},(null==(t=e.value)?void 0:t.name)||"No pilot")}var ot,st,ut=Object(an.a)(at||(at=nn()(["\n  query QueryPlanes(\n    $dropzoneId: Int!\n  ) {\n    planes(dropzoneId: $dropzoneId) {\n      id\n      name\n      registration\n      hours\n      minSlots\n      maxSlots\n      nextMaintenanceHours\n      createdAt\n    }\n  }\n"])));function ct(e){var n,t,r,i,o=Object(a.useState)(!1),s=q()(o,2),u=s[0],c=s[1],d=ze((function(e){return e.global})),m=Object(g.useQuery)(ut,{variables:{dropzoneId:Number(null==(n=d.currentDropzone)?void 0:n.id)}}).data,f=wn("updateLoad");return f?l.a.createElement(yn.a,{onDismiss:function(){return c(!1)},visible:u,anchor:l.a.createElement(vn.a,{mode:"outlined",icon:"airplane",style:{marginHorizontal:4},onPress:function(){return f&&c(!0)}},(null==(r=e.value)?void 0:r.name)||"No plane")},null==m||null==(i=m.planes)?void 0:i.map((function(n){return l.a.createElement(gn.a.Item,{onPress:function(){c(!1),e.onSelect(n)},title:n.name})}))):l.a.createElement(vn.a,{mode:"outlined",icon:"airplane-takeoff"},(null==(t=e.value)?void 0:t.name)||"No plane")}var dt=Object(g.gql)(ot||(ot=nn()(["\n  query QueryLoad($id: Int!) {\n    load(id: $id) {\n      id\n      name\n      createdAt\n      dispatchAt\n      hasLanded\n      maxSlots\n      loadNumber\n      isFull\n      isOpen\n      plane {\n        id\n        name\n      }\n      gca {\n        id\n        user {\n          id\n          name\n        }\n      }\n      pilot {\n        id\n        user {\n          id\n          name\n        }\n      }\n      loadMaster {\n        id\n        user {\n          id\n          name\n        }\n      }\n      slots {\n        id\n        createdAt\n        exitWeight\n        user {\n          id\n          name\n        }\n        ticketType {\n          id\n          name\n          altitude\n\n          extras {\n            id\n            name\n            cost\n          }\n        }\n        jumpType {\n          id\n          name\n        }\n        extras {\n          id\n          name\n        }\n      }\n    }\n  }\n"]))),mt=Object(g.gql)(st||(st=nn()(["\n  mutation UpdateLoad(\n    $id: Int!,\n    $pilotId: Int,\n    $gcaId: Int,\n    $planeId: Int,\n    $isOpen: Boolean,\n    $loadMasterId: Int,\n    $dispatchAt: Int,\n    $hasLanded: Boolean,\n  ){\n    updateLoad(input: {\n      id: $id\n      attributes: {\n        pilotId: $pilotId,\n        gcaId: $gcaId,\n        planeId: $planeId,\n        isOpen: $isOpen,\n        loadMasterId: $loadMasterId\n        dispatchAt: $dispatchAt\n        hasLanded: $hasLanded\n      }\n    }) {\n      load {\n        id\n        name\n        createdAt\n        loadNumber\n        dispatchAt\n        hasLanded\n        maxSlots\n        isFull\n        isOpen\n        plane {\n          id\n          name\n        }\n        gca {\n          id\n          user {\n            id\n            name\n          }\n        }\n        pilot {\n          id\n          user {\n            id\n            name\n          }\n        }\n        loadMaster {\n          id\n          user {\n            id\n            name\n          }\n        }\n        slots {\n          id\n          createdAt\n          exitWeight\n          user {\n            id\n            name\n          }\n          ticketType {\n            id\n            name\n            altitude\n          }\n          jumpType {\n            id\n            name\n          }\n          extras {\n            id\n            name\n          }\n        }\n      }\n    }\n  }\n"])));function ft(e){var n,t,r,l,i,o,s,u,c,d,m,f,p,v,b,h,y,E,S,x,I,k,z,O,w,C,j=ze((function(e){return e.global})),T=a.useState(!1),P=q()(T,2),F=P[0],$=P[1],N=a.useState(!1),D=q()(N,2),A=D[0],M=D[1],U=(Object(tn.useNavigation)(),e.load),R=(e.loadNumber,e.onManifest),B=e.canManifest,W=Object(g.useQuery)(dt,{variables:{id:Number(U.id)}}),L=W.data,H=W.loading,V=Object(g.useMutation)(mt),Q=q()(V,2),J=Q[0],_=Q[1],G=a.useCallback((function(e){return Pe.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Pe.a.awrap(J({variables:{id:Number(U.id),pilotId:Number(e.id)}}));case 3:n.next=7;break;case 5:n.prev=5,n.t0=n.catch(0);case 7:case"end":return n.stop()}}),null,null,[[0,5]],Promise)}),[J,JSON.stringify(U)]),Y=a.useCallback((function(e){return Pe.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Pe.a.awrap(J({variables:{id:Number(U.id),gcaId:Number(e.id)}}));case 3:n.next=7;break;case 5:n.prev=5,n.t0=n.catch(0);case 7:case"end":return n.stop()}}),null,null,[[0,5]],Promise)}),[J,JSON.stringify(U)]),Z=a.useCallback((function(e){return Pe.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Pe.a.awrap(J({variables:{id:Number(U.id),planeId:Number(e.id)}}));case 3:n.next=7;break;case 5:n.prev=5,n.t0=n.catch(0);case 7:case"end":return n.stop()}}),null,null,[[0,5]],Promise)}),[J,JSON.stringify(U)]),K=a.useCallback((function(e){return Pe.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Pe.a.awrap(J({variables:{id:Number(U.id),loadMasterId:Number(e.id)}}));case 3:n.next=7;break;case 5:n.prev=5,n.t0=n.catch(0);case 7:case"end":return n.stop()}}),null,null,[[0,5]],Promise)}),[J,JSON.stringify(U)]),X=a.useCallback((function(e){var n;return Pe.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e?Object(Xn.a)(new Date,e).getTime()/1e3:null,t.prev=1,t.next=4,Pe.a.awrap(J({variables:{id:Number(U.id),dispatchAt:n?Math.ceil(n):null}}));case 4:t.next=8;break;case 6:t.prev=6,t.t0=t.catch(1);case 8:case"end":return t.stop()}}),null,null,[[1,6]],Promise)}),[J,JSON.stringify(U)]),ee=a.useCallback((function(){return Pe.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Pe.a.awrap(J({variables:{id:Number(U.id),hasLanded:!0}}));case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:case"end":return e.stop()}}),null,null,[[0,5]],Promise)}),[J,JSON.stringify(U)]),ne=wn("updateLoad"),te=wn("updateSlot"),re=wn("updateUserSlot"),ae=a.useCallback((function(n){var t,r;if((null==n||null==(t=n.user)?void 0:t.id)===(null==(r=j.currentUser)?void 0:r.id)||re)return function(){var t,r;(null==(t=n.user)?void 0:t.id)===(null==(r=j.currentUser)?void 0:r.id)?te&&e.onSlotPress(n):re&&e.onSlotPress(n)}}),[JSON.stringify(U),re,e.onSlotPress]);return a.useEffect((function(){var e,n;null!=L&&null!=(e=L.load)&&e.maxSlots&&(null==L||null==(n=L.load)?void 0:n.maxSlots)<5&&!F&&$(!0)}),[null==L||null==(n=L.load)?void 0:n.maxSlots]),a.createElement(Zn.a,{style:{margin:16},elevation:3},a.createElement(Zn.a.Title,{title:"Load "+(null==L||null==(t=L.load)?void 0:t.loadNumber),subtitle:U.name}),a.createElement(sn.a,{visible:H||_.loading,color:j.theme.colors.accent}),a.createElement(Zn.a.Content,{style:{marginVertical:8,height:F?void 0:300,overflow:"hidden"}},a.createElement(Hn,{style:{flexDirection:"row"}},a.createElement(fn.a,{horizontal:!0},a.createElement(ct,{dropzoneId:Number(null==(r=j.currentDropzone)?void 0:r.id),value:null==L||null==(l=L.load)?void 0:l.plane,onSelect:Z}),a.createElement(tt,{dropzoneId:Number(null==(i=j.currentDropzone)?void 0:i.id),value:null==L||null==(o=L.load)||null==(s=o.gca)?void 0:s.user,onSelect:Y}),a.createElement(it,{dropzoneId:Number(null==(u=j.currentDropzone)?void 0:u.id),value:null==L||null==(c=L.load)||null==(d=c.pilot)?void 0:d.user,onSelect:G}),a.createElement(rt,{dropzoneId:Number(null==(m=j.currentDropzone)?void 0:m.id),value:null==L||null==(f=L.load)||null==(p=f.loadMaster)?void 0:p.user,slots:(null==L?void 0:L.load.slots)||[],onSelect:K}))),a.createElement(Kn.a,null,a.createElement(Kn.a.Header,{style:{width:"100%"}},a.createElement(Kn.a.Title,null,"Name"),a.createElement(Kn.a.Title,{numeric:!0},"Exit weight"),a.createElement(Kn.a.Title,{numeric:!0},"Jump type"),a.createElement(Kn.a.Title,{numeric:!0},"Altitude")),null==L||null==(v=L.load)||null==(b=v.slots)?void 0:b.map((function(e){var n,t,r;return a.createElement(Kn.a.Row,{onPress:ae(e),pointerEvents:"none"},a.createElement(Kn.a.Cell,null,null==e||null==(n=e.user)?void 0:n.name),a.createElement(Kn.a.Cell,{numeric:!0},null==e?void 0:e.exitWeight),a.createElement(Kn.a.Cell,{numeric:!0},null==e||null==(t=e.jumpType)?void 0:t.name),a.createElement(Kn.a.Cell,{numeric:!0},null==e||null==(r=e.ticketType)?void 0:r.altitude))})),Array.from({length:((null==U?void 0:U.maxSlots)||0)-((null==U||null==(h=U.slots)?void 0:h.length)||0)},(function(e,n){return n})).map((function(){return a.createElement(Kn.a.Row,null,a.createElement(Kn.a.Cell,null,"- Available -"),a.createElement(Kn.a.Cell,{numeric:!0},"-"),a.createElement(Kn.a.Cell,{numeric:!0},"-"),a.createElement(Kn.a.Cell,{numeric:!0},"-"))})))),!(null==L||null==(y=L.load)||!y.dispatchAt)&&(null==L||null==(E=L.load)?void 0:E.dispatchAt)>(new Date).getTime()/1e3&&a.createElement(Hn,{style:{flex:1,backgroundColor:"#FF8800",padding:8}},a.createElement(Mn.a,null,"Take-off in "+Object(et.a)(new Date,1e3*(null==L||null==(S=L.load)?void 0:S.dispatchAt))+" min")),a.createElement(Zn.a.Actions,null,null!=L&&null!=(x=L.load)&&x.maxSlots&&(null==L||null==(I=L.load)?void 0:I.maxSlots)<5?null:a.createElement(mn.a,{onPress:function(){return $(!F)}},F?"Show less":"Show more"),a.createElement(Hn,{style:{flexGrow:1}}),!ne||null!=L&&null!=(k=L.load)&&k.hasLanded?null:null!=L&&null!=(z=L.load)&&z.dispatchAt?a.createElement(mn.a,{mode:"outlined",onPress:function(){return X(null)}},"Cancel"):a.createElement(yn.a,{onDismiss:function(){return M(!1)},visible:A,anchor:a.createElement(mn.a,{mode:"outlined",onPress:function(){return M(!0)}},"Dispatch")},a.createElement(gn.a.Item,{onPress:function(){M(!1),X(20)},title:"20 minute call"}),a.createElement(gn.a.Item,{onPress:function(){M(!1),X(15)},title:"15 minute call"}),a.createElement(gn.a.Item,{onPress:function(){M(!1),X(10)},title:"10 minute call"}),a.createElement(gn.a.Item,{onPress:function(){M(!1),X(5)},title:"5 minute call"})),null!=L&&null!=(O=L.load)&&O.hasLanded?null:null!=L&&null!=(w=L.load)&&w.dispatchAt&&(null==L?void 0:L.load.dispatchAt)<(new Date).getTime()/1e3&&ne?a.createElement(mn.a,{style:{marginLeft:8},mode:"contained",onPress:function(){return ee()}},"Mark as landed"):a.createElement(mn.a,{style:{marginLeft:8},mode:"contained",onPress:function(){return R()},disabled:!B||Boolean((null==L||null==(C=L.load)?void 0:C.dispatchAt)&&L.load.dispatchAt<(new Date).getTime()/1e3)},"Manifest")))}var pt;Me.a.create({container:{flex:1,alignItems:"center",justifyContent:"center",marginVertical:8},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fab:{position:"absolute",margin:16,right:0,bottom:0}});function gt(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function vt(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?gt(Object(t),!0).forEach((function(n){p()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):gt(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var bt=Object(an.a)(pt||(pt=nn()(["\n  query QueryDropzone($dropzoneId: Int!, $earliestTimestamp: Int) {\n    dropzone(id: $dropzoneId) {\n      id\n      name\n      primaryColor,\n      secondaryColor,\n      planes {\n        id\n        name\n        registration\n      }\n      ticketTypes {\n        id\n        name\n      }\n\n      currentUser {\n        id\n        user {\n          id\n          name\n          exitWeight\n          email\n          phone\n          rigs {\n            id\n            model\n            make\n            serial\n            canopySize\n            repackExpiresAt\n          }\n          jumpTypes {\n            id\n            name\n          }\n          license {\n            id\n            name\n          }\n        }\n      }\n\n      loads(earliestTimestamp: $earliestTimestamp) {\n        edges {\n          node {\n            id\n            name\n            isOpen\n            maxSlots\n            isFull\n          }\n        }\n      }\n    }\n  }\n"])));function ht(){var e,n,t,r,l,i,o,s,u,c,d,m,f,p=ze((function(e){return e.global})),v=a.useState(!1),b=q()(v,2),h=b[0],y=b[1],E=ke(),S=Object(g.useQuery)(bt,{variables:{dropzoneId:Number(null==(e=p.currentDropzone)?void 0:e.id),earliestTimestamp:Object(rn.a)(new Date).getTime()/1e3},fetchPolicy:"no-cache"}),x=S.data,I=S.loading,k=S.refetch,z=Object(tn.useNavigation)(),O=Object(tn.useIsFocused)();a.useEffect((function(){O&&k()}),[O]);var w=!(null==x||null==(n=x.dropzone)||null==(t=n.planes)||!t.length),C=!(null==x||null==(r=x.dropzone)||null==(l=r.ticketTypes)||!l.length),j=!(null==x||null==(i=x.dropzone)||!i.isPublic),T=w&&C;a.useEffect((function(){var e,n;null!=x&&null!=(e=x.dropzone)&&e.id&&(E(me.setDropzone(x.dropzone)),E(me.setUser(vt(vt({},null==p?void 0:p.currentUser),(null==x||null==(n=x.dropzone)?void 0:n.currentUser.user)||{}))))}),[JSON.stringify(null==x?void 0:x.dropzone)]),a.useEffect((function(){var e,n,t,r,a,l,i,o;null!=x&&null!=(e=x.dropzone)&&e.primaryColor&&(null==x||null==(n=x.dropzone)?void 0:n.primaryColor)!==(null==(t=p.theme)||null==(r=t.colors)?void 0:r.primary)&&E(me.setPrimaryColor(x.dropzone.primaryColor)),null!=x&&null!=(a=x.dropzone)&&a.secondaryColor&&(null==x||null==(l=x.dropzone)?void 0:l.secondaryColor)!==(null==(i=p.theme)||null==(o=i.colors)?void 0:o.accent)&&E(me.setPrimaryColor(x.dropzone.secondaryColor))}),[null==x||null==(o=x.dropzone)?void 0:o.primaryColor,null==x||null==(s=x.dropzone)?void 0:s.secondaryColor]);var P=wn("createSlot"),F=wn("createLoad");return a.createElement(a.Fragment,null,a.createElement(Dn,{open:h,onClose:function(){return y(!1)},onSuccess:function(){return y(!1)}}),a.createElement(sn.a,{visible:I,indeterminate:!0,color:p.theme.colors.accent}),a.createElement(Hn,{style:yt.container},!I&&(T?a.createElement(Hn,{style:{width:"100%",flex:1,height:ln.a.get("window").height}},((null==x||null==(u=x.dropzone)||null==(c=u.loads)||null==(d=c.edges)?void 0:d.length)||0)<1?a.createElement(Vn,{title:"No loads so far today",subtitle:"How's the weather?"}):a.createElement(on.a,{style:{flex:1,height:ln.a.get("window").height},contentContainerStyle:{flexGrow:1},numColumns:1,data:(null==x||null==(m=x.dropzone)||null==(f=m.loads)?void 0:f.edges)||[],refreshing:I,onRefresh:k,renderItem:function(e){var n,t,r,l,i,o=e.item,s=e.index;return null!=o&&o.node?a.createElement(ft,{key:"load-"+o.node.id,load:o.node,canManifest:P&&(null==o||null==(n=o.node)?void 0:n.isOpen)&&!(null!=o&&null!=(t=o.node)&&t.isFull),loadNumber:((null==x||null==(r=x.dropzone)||null==(l=r.loads)||null==(i=l.edges)?void 0:i.length)||0)-s,onSlotPress:function(e){E(ge.setOriginal(e)),E(ge.setField(["load",o.node])),y(!0)},onManifest:function(){E(ge.setField(["user",p.currentUser])),E(ge.setField(["load",o.node])),y(!0)}}):null}})):a.createElement(Jn,{hasPlanes:w,hasTicketTypes:C,isPublic:j})),F&&T&&a.createElement(un.a,{style:yt.fab,small:!0,icon:"plus",onPress:function(){return z.navigate("CreateLoadScreen")},label:"New load"})))}var yt=Me.a.create({container:{flex:1,alignItems:"center",justifyContent:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fab:{position:"absolute",margin:16,right:0,bottom:0}}),Et=t(363);function St(e){return a.createElement(Ln,qn()({},e,{style:[e.style,{fontFamily:"space-mono"}]}))}function xt(e){var n=e.path;return l.a.createElement(Hn,null,l.a.createElement(Hn,{style:kt.getStartedContainer},l.a.createElement(Ln,{style:kt.getStartedText,lightColor:"rgba(0,0,0,0.8)",darkColor:"rgba(255,255,255,0.8)"},"Open up the code for this screen:"),l.a.createElement(Hn,{style:[kt.codeHighlightContainer,kt.homeScreenFilename],darkColor:"rgba(255,255,255,0.05)",lightColor:"rgba(0,0,0,0.05)"},l.a.createElement(St,null,n)),l.a.createElement(Ln,{style:kt.getStartedText,lightColor:"rgba(0,0,0,0.8)",darkColor:"rgba(255,255,255,0.8)"},"Change any of the text, save the file, and your app will automatically update.")),l.a.createElement(Hn,{style:kt.helpContainer},l.a.createElement(Qe.a,{onPress:It,style:kt.helpLink},l.a.createElement(Ln,{style:kt.helpLinkText,lightColor:qe.light.tint},"Tap here if your app doesn't automatically update after making changes"))))}function It(){Et.a("https://docs.expo.io/get-started/create-a-new-app/#opening-the-app-on-your-phonetablet")}var kt=Me.a.create({container:{flex:1,backgroundColor:"#fff"},developmentModeText:{marginBottom:20,fontSize:14,lineHeight:19,textAlign:"center"},contentContainer:{paddingTop:30},welcomeContainer:{alignItems:"center",marginTop:10,marginBottom:20},welcomeImage:{width:100,height:80,resizeMode:"contain",marginTop:3,marginLeft:-10},getStartedContainer:{alignItems:"center",marginHorizontal:50},homeScreenFilename:{marginVertical:7},codeHighlightText:{color:"rgba(96,100,109, 0.8)"},codeHighlightContainer:{borderRadius:3,paddingHorizontal:4},getStartedText:{fontSize:17,lineHeight:24,textAlign:"center"},helpContainer:{marginTop:15,marginHorizontal:20,alignItems:"center"},helpLink:{paddingVertical:15},helpLinkText:{textAlign:"center"}});function zt(){return a.createElement(Hn,{style:Ct.container},a.createElement(Ln,{style:Ct.title},"Tab One"),a.createElement(Hn,{style:Ct.separator,lightColor:"#eee",darkColor:"rgba(255,255,255,0.1)"}),a.createElement(xt,{path:"/screens/LoadScreen.tsx"}))}var Ot,wt,Ct=Me.a.create({container:{flex:1,alignItems:"center",justifyContent:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"}}),jt=D.actions,Tt=t(304),Pt=Object(an.a)(Ot||(Ot=nn()(["\n  query QueryPlanes(\n    $dropzoneId: Int!\n  ) {\n    planes(dropzoneId: $dropzoneId) {\n      id\n      name\n      registration\n      hours\n      minSlots\n      maxSlots\n      nextMaintenanceHours\n      createdAt\n    }\n  }\n"])));function Ft(e){var n,t,r,i=Object(a.useState)(!1),o=q()(i,2),s=o[0],u=o[1],c=ze((function(e){return e.global})),d=Object(g.useQuery)(Pt,{variables:{dropzoneId:Number(null==(n=c.currentDropzone)?void 0:n.id)}}),m=d.data;d.loading,d.refetch;return l.a.createElement(yn.a,{onDismiss:function(){return u(!1)},visible:s,anchor:l.a.createElement(gn.a.Item,{onPress:function(){u(!0)},title:(null==(t=e.value)?void 0:t.name)||"No plane selected",description:e.required?null:"Optional",right:function(){return l.a.createElement(gn.a.Icon,{icon:"airplane"})}})},null==m||null==(r=m.planes)?void 0:r.map((function(n){return l.a.createElement(gn.a.Item,{onPress:function(){u(!1),e.onSelect(n)},title:n.name||"-",description:n.registration})})))}var $t=function(e,n){var t=n.getPayload;return function(n){var r=n.variables,l=n.onError,i=ke(),o=Object(g.useQuery)(e,{variables:r}),s=o.data,u=o.loading,c=o.previousData,d=o.refetch,m=o.error,f=Object(a.useMemo)((function(){return t(s)}),[JSON.stringify(s)]);return Object(a.useEffect)((function(){JSON.stringify(c),JSON.stringify(s);null!=m&&m.message&&(!1!==n.showSnackbarErrors&&i(pe.showSnackbar({message:m.message,variant:"error"})),l(m.message))}),[n.onError,null==m?void 0:m.message]),{loading:u,data:f,refetch:d}}}(Object(an.a)(wt||(wt=nn()(["\nquery QueryDropzoneUsers(\n  $dropzoneId: Int!\n  $permissions: [Permission!]\n) {\n  dropzone(id: $dropzoneId) {\n    id\n    name\n\n    dropzoneUsers(permissions: $permissions) {\n      edges {\n        node {\n          id\n          role {\n            id\n            name\n          }\n          user {\n            id\n            name\n          }\n        }\n      }\n    }\n  }\n}\n"]))),{getPayload:function(e){var n;return null==e||null==(n=e.dropzone)?void 0:n.dropzoneUsers}});function Nt(e){var n,t,r,i,o,s=Object(a.useState)(!1),u=q()(s,2),c=u[0],d=u[1],m=ze((function(e){return e.global})),f=$t({variables:{dropzoneId:Number(null==(n=m.currentDropzone)?void 0:n.id),permissions:e.requiredPermissions}}),p=f.data;f.loading,f.refetch;return l.a.createElement(l.a.Fragment,null,l.a.createElement(An.a,null,e.label),l.a.createElement(yn.a,{onDismiss:function(){return d(!1)},visible:c,anchor:l.a.createElement(gn.a.Item,{onPress:function(){d(!0)},title:null!=(t=e.value)&&null!=(r=t.user)&&r.id?null==(i=e.value)?void 0:i.user.name:"No user selected",style:{width:"100%"},right:function(){return l.a.createElement(gn.a.Icon,{icon:"account"})},description:e.required?null:"Optional"})},null==p||null==(o=p.edges)?void 0:o.map((function(n){var t,r,a,i;return l.a.createElement(gn.a.Item,{style:{width:"100%"},onPress:function(){d(!1),e.onSelect(null==n?void 0:n.node)},title:(null==n||null==(t=n.node)||null==(r=t.user)?void 0:r.name)||"-",description:(null==n||null==(a=n.node)||null==(i=a.role)?void 0:i.name)||null})}))))}var Dt=X.actions;function At(){var e,n,t,r,l,i=ze((function(e){return e.loadForm})),o=ke(),s=ze((function(e){return e.global}));return a.createElement(a.Fragment,null,a.createElement(hn.a,{style:Mt.field,mode:"outlined",label:"Name",error:!!i.fields.name.error,placeholder:"Optional",value:i.fields.name.value||"",onChangeText:function(e){return o(Dt.setField(["name",e]))}}),a.createElement(pn.a,{type:i.fields.name.error?"error":"info"},i.fields.name.error||"e.g Starcrest load, Tandem load"),a.createElement(hn.a,{style:Mt.field,mode:"outlined",label:"Slots",error:!!i.fields.maxSlots.error,value:null==(e=i.fields.maxSlots)||null==(n=e.value)?void 0:n.toString(),onChangeText:function(e){return o(Dt.setField(["maxSlots",Number(e)]))}}),a.createElement(pn.a,{type:i.fields.maxSlots.error?"error":"info"},i.fields.maxSlots.error||""),a.createElement(d.a,{style:{width:"100%"}},a.createElement(Ft,{value:i.fields.plane.value,required:!0,onSelect:function(e){o(Dt.setField(["plane",e])),o(Dt.setField(["maxSlots",e.maxSlots]))},dropzoneId:Number(null==(t=s.currentDropzone)?void 0:t.id)}),a.createElement(pn.a,{type:i.fields.plane.error?"error":"info"},i.fields.plane.error||""),a.createElement(Tt.a.Item,{label:"Allow public manifesting",status:i.fields.isOpen.value?"checked":"unchecked",onPress:function(){return o(Dt.setField(["isOpen",!i.fields.isOpen.value]))}}),a.createElement(bn.a,{style:{marginVertical:8}}),a.createElement(Nt,{label:"GCA",onSelect:function(e){return o(Dt.setField(["gca",e]))},dropzoneId:Number(null==(r=s.currentDropzone)?void 0:r.id),value:i.fields.gca.value||null,requiredPermissions:["actAsGCA"],required:!0}),a.createElement(pn.a,{type:i.fields.gca.error?"error":"info"},i.fields.gca.error||""),a.createElement(Nt,{label:"Pilot",onSelect:function(e){return o(Dt.setField(["pilot",e]))},dropzoneId:Number(null==(l=s.currentDropzone)?void 0:l.id),value:i.fields.pilot.value||null,requiredPermissions:["actAsPilot"]}),a.createElement(pn.a,{type:i.fields.pilot.error?"error":"info"},i.fields.pilot.error||"")))}var Mt=Me.a.create({fields:{flex:1,width:"100%"},field:{marginBottom:8,width:"100%"}}),Ut=t(182);function qt(e){var n=Object(Ut.a)().height,t=ze((function(e){return e.global})).theme;return l.a.createElement(fn.a,{style:[Bt.container,{backgroundColor:t.colors.surface,height:n-112},e.style],contentContainerStyle:[Bt.content,e.contentContainerStyle]},e.children)}var Rt,Bt=Me.a.create({container:{flex:1},content:{paddingHorizontal:16,alignItems:"flex-start",flexGrow:1,paddingBottom:50}}),Wt=X.actions,Lt=(N.actions,Object(g.gql)(Rt||(Rt=nn()(["\n  mutation CreateLoad(\n    $name: String,\n    $pilotId: Int,\n    $gcaId: Int,\n    $maxSlots: Int!,\n    $planeId: Int,\n    $isOpen: Boolean,\n  ){\n    createLoad(input: {\n      attributes: {\n        name: $name,\n        pilotId: $pilotId,\n        gcaId: $gcaId,\n        maxSlots: $maxSlots,\n        planeId: $planeId,\n        isOpen: $isOpen,\n      }\n    }) {\n      load {\n        id\n        name\n        pilot {\n          id\n          user {\n            id \n            name\n          }\n        }\n        gca {\n          id\n          user {\n            id \n            name\n          }\n        }\n        maxSlots\n        isOpen\n      }\n      fieldErrors {\n        field,\n        message\n      }\n      errors\n    }\n  }\n"]))));function Ht(){var e=ze((function(e){return e})),n=e.loadForm,t=e.global,r=ke(),l=Object(tn.useNavigation)(),i=Object(g.useMutation)(Lt),o=q()(i,2),s=o[0],u=o[1],c=a.useCallback((function(){var e=!1;return n.fields.maxSlots.value<1&&(e=!0,r(Wt.setFieldError(["maxSlots","Please specify amount of allowed jumpers"]))),n.fields.plane.value||(e=!0,r(Wt.setFieldError(["plane","What plane is flying this load?"]))),n.fields.gca.value||(e=!0,r(Wt.setFieldError(["gca","You must have a GCA for this load"]))),!e}),[JSON.stringify(n.fields),r]),d=a.useCallback((function(){var e,a,i,o,u,d,m,f,p,g,v,b,h,y,E,S,x,I,k,z,O,w,C,j,T,P,F,$;return Pe.a.async((function(N){for(;;)switch(N.prev=N.next){case 0:if(e=n.fields,a=e.name,i=e.gca,e.loadMaster,o=e.plane,u=e.maxSlots,d=e.pilot,m=e.isOpen,!c()){N.next=15;break}return N.prev=2,N.next=5,Pe.a.awrap(s({variables:{dropzoneId:Number(null==(f=t.currentDropzone)?void 0:f.id),name:a.value,maxSlots:u.value,planeId:null!=(p=o.value)&&p.id?Number(null==(g=o.value)?void 0:g.id):null,pilotId:null!=(v=d.value)&&v.id?Number(null==(b=o.value)?void 0:b.id):null,gcaId:null!=(h=i.value)&&null!=(y=h.user)&&y.id?Number(null==(E=i.value)||null==(S=E.user)?void 0:S.id):null,isOpen:!!m.value}}));case 5:if(T=N.sent,null==(x=T.data)||null==(I=x.createLoad)||null==(k=I.fieldErrors)||k.map((function(e){var n=e.field,t=e.message;switch(n){case"name":return r(Wt.setFieldError(["name",t]));case"maxSlots":return r(Wt.setFieldError(["maxSlots",t]));case"plane":return r(Wt.setFieldError(["plane",t]));case"gca":return r(Wt.setFieldError(["gca",t]));case"is_open":return r(Wt.setFieldError(["isOpen",t]));case"pilot":return r(Wt.setFieldError(["pilot",t]))}})),null==T||null==(z=T.data)||null==(O=z.createLoad)||null==(w=O.errors)||!w.length){N.next=9;break}return N.abrupt("return",r(jt.showSnackbar({message:T.data.createLoad.errors[0],variant:"error"})));case 9:null!=(C=T.data)&&null!=(j=C.createLoad)&&j.load&&($=T.data.createLoad.load,r(jt.showSnackbar({message:"Load "+$.name+" created",variant:"success"})),null!=(P=T.data)&&null!=(F=P.createLoad)&&F.fieldErrors||l.goBack()),N.next=15;break;case 12:N.prev=12,N.t0=N.catch(2),r(jt.showSnackbar({message:N.t0.message,variant:"error"}));case 15:case"end":return N.stop()}}),null,null,[[2,12]],Promise)}),[JSON.stringify(n.fields),r,s]);return a.createElement(qt,{contentContainerStyle:Qt.content},a.createElement(Xe.a,{name:"airplane-takeoff",size:100,color:"#999999",style:{alignSelf:"center",marginTop:32}}),a.createElement(At,null),a.createElement(Hn,{style:Qt.fields},a.createElement(mn.a,{mode:"contained",style:Qt.button,disabled:u.loading,onPress:d,loading:u.loading},"Save")))}var Vt,Qt=Me.a.create({content:{paddingHorizontal:48},button:{},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fields:{marginVertical:16,width:"100%"},field:{marginBottom:8}}),Jt=t(301),_t=t(37),Gt=Object(g.gql)(Vt||(Vt=nn()(["\n  query QueryDropzonesCompact {\n    dropzones {\n      edges {\n        node {\n          id\n          name\n        }\n      }\n    }\n  }\n"])));var Yt=Me.a.create({warning:{flexDirection:"row",alignItems:"center",height:56,width:"100%",backgroundColor:"#ffbb33",justifyContent:"space-between",paddingHorizontal:32}}),Zt=function(e){var n,t,r,i,o,s,u,c=e.navigation,m=e.previous,f=e.scene,p=Object(a.useState)(!1),v=q()(p,2),b=v[0],h=v[1],y=Object(g.useQuery)(Gt).data,E=ze((function(e){return e.global})),S=E.currentDropzone,x=(E.theme,ke()),I=!(null==S||null==(n=S.currentUser)||null==(t=n.user)||null==(r=t.rigs)||!r.length),k=!(null==S||null==(i=S.currentUser)||null==(o=i.user)||!o.exitWeight),z=!I||!k;return l.a.createElement(l.a.Fragment,null,l.a.createElement(Jt.a.Header,null,m?l.a.createElement(Jt.a.BackAction,{onPress:c.goBack}):null,l.a.createElement(Jt.a.Content,{title:f.descriptor.options.title}),l.a.createElement(yn.a,{onDismiss:function(){return h(!1)},visible:b,anchor:l.a.createElement(_t.a,{onPress:function(){return h(!0)},style:{color:"white",marginRight:8}},null==S?void 0:S.name)},null==y||null==(s=y.dropzones)||null==(u=s.edges)?void 0:u.map((function(e){var n;return l.a.createElement(yn.a.Item,{title:null==e||null==(n=e.node)?void 0:n.name,onPress:function(){x(me.setDropzone(null==e?void 0:e.node)),h(!1)}})})))),z&&l.a.createElement(d.a,{style:Yt.warning},l.a.createElement(Mn.a,null,"You need to complete your profile"),l.a.createElement(mn.a,{color:"black",mode:"outlined",onPress:function(){return c.navigate("Profile")}},"Take me there")))},Kt=Object(He.a)();function Xt(){var e=ze((function(e){return e.global}));return a.createElement(Kt.Navigator,{screenOptions:{headerShown:!(!e.credentials||!e.currentDropzone),header:function(e){return a.createElement(Zt,e)},cardStyle:{flex:1}}},a.createElement(Kt.Screen,{name:"DropzoneScreen",component:ht,options:{title:"Manifest"}}),a.createElement(Kt.Screen,{name:"LoadScreen",component:zt,options:{title:"Loads"}}),a.createElement(Kt.Screen,{name:"CreateLoadScreen",component:Ht,options:{title:"Create load"}}))}Me.a.create({container:{flex:1,alignItems:"center",justifyContent:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"}}),Object(He.a)();var er=t(167),nr=t(353),tr=t.n(nr);t(462);function rr(e){var n=a.useState(!1),t=q()(n,2),r=t[0],l=t[1];a.useCallback((function(){l(!1)}),[l]),a.useCallback((function(n){var t=n.date;l(!1),e.onChange(t.getTime()/1e3)}),[l,e.onChange]);return a.createElement(a.Fragment,null,a.createElement(yn.a,{onDismiss:function(){return l(!1)},visible:r,anchor:a.createElement(gn.a.Item,{onPress:function(){return l(!0)},disabled:!!e.disabled,title:e.label,description:e.timestamp?Object(er.a)(1e3*e.timestamp,"yyyy/MM/dd"):"No date selected",left:function(){return a.createElement(gn.a.Icon,{icon:"calendar"})}})},a.createElement(tr.a,{selectedDays:e.timestamp?[new Date(1e3*e.timestamp)]:[],onDayClick:function(n){e.onChange(n.getTime()/1e3),l(!1)}})))}var ar=oe.actions;function lr(){var e,n=ze((function(e){return e.rigForm})),t=ke(),r=a.useState(!1),l=q()(r,2);l[0],l[1];return a.createElement(a.Fragment,null,a.createElement(hn.a,{style:sr.field,mode:"outlined",label:"Make",error:!!n.fields.make.error,value:n.fields.make.value||"",onChangeText:function(e){return t(ar.setField(["make",e]))}}),a.createElement(pn.a,{type:n.fields.make.error?"error":"info"},n.fields.make.error||"e.g Javelin, Mirage"),a.createElement(hn.a,{style:sr.field,mode:"outlined",label:"Model",error:!!n.fields.model.error,value:n.fields.model.value||"",onChangeText:function(e){return t(ar.setField(["model",e]))}}),a.createElement(pn.a,{type:n.fields.model.error?"error":"info"},n.fields.model.error||"e.g G4.1"),a.createElement(hn.a,{style:sr.field,mode:"outlined",label:"Serial",error:!!n.fields.serial.error,value:n.fields.serial.value||"",onChangeText:function(e){return t(ar.setField(["serial",e]))}}),a.createElement(pn.a,{type:n.fields.serial.error?"error":"info"},n.fields.serial.error||""),a.createElement(hn.a,{style:sr.field,mode:"outlined",label:"Current canopy size",error:!!n.fields.canopySize.error,value:(null==(e=n.fields.canopySize.value)?void 0:e.toString())||"",keyboardType:"number-pad",onChangeText:function(e){return t(ar.setField(["canopySize",Number(e)]))}}),a.createElement(pn.a,{type:n.fields.canopySize.error?"error":"info"},n.fields.canopySize.error||"Size of canopy in container"),a.createElement(rr,{timestamp:n.fields.repackExpiresAt.value||(new Date).getTime()/1e3,onChange:function(e){return t(ar.setField(["repackExpiresAt",e]))},label:"Reserve repack expiry date"}))}var ir,or,sr=Me.a.create({fields:{flex:1},field:{marginBottom:8}});function ur(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function cr(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?ur(Object(t),!0).forEach((function(n){p()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ur(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var dr,mr=Object(g.gql)(ir||(ir=nn()(["\n  mutation CreateRig(\n    $make: String,\n    $model: String,\n    $serial: String,\n    $canopySize: Int,\n    $repackExpiresAt: Int\n    $userId: Int\n    $dropzoneId: Int\n  ) {\n    createRig(\n      input: {\n        attributes: {\n          make: $make\n          model: $model\n          serial: $serial\n          repackExpiresAt: $repackExpiresAt\n          dropzoneId: $dropzoneId\n          userId: $userId\n          canopySize: $canopySize\n        }\n      }\n    ) {\n      errors\n      fieldErrors {\n        field\n        message\n      }\n      rig {\n        id\n        make\n        model\n        serial\n        canopySize\n        repackExpiresAt\n        packValue\n        maintainedAt\n\n        user {\n          id\n          rigs {\n            id\n            make\n            model\n            serial\n            canopySize\n            repackExpiresAt\n            packValue\n            maintainedAt\n          }\n        }\n      }\n    }\n  }\n"]))),fr=Object(g.gql)(or||(or=nn()(["\n  mutation UpdateRig(\n    $id: Int!\n    $make: String,\n    $model: String,\n    $serial: String,\n    $canopySize: Int,\n    $repackExpiresAt: Int\n    $userId: Int\n    $dropzoneId: Int\n  ) {\n    updateRig(\n      input: {\n        id: $id,\n        attributes: {\n          make: $make\n          model: $model\n          serial: $serial\n          repackExpiresAt: $repackExpiresAt\n          dropzoneId: $dropzoneId\n          userId: $userId\n          canopySize: $canopySize\n        }\n      }\n    ) {\n      errors\n      fieldErrors {\n        field\n        message\n      }\n      rig {\n        id\n        make\n        model\n        serial\n        canopySize\n        repackExpiresAt\n        packValue\n        maintainedAt\n\n        user {\n          id\n          rigs {\n            id\n            make\n            model\n            serial\n            canopySize\n            repackExpiresAt\n            packValue\n            maintainedAt\n          }\n        }\n      }\n    }\n  }\n"])));function pr(e){var n,t=ke(),r=ze((function(e){return e.rigForm})),i=ze((function(e){return e.global})),o=Object(g.useMutation)(mr),s=q()(o,2),u=s[0],c=s[1],d=Object(g.useMutation)(fr),m=q()(d,2),f=m[0],p=m[1],v=Object(a.useCallback)((function(){var e=!1;return r.fields.make.value||(e=!0,t(he.setFieldError(["make","Required"]))),r.fields.model.value||(e=!0,t(he.setFieldError(["model","Required"]))),r.fields.serial.value||(e=!0,t(he.setFieldError(["serial","Required"]))),r.fields.canopySize.value||(e=!0,t(he.setFieldError(["canopySize","Required"]))),r.fields.repackExpiresAt.value||(e=!0,t(he.setFieldError(["repackExpiresAt","Required"]))),!e}),[JSON.stringify(r.fields)]),b=Object(a.useCallback)((function(){var n,a,l,i,o,s,c,d,m,p,g,b;return Pe.a.async((function(h){for(;;)switch(h.prev=h.next){case 0:if(v()){h.next=2;break}return h.abrupt("return");case 2:return h.prev=2,p=null!=(n=r.original)&&n.id?f:u,h.next=6,Pe.a.awrap(p({variables:cr(cr({},null!=(a=r.original)&&a.id?{id:null==(l=r.original)?void 0:l.id}:{}),{},{make:r.fields.make.value,model:r.fields.model.value,serial:r.fields.serial.value,canopySize:r.fields.canopySize.value,repackExpiresAt:r.fields.repackExpiresAt.value,userId:e.userId?Number(e.userId):null,dropzoneId:e.dropzoneId?Number(e.dropzoneId):null})}));case 6:if(g=h.sent,null==(b=null!=(i=r.original)&&i.id?null==(o=g.data)?void 0:o.updateRig:null==(s=g.data)?void 0:s.createRig)||null==(c=b.fieldErrors)||c.map((function(e){var n=e.field,r=e.message;switch(n){case"make":return t(he.setFieldError(["make",r]));case"model":return t(he.setFieldError(["model",r]));case"serial":return t(he.setFieldError(["serial",r]));case"canopySize":return t(he.setFieldError(["canopySize",r]));case"repack_expires_at":return t(he.setFieldError(["repackExpiresAt",r]))}})),null==b||null==(d=b.errors)||!d.length){h.next=11;break}return h.abrupt("return",t(pe.showSnackbar({message:null==b?void 0:b.errors[0],variant:"error"})));case 11:null!=b&&null!=(m=b.fieldErrors)&&m.length||e.onSuccess(),h.next=17;break;case 14:h.prev=14,h.t0=h.catch(2),t(pe.showSnackbar({message:h.t0.message,variant:"error"}));case 17:case"end":return h.stop()}}),null,null,[[2,14]],Promise)}),[JSON.stringify(r.fields),u,e.onSuccess]);return l.a.createElement(cn.a,null,l.a.createElement(dn.a,{visible:!!e.open},l.a.createElement(sn.a,{indeterminate:!0,visible:c.loading||p.loading,color:i.theme.colors.accent}),l.a.createElement(dn.a.Title,null,(null!=r&&null!=(n=r.original)&&n.id?"Edit":"New")+" rig"),l.a.createElement(dn.a.Content,null,l.a.createElement(lr,null)),l.a.createElement(dn.a.Actions,{style:{justifyContent:"flex-end"}},l.a.createElement(mn.a,{onPress:function(){t(he.reset()),e.onClose()}},"Cancel"),l.a.createElement(mn.a,{onPress:b},"Save"))))}var gr=Object(an.a)(dr||(dr=nn()(["\n  query RolesQuery($dropzoneId: Int!) {\n    dropzone(id: $dropzoneId) {\n      id\n      roles {\n        id\n        name\n      }\n    }\n  }\n"])));function vr(e){var n,t,r,i,o=Object(a.useState)(!1),s=q()(o,2),u=s[0],c=s[1],d=ze((function(e){return e.global})),m=Object(g.useQuery)(gr,{variables:{dropzoneId:Number(null==(n=d.currentDropzone)?void 0:n.id)}}),f=m.data;m.loading,m.refetch;return l.a.createElement(l.a.Fragment,null,l.a.createElement(gn.a.Subheader,{style:{paddingLeft:0}},"Access level"),l.a.createElement(yn.a,{onDismiss:function(){return c(!1)},visible:!e.disabled&&u,anchor:l.a.createElement(gn.a.Item,{left:function(){return l.a.createElement(gn.a.Icon,{icon:"lock"})},onPress:e.disabled?void 0:function(){c(!0)},title:(null==(t=e.value)?void 0:t.name)||"Access level",description:e.required?null:"Optional"})},null==f||null==(r=f.dropzone)||null==(i=r.roles)?void 0:i.map((function(n){return l.a.createElement(gn.a.Item,{onPress:function(){c(!1),e.onSelect(n)},title:n.name||"-"})}))))}var br=le.actions;function hr(){var e,n,t=ze((function(e){return e})),r=t.dropzoneUserForm,l=(t.global,ke()),i=wn("updatePermission");return a.createElement(a.Fragment,null,a.createElement(vr,{value:r.fields.role.value,onSelect:function(e){return l(br.setField(["role",e]))},disabled:!i,required:!0}),a.createElement(pn.a,{type:r.fields.role.error?"error":"info"},r.fields.role.error),a.createElement(gn.a.Subheader,{style:{paddingLeft:0}},"Financial"),a.createElement(rr,{timestamp:r.fields.expiresAt.value||(new Date).getTime()/1e3,onChange:function(e){return l(br.setField(["expiresAt",e]))},label:"Membership expires"}),a.createElement(pn.a,{type:r.fields.expiresAt.error?"error":"info"},r.fields.expiresAt.error),a.createElement(hn.a,{style:Er.field,mode:"outlined",label:"Credits",error:!!r.fields.credits.error,value:(null==(e=r.fields.credits.value)?void 0:e.toString())||"",keyboardType:"number-pad",onChangeText:function(e){return l(br.setField(["credits",Number(e)]))}}),a.createElement(pn.a,{type:r.fields.credits.error?"error":"info"},r.fields.credits.error||"Current balance: $"+((null==(n=r.original)?void 0:n.credits)||0)))}var yr,Er=Me.a.create({fields:{flex:1},field:{marginBottom:8}});function Sr(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function xr(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Sr(Object(t),!0).forEach((function(n){p()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Sr(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var Ir,kr=Object(g.gql)(yr||(yr=nn()(["\n  mutation UpdateDropzoneUser(\n    $credits: Float,\n    $userRoleId: Int,\n    $expiresAt: Int,\n    $dropzoneUserId: Int\n  ) {\n    updateDropzoneUser(\n      input: {\n        id: $dropzoneUserId,\n        attributes: {\n          credits: $credits,\n          userRoleId: $userRoleId,\n          expiresAt: $expiresAt,\n        }\n      }\n    ) {\n      errors\n      fieldErrors {\n        field\n        message\n      }\n      dropzoneUser {\n        id\n        credits\n        expiresAt\n        role {\n          id\n          name\n        }\n\n        user {\n          id\n          name\n        }\n      }\n    }\n  }\n"])));function zr(e){var n,t=ke(),r=ze((function(e){return e.dropzoneUserForm})),i=ze((function(e){return e.global})),o=Object(g.useMutation)(kr),s=q()(o,2),u=s[0],c=s[1],d=Object(a.useCallback)((function(){var e=!1;return r.fields.credits.value||(e=!0,t(be.setFieldError(["credits","Required"]))),r.fields.role.value||(e=!0,t(be.setFieldError(["role","User must have an access level"]))),r.fields.expiresAt.value||(e=!0,t(be.setFieldError(["expiresAt","Membership expiry must be set"]))),!e}),[JSON.stringify(r.fields)]),m=Object(a.useCallback)((function(){var n,a,l,i,o,s,c,m,f,p,g,v;return Pe.a.async((function(b){for(;;)switch(b.prev=b.next){case 0:if(d()){b.next=2;break}return b.abrupt("return");case 2:return b.prev=2,b.next=5,Pe.a.awrap(u({variables:xr(xr({},null!=(n=r.original)&&n.id?{id:null==(a=r.original)?void 0:a.id}:{}),{},{credits:r.fields.credits.value,userRoleId:Number(null==(l=r.fields.role.value)?void 0:l.id),expiresAt:r.fields.expiresAt.value,dropzoneUserId:Number(null==(i=r.original)?void 0:i.id)})}));case 5:if(g=b.sent,null==(v=null!=(o=r.original)&&o.id?null==(s=g.data)?void 0:s.updateRig:null==(c=g.data)?void 0:c.createRig)||null==(m=v.fieldErrors)||m.map((function(e){var n=e.field,r=e.message;switch(n){case"user_role":return t(be.setFieldError(["role",r]));case"credits":return t(be.setFieldError(["credits",r]));case"expires_at":return t(be.setFieldError(["expiresAt",r]))}})),null==v||null==(f=v.errors)||!f.length){b.next=10;break}return b.abrupt("return",t(pe.showSnackbar({message:null==v?void 0:v.errors[0],variant:"error"})));case 10:null!=v&&null!=(p=v.fieldErrors)&&p.length||e.onSuccess(),b.next=16;break;case 13:b.prev=13,b.t0=b.catch(2),t(pe.showSnackbar({message:b.t0.message,variant:"error"}));case 16:case"end":return b.stop()}}),null,null,[[2,13]],Promise)}),[JSON.stringify(r.fields),u,e.onSuccess]);return l.a.createElement(cn.a,null,l.a.createElement(dn.a,{visible:!!e.open},l.a.createElement(sn.a,{indeterminate:!0,visible:c.loading,color:i.theme.colors.accent}),l.a.createElement(dn.a.Title,null,(null!=r&&null!=(n=r.original)&&n.id?"Edit":"New")+" dropzone user"),l.a.createElement(dn.a.Content,null,l.a.createElement(hr,null)),l.a.createElement(dn.a.Actions,{style:{justifyContent:"flex-end"}},l.a.createElement(mn.a,{onPress:function(){t(be.reset()),e.onClose()}},"Cancel"),l.a.createElement(mn.a,{onPress:m},"Save"))))}var Or=Object(an.a)(Ir||(Ir=nn()(["\n  query QueryDropzoneUser($dropzoneId: Int!, $dropzoneUserId: Int!) {\n    dropzone(id: $dropzoneId) {\n      id\n      name\n\n      dropzoneUser(id: $dropzoneUserId) {\n        id\n        credits\n        expiresAt\n        role {\n          id\n          name\n        }\n        user {\n          id\n          name\n          exitWeight\n          email\n          phone\n          rigs {\n            id\n            model\n            make\n            serial\n            canopySize\n            repackExpiresAt\n          }\n          jumpTypes {\n            id\n            name\n          }\n          license {\n            id\n            name\n          }\n        }\n      }\n    }\n  }\n"])));function wr(){var e,n,t,r,l,i,o,s,u,c,d,m,f,p,v,b,h,y,E,S,x,I,k,z,O,w,C,j,T,P,F,$,N,D,A,M,U,R,B,W=ze((function(e){return e.global})),L=ke(),H=Object(tn.useNavigation)(),V=a.useState(!1),Q=q()(V,2),J=Q[0],_=Q[1],G=a.useState(!1),Y=q()(G,2),Z=Y[0],K=Y[1],X=Object(tn.useRoute)(),ee=(null==(e=W.currentDropzone)||null==(n=e.currentUser)?void 0:n.id)===X.params.userId,ne=wn("actAsRigInspector"),te=Object(g.useQuery)(Or,{variables:{dropzoneId:Number(null==(t=W.currentDropzone)?void 0:t.id),dropzoneUserId:Number(X.params.userId)}}),re=te.data,ae=te.loading,le=a.useCallback((function(e){return function(){ee?ne&&H.navigate("RigInspectionScreen",{dropzoneUserId:Number(X.params.userId),rig:e}):(L(he.setOriginal(e)),_(!0))}}),[L,_]);return a.createElement(a.Fragment,null,a.createElement(sn.a,{color:W.theme.colors.accent,indeterminate:!0,visible:ae}),a.createElement(qt,{contentContainerStyle:Cr.content},a.createElement(Zn.a,{elevation:3,style:Cr.card},a.createElement(Zn.a.Title,{title:"Basic information"}),a.createElement(Zn.a.Content,null,a.createElement(gn.a.Item,{title:"Name",left:function(){return a.createElement(gn.a.Icon,{icon:"account-outline"})},description:(null==re||null==(r=re.dropzone)||null==(l=r.dropzoneUser)||null==(i=l.user)?void 0:i.name)||"-"}),a.createElement(gn.a.Item,{title:"Email",left:function(){return a.createElement(gn.a.Icon,{icon:"at"})},description:(null==re||null==(o=re.dropzone)||null==(s=o.dropzoneUser)||null==(u=s.user)?void 0:u.email)||"-"}),a.createElement(gn.a.Item,{title:"Phone",left:function(){return a.createElement(gn.a.Icon,{icon:"phone"})},description:(null==re||null==(c=re.dropzone)||null==(d=c.dropzoneUser)||null==(m=d.user)?void 0:m.phone)||"-"}),a.createElement(gn.a.Item,{title:"License",left:function(){return a.createElement(gn.a.Icon,{icon:"ticket-account"})},description:(null==re||null==(f=re.dropzone)||null==(p=f.dropzoneUser)||null==(v=p.user)||null==(b=v.license)?void 0:b.name)||"-"}),a.createElement(gn.a.Item,{title:"Exit weight",left:function(){return a.createElement(gn.a.Icon,{icon:"scale"})},description:(null==re||null==(h=re.dropzone)||null==(y=h.dropzoneUser)||null==(E=y.user)?void 0:E.exitWeight)||"-"})),ee&&a.createElement(Zn.a.Actions,{style:{justifyContent:"flex-end"}},a.createElement(mn.a,{icon:"pencil",onPress:function(){var e,n;return H.navigate("UpdateUserScreen",{user:null==(e=W.currentDropzone)||null==(n=e.currentUser)?void 0:n.user})}},"Edit"))),a.createElement(Zn.a,{elevation:3,style:Cr.card},a.createElement(Zn.a.Title,{title:null==(S=W.currentDropzone)?void 0:S.name}),a.createElement(Zn.a.Content,null,a.createElement(gn.a.Item,{title:"Role",description:null==re||null==(x=re.dropzone)||null==(I=x.dropzoneUser)||null==(k=I.role)?void 0:k.name,left:function(){return a.createElement(gn.a.Icon,{icon:"lock"})}}),a.createElement(gn.a.Item,{title:"Credits",description:null==re||null==(z=re.dropzone)||null==(O=z.dropzoneUser)?void 0:O.credits,left:function(){return a.createElement(gn.a.Icon,{icon:"cash-multiple"})}}),a.createElement(gn.a.Item,{title:"Membership",description:null!=re&&null!=(w=re.dropzone)&&null!=(C=w.dropzoneUser)&&C.expiresAt?Object(er.a)(1e3*((null==re||null==(j=re.dropzone)||null==(T=j.dropzoneUser)?void 0:T.expiresAt)||0),"yyyy/MM/dd"):a.createElement("span",null,"Not a member"),left:function(){var e,n,t,r;return a.createElement(gn.a.Icon,{icon:"card-account-details",color:null!=re&&null!=(e=re.dropzone)&&null!=(n=e.dropzoneUser)&&n.expiresAt&&1e3*(null==re||null==(t=re.dropzone)||null==(r=t.dropzoneUser)?void 0:r.expiresAt)>(new Date).getTime()?void 0:"#B00020"})}})),a.createElement(Zn.a.Actions,{style:{justifyContent:"flex-end"}},a.createElement(mn.a,{icon:"pencil",onPress:function(){var e;L(be.setOriginal(null==re||null==(e=re.dropzone)?void 0:e.dropzoneUser)),K(!0)}},"Edit"))),a.createElement(Zn.a,{elevation:3,style:Cr.card},a.createElement(Zn.a.Title,{title:"Rigs"}),a.createElement(Zn.a.Content,null,a.createElement(Kn.a,null,a.createElement(Kn.a.Header,null,a.createElement(Kn.a.Title,null,"Container"),a.createElement(Kn.a.Title,{numeric:!0},"Repack due"),a.createElement(Kn.a.Title,{numeric:!0},"Canopy size")),null==re||null==(P=re.dropzone)||null==(F=P.dropzoneUser)||null==($=F.user)||null==(N=$.rigs)?void 0:N.map((function(e){return a.createElement(Kn.a.Row,{onPress:le(e),pointerEvents:"none"},a.createElement(Kn.a.Cell,null,[null==e?void 0:e.make,null==e?void 0:e.model,"#"+(null==e?void 0:e.serial)].join(" ")),a.createElement(Kn.a.Cell,{numeric:!0},null!=e&&e.repackExpiresAt?Object(er.a)(1e3*e.repackExpiresAt,"yyyy/MM/dd"):"-"),a.createElement(Kn.a.Cell,{numeric:!0},""+(null==e?void 0:e.canopySize)))})))),ee&&a.createElement(Zn.a.Actions,{style:{justifyContent:"flex-end"}},a.createElement(mn.a,{onPress:function(){return _(!0)}},"Add rig"))),(null==re||null==(D=re.dropzone)||null==(A=D.dropzoneUser)?void 0:A.id)===(null==(M=W.currentUser)?void 0:M.id)&&a.createElement(mn.a,{color:"#B00020",onPress:function(){return L(me.logout())}},"Log out")),a.createElement(pr,{onClose:function(){return _(!1)},onSuccess:function(){return _(!1)},userId:Number(null==re||null==(U=re.dropzone)||null==(R=U.dropzoneUser)||null==(B=R.user)?void 0:B.id),open:J}),a.createElement(zr,{onClose:function(){return K(!1)},onSuccess:function(){return K(!1)},open:Z}))}var Cr=Me.a.create({container:{flex:1},content:{alignItems:"center",flexGrow:1,paddingBottom:56},card:{margin:8,width:"100%"},fields:{width:"80%",display:"flex"},spacer:{width:"100%",height:32},title:{fontSize:20,fontWeight:"bold"},fab:{position:"absolute",margin:16,right:0,bottom:0},separator:{marginVertical:30,height:1,width:"80%"}});function jr(){return a.createElement(Hn,{style:Fr.container},a.createElement(Ln,{style:Fr.title},"Tab One"),a.createElement(Hn,{style:Fr.separator,lightColor:"#eee",darkColor:"rgba(255,255,255,0.1)"}),a.createElement(xt,{path:"/screens/RigScreen.tsx"}))}var Tr,Pr,Fr=Me.a.create({container:{flex:1,alignItems:"center",justifyContent:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"}}),$r=Object(an.a)(Tr||(Tr=nn()(["\n  query Licenses($federationId: Int) {\n    licenses(federationId: $federationId) {\n      id\n      name\n\n      federation {\n        id\n        name\n      }\n\n    }\n  }\n"])));function Nr(e){var n,t,r=Object(a.useState)(!1),i=q()(r,2),o=i[0],s=i[1],u=(ze((function(e){return e.global})),Object(g.useQuery)($r,{variables:{federationId:e.federationId}})),c=u.data;u.loading,u.refetch;return l.a.createElement(l.a.Fragment,null,l.a.createElement(gn.a.Subheader,null,"License"),l.a.createElement(yn.a,{onDismiss:function(){return s(!1)},visible:o,anchor:l.a.createElement(gn.a.Item,{onPress:function(){s(!0)},title:(null==(n=e.value)?void 0:n.name)||"Please select a license",description:e.required?null:"Optional"})},null==c||null==(t=c.licenses)?void 0:t.map((function(n){return l.a.createElement(gn.a.Item,{onPress:function(){s(!1),e.onSelect(n)},title:n.name||"-"})}))))}var Dr=Object(an.a)(Pr||(Pr=nn()(["\n  query Federations {\n    federations {\n      id\n      name\n    }\n  }\n"])));function Ar(e){var n,t,r=Object(a.useState)(!1),i=q()(r,2),o=i[0],s=i[1],u=Object(g.useQuery)(Dr).data;return Object(a.useEffect)((function(){var n;1!==(null==u||null==(n=u.federations)?void 0:n.length)||e.value||e.onSelect(u.federations[0])}),[JSON.stringify(null==u?void 0:u.federations)]),l.a.createElement(l.a.Fragment,null,l.a.createElement(gn.a.Subheader,null,"Federation"),l.a.createElement(yn.a,{onDismiss:function(){return s(!1)},visible:o,anchor:l.a.createElement(gn.a.Item,{onPress:function(){s(!0)},title:(null==(n=e.value)?void 0:n.name)||"Please select federation",description:e.required?null:"Optional"})},null==u||null==(t=u.federations)?void 0:t.map((function(n){return l.a.createElement(gn.a.Item,{onPress:function(){s(!1),e.onSelect(n)},title:n.name||"-"})}))))}var Mr=re.actions;function Ur(){var e,n,t,r,l,i,o,s,u,c,d,m,f,p,g,v,b,h,y,E,S,x,I,k,z,O,w,C=ze((function(e){return e.userForm})),j=ke(),T=ze((function(e){return e.global}));a.useEffect((function(){var e;C.original&&(C.fields.exitWeight.value||j(Mr.setField(["exitWeight",C.original.exitWeight||"60"])),!C.fields.rigs.value&&null!=(e=C.original)&&e.id&&j(Mr.setField(["rigs",C.original.rigs])))}),[null==(e=C.original)?void 0:e.id]);null==C||null==(n=C.original)||n.id,null==C||null==(t=C.original)||t.id,null==(r=T.currentUser)||r.id;return a.createElement(a.Fragment,null,a.createElement(hn.a,{style:Rr.field,mode:"outlined",label:"Name",error:!!C.fields.name.error,value:(null==(l=C.fields.name)||null==(i=l.value)?void 0:i.toString())||"",onChangeText:function(e){return j(Mr.setField(["name",e]))}}),a.createElement(pn.a,{type:C.fields.name.error?"error":"info"},C.fields.name.error||" "),a.createElement(hn.a,{style:Rr.field,mode:"outlined",label:"Email",error:!!C.fields.email.error,value:(null==(o=C.fields.email)||null==(s=o.value)?void 0:s.toString())||"",onChangeText:function(e){return j(Mr.setField(["email",e]))}}),a.createElement(pn.a,{type:C.fields.email.error?"error":"info"},C.fields.email.error||" "),a.createElement(hn.a,{style:Rr.field,mode:"outlined",label:"Phone",error:!!C.fields.phone.error,value:(null==(u=C.fields.phone)||null==(c=u.value)?void 0:c.toString())||"",onChangeText:function(e){return j(Mr.setField(["phone",e]))}}),a.createElement(pn.a,{type:C.fields.phone.error?"error":"info"},C.fields.phone.error||""),a.createElement(hn.a,{style:Rr.field,mode:"outlined",label:"Exit weight",error:!!C.fields.exitWeight.error,value:(null==(d=C.fields.exitWeight)||null==(m=d.value)?void 0:m.toString())||"",keyboardType:"numbers-and-punctuation",right:function(){return a.createElement(hn.a.Affix,{text:"kg"})},onChangeText:function(e){return j(Mr.setField(["exitWeight",e]))}}),a.createElement(pn.a,{type:C.fields.exitWeight.error?"error":"info"},C.fields.exitWeight.error||""),a.createElement(bn.a,null),a.createElement(Ar,{value:(null==C||null==(f=C.fields)||null==(p=f.license)||null==(g=p.value)?void 0:g.federation)||C.federation.value,onSelect:function(e){return j(Mr.setFederation(e))},required:!0}),a.createElement(pn.a,{type:C.federation.error?"error":"info"},C.federation.error||""),((null==C||null==(v=C.fields)||null==(b=v.license)||null==(h=b.value)||null==(y=h.federation)?void 0:y.id)||(null==C||null==(E=C.federation)||null==(S=E.value)?void 0:S.id))&&a.createElement(a.Fragment,null,a.createElement(Nr,{value:C.fields.license.value,federationId:Number((null==C||null==(x=C.fields)||null==(I=x.license)||null==(k=I.value)||null==(z=k.federation)?void 0:z.id)||(null==(O=C.federation)||null==(w=O.value)?void 0:w.id)),onSelect:function(e){return j(Mr.setField(["license",e]))},required:!0}),a.createElement(pn.a,{type:C.fields.license.error?"error":"info"},C.fields.license.error||"")))}var qr,Rr=Me.a.create({fields:{flex:1,width:"100%",paddingTop:32},field:{marginBottom:8,width:"100%"},ticketAddons:{marginBottom:8}}),Br=re.actions,Wr=(N.actions,Object(g.gql)(qr||(qr=nn()(["\n  mutation UpdateUser(\n    $id: Int,\n    $name: String,\n    $phone: String,\n    $email: String,\n    $licenseId: Int,\n    $exitWeight: Float,\n  ){\n    updateUser(input: {\n      id: $id\n      attributes: {\n        name: $name,\n        phone: $phone,\n        email: $email,\n        licenseId: $licenseId,\n        exitWeight: $exitWeight,\n      }\n    }) {\n      user {\n        id\n        name\n        exitWeight\n        email\n        phone\n        rigs {\n          id\n          model\n          make\n          serial\n          canopySize\n        }\n        jumpTypes {\n          id\n          name\n        }\n        license {\n          id\n          name\n\n          federation {\n            id\n            name\n          }\n        }\n      }\n    }\n  }\n"]))));function Lr(){var e=ze((function(e){return e})),n=e.userForm,t=(e.global,ke()),r=Object(tn.useNavigation)(),l=Object(tn.useRoute)().params.user;a.useEffect((function(){t(Br.setOriginal(l))}),[null==l?void 0:l.id]);var i=Object(g.useMutation)(Wr),o=q()(i,2),s=o[0],u=o[1],c=a.useCallback((function(){var e,r,a,l,i,o,s,u,c,d=!1,m=new RegExp(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/);return((null==(e=n.fields.name)||null==(r=e.value)?void 0:r.length)||0)<3&&(d=!0,t(Br.setFieldError(["name","Name is too short"]))),((null==(a=n.fields.email)||null==(l=a.value)?void 0:l.length)||0)<3&&(d=!0,t(Br.setFieldError(["email","Email is too short"]))),((null==(i=n.fields.phone)||null==(o=i.value)?void 0:o.length)||0)<3&&(d=!0,t(Br.setFieldError(["phone","Phone number is too short"]))),m.test((null==(s=n.fields)||null==(u=s.email)?void 0:u.value)||"")||(d=!0,t(Br.setFieldError(["email","Please enter a valid email"]))),((null==(c=n.fields.exitWeight)?void 0:c.value)||0)<30&&(d=!0,t(Br.setFieldError(["exitWeight","Exit weight seems too low?"]))),!d}),[JSON.stringify(n.fields),t]),d=a.useCallback((function(){var e,a,l,i,o,u,d,m,f,p,g,v,b;return Pe.a.async((function(h){for(;;)switch(h.prev=h.next){case 0:if(e=n.fields,a=e.name,l=e.license,i=e.phone,o=e.email,u=e.exitWeight,!c()){h.next=12;break}return h.prev=2,h.next=5,Pe.a.awrap(s({variables:{id:Number(n.original.id),name:a.value,licenseId:null!=(d=l.value)&&d.id?Number(l.value.id):null,phone:i.value,exitWeight:parseFloat(u.value),email:o.value}}));case 5:p=h.sent,null!=(m=p.data)&&null!=(f=m.updateUser)&&f.user&&(g=p.data.updateUser,v=g.fieldErrors,b=g.errors,v?null==v||v.map((function(e){var n=e.field,r=e.message;switch(n){case"name":return t(ve.setFieldError(["name",r]));case"exit_weight":return t(ve.setFieldError(["exitWeight",r]));case"license_id":return t(ve.setFieldError(["license",r]));case"phone":return t(ve.setFieldError(["phone",r]));case"email":return t(ve.setFieldError(["email",r]))}})):null!=b&&b.length?b.map((function(e){return t(jt.showSnackbar({message:e,variant:"error"}))})):(t(jt.showSnackbar({message:"Profile has been updated",variant:"success"})),r.goBack(),t(ve.reset()))),h.next=12;break;case 9:h.prev=9,h.t0=h.catch(2),t(jt.showSnackbar({message:h.t0.message,variant:"error"}));case 12:case"end":return h.stop()}}),null,null,[[2,9]],Promise)}),[JSON.stringify(n.fields),t,s]);return a.createElement(qt,{contentContainerStyle:{paddingHorizontal:48}},a.createElement(Ur,null),a.createElement(Hn,{style:Hr.fields},a.createElement(mn.a,{mode:"contained",disabled:u.loading,onPress:d,loading:u.loading},"Save")))}var Hr=Me.a.create({container:{flex:1,alignItems:"center",paddingTop:56},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fields:{width:"100%",marginBottom:16},field:{marginBottom:8}}),Vr=Object(He.a)();function Qr(){var e,n=ze((function(e){return e.global})).currentDropzone;return a.createElement(Vr.Navigator,{screenOptions:{headerShown:!0,header:function(e){return a.createElement(Zt,e)},cardStyle:{flex:1}}},a.createElement(Vr.Screen,{name:"ProfileScreen",component:wr,options:{title:"Profile"},initialParams:{userId:null==n||null==(e=n.currentUser)?void 0:e.id}}),a.createElement(Vr.Screen,{name:"UpdateUserScreen",component:Lr,options:{title:"Edit profile"}}),a.createElement(Vr.Screen,{name:"RigScreen",component:jr,options:{title:"Rig"}}))}function Jr(){var e=Object(tn.useNavigation)(),n=ze((function(e){return e.global}));return a.createElement(Hn,{style:_r.container},a.createElement(gn.a.Section,{title:"Dropzone"},a.createElement(gn.a.Item,{title:"Configuration",onPress:function(){return e.navigate("UpdateDropzoneScreen",{dropzone:n.currentDropzone})},left:function(){return a.createElement(gn.a.Icon,{color:"#000",icon:"information-outline"})}}),a.createElement(gn.a.Item,{title:"Planes",onPress:function(){return e.navigate("PlanesScreen")},left:function(){return a.createElement(gn.a.Icon,{color:"#000",icon:"airplane"})}}),a.createElement(gn.a.Item,{title:"Rigs",left:function(){return a.createElement(gn.a.Icon,{color:"#000",icon:"parachute"})},description:"Coming soon"})),a.createElement(gn.a.Section,{title:"Tickets"},a.createElement(gn.a.Item,{title:"Ticket types",onPress:function(){return e.navigate("TicketTypesScreen")},left:function(){return a.createElement(gn.a.Icon,{color:"#000",icon:"ticket"})}}),a.createElement(gn.a.Item,{title:"Ticket add-ons",onPress:function(){return e.navigate("ExtrasScreen")},left:function(){return a.createElement(gn.a.Icon,{color:"#000",icon:"plus"})}})))}var _r=Me.a.create({container:{flex:1,padding:8,display:"flex"},fab:{position:"absolute",margin:16,right:0,bottom:0},empty:{flex:1,alignItems:"center",justifyContent:"center",width:"100%",height:"100%"}});function Gr(){return a.createElement(Hn,{style:Kr.container},a.createElement(Ln,{style:Kr.title},"Tab One"),a.createElement(Hn,{style:Kr.separator,lightColor:"#eee",darkColor:"rgba(255,255,255,0.1)"}),a.createElement(xt,{path:"/screens/DropzoneSettingsScreen.tsx"}))}var Yr,Zr,Kr=Me.a.create({container:{flex:1,alignItems:"center",justifyContent:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"}}),Xr=t(110),ea=t(293),na=Object(an.a)(Yr||(Yr=nn()(["\n  query QueryTicketType(\n    $dropzoneId: Int!\n  ) {\n    ticketTypes(dropzoneId: $dropzoneId) {\n      id\n      cost\n      currency\n      name\n      altitude\n      allowManifestingSelf\n\n      extras {\n        id\n        name\n      }\n    }\n  }\n"]))),ta=Object(an.a)(Zr||(Zr=nn()(["\n  mutation UpdateTicketTypePublic(\n    $id: Int!,\n    $allowManifestingSelf: Boolean\n  ){\n    updateTicketType(input: {\n      id: $id\n      attributes: {\n        allowManifestingSelf: $allowManifestingSelf\n      }\n    }) {\n      ticketType {\n        id\n        name\n        altitude\n        cost\n        allowManifestingSelf\n        extras {\n          id\n          name\n          cost\n        }\n      }\n    }\n  }\n"])));function ra(){var e,n,t=ze((function(e){return e.global})),r=Object(g.useQuery)(na,{variables:{dropzoneId:Number(null==(e=t.currentDropzone)?void 0:e.id)}}),l=r.data,i=r.loading,o=r.refetch,s=Object(tn.useNavigation)(),u=Object(tn.useRoute)(),c=Object(tn.useIsFocused)();a.useEffect((function(){c&&o()}),[c]);var d=Object(g.useMutation)(ta),m=q()(d,2),f=m[0];m[1];return a.useEffect((function(){"TicketTypesScreen"===u.name&&o()}),[u.name]),a.createElement(qt,{style:aa.container,contentContainerStyle:[aa.content,{backgroundColor:"white"}],refreshControl:a.createElement(Xr.a,{refreshing:i,onRefresh:o})},a.createElement(sn.a,{visible:i,color:t.theme.colors.accent}),a.createElement(Kn.a,null,a.createElement(Kn.a.Header,null,a.createElement(Kn.a.Title,null,"Name"),a.createElement(Kn.a.Title,{numeric:!0},"Cost"),a.createElement(Kn.a.Title,{numeric:!0},"Altitude"),a.createElement(Kn.a.Title,{numeric:!0},"Public")),null==l||null==(n=l.ticketTypes)?void 0:n.map((function(e){return a.createElement(Kn.a.Row,{onPress:function(){return s.navigate("UpdateTicketTypeScreen",{ticketType:e})},pointerEvents:"none"},a.createElement(Kn.a.Cell,null,e.name),a.createElement(Kn.a.Cell,{numeric:!0},"$",e.cost),a.createElement(Kn.a.Cell,{numeric:!0},e.altitude),a.createElement(Kn.a.Cell,{numeric:!0},a.createElement(ea.a,{onValueChange:function(){f({variables:{id:Number(e.id),allowManifestingSelf:!e.allowManifestingSelf}})},value:!!e.allowManifestingSelf})))}))),a.createElement(un.a,{style:aa.fab,small:!0,icon:"plus",onPress:function(){return s.navigate("CreateTicketTypeScreen")},label:"New ticket type"}))}var aa=Me.a.create({container:{flex:1,display:"flex"},content:{flexGrow:1},fab:{position:"absolute",margin:16,right:0,bottom:0},empty:{flex:1,alignItems:"center",justifyContent:"center",width:"100%",height:"100%"}}),la=J.actions;function ia(){var e,n,t,r,l=ze((function(e){return e.planeForm})),i=ke();return a.createElement(a.Fragment,null,a.createElement(hn.a,{style:sa.field,mode:"outlined",label:"Name",error:!!l.fields.name.error,value:l.fields.name.value,onChangeText:function(e){return i(la.setField(["name",e]))}}),a.createElement(pn.a,{type:l.fields.name.error?"error":"info"},l.fields.name.error||""),a.createElement(hn.a,{style:sa.field,mode:"outlined",label:"Registration",error:!!l.fields.registration.error,value:l.fields.registration.value,onChangeText:function(e){return i(la.setField(["registration",e]))}}),a.createElement(pn.a,{type:l.fields.registration.error?"error":"info"},l.fields.registration.error||""),a.createElement(hn.a,{style:sa.field,mode:"outlined",label:"hours",error:!!l.fields.hours.error,value:null==(e=l.fields.hours)||null==(n=e.value)?void 0:n.toString(),placeholder:"Optional",onChangeText:function(e){return i(la.setField(["hours",Number(e)]))}}),a.createElement(pn.a,{type:l.fields.hours.error?"error":"info"},l.fields.hours.error||""),a.createElement(hn.a,{style:sa.field,mode:"outlined",label:"Min slots",error:!!l.fields.minSlots.error,value:null==(t=l.fields.minSlots.value)?void 0:t.toString(),keyboardType:"number-pad",onChangeText:function(e){return i(la.setField(["minSlots",Number(e)]))}}),a.createElement(pn.a,{type:l.fields.minSlots.error?"error":"info"},l.fields.minSlots.error||"Minimum tickets required to send it"),a.createElement(hn.a,{style:sa.field,mode:"outlined",label:"Max slots",error:!!l.fields.maxSlots.error,value:null==(r=l.fields.maxSlots)?void 0:r.value.toString(),keyboardType:"number-pad",onChangeText:function(e){return i(la.setField(["maxSlots",Number(e)]))}}),a.createElement(pn.a,{type:l.fields.maxSlots.error?"error":"info"},l.fields.maxSlots.error||"Maximum amount of jumpers who can be manifested on one load"))}var oa,sa=Me.a.create({fields:{width:"100%",flex:1},field:{width:"100%",marginBottom:8}}),ua=J.actions,ca=(N.actions,Object(g.gql)(oa||(oa=nn()(["\n  mutation CreatePlane(\n    $name: String!,\n    $registration: String!,\n    $dropzoneId: Int!\n    $minSlots: Int!\n    $maxSlots: Int!\n    $hours: Int\n    $nextMaintenanceHours: Int\n  ){\n    createPlane(input: {\n      attributes: {\n        name: $name,\n        registration: $registration,\n        dropzoneId: $dropzoneId\n        minSlots: $minSlots\n        maxSlots: $maxSlots\n        hours: $hours\n        nextMaintenanceHours: $nextMaintenanceHours\n      }\n    }) {\n      plane {\n        id\n        name\n        registration\n        minSlots\n        maxSlots\n        hours\n        nextMaintenanceHours\n\n        dropzone {\n          id\n          name\n          planes {\n            id\n            name\n            registration\n            minSlots\n            maxSlots\n            hours\n            nextMaintenanceHours\n          }\n        }\n      }\n    }\n  }\n"]))));function da(){var e=ze((function(e){return e})),n=e.planeForm,t=e.global,r=ke(),l=Object(tn.useNavigation)(),i=Object(g.useMutation)(ca),o=q()(i,2),s=o[0],u=o[1],c=Object(tn.useIsFocused)();a.useEffect((function(){c&&r(ua.reset())}),[c]);var d=a.useCallback((function(){var e=!1;return n.fields.name.value.length<3&&(e=!0,r(ua.setFieldError(["name","Name is too short"]))),n.fields.registration.value.length<3&&(e=!0,r(ua.setFieldError(["registration","Registration is too short"]))),n.fields.maxSlots.value||(e=!0,r(ua.setFieldError(["maxSlots","Max slots must be specified"]))),!e}),[JSON.stringify(n.fields),r]),m=a.useCallback((function(){var e,a,i,o,u,c,m,f,p,g,v,b;return Pe.a.async((function(h){for(;;)switch(h.prev=h.next){case 0:if(e=n.fields,a=e.name,i=e.registration,o=e.maxSlots,u=e.minSlots,c=e.hours,m=e.nextMaintenanceHours,!d()){h.next=12;break}return h.prev=2,h.next=5,Pe.a.awrap(s({variables:{dropzoneId:Number(null==(f=t.currentDropzone)?void 0:f.id),name:a.value,registration:i.value,minSlots:u.value,maxSlots:o.value,hours:c.value,nextMaintenanceHours:m.value}}));case 5:v=h.sent,null!=(p=v.data)&&null!=(g=p.createPlane)&&g.plane&&(b=v.data.createPlane.plane,r(jt.showSnackbar({message:"Added plane "+b.name,variant:"success"})),l.goBack()),h.next=12;break;case 9:h.prev=9,h.t0=h.catch(2),r(jt.showSnackbar({message:h.t0.message,variant:"error"}));case 12:case"end":return h.stop()}}),null,null,[[2,9]],Promise)}),[JSON.stringify(n.fields),r,s]);return a.createElement(qt,{contentContainerStyle:fa.content},a.createElement(Xe.a,{name:"airplane",size:100,color:"#999999",style:{alignSelf:"center"}}),a.createElement(ia,null),a.createElement(Hn,{style:fa.fields},a.createElement(mn.a,{mode:"contained",disabled:u.loading,onPress:m,loading:u.loading},"Save")))}var ma,fa=Me.a.create({content:{paddingHorizontal:48},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fields:{width:"100%",marginBottom:16},field:{marginBottom:8}}),pa=J.actions,ga=(N.actions,Object(g.gql)(ma||(ma=nn()(["\n  mutation UpdatePlane(\n    $id: Int!,\n    $name: String!,\n    $registration: String!,\n    $minSlots: Int!\n    $maxSlots: Int!\n    $hours: Int\n    $nextMaintenanceHours: Int\n  ){\n    updatePlane(input: {\n      id: $id\n      attributes: {\n        name: $name,\n        registration: $registration,\n        minSlots: $minSlots\n        maxSlots: $maxSlots\n        hours: $hours\n        nextMaintenanceHours: $nextMaintenanceHours\n      }\n    }) {\n      plane {\n        id\n        name\n        registration\n        minSlots\n        maxSlots\n        hours\n        nextMaintenanceHours\n\n        dropzone {\n          id\n          name\n          planes {\n            id\n            name\n            registration\n            minSlots\n            maxSlots\n            hours\n            nextMaintenanceHours\n          }\n        }\n      }\n    }\n  }\n"]))));function va(){var e=ze((function(e){return e})),n=e.planeForm,t=(e.global,ke()),r=Object(tn.useNavigation)(),l=Object(tn.useRoute)().params.plane;a.useEffect((function(){t(pa.setOriginal(l))}),[null==l?void 0:l.id]);var i=Object(g.useMutation)(ga),o=q()(i,2),s=o[0],u=o[1],c=a.useCallback((function(){var e=!1;return n.fields.name.value.length<3&&(e=!0,t(pa.setFieldError(["name","Name is too short"]))),n.fields.registration.value.length<3&&(e=!0,t(pa.setFieldError(["registration","Registration is too short"]))),n.fields.maxSlots.value||(e=!0,t(pa.setFieldError(["maxSlots","Max slots must be specified"]))),!e}),[JSON.stringify(n.fields),t]),d=a.useCallback((function(){var e,a,l,i,o,u,d,m,f,p,g;return Pe.a.async((function(v){for(;;)switch(v.prev=v.next){case 0:if(e=n.fields,a=e.name,l=e.registration,i=e.maxSlots,o=e.minSlots,u=e.hours,d=e.nextMaintenanceHours,!c()){v.next=12;break}return v.prev=2,v.next=5,Pe.a.awrap(s({variables:{id:Number(n.original.id),name:a.value,registration:l.value,minSlots:o.value,maxSlots:i.value,hours:u.value,nextMaintenanceHours:d.value}}));case 5:p=v.sent,null!=(m=p.data)&&null!=(f=m.updatePlane)&&f.plane&&(g=p.data.updatePlane.plane,t(jt.showSnackbar({message:"Saved plane "+g.name,variant:"success"})),r.goBack()),v.next=12;break;case 9:v.prev=9,v.t0=v.catch(2),t(jt.showSnackbar({message:v.t0.message,variant:"error"}));case 12:case"end":return v.stop()}}),null,null,[[2,9]],Promise)}),[JSON.stringify(n.fields),t,s]);return a.createElement(qt,{contentContainerStyle:ha.content},a.createElement(Xe.a,{name:"airplane",size:100,color:"#999999",style:{alignSelf:"center"}}),a.createElement(ia,null),a.createElement(Hn,{style:ha.actions},a.createElement(mn.a,{mode:"contained",disabled:u.loading,onPress:d,loading:u.loading},"Save")))}var ba,ha=Me.a.create({content:{paddingHorizontal:48},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},actions:{width:"100%",marginBottom:16},field:{marginBottom:8}}),ya=t(364),Ea=t(362),Sa=t(354),xa=t.n(Sa),Ia=V.actions,ka=Object(g.gql)(ba||(ba=nn()(["\n  query QueryFederations {\n    federations {\n      id\n      name\n    }\n  }\n"])));function za(){var e,n,t,r,i=ze((function(e){return e})),o=i.dropzoneForm,s=i.global,u=ke(),c=Object(g.useQuery)(ka),d=c.data,m=(c.loading,Object(a.useState)(!1)),f=q()(m,2),p=f[0],v=f[1],b=Object(a.useState)(null),h=q()(b,2),y=h[0],E=h[1];Object(a.useEffect)((function(){var e,n;null==d||null==(e=d.federations)||!e.length||null!=(n=o.fields.federation)&&n.value||u(Ia.setField(["federation",d.federations[0]]))}),[JSON.stringify(null==d?void 0:d.federations)]);var S=Object(a.useCallback)((function(){var e;return Pe.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Pe.a.awrap(Object(ya.a)({multiple:!1,type:"image"}));case 3:e=n.sent,u(Ia.setField(["banner",e.uri])),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),console.log(n.t0);case 10:case"end":return n.stop()}}),null,null,[[0,7]],Promise)}),[u]);return l.a.createElement(l.a.Fragment,null,l.a.createElement(cn.a,null,l.a.createElement(dn.a,{visible:!!y,onDismiss:function(){return E(null)}},l.a.createElement(dn.a.Title,null,"Pick a ","primary"===y?"primary color":"secondary color"),l.a.createElement(dn.a.Content,{style:{padding:20,height:400}},l.a.createElement(Ea.a,{onColorSelected:function(e){u("primary"===y?Ia.setField(["primaryColor",e]):Ia.setField(["secondaryColor",e]))},style:{flex:1},sliderComponent:xa.a,defaultColor:("primary"===y?o.fields.primaryColor.value:o.fields.secondaryColor.value)||void 0,hideSliders:!0})),l.a.createElement(dn.a.Actions,null,l.a.createElement(mn.a,{onPress:function(){return E(null)}},"Cancel"),l.a.createElement(mn.a,{disabled:"primary"===y&&!o.fields.primaryColor.value||"secondary"===y&&!o.fields.secondaryColor.value,onPress:function(){console.log({current:s.theme.colors.accent,next:o.fields.secondaryColor.value}),u("primary"===y?me.setPrimaryColor(o.fields.primaryColor.value):me.setAccentColor(o.fields.secondaryColor.value)),E(null)}},"Save")))),l.a.createElement(Zn.a,{style:{width:"100%",maxHeight:300,marginVertical:16}},l.a.createElement(Zn.a.Cover,{source:{uri:o.fields.banner.value||"https://picsum.photos/700"},resizeMode:"cover"}),l.a.createElement(Zn.a.Actions,{style:{justifyContent:"flex-end"}},l.a.createElement(mn.a,{onPress:S},"Upload"))),l.a.createElement(Zn.a,{style:{width:"100%",marginVertical:16,paddingHorizontal:16}},l.a.createElement(gn.a.Subheader,{style:Ca.subheader},"Dropzone"),l.a.createElement(hn.a,{style:Ca.field,mode:"outlined",label:"Name",error:!!o.fields.name.error,value:o.fields.name.value||"",onChangeText:function(e){return u(Ia.setField(["name",e]))}}),l.a.createElement(pn.a,{type:"error"},o.fields.name.error||""),l.a.createElement(gn.a.Subheader,{style:Ca.subheader},"Federation"),l.a.createElement(yn.a,{onDismiss:function(){return v(!1)},visible:p,anchor:l.a.createElement(yn.a.Item,{onPress:function(){return v(!0)},title:(null==(e=o.fields)||null==(n=e.federation)||null==(t=n.value)?void 0:t.name)||"",icon:"parachute"})},null==d||null==(r=d.federations)?void 0:r.map((function(e){return l.a.createElement(yn.a.Item,{title:e.name,onPress:function(){u(Ia.setField(["federation",e])),v(!1)}})}))),l.a.createElement(pn.a,{type:"error"},o.fields.federation.error||""),l.a.createElement(gn.a.Subheader,{style:Ca.subheader},"Branding"),l.a.createElement(gn.a.Item,{title:"Primary color",onPress:function(){return E("primary")},left:function(){return l.a.createElement(Hn,{style:{width:24,height:24,backgroundColor:s.theme.colors.primary}})}}),l.a.createElement(gn.a.Item,{title:"Secondary color",onPress:function(){return E("secondary")},left:function(){return l.a.createElement(Hn,{style:{width:24,height:24,backgroundColor:s.theme.colors.accent}})}}),l.a.createElement(gn.a.Item,{title:"Use credit system",description:"Users will be charged credits when a load is marked as landed and can't manifest with insufficient funds.",onPress:function(){return u(Ia.setField(["isCreditSystemEnabled",!o.fields.isCreditSystemEnabled.value]))},left:function(){return l.a.createElement(Tt.a,{onPress:function(){return u(Ia.setField(["isCreditSystemEnabled",!o.fields.isCreditSystemEnabled.value]))},status:o.fields.isCreditSystemEnabled.value?"checked":"unchecked"})}}),l.a.createElement(gn.a.Item,{title:"Public",description:"Your dropzone will not be available in the app if this is disabled",onPress:function(){return u(Ia.setField(["isPublic",!o.fields.isPublic.value]))},left:function(){return l.a.createElement(Tt.a,{onPress:function(){return u(Ia.setField(["isPublic",!o.fields.isPublic.value]))},status:o.fields.isPublic.value?"checked":"unchecked"})}})))}var Oa,wa,Ca=Me.a.create({fields:{flexGrow:1,display:"flex",width:"100%"},field:{marginBottom:8,width:"100%"},subheader:{paddingLeft:0}});function ja(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function Ta(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?ja(Object(t),!0).forEach((function(n){p()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ja(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var Pa=V.actions,Fa=N.actions,$a=Object(g.gql)(Oa||(Oa=nn()(["\n  query QueryDropzoneDetails($dropzoneId: Int!) {\n    dropzone(id: $dropzoneId) {\n      id\n      name\n      primaryColor,\n      secondaryColor,\n      planes {\n        id\n        name\n        registration\n      }\n      ticketTypes {\n        id\n        name\n      }\n    }\n  }\n"]))),Na=Object(g.gql)(wa||(wa=nn()(["\n  mutation UpdateDropzone(\n    $id: Int!,\n    $name: String!,\n    $banner: String,\n    $federationId: Int!\n    $primaryColor: String\n    $secondaryColor: String\n    $isCreditSystemEnabled: Boolean,\n    $isPublic: Boolean\n  ){\n    updateDropzone(input: {\n      id: $id\n      attributes: {\n        name: $name,\n        banner: $banner,\n        federationId: $federationId\n        primaryColor: $primaryColor\n        secondaryColor: $secondaryColor\n        isCreditSystemEnabled: $isCreditSystemEnabled\n        isPublic: $isPublic\n      }\n    }) {\n      dropzone {\n        id\n        name\n        banner\n        primaryColor\n        secondaryColor,\n        isCreditSystemEnabled\n\n        planes {\n          id\n          name\n        }\n\n        federation {\n          id\n          name\n        }\n      }\n    }\n  }\n"])));function Da(){var e,n=ze((function(e){return e.dropzoneForm})),t=ze((function(e){return e.global})),r=ke(),l=Object(tn.useRoute)().params.dropzone,i=Object(tn.useNavigation)(),o=Object(g.useQuery)($a,{variables:{dropzoneId:Number(l.id)}}),s=o.data,u=o.loading;a.useEffect((function(){var e;null!=s&&null!=(e=s.dropzone)&&e.id&&r(Pa.setOriginal(s.dropzone))}),[null==s||null==(e=s.dropzone)?void 0:e.id]);var c=Object(g.useMutation)(Na),d=q()(c,2),m=d[0],f=d[1],p=a.useCallback((function(){var e,a,o,s,u,c,d,f,p,g,v,b,h,y,E,S,x,I,k,z,O,w,C,j,T,P,F,$;return Pe.a.async((function(N){for(;;)switch(N.prev=N.next){case 0:if(o=!1,s=n.fields,u=s.name,c=s.banner,d=s.federation,f=s.primaryColor,p=s.secondaryColor,g=s.isCreditSystemEnabled,v=s.isPublic,(null==(e=u.value)||!e.length||(null==(a=u.value)?void 0:a.length)<3)&&(o=!0,r(Pa.setFieldError(["name","Name is too short"]))),o){N.next=19;break}return N.prev=4,N.next=7,Pe.a.awrap(m({variables:{id:Number(null==l?void 0:l.id),name:u.value,banner:c.value||null,primaryColor:f.value,secondaryColor:p.value,federationId:Number(null==d||null==(b=d.value)?void 0:b.id),isCreditSystemEnabled:!!g,isPublic:!!v}}));case 7:if(null==(w=N.sent)||null==(h=w.data)||null==(y=h.updateDropzone)||null==(E=y.fieldErrors)||E.map((function(e){var n=e.field,t=e.message;switch(n){case"federation":case"federation_id":return r(Pa.setFieldError(["federation",t]));case"banner":return r(Pa.setFieldError(["banner",t]));case"primary_color":return r(Pa.setFieldError(["primaryColor",t]));case"secondary_color":return r(Pa.setFieldError(["secondaryColor",t]));case"is_credit_system_enabled":return r(Pa.setFieldError(["isCreditSystemEnabled",t]));case"name":return r(Pa.setFieldError(["name",t]));case"is_public":return r(Pa.setFieldError(["isPublic",t]))}})),null==w||null==(S=w.data)||null==(x=S.updateDropzone)||null==(I=x.errors)||!I.length){N.next=13;break}return N.abrupt("return",r(pe.showSnackbar({message:null==w||null==(C=w.data)||null==(j=C.updateDropzone)?void 0:j.errors[0],variant:"error"})));case 13:null!=w&&null!=(k=w.data)&&null!=(z=k.updateDropzone)&&null!=(O=z.fieldErrors)&&O.length||null!=(T=w.data)&&null!=(P=T.updateDropzone)&&P.dropzone&&(r(Fa.setDropzone(Ta(Ta({},t.currentDropzone||{}),null==w||null==(F=w.data)||null==($=F.updateDropzone)?void 0:$.dropzone))),r(jt.showSnackbar({message:"Saved",variant:"success"})),i.goBack());case 14:N.next=19;break;case 16:N.prev=16,N.t0=N.catch(4),r(jt.showSnackbar({message:N.t0.message,variant:"error"}));case 19:case"end":return N.stop()}}),null,null,[[4,16]],Promise)}),[JSON.stringify(n.fields),r,m]);return a.createElement(a.Fragment,null,a.createElement(sn.a,{indeterminate:!0,color:t.theme.colors.accent,visible:u}),a.createElement(qt,{contentContainerStyle:Ma.content},a.createElement(za,null),a.createElement(Hn,{style:Ma.fields},a.createElement(mn.a,{mode:"contained",disabled:f.loading,onPress:p,loading:f.loading},"Save"))))}var Aa,Ma=Me.a.create({container:{flex:1,backgroundColor:"white",display:"flex"},content:{display:"flex",flexGrow:1,alignItems:"center",padding:48},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fields:{width:"70%",marginBottom:16},field:{marginBottom:8}}),Ua=Object(an.a)(Aa||(Aa=nn()(["\n  query QueryPlanes(\n    $dropzoneId: Int!\n  ) {\n    planes(dropzoneId: $dropzoneId) {\n      id\n      name\n      registration\n      hours\n      minSlots\n      maxSlots\n      nextMaintenanceHours\n      createdAt\n    }\n  }\n"])));function qa(){var e,n,t,r,l=ze((function(e){return e.global})),i=Object(g.useQuery)(Ua,{variables:{dropzoneId:Number(null==(e=l.currentDropzone)?void 0:e.id)}}),o=i.data,s=i.loading,u=i.refetch,c=Object(tn.useNavigation)(),d=Object(tn.useIsFocused)();return a.useEffect((function(){d&&u()}),[d]),a.createElement(qt,{refreshControl:a.createElement(Xr.a,{refreshing:s,onRefresh:u})},a.createElement(sn.a,{visible:s,color:l.theme.colors.accent}),!(null!=o&&null!=(n=o.planes)&&n.length)&&a.createElement(Vn,{title:"No planes?",subtitle:"You need to have at least one plane to manifest loads"}),(null==o||null==(t=o.planes)?void 0:t.length)&&a.createElement(Kn.a,null,a.createElement(Kn.a.Header,null,a.createElement(Kn.a.Title,null,"Name"),a.createElement(Kn.a.Title,{numeric:!0},"Registration"),a.createElement(Kn.a.Title,{numeric:!0},"Slots")),null==o||null==(r=o.planes)?void 0:r.map((function(e){return a.createElement(Kn.a.Row,{pointerEvents:"none",onPress:function(){return c.navigate("UpdatePlaneScreen",{plane:e})}},a.createElement(Kn.a.Cell,null,e.name),a.createElement(Kn.a.Cell,{numeric:!0},e.registration),a.createElement(Kn.a.Cell,{numeric:!0},e.maxSlots))}))),a.createElement(un.a,{style:Ba.fab,small:!0,icon:"plus",onPress:function(){return c.navigate("CreatePlaneScreen")},label:"New plane"}))}var Ra,Ba=Me.a.create({content:{flexGrow:1},fab:{position:"absolute",margin:16,right:0,bottom:0},empty:{flex:1,alignItems:"center",justifyContent:"center",width:"100%",height:"100%"}}),Wa=G.actions,La=Object(an.a)(Ra||(Ra=nn()(["\n  query QueryExtras(\n    $dropzoneId: Int!\n  ) {\n    extras(dropzoneId: $dropzoneId) {\n      id\n      cost\n      name\n\n      ticketTypes {\n        id\n        name\n      }\n    }\n  }\n"])));function Ha(){var e,n,t,r,l,i=ze((function(e){return e.ticketTypeForm})),o=ke(),s=ze((function(e){return e.global})),u=a.useState(!1),c=q()(u,2),m=c[0],f=c[1],p=Object(g.useQuery)(La,{variables:{dropzoneId:Number(null==(e=s.currentDropzone)?void 0:e.id)}}),v=p.data;p.loading,p.refetch;return a.createElement(a.Fragment,null,a.createElement(hn.a,{style:Qa.field,mode:"outlined",label:"Name",error:!!i.fields.name.error,value:i.fields.name.value||"",onChangeText:function(e){return o(Wa.setField(["name",e]))}}),a.createElement(pn.a,{type:i.fields.name.error?"error":"info"},i.fields.name.error||"Name of the ticket users will see"),a.createElement(hn.a,{style:Qa.field,mode:"outlined",label:"Price",error:!!i.fields.cost.error,value:null==(n=i.fields.cost)||null==(t=n.value)?void 0:t.toString(),onChangeText:function(e){return o(Wa.setField(["cost",Number(e)]))}}),a.createElement(pn.a,{type:i.fields.cost.error?"error":"info"},i.fields.cost.error||"Base cost without extra ticket addons"),a.createElement(d.a,{style:{width:"100%"}},a.createElement(yn.a,{onDismiss:function(){return f(!1)},visible:m,style:{position:"absolute",right:"10%",left:"10%",flex:1},anchor:a.createElement(gn.a.Item,{onPress:function(){f(!0)},title:i.fields.altitude.value&&[4e3,14e3].includes(i.fields.altitude.value)?{14e3:"Height",4e3:"Hop n Pop"}[i.fields.altitude.value.toString()]:"Custom",style:{width:"100%",flex:1},right:function(){return a.createElement(gn.a.Icon,{icon:i.fields.altitude.value&&[4e3,14e3].includes(i.fields.altitude.value)?{14e3:"airplane",4e3:"parachute"}[i.fields.altitude.value.toString()]:"pencil-plus"})}})},a.createElement(gn.a.Item,{onPress:function(){o(Wa.setField(["altitude",4e3])),f(!1)},title:"Hop n Pop",right:function(){return a.createElement(gn.a.Icon,{icon:"parachute"})}}),a.createElement(gn.a.Item,{onPress:function(){o(Wa.setField(["altitude",14e3])),f(!1)},title:"Height",right:function(){return a.createElement(gn.a.Icon,{icon:"airplane-takeoff"})}}),a.createElement(gn.a.Item,{onPress:function(){o(Wa.setField(["altitude",7e3])),f(!1)},title:"Other",right:function(){return a.createElement(gn.a.Icon,{icon:"parachute"})}})),(!i.fields.altitude.value||![4e3,14e3].includes(i.fields.altitude.value))&&a.createElement(hn.a,{style:Qa.field,mode:"outlined",label:"Custom altitude",error:!!i.fields.altitude.error,value:null==(r=i.fields.altitude)||null==(l=r.value)?void 0:l.toString(),onChangeText:function(e){return o(Wa.setField(["altitude",Number(e)]))}}),a.createElement(Tt.a.Item,{label:"Tandem",style:{width:"100%"},status:i.fields.isTandem.value?"checked":"unchecked",onPress:function(){return o(Wa.setField(["isTandem",!i.fields.isTandem.value]))}}),a.createElement(pn.a,{type:i.fields.isTandem.error?"error":"info"},i.fields.isTandem.error||"Allow also manifesting a passenger when using this ticket type"),a.createElement(Tt.a.Item,{label:"Public manifesting",style:{width:"100%"},status:i.fields.allowManifestingSelf.value?"checked":"unchecked",onPress:function(){return o(Wa.setField(["allowManifestingSelf",!i.fields.allowManifestingSelf.value]))}}),a.createElement(pn.a,{type:i.fields.allowManifestingSelf.error?"error":"info"},i.fields.allowManifestingSelf.error||"Allow users to manifest themselves with this ticket"),a.createElement(bn.a,null),a.createElement(gn.a.Subheader,null,"Enabled ticket add-ons"),null==v?void 0:v.extras.map((function(e){var n;return a.createElement(Tt.a.Item,{label:e.name,status:null!=(n=i.fields.extras.value)&&n.map((function(e){return e.id})).includes(e.id)?"checked":"unchecked",onPress:function(){var n,t;return o(Wa.setField(["extras",null!=(n=i.fields.extras.value)&&n.map((function(e){return e.id})).includes(e.id)?null==(t=i.fields.extras.value)?void 0:t.filter((function(n){return n.id!==e.id})):[].concat(ue()(i.fields.extras.value),[e])]))}})}))))}var Va,Qa=Me.a.create({field:{marginBottom:8,width:"100%"}}),Ja=G.actions,_a=(N.actions,Object(g.gql)(Va||(Va=nn()(["\n  mutation CreateTicketType(\n    $name: String,\n    $cost: Float,\n    $dropzoneId: Int!\n    $altitude: Int\n    $allowManifestingSelf: Boolean\n  ){\n    createTicketType(input: {\n      attributes: {\n        name: $name,\n        cost: $cost,\n        dropzoneId: $dropzoneId\n        altitude: $altitude\n        allowManifestingSelf: $allowManifestingSelf\n      }\n    }) {\n      ticketType {\n        id\n        name\n        altitude\n        cost\n        allowManifestingSelf\n        extras {\n          id\n          name\n          cost\n        }\n      }\n    }\n  }\n"]))));function Ga(){var e=ze((function(e){return e})),n=e.ticketTypeForm,t=e.global,r=ke(),l=Object(tn.useNavigation)(),i=Object(g.useMutation)(_a),o=q()(i,2),s=o[0],u=o[1],c=Object(tn.useIsFocused)();a.useEffect((function(){c&&r(Ja.reset())}),[c]);var d=a.useCallback((function(){var e=!1;return(!n.fields.name.value||n.fields.name.value.length<3)&&(e=!0,r(Ja.setFieldError(["name","Name is too short"]))),n.fields.cost.value<1&&(e=!0,r(Ja.setFieldError(["cost","Cost must be at least $1"]))),n.fields.altitude.value||(e=!0,r(Ja.setFieldError(["altitude","Altitude must be specified"]))),!e}),[JSON.stringify(n.fields),r]),m=a.useCallback((function(){var e,a,i,o,u,c,m,f,p,g,v,b,h,y,E,S,x,I,k,z;return Pe.a.async((function(O){for(;;)switch(O.prev=O.next){case 0:if(e=n.fields,a=e.name,i=e.cost,o=e.allowManifestingSelf,u=e.altitude,c=e.extras,m=e.isTandem,!d()){O.next=15;break}return O.prev=2,O.next=5,Pe.a.awrap(s({variables:{dropzoneId:Number(null==(f=t.currentDropzone)?void 0:f.id),name:a.value,cost:i.value,altitude:u.value,allowManifestingSelf:o.value,extraIds:null==c||null==(p=c.value)?void 0:p.map((function(e){return e.id})),isTandem:!!m.value}}));case 5:if(null==(I=O.sent)||null==(g=I.data)||null==(v=g.createTicketType)||null==(b=v.fieldErrors)||b.map((function(e){var n=e.field,t=e.message;switch(n){case"name":return r(Ja.setFieldError(["name",t]));case"altitude":return r(Ja.setFieldError(["altitude",t]));case"cost":return r(Ja.setFieldError(["cost",t]));case"allow_manifesting_self":return r(Ja.setFieldError(["allowManifestingSelf",t]));case"extras":return r(Ja.setFieldError(["extras",t]))}})),null==I||null==(h=I.data)||null==(y=h.createTicketType)||null==(E=y.errors)||!E.length){O.next=9;break}return O.abrupt("return",r(pe.showSnackbar({message:null==I||null==(k=I.data)||null==(z=k.createTicketType)?void 0:z.errors[0],variant:"error"})));case 9:null!=(S=I.data)&&null!=(x=S.createTicketType)&&x.ticketType&&(r(jt.showSnackbar({message:"Saved",variant:"success"})),l.goBack()),O.next=15;break;case 12:O.prev=12,O.t0=O.catch(2),r(jt.showSnackbar({message:O.t0.message,variant:"error"}));case 15:case"end":return O.stop()}}),null,null,[[2,12]],Promise)}),[JSON.stringify(n.fields),r,s]);return a.createElement(qt,{contentContainerStyle:{paddingHorizontal:48}},a.createElement(Xe.a,{name:"ticket",size:100,color:"#999999",style:{alignSelf:"center"}}),a.createElement(Ha,null),a.createElement(Hn,{style:Za.actions},a.createElement(mn.a,{mode:"contained",disabled:u.loading,onPress:m,loading:u.loading},"Save")))}var Ya,Za=Me.a.create({separator:{marginVertical:30,height:1,width:"80%"},actions:{marginVertical:16,width:"100%"}}),Ka=G.actions,Xa=(N.actions,Object(g.gql)(Ya||(Ya=nn()(["\n  mutation UpdateTicketType(\n    $id: Int!,\n    $name: String,\n    $cost: Float,\n    $dropzoneId: Int!\n    $altitude: Int\n    $allowManifestingSelf: Boolean\n  ){\n    updateTicketType(input: {\n      id: $id\n      attributes: {\n        name: $name,\n        cost: $cost,\n        dropzoneId: $dropzoneId\n        altitude: $altitude\n        allowManifestingSelf: $allowManifestingSelf\n      }\n    }) {\n      ticketType {\n        id\n        name\n        altitude\n        cost\n        allowManifestingSelf\n        extras {\n          id\n          name\n          cost\n        }\n      }\n    }\n  }\n"]))));function el(){var e=ze((function(e){return e})),n=e.ticketTypeForm,t=(e.global,ke()),r=Object(tn.useNavigation)(),l=Object(tn.useRoute)().params.ticketType;a.useEffect((function(){t(Ka.setOriginal(l))}),[null==l?void 0:l.id]);var i=Object(g.useMutation)(Xa),o=q()(i,2),s=o[0],u=o[1],c=a.useCallback((function(){var e=!1;return(!n.fields.name.value||n.fields.name.value.length<3)&&(e=!0,t(Ka.setFieldError(["name","Name is too short"]))),n.fields.cost.value<1&&(e=!0,t(Ka.setFieldError(["cost","Cost must be at least $1"]))),n.fields.altitude.value||(e=!0,t(Ka.setFieldError(["altitude","Altitude must be specified"]))),!e}),[JSON.stringify(n.fields),t]),d=a.useCallback((function(){var e,a,l,i,o,u,d,m,f,p,g,v,b,h,y,E,S,x,I;return Pe.a.async((function(k){for(;;)switch(k.prev=k.next){case 0:if(e=n.fields,a=e.name,l=e.cost,i=e.allowManifestingSelf,o=e.altitude,u=e.extras,d=e.isTandem,!c()){k.next=15;break}return k.prev=2,k.next=5,Pe.a.awrap(s({variables:{id:Number(n.original.id),name:a.value,cost:l.value,altitude:o.value,allowManifestingSelf:i.value,extraIds:null==u||null==(m=u.value)?void 0:m.map((function(e){return e.id})),isTandem:!!d.value}}));case 5:if(null==(S=k.sent)||null==(f=S.data)||null==(p=f.updateTicketType)||null==(g=p.fieldErrors)||g.map((function(e){var n=e.field,r=e.message;switch(n){case"name":return t(Ka.setFieldError(["name",r]));case"altitude":return t(Ka.setFieldError(["altitude",r]));case"cost":return t(Ka.setFieldError(["cost",r]));case"allow_manifesting_self":return t(Ka.setFieldError(["allowManifestingSelf",r]));case"extras":return t(Ka.setFieldError(["extras",r]))}})),null==S||null==(v=S.data)||null==(b=v.updateTicketType)||null==(h=b.errors)||!h.length){k.next=9;break}return k.abrupt("return",t(pe.showSnackbar({message:null==S||null==(x=S.data)||null==(I=x.updateTicketType)?void 0:I.errors[0],variant:"error"})));case 9:null!=(y=S.data)&&null!=(E=y.updateTicketType)&&E.ticketType&&(t(jt.showSnackbar({message:"Saved",variant:"success"})),r.goBack()),k.next=15;break;case 12:k.prev=12,k.t0=k.catch(2),t(jt.showSnackbar({message:k.t0.message,variant:"error"}));case 15:case"end":return k.stop()}}),null,null,[[2,12]],Promise)}),[JSON.stringify(n.fields),t,s]);return a.createElement(qt,{contentContainerStyle:{paddingHorizontal:48}},a.createElement(Xe.a,{name:"ticket",size:100,color:"#999999",style:{alignSelf:"center"}}),a.createElement(Ha,null),a.createElement(Hn,{style:tl.fields},a.createElement(mn.a,{mode:"contained",disabled:u.loading,onPress:d,loading:u.loading},"Save")))}var nl,tl=Me.a.create({container:{flex:1,alignItems:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fields:{width:"100%",marginVertical:16},field:{marginBottom:8}}),rl=t(355),al=Z.actions,ll=Object(an.a)(nl||(nl=nn()(["\n  query QueryTicketType(\n    $dropzoneId: Int!\n  ) {\n    ticketTypes(dropzoneId: $dropzoneId) {\n      id\n      cost\n      currency\n      name\n      allowManifestingSelf\n\n      extras {\n        id\n        name\n      }\n    }\n  }\n"])));function il(){var e,n,t,r=ze((function(e){return e.extraForm})),l=ke(),i=ze((function(e){return e.global})),o=Object(g.useQuery)(ll,{variables:{dropzoneId:Number(null==(e=i.currentDropzone)?void 0:e.id)}}),s=o.data;o.loading,o.refetch;return a.createElement(a.Fragment,null,a.createElement(hn.a,{style:sl.field,mode:"outlined",label:"Name",error:!!r.fields.name.error,value:r.fields.name.value,onChangeText:function(e){return l(al.setField(["name",e]))}}),a.createElement(pn.a,{type:r.fields.name.error?"error":"info"},r.fields.name.error||""),a.createElement(hn.a,{style:sl.field,mode:"outlined",label:"Price",error:!!r.fields.cost.error,value:null==(n=r.fields.cost)||null==(t=n.value)?void 0:t.toString(),onChangeText:function(e){return l(al.setField(["cost",Number(e)]))}}),a.createElement(pn.a,{type:r.fields.cost.error?"error":"info"},r.fields.cost.error||""),a.createElement(d.a,{style:{width:"100%"}},a.createElement(gn.a.Subheader,null,"Compatible tickets"),null==s?void 0:s.ticketTypes.map((function(e){return a.createElement(Tt.a.Item,{label:e.name,status:r.fields.ticketTypeIds.value.includes(Number(e.id))?"checked":"unchecked",onPress:function(){return l(al.setField(["ticketTypeIds",Object(rl.xor)(r.fields.ticketTypeIds.value,[Number(e.id)])]))}})}))))}var ol,sl=Me.a.create({fields:{width:"100%",flex:1},field:{marginBottom:8,width:"100%"}}),ul=Z.actions,cl=(N.actions,Object(g.gql)(ol||(ol=nn()(["\n  mutation CreateExtra(\n    $name: String,\n    $ticketTypeIds: [Int!]\n    $cost: Float\n    $dropzoneId: Int\n  ){\n    createExtra(input: {\n      attributes: {\n        name: $name,\n        ticketTypeIds: $ticketTypeIds\n        cost: $cost\n        dropzoneId: $dropzoneId\n      }\n    }) {\n      extra {\n        id\n        name\n\n        ticketTypes {\n          id\n          name\n          cost\n          altitude\n          allowManifestingSelf\n        }\n      }\n    }\n  }\n"]))));function dl(){var e=ze((function(e){return e})),n=e.extraForm,t=e.global,r=ke(),l=Object(tn.useNavigation)(),i=Object(tn.useIsFocused)();a.useEffect((function(){i&&r(ul.reset())}),[i]);var o=Object(g.useMutation)(cl),s=q()(o,2),u=s[0],c=s[1],d=a.useCallback((function(){var e=!1;return n.fields.name.value.length<3&&(e=!0,r(ul.setFieldError(["name","Name is too short"]))),Number(n.fields.cost.value)<0&&(e=!0,r(ul.setFieldError(["cost","Price must be a number"]))),!e}),[JSON.stringify(n.fields),r]),m=a.useCallback((function(){var e,a,i,o,s,c,m,f,p;return Pe.a.async((function(g){for(;;)switch(g.prev=g.next){case 0:if(e=n.fields,a=e.name,i=e.cost,o=e.ticketTypeIds,!d()){g.next=12;break}return g.prev=2,g.next=5,Pe.a.awrap(u({variables:{dropzoneId:Number(null==(s=t.currentDropzone)?void 0:s.id),name:a.value,cost:i.value,ticketTypeIds:o.value}}));case 5:f=g.sent,null!=(c=f.data)&&null!=(m=c.createExtra)&&m.extra&&(p=f.data.createExtra.extra,r(jt.showSnackbar({message:"Added extra "+p.name,variant:"success"})),l.goBack()),g.next=12;break;case 9:g.prev=9,g.t0=g.catch(2),r(jt.showSnackbar({message:g.t0.message,variant:"error"}));case 12:case"end":return g.stop()}}),null,null,[[2,9]],Promise)}),[JSON.stringify(n.fields),r,u]);return a.createElement(qt,{contentContainerStyle:{paddingHorizontal:48}},a.createElement(Xe.a,{name:"ticket-percent",size:100,color:"#999999",style:{alignSelf:"center"}}),a.createElement(il,null),a.createElement(Hn,{style:fl.fields},a.createElement(mn.a,{mode:"contained",disabled:c.loading,onPress:m,loading:c.loading},"Save")))}var ml,fl=Me.a.create({container:{flex:1,alignItems:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fields:{width:"100%",marginBottom:16},field:{width:"100%",marginBottom:8}}),pl=Z.actions,gl=(N.actions,Object(g.gql)(ml||(ml=nn()(["\n  mutation UpdateExtra(\n    $id: Int!,\n    $name: String,\n    $ticketTypeIds: [Int!]\n    $cost: Float\n    $dropzoneId: Int\n  ){\n    updateExtra(input: {\n      id: $id\n      attributes: {\n        name: $name,\n        ticketTypeIds: $ticketTypeIds\n        cost: $cost\n        dropzoneId: $dropzoneId\n      }\n    }) {\n      extra {\n        id\n        name\n\n        ticketTypes {\n          id\n          name\n          cost\n          altitude\n          allowManifestingSelf\n        }\n      }\n    }\n  }\n"]))));function vl(){var e=ze((function(e){return e})),n=e.extraForm,t=e.global,r=ke(),l=Object(tn.useNavigation)(),i=Object(tn.useRoute)().params.extra;a.useEffect((function(){r(pl.setOriginal(i))}),[null==i?void 0:i.id]);var o=Object(g.useMutation)(gl),s=q()(o,2),u=s[0],c=s[1],d=a.useCallback((function(){var e=!1;return n.fields.name.value.length<3&&(e=!0,r(pl.setFieldError(["name","Name is too short"]))),Number(n.fields.cost.value)<0&&(e=!0,r(pl.setFieldError(["cost","Price must be a number"]))),!e}),[JSON.stringify(n.fields),r]),m=a.useCallback((function(){var e,a,i,o,s,c,m,f;return Pe.a.async((function(p){for(;;)switch(p.prev=p.next){case 0:if(e=n.fields,a=e.name,i=e.cost,o=e.ticketTypeIds,!d()){p.next=12;break}return p.prev=2,p.next=5,Pe.a.awrap(u({variables:{id:Number(n.original.id),dropzoneId:Number(null==(s=t.currentDropzone)?void 0:s.id),name:a.value,cost:i.value,ticketTypeIds:o.value}}));case 5:f=p.sent,null!=(c=f.data)&&null!=(m=c.updateExtra)&&m.extra&&(r(jt.showSnackbar({message:"Saved",variant:"success"})),l.goBack()),p.next=12;break;case 9:p.prev=9,p.t0=p.catch(2),r(jt.showSnackbar({message:p.t0.message,variant:"error"}));case 12:case"end":return p.stop()}}),null,null,[[2,9]],Promise)}),[JSON.stringify(n.fields),r,u]);return a.createElement(qt,{contentContainerStyle:{paddingHorizontal:48}},a.createElement(Xe.a,{name:"ticket-percent",size:100,color:"#999999",style:{alignSelf:"center"}}),a.createElement(il,null),a.createElement(Hn,{style:hl.fields},a.createElement(mn.a,{mode:"contained",disabled:c.loading,onPress:m,loading:c.loading},"Save")))}var bl,hl=Me.a.create({container:{flex:1},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fields:{width:"100%",marginBottom:16},field:{marginBottom:8}}),yl=Object(an.a)(bl||(bl=nn()(["\n  query QueryExtra(\n    $dropzoneId: Int!\n  ) {\n    extras(dropzoneId: $dropzoneId) {\n      id\n      cost\n      name\n\n      ticketTypes {\n        id\n        altitude\n        name\n      }\n    }\n  }\n"])));function El(){var e,n,t,r=ze((function(e){return e.global})),l=Object(g.useQuery)(yl,{variables:{dropzoneId:Number(null==(e=r.currentDropzone)?void 0:e.id)}}),i=l.data,o=l.loading,s=(l.refetch,Object(tn.useNavigation)());Object(tn.useRoute)();return a.createElement(a.Fragment,null,a.createElement(sn.a,{visible:o,indeterminate:!0,color:r.theme.colors.accent}),a.createElement(Hn,{style:xl.container},a.createElement(Kn.a,null,a.createElement(Kn.a.Header,null,a.createElement(Kn.a.Title,null,"Name"),a.createElement(Kn.a.Title,{numeric:!0},"Cost")),null==i||null==(n=i.extras)?void 0:n.map((function(e){return a.createElement(Kn.a.Row,null,a.createElement(Kn.a.Cell,{onPress:function(){return s.navigate("UpdateExtraScreen",{extra:e})}},e.name),a.createElement(Kn.a.Cell,{numeric:!0},e.cost))}))),!o&&!(null!=i&&null!=(t=i.extras)&&t.length)&&a.createElement(Vn,{title:"No ticket addons",subtitle:"You can add multiple addons to assign to tickets, e.g outside camera, or coach"}),a.createElement(un.a,{style:xl.fab,small:!0,icon:"plus",onPress:function(){return s.navigate("CreateExtraScreen")},label:"New ticket addon"})))}var Sl,xl=Me.a.create({container:{flex:1,padding:8,display:"flex"},fab:{position:"absolute",margin:16,right:0,bottom:0},empty:{flex:1,alignItems:"center",justifyContent:"center",width:"100%",height:"100%"}}),Il=Object(He.a)();function kl(){return a.createElement(Il.Navigator,{screenOptions:{headerShown:!0,header:function(e){return a.createElement(Zt,e)},cardStyle:{flex:1}}},a.createElement(Il.Screen,{name:"SettingsScreen",component:Jr,options:{title:"Settings"}}),a.createElement(Il.Screen,{name:"DropzoneSettingsScreen",component:Gr}),a.createElement(Il.Screen,{name:"UpdateDropzoneScreen",component:Da}),a.createElement(Il.Screen,{name:"PlanesScreen",component:qa,options:{title:"Planes"}}),a.createElement(Il.Screen,{name:"CreatePlaneScreen",component:da,options:{title:"New plane"}}),a.createElement(Il.Screen,{name:"UpdatePlaneScreen",component:va,options:{title:"Edit plane"}}),a.createElement(Il.Screen,{name:"TicketTypesScreen",component:ra,options:{title:"Ticket types"}}),a.createElement(Il.Screen,{name:"CreateTicketTypeScreen",component:Ga,options:{title:"New ticket type"}}),a.createElement(Il.Screen,{name:"UpdateTicketTypeScreen",component:el,options:{title:"Edit ticket type"}}),a.createElement(Il.Screen,{name:"CreateExtraScreen",component:dl,options:{title:"Create ticket add-on"}}),a.createElement(Il.Screen,{name:"UpdateExtraScreen",component:vl,options:{title:"Update ticket add-on"}}),a.createElement(Il.Screen,{name:"ExtrasScreen",component:El,options:{title:"Ticket add-ons"}}))}var zl=Object(an.a)(Sl||(Sl=nn()(["\n  query QueryDropzoneUsersSearch(\n    $dropzoneId: Int!\n    $search: String\n  ) {\n    dropzone(id: $dropzoneId) {\n      id\n      name\n\n      dropzoneUsers(search: $search) {\n        edges {\n          node {\n            id\n            role {\n              id\n              name\n            }\n            user {\n              id\n              name\n            }\n          }\n        }\n      }\n    }\n  }\n"])));function Ol(){var e,n,t,r,l,i,o,s=ze((function(e){return e})),u=s.global,c=s.usersScreen,d=ke(),m=Object(g.useQuery)(zl,{variables:{dropzoneId:Number(null==(e=u.currentDropzone)?void 0:e.id),search:c.searchText}}),f=m.data,p=m.loading,v=Object(tn.useNavigation)(),b=Object(tn.useIsFocused)();return a.useEffect((function(){c.isSearchVisible&&d(fe.setSearchVisible(!1))}),[b]),a.createElement(Hn,{style:wl.container},a.createElement(sn.a,{indeterminate:!0,color:u.theme.colors.accent,visible:p}),!(null!=f&&null!=(n=f.dropzone)&&null!=(t=n.dropzoneUsers)&&null!=(r=t.edges)&&r.length)&&a.createElement(Vn,{title:"No users",subtitle:""}),null==f||null==(l=f.dropzone)||null==(i=l.dropzoneUsers)||null==(o=i.edges)?void 0:o.map((function(e){var n,t,r;return a.createElement(gn.a.Item,{title:null==e||null==(n=e.node)?void 0:n.user.name,description:null==e||null==(t=e.node)||null==(r=t.role)?void 0:r.name,left:function(){return a.createElement(gn.a.Icon,{icon:"account"})},onPress:function(){var n;return v.navigate("UserProfileScreen",{userId:null==e||null==(n=e.node)?void 0:n.id})}})})))}var wl=Me.a.create({container:{flex:1},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"}}),Cl=t(477);var jl,Tl=Me.a.create({inputContainer:{flexGrow:1},input:{backgroundColor:"transparent",height:"100%",color:"white"},icon:{marginHorizontal:8}}),Pl=function(e){var n=e.navigation,t=e.previous,r=e.scene,a=e.onSearch,i=e.searchText,o=e.searchVisible,s=e.setSearchVisible,u=ze((function(e){return e.global}));return u.currentDropzone,u.theme,ke(),l.a.createElement(Jt.a.Header,null,t?l.a.createElement(Jt.a.BackAction,{onPress:n.goBack}):null,o?l.a.createElement(Jt.a.BackAction,{onPress:function(){return s(!1)}}):null,o?l.a.createElement(d.a,{style:Tl.inputContainer},l.a.createElement(hn.a,{style:Tl.input,value:i,onChangeText:function(e){return a(e)}})):l.a.createElement(Jt.a.Content,{title:r.descriptor.options.title}),l.a.createElement(Cl.a,{name:"search",onPress:function(){return s(!o)},color:"#FFFFFF",size:24,style:Tl.icon}))};function Fl(e){var n,t,r,a,i,o,s,u,c=wn("actAsRigInspector");return null!=(n=e.config)&&n.valueType&&"string"===(null==(t=e.config)?void 0:t.valueType)?l.a.createElement(hn.a,{mode:"outlined",disabled:!c,style:{marginVertical:8},value:e.value,onChangeText:function(n){return e.onChange(n)},label:e.config.name||""}):null!=(r=e.config)&&r.valueType&&"boolean"===(null==(a=e.config)?void 0:a.valueType)?l.a.createElement(Tt.a.Item,{label:e.config.name||"",disabled:!c,style:{marginVertical:8},status:"true"===e.value?"checked":"unchecked",onPress:function(){return e.onChange("true"===e.value?"false":"true")}}):null!=(i=e.config)&&i.valueType&&"integer"===(null==(o=e.config)?void 0:o.valueType)?l.a.createElement(hn.a,{disabled:!c,value:e.value,mode:"outlined",onChangeText:function(n){return e.onChange(n)},label:e.config.name||"",keyboardType:"number-pad",style:{marginVertical:8}}):null!=(s=e.config)&&s.valueType&&"date"===(null==(u=e.config)?void 0:u.valueType)?l.a.createElement(rr,{disabled:!c,timestamp:Number(e.value),onChange:function(n){return e.onChange(n.toString())},label:e.config.name||""}):null}var $l=Object(an.a)(jl||(jl=nn()(["\n  query RigInspection($dropzoneId: Int!) {\n    dropzone(id: $dropzoneId) {\n      rigInspectionChecklist {\n        checklistItems {\n          id\n          isRequired\n          name\n          valueType\n          description\n        }\n      }\n    }\n  }\n"])));function Nl(){var e,n,t,r,l=ze((function(e){return e})),i=l.global,o=l.rigInspectionForm,s=ke(),u=Object(g.useQuery)($l,{variables:{dropzoneId:Number(null==i||null==(e=i.currentDropzone)?void 0:e.id)}}),c=u.data;u.loading;return a.createElement(a.Fragment,null,null==c||null==(n=c.dropzone)||null==(t=n.rigInspectionChecklist)||null==(r=t.checklistItems)?void 0:r.map((function(e){var n=o.fields.find((function(n){return(null==n?void 0:n.checklistItem.id)===e.id}));return a.createElement(Fl,{config:e,value:(null==n?void 0:n.value)||"",onChange:function(t){return s(ye.setItem({checklistItem:e,value:t,id:(null==n?void 0:n.id)||null}))}})})))}Me.a.create({fields:{flex:1},field:{marginBottom:8}});var Dl,Al,Ml,Ul=Object(an.a)(Dl||(Dl=nn()(["\n  query RigInspections($dropzoneUserId: Int!, $dropzoneId: Int!) {\n    dropzone(id: $dropzoneId) {\n      id\n      dropzoneUser(id: $dropzoneUserId) {\n        id\n        rigInspections {\n          id\n          rig {\n            id\n          }\n          inspectedBy {\n            id\n            name\n          }\n          checklistValues {\n            id\n            value\n            checklistItem {\n              id\n              name\n              valueType\n              isRequired\n              description\n            }\n          }\n        }\n      }\n    }\n  }\n"]))),ql=Object(an.a)(Al||(Al=nn()(["\n  mutation CreateRigInspection(\n    $dropzoneId: Int,\n    $rigId: Int,\n  ) {\n    createRigInspection(input: {\n      attributes: {\n        dropzoneId: $dropzoneId,\n        rigId: $rigId,\n      }\n    }) {\n      rigInspection {\n        id\n        inspectedBy {\n          id\n          name\n        }\n        rig {\n          id\n        }\n        checklistValues {\n          id\n          value\n          checklistItem {\n            id\n            name\n            valueType\n            isRequired\n            description\n          }\n        }\n      }\n      fieldErrors {\n        field\n        message\n      }\n      errors\n    }\n  }\n"]))),Rl=Object(an.a)(Ml||(Ml=nn()(["\n  mutation SetValue(\n    $checklistItemId: Int,\n    $rigInspectionId: Int,\n    $value: String,\n  ) {\n    updateChecklistValue(input: {\n      attributes: {\n        checklistItemId: $checklistItemId,\n        rigInspectionId: $rigInspectionId,\n        value: $value\n      }\n    }) {\n      checklistValue {\n        id,\n        value,\n        checklistItem {\n          id\n          name\n          valueType,\n          description\n        }\n      }\n      fieldErrors {\n        field\n        message\n      }\n      errors\n    }\n  }\n"])));function Bl(){var e,n,t,r,l=ze((function(e){return e})),i=l.global,o=l.rigInspectionForm,s=ke(),u=Object(tn.useRoute)().params,c=u.rig,d=u.dropzoneUserId,m=Object(g.useQuery)(Ul,{variables:{dropzoneId:Number(i.currentDropzone.id),dropzoneUserId:d}}),f=m.data,p=(m.loading,wn("actAsRigInspector")),v=Object(g.useMutation)(ql),b=q()(v,1)[0],h=Object(g.useMutation)(Rl),y=q()(h,1)[0];a.useEffect((function(){var e,n,t;if(null!=f&&null!=(e=f.dropzone)&&null!=(n=e.dropzoneUser)&&null!=(t=n.rigInspections)&&t.some((function(e){var n;return(null==(n=e.rig)?void 0:n.id.toString())===c.id.toString()}))){var r,a,l,i=null==f||null==(r=f.dropzone)||null==(a=r.dropzoneUser)||null==(l=a.rigInspections)?void 0:l.find((function(e){var n;return(null==(n=e.rig)?void 0:n.id)===c.id}));console.log({inspection:i}),s(ye.setOriginal(i))}}),[JSON.stringify(null==f||null==(e=f.dropzone)||null==(n=e.dropzoneUser)?void 0:n.rigInspections)]);var E=a.useCallback((function(){var e,n,t,r,a;return Pe.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:if(l.prev=0,n=null==(e=o.original)?void 0:e.id){l.next=7;break}return l.next=5,Pe.a.awrap(b({variables:{dropzoneId:Number(i.currentDropzone.id),rigId:Number(c.id)}}));case 5:a=l.sent,n=null==a||null==(t=a.data)||null==(r=t.createRigInspection)?void 0:r.rigInspection.id;case 7:return l.next=9,Pe.a.awrap(Promise.all(o.fields.map((function(e){return y({variables:{rigInspectionId:Number(n),checklistItemId:Number(e.checklistItem.id),value:e.value}})}))));case 9:l.next=14;break;case 11:l.prev=11,l.t0=l.catch(0),s(pe.showSnackbar({message:l.t0.message,variant:"error"}));case 14:case"end":return l.stop()}}),null,null,[[0,11]],Promise)}),[JSON.stringify(o.fields),null==o||null==(t=o.original)?void 0:t.id,null==i||null==(r=i.currentDropzone)?void 0:r.id]);return a.createElement(qt,null,a.createElement(Zn.a,{style:{width:"100%"}},a.createElement(Zn.a.Title,{title:"Rig"}),a.createElement(Zn.a.Content,null,a.createElement(gn.a.Item,{title:"Make",description:c.make}),a.createElement(gn.a.Item,{title:"Model",description:c.model}),a.createElement(gn.a.Item,{title:"Serial",description:c.serial}),a.createElement(gn.a.Item,{title:"Repack due",description:null!=c&&c.repackExpiresAt?Object(er.a)(1e3*c.repackExpiresAt,"yyyy/MM/dd"):"-"}))),a.createElement(Zn.a,{style:{width:"100%"}},a.createElement(Zn.a.Title,{title:"Inspection"}),a.createElement(Zn.a.Content,null,a.createElement(Nl,null)),a.createElement(Zn.a.Actions,null,a.createElement(mn.a,{disabled:!p,mode:"contained",onPress:function(){return E()},style:{width:"100%"}},"Mark as inspected"))))}var Wl=Object(He.a)();function Ll(){var e=ze((function(e){return e.usersScreen})),n=e.isSearchVisible,t=e.searchText,r=ke();return a.createElement(Wl.Navigator,{screenOptions:{headerShown:!0,header:function(e){return a.createElement(Pl,qn()({},e,{searchText:t,searchVisible:n,setSearchVisible:function(e){return r(fe.setSearchVisible(e))},onSearch:function(e){return r(fe.setSearchText(e))}}))},cardStyle:{flex:1}}},a.createElement(Wl.Screen,{name:"UsersScreen",component:Ol,options:{title:"Dropzone users"}}),a.createElement(Wl.Screen,{name:"UserProfileScreen",component:wr,options:{title:"User"}}),a.createElement(Wl.Screen,{name:"RigInspectionScreen",component:Bl,options:{title:"Inspection"}}))}var Hl=Object(Ke.a)();function Vl(){var e=Object(Ze.b)(),n=wn("readUser"),t=(wn("createPackjob"),wn("updateDropzone"));return a.createElement(Hl.Navigator,{initialRouteName:"Manifest",tabBarOptions:{activeTintColor:"#FFFFFF",inactiveBackgroundColor:e.colors.primary,activeBackgroundColor:e.colors.primary,inactiveTintColor:"#CCCCCC",showLabel:!1}},a.createElement(Hl.Screen,{name:"Manifest",component:Xt,options:{tabBarIcon:function(e){e.focused;var n=e.color,t=e.size;return a.createElement(Xe.a,{name:"airplane",color:n,size:t})},unmountOnBlur:!0}}),a.createElement(Hl.Screen,{name:"Profile",component:Qr,options:{tabBarIcon:function(e){var n=e.size,t=e.color;e.focused;return a.createElement(Xe.a,{size:n,color:t,name:"account-circle"})},unmountOnBlur:!0}}),!1,n&&a.createElement(Hl.Screen,{name:"Users",component:Ll,options:{tabBarIcon:function(e){var n=e.size,t=e.color;e.focused;return a.createElement(Xe.a,{size:n,color:t,name:"account-group"})},unmountOnBlur:!0}}),t&&a.createElement(Hl.Screen,{name:"Settings",component:kl,options:{tabBarIcon:function(e){var n=e.size,t=e.color;e.focused;return a.createElement(Xe.a,{size:n,color:t,name:"account-cog"})}}}))}var Ql,Jl=t(113),_l=Object(an.a)(Ql||(Ql=nn()(["\n  query QueryDropzones {\n    dropzones {\n      edges {\n        node {\n          id\n          name\n          banner\n          ticketTypes {\n            id\n            name\n            cost\n            allowManifestingSelf\n            currency\n          }\n          planes {\n            id\n            name,\n            registration,\n            minSlots,\n            maxSlots,\n          }\n        }\n      }\n    }\n  }\n"])));function Gl(){var e,n=ke(),t=Object(g.useQuery)(_l),r=t.data,l=t.loading,i=t.refetch,o=Object(tn.useNavigation)();return a.createElement(Hn,{style:Zl.container},a.createElement(Jl.a,{data:(null==r||null==(e=r.dropzones)?void 0:e.edges)||[],numColumns:2,refreshing:l,onRefresh:function(){return i()},style:{flex:1},contentContainerStyle:{flexGrow:1},ListEmptyComponent:function(){return a.createElement(Hn,{style:Zl.empty},a.createElement(An.a,null,"No dropzones?"),a.createElement(Mn.a,null,"You can set one up!"))},renderItem:function(e){var t,r,l=e.item;return a.createElement(Zn.a,{style:{width:ln.a.get("window").width/2-32,margin:8},onPress:function(){return Pe.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:null!=l&&l.node&&n(me.setDropzone(l.node));case 1:case"end":return e.stop()}}),null,null,null,Promise)}},a.createElement(Zn.a.Cover,{source:{uri:null==l||null==(t=l.node)?void 0:t.banner}}),a.createElement(Zn.a.Content,null,a.createElement(An.a,null,null==l||null==(r=l.node)?void 0:r.name)))}}),a.createElement(un.a,{style:Zl.fab,small:!0,icon:"plus",onPress:function(){return o.navigate("CreateDropzoneScreen")},label:"Create dropzone"}))}var Yl,Zl=Me.a.create({container:{flex:1,padding:8,display:"flex"},fab:{position:"absolute",margin:16,right:0,bottom:0},empty:{flex:1,alignItems:"center",justifyContent:"center",width:"100%",height:"100%"}});function Kl(e){return{message:e,pattern:/.{1,}/}}function Xl(e,n){return{message:e,callback:n}}function ei(e,n){var t=n.getPayload,r=n.fieldErrorMap,l=n.validates;return function(i){var o=i.onFieldError,s=i.onSuccess,u=i.onError,c=Object(g.useMutation)(e),d=q()(c,2),m=d[0],f=d[1],p=f.data,v=f.loading;f.error;return{loading:v,mutate:Object(a.useCallback)((function(e){var a,c,d,f,p,g;return Pe.a.async((function(v){for(;;)switch(v.prev=v.next){case 0:if(function(){var t=!1;return l&&Object.keys(e).forEach((function(r){var a,i=r;i in(n.validates||{})&&(null==(a=l[i])||a.forEach((function(n){n.pattern?n.pattern.test(""+e[i])||(t=!0,o&&o(i,n.message)):n.callback&&!n.callback(e)&&(t=!0,o&&o(i,n.message))})))})),!t}()){v.next=3;break}return v.abrupt("return");case 3:return v.prev=3,v.next=6,Pe.a.awrap(m({variables:e}));case 6:if(f=v.sent,null==(p=t(f.data))||null==(a=p.fieldErrors)||a.map((function(e){var t=e.field,a=e.message,l=t in(r||{})?n.fieldErrorMap[t]:t;i.onFieldError&&i.onFieldError(""+l,a)})),null==p||null==(c=p.errors)||!c.length||!u){v.next=12;break}return null==(g=p.errors)||g.map((function(e){return u(e)})),v.abrupt("return");case 12:return null!=p&&null!=(d=p.fieldErrors)&&d.length||s(p),v.abrupt("return",p);case 16:v.prev=16,v.t0=v.catch(3),u&&u(v.t0.message);case 19:return v.abrupt("return");case 20:case"end":return v.stop()}}),null,null,[[3,16]],Promise)}),[o,u,s,,m,t,JSON.stringify(p)])}}}var ni=ei(Object(an.a)(Yl||(Yl=nn()(["\nmutation CreateDropzone(\n  $name: String!,\n  $banner: String!,\n  $federationId: Int!\n){\n  createDropzone(input: { attributes: { name: $name, banner: $banner, federationId: $federationId }}) {\n    dropzone {\n      id\n      name\n      banner\n\n      federation {\n        id\n        name\n      }\n    }\n  }\n}\n"]))),{getPayload:function(e){return e.createDropzone},fieldErrorMap:{federation:"federationId"},validates:{name:[Kl("Name is required")]}}),ti=V.actions,ri=N.actions;function ai(){var e=ze((function(e){return e.dropzoneForm})),n=ke(),t=(Object(tn.useNavigation)(),ni({onError:function(e){return n(pe.showSnackbar({message:e,variant:"error"}))},onFieldError:function(e,t){return n(ti.setFieldError([e,t]))},onSuccess:function(e){return n(ri.setDropzone(e.dropzone))}}));return a.createElement(qt,{contentContainerStyle:{paddingHorizontal:32}},a.createElement(za,null),a.createElement(Hn,{style:li.fields},a.createElement(mn.a,{mode:"contained",disabled:t.loading,loading:t.loading,onPress:function(){return t.mutate({name:e.fields.name.value,banner:e.fields.banner.value,federationId:Number(e.fields.federation.value.id)})}},"Save")))}var li=Me.a.create({container:{flex:1,alignItems:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fields:{width:"100%"},field:{marginBottom:8}}),ii=Object(He.a)();function oi(){return a.createElement(ii.Navigator,{screenOptions:{headerShown:!1,cardStyle:{flex:1}},initialRouteName:"Dropzones"},a.createElement(ii.Screen,{name:"DropzonesScreen",component:Gl}),a.createElement(ii.Screen,{name:"CreateDropzoneScreen",component:ai}))}var si,ui=t(38),ci=M.actions,di=Object(g.gql)(si||(si=nn()(["\n  mutation UserLogin($email: String!, $password: String!) {\n    userLogin(email: $email, password: $password) {\n      authenticatable {\n        id\n        email\n        name\n        phone\n        createdAt\n        updatedAt\n      }\n      credentials {\n        accessToken\n        tokenType\n        client\n        expiry\n        uid\n      }\n    }\n  }\n"])));function mi(){var e=ze((function(e){return e.login})),n=ke(),t=Object(ui.useNavigation)(),r=Object(g.useMutation)(di),i=q()(r,2),o=i[0],s=i[1],u=Object(a.useCallback)((function(){var t,r,a,l,i,s,u;return Pe.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:if(t=new RegExp(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/),r=!1,e.fields.email.value||(r=!0,n(ci.setEmailError("Email is required"))),e.fields.password.value||(r=!0,n(ci.setPasswordError("Password is required"))),t.test(e.fields.email.value)||(r=!0,n(ci.setEmailError("Please enter a valid email"))),r){c.next=17;break}return c.prev=6,c.next=9,Pe.a.awrap(o({variables:{email:e.fields.email.value,password:e.fields.password.value}}));case 9:u=c.sent,console.log({result:u}),null!=u&&null!=(a=u.data)&&null!=(l=a.userLogin)&&l.authenticatable&&null!=u&&null!=(i=u.data)&&null!=(s=i.userLogin)&&s.credentials&&(n(me.setCredentials(u.data.userLogin.credentials)),n(me.setUser(u.data.userLogin.authenticatable))),c.next=17;break;case 14:c.prev=14,c.t0=c.catch(6),n(pe.showSnackbar({message:c.t0.message,variant:"error"}));case 17:case"end":return c.stop()}}),null,null,[[6,14]],Promise)}),[o,JSON.stringify(e.fields)]);return l.a.createElement(Hn,{style:gi.container},l.a.createElement(Ln,{style:gi.title},"Sign in"),l.a.createElement(Hn,{style:gi.fields},l.a.createElement(hn.a,{label:"Email",mode:"outlined",value:e.fields.email.value,onChangeText:function(e){n(ci.setEmail(e))}}),l.a.createElement(pn.a,{type:"error"},e.fields.email.error||" "),l.a.createElement(hn.a,{label:"Password",mode:"outlined",value:e.fields.password.value,secureTextEntry:!0,onChangeText:function(e){n(ci.setPassword(e))},error:!!e.fields.password.error}),l.a.createElement(pn.a,{type:"error"},e.fields.password.error||" "),l.a.createElement(mn.a,{mode:"contained",style:gi.button,onPress:u,loading:s.loading},"Log in"),l.a.createElement(mn.a,{style:gi.button,onPress:function(){return t.navigate("SignUpScreen")}},"Sign up")))}var fi,pi,gi=Me.a.create({container:{flex:1,alignItems:"center",justifyContent:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fields:{marginBottom:10},button:{marginTop:10,width:"100%"}}),vi=ei(Object(an.a)(fi||(fi=nn()(["\n  mutation UserSignUp(\n    $email: String!,\n    $password: String!,\n    $passwordConfirmation: String!\n    $name: String!\n    $phone: String!\n    $exitWeight: Float!\n    $licenseId: Int\n  ){\n    userSignUp(\n      email: $email,\n      password: $password,\n      passwordConfirmation: $passwordConfirmation,\n      exitWeight: $exitWeight,\n      name: $name,\n      phone: $phone,\n      licenseId: $licenseId\n    ) {\n      authenticatable {\n        createdAt,\n        email,\n        id,\n        name,\n        phone,\n      }\n      credentials {\n        accessToken\n        tokenType\n        client\n        expiry\n        uid\n      }\n    }\n  }\n"]))),{getPayload:function(e){return e.userSignUp},fieldErrorMap:{license:"licenseId"},validates:{name:[Kl("Name is required")],email:[(pi="Please enter a valid email",{message:pi,pattern:new RegExp(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)})],passwordConfirmation:[Xl("Password must have 1 uppercase, 1 lowercase, 1 digit and be at least 8 characters",(function(e){return/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{8,}.*$/.test(e.passwordConfirmation)})),Xl("Passwords don't match",(function(e){return e.password===e.passwordConfirmation}))]}}),bi=B.actions,hi=N.actions;function yi(){var e,n,t=ze((function(e){return e.signup})),r=ke(),l=vi({onSuccess:function(e){e.credentials&&(r(hi.setCredentials(e.credentials)),r(hi.setUser(e.authenticatable)))},onFieldError:function(e,n){return r(bi.setFieldError([e,n]))}}),i=l.loading,o=l.mutate;return a.createElement(qt,{contentContainerStyle:{padding:48,alignItems:"center"}},a.createElement(Ln,{style:Ei.title},"Sign up"),a.createElement(Hn,{style:Ei.fields},a.createElement(hn.a,{style:Ei.field,mode:"outlined",label:"Name",error:!!t.fields.name.error,value:t.fields.name.value,onChangeText:function(e){return r(bi.setField(["name",e]))}}),a.createElement(pn.a,{type:"error"},t.fields.name.error||""),a.createElement(hn.a,{style:Ei.field,mode:"outlined",label:"Exit weight",error:!!t.fields.exitWeight.error,value:(null==(e=t.fields.exitWeight)||null==(n=e.value)?void 0:n.toString())||"",keyboardType:"numbers-and-punctuation",right:function(){return a.createElement(hn.a.Affix,{text:"kg"})},onChangeText:function(e){return r(bi.setField(["exitWeight",parseFloat(e)]))}}),a.createElement(pn.a,{type:t.fields.exitWeight.error?"error":"info"},t.fields.exitWeight.error||""),a.createElement(hn.a,{style:Ei.field,mode:"outlined",label:"Email",error:!!t.fields.email.error,value:t.fields.email.value,onChangeText:function(e){return r(bi.setField(["email",e]))}}),a.createElement(pn.a,{type:"error"},t.fields.email.error||""),a.createElement(hn.a,{style:Ei.field,mode:"outlined",label:"Phone",error:!!t.fields.phone.error,value:t.fields.phone.value,onChangeText:function(e){return r(bi.setField(["phone",e]))}}),a.createElement(pn.a,{type:"error"},t.fields.phone.error||""),a.createElement(hn.a,{style:Ei.field,mode:"outlined",label:"Password",error:Boolean(t.fields.password.error||t.fields.passwordConfirmation.error),textContentType:"newPassword",secureTextEntry:!0,passwordRules:"required: upper; required: lower; required: digit; minlength: 8;",value:t.fields.password.value,onChangeText:function(e){return r(bi.setField(["password",e]))}}),a.createElement(pn.a,{type:"error"},t.fields.password.error||""),a.createElement(hn.a,{style:Ei.field,mode:"outlined",label:"Repeat password",error:Boolean(t.fields.password.error||t.fields.passwordConfirmation.error),textContentType:"newPassword",secureTextEntry:!0,passwordRules:"required: upper; required: lower; required: digit; minlength: 8;",value:t.fields.passwordConfirmation.value,onChangeText:function(e){return r(bi.setField(["passwordConfirmation",e]))}}),a.createElement(pn.a,{type:"error"},t.fields.passwordConfirmation.error||""),a.createElement(mn.a,{mode:"contained",onPress:function(){var e,n;return o({email:t.fields.email.value,name:t.fields.name.value,exitWeight:t.fields.exitWeight.value,password:t.fields.password.value,passwordConfirmation:t.fields.passwordConfirmation.value,licenseId:Number(null==(e=t.fields.license)||null==(n=e.value)?void 0:n.id)||null,phone:t.fields.phone.value})},loading:i},"Sign up")))}var Ei=Me.a.create({container:{flex:1},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fields:{width:"100%",maxWidth:400},field:{marginBottom:8}}),Si=Object(He.a)();function xi(){return a.createElement(Si.Navigator,{screenOptions:{headerShown:!1,cardStyle:{flex:1}},initialRouteName:"LoginScreen"},a.createElement(Si.Screen,{name:"LoginScreen",component:mi}),a.createElement(Si.Screen,{name:"SignUpScreen",component:yi}))}var Ii=Object(He.a)();function ki(){var e=ze((function(e){return e.global}));return a.createElement(Ii.Navigator,{screenOptions:{headerShown:!1,cardStyle:{flex:1}}},e.credentials?e.currentDropzone?a.createElement(Ii.Screen,{name:"Authenticated",component:Vl}):a.createElement(Ii.Screen,{name:"Dropzones",component:oi}):a.createElement(Ii.Screen,{name:"Unauthenticated",component:xi}),a.createElement(Ii.Screen,{name:"NotFound",component:Je,options:{title:"Oops!"}}))}function zi(){var e=ze((function(e){return e.global}));return l.a.createElement(je,null,l.a.createElement(u.a,{theme:e.theme},l.a.createElement(i.b,null,l.a.createElement(m.a,{linking:Le,theme:e.theme},l.a.createElement(ki,null)),l.a.createElement(r.a,null),l.a.createElement(We,null))))}function Oi(){return function(){var e=a.useState(!1),n=q()(e,2),r=n[0],l=n[1];return a.useEffect((function(){Pe.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,Ne.b(),e.next=4,Pe.a.awrap($e.b(Ae(Ae({},Fe.a.font),{},{"space-mono":t(421)})));case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(0);case 8:return e.prev=8,l(!0),Ne.a(),e.finish(8);case 12:case"end":return e.stop()}}),null,null,[[0,6,8,12]],Promise)}),[]),r}()?l.a.createElement(o.a,{store:xe},l.a.createElement(s.a,{persistor:Ie,loading:l.a.createElement(d.a,{style:{flex:1,justifyContent:"center",alignItems:"center"}},l.a.createElement(c.a,{size:"large"}))},l.a.createElement(zi,null))):null}},382:function(e,n,t){e.exports=t(469)},421:function(e,n,t){e.exports=t.p+"./fonts/SpaceMono-Regular.ttf"},438:function(e,n){}},[[382,1,2]]]);
//# sourceMappingURL=app.e7dfcf87.chunk.js.map