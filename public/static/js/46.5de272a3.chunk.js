(this.webpackJsonp=this.webpackJsonp||[]).push([[46],{519:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return F}));var a,r=n(6),l=n.n(r),i=n(405),s=n.n(i),o=n(10),c=n.n(o),u=n(0),d=n(4),f=n(203),m=n(120),g=n(60),p=n(404),v=n(426),b=n(161),k=n(167),w=n(477),h=n(73),S=n(408),T=n(297),y=k.a.actions,E=(b.a.actions,Object(m.gql)(a||(a=s()(["\n  mutation CreateTicketType(\n    $name: String,\n    $cost: Float,\n    $dropzoneId: Int!\n    $altitude: Int\n    $allowManifestingSelf: Boolean\n  ){\n    createTicketType(input: {\n      attributes: {\n        name: $name,\n        cost: $cost,\n        dropzoneId: $dropzoneId\n        altitude: $altitude\n        allowManifestingSelf: $allowManifestingSelf\n      }\n    }) {\n      ticketType {\n        id\n        name\n        altitude\n        cost\n        allowManifestingSelf\n        extras {\n          id\n          name\n          cost\n        }\n      }\n    }\n  }\n"]))));function F(){var e=Object(g.h)((function(e){return e})),t=e.ticketTypeForm,n=e.global,a=Object(g.g)(),r=Object(h.useNavigation)(),i=Object(m.useMutation)(E),s=l()(i,2),o=s[0],d=s[1],b=Object(h.useIsFocused)();u.useEffect((function(){b&&a(y.reset())}),[b]);var k=u.useCallback((function(){var e=!1;return(!t.fields.name.value||t.fields.name.value.length<3)&&(e=!0,a(y.setFieldError(["name","Name is too short"]))),t.fields.cost.value<1&&(e=!0,a(y.setFieldError(["cost","Cost must be at least $1"]))),t.fields.altitude.value||(e=!0,a(y.setFieldError(["altitude","Altitude must be specified"]))),!e}),[JSON.stringify(t.fields),a]),F=u.useCallback((function(){var e,l,i,s,u,d,f,m,p,b,w,h,S,T,E,F,$,x,I,M;return c.a.async((function(O){for(;;)switch(O.prev=O.next){case 0:if(e=t.fields,l=e.name,i=e.cost,s=e.allowManifestingSelf,u=e.altitude,d=e.extras,f=e.isTandem,!k()){O.next=15;break}return O.prev=2,O.next=5,c.a.awrap(o({variables:{dropzoneId:Number(null==(m=n.currentDropzone)?void 0:m.id),name:l.value,cost:i.value,altitude:u.value,allowManifestingSelf:s.value,extraIds:null==d||null==(p=d.value)?void 0:p.map((function(e){return e.id})),isTandem:!!f.value}}));case 5:if(null==(x=O.sent)||null==(b=x.data)||null==(w=b.createTicketType)||null==(h=w.fieldErrors)||h.map((function(e){var t=e.field,n=e.message;switch(t){case"name":return a(y.setFieldError(["name",n]));case"altitude":return a(y.setFieldError(["altitude",n]));case"cost":return a(y.setFieldError(["cost",n]));case"allow_manifesting_self":return a(y.setFieldError(["allowManifestingSelf",n]));case"extras":return a(y.setFieldError(["extras",n]))}})),null==x||null==(S=x.data)||null==(T=S.createTicketType)||null==(E=T.errors)||!E.length){O.next=9;break}return O.abrupt("return",a(g.f.showSnackbar({message:null==x||null==(I=x.data)||null==(M=I.createTicketType)?void 0:M.errors[0],variant:"error"})));case 9:null!=(F=x.data)&&null!=($=F.createTicketType)&&$.ticketType&&(a(v.a.showSnackbar({message:"Saved",variant:"success"})),r.goBack()),O.next=15;break;case 12:O.prev=12,O.t0=O.catch(2),a(v.a.showSnackbar({message:O.t0.message,variant:"error"}));case 15:case"end":return O.stop()}}),null,null,[[2,12]],Promise)}),[JSON.stringify(t.fields),a,o]);return u.createElement(S.a,{contentContainerStyle:{paddingHorizontal:48}},u.createElement(T.a,{name:"ticket",size:100,color:"#999999",style:{alignSelf:"center"}}),u.createElement(w.a,null),u.createElement(p.b,{style:$.actions},u.createElement(f.a,{mode:"contained",disabled:d.loading,onPress:F,loading:d.loading},"Save")))}var $=d.a.create({separator:{marginVertical:30,height:1,width:"80%"},actions:{marginVertical:16,width:"100%"}})}}]);
//# sourceMappingURL=46.5de272a3.chunk.js.map