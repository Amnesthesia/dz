(this.webpackJsonp=this.webpackJsonp||[]).push([[47],{520:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return $}));var a,l=n(6),i=n.n(l),r=n(405),s=n.n(r),o=n(10),u=n.n(o),c=n(0),d=n(4),f=n(203),m=n(120),p=n(60),g=n(404),v=n(426),b=n(161),k=n(167),h=n(477),w=n(73),S=n(297),T=n(408),y=k.a.actions,E=(b.a.actions,Object(m.gql)(a||(a=s()(["\n  mutation UpdateTicketType(\n    $id: Int!,\n    $name: String,\n    $cost: Float,\n    $dropzoneId: Int!\n    $altitude: Int\n    $allowManifestingSelf: Boolean\n  ){\n    updateTicketType(input: {\n      id: $id\n      attributes: {\n        name: $name,\n        cost: $cost,\n        dropzoneId: $dropzoneId\n        altitude: $altitude\n        allowManifestingSelf: $allowManifestingSelf\n      }\n    }) {\n      ticketType {\n        id\n        name\n        altitude\n        cost\n        allowManifestingSelf\n        extras {\n          id\n          name\n          cost\n        }\n      }\n    }\n  }\n"]))));function $(){var e=Object(p.h)((function(e){return e})),t=e.ticketTypeForm,n=(e.global,Object(p.g)()),a=Object(w.useNavigation)(),l=Object(w.useRoute)().params.ticketType;c.useEffect((function(){n(y.setOriginal(l))}),[null==l?void 0:l.id]);var r=Object(m.useMutation)(E),s=i()(r,2),o=s[0],d=s[1],b=c.useCallback((function(){var e=!1;return(!t.fields.name.value||t.fields.name.value.length<3)&&(e=!0,n(y.setFieldError(["name","Name is too short"]))),t.fields.cost.value<1&&(e=!0,n(y.setFieldError(["cost","Cost must be at least $1"]))),t.fields.altitude.value||(e=!0,n(y.setFieldError(["altitude","Altitude must be specified"]))),!e}),[JSON.stringify(t.fields),n]),k=c.useCallback((function(){var e,l,i,r,s,c,d,f,m,g,k,h,w,S,T,E,$,x,F;return u.a.async((function(O){for(;;)switch(O.prev=O.next){case 0:if(e=t.fields,l=e.name,i=e.cost,r=e.allowManifestingSelf,s=e.altitude,c=e.extras,d=e.isTandem,!b()){O.next=15;break}return O.prev=2,O.next=5,u.a.awrap(o({variables:{id:Number(t.original.id),name:l.value,cost:i.value,altitude:s.value,allowManifestingSelf:r.value,extraIds:null==c||null==(f=c.value)?void 0:f.map((function(e){return e.id})),isTandem:!!d.value}}));case 5:if(null==($=O.sent)||null==(m=$.data)||null==(g=m.updateTicketType)||null==(k=g.fieldErrors)||k.map((function(e){var t=e.field,a=e.message;switch(t){case"name":return n(y.setFieldError(["name",a]));case"altitude":return n(y.setFieldError(["altitude",a]));case"cost":return n(y.setFieldError(["cost",a]));case"allow_manifesting_self":return n(y.setFieldError(["allowManifestingSelf",a]));case"extras":return n(y.setFieldError(["extras",a]))}})),null==$||null==(h=$.data)||null==(w=h.updateTicketType)||null==(S=w.errors)||!S.length){O.next=9;break}return O.abrupt("return",n(p.f.showSnackbar({message:null==$||null==(x=$.data)||null==(F=x.updateTicketType)?void 0:F.errors[0],variant:"error"})));case 9:null!=(T=$.data)&&null!=(E=T.updateTicketType)&&E.ticketType&&(n(v.a.showSnackbar({message:"Saved",variant:"success"})),a.goBack()),O.next=15;break;case 12:O.prev=12,O.t0=O.catch(2),n(v.a.showSnackbar({message:O.t0.message,variant:"error"}));case 15:case"end":return O.stop()}}),null,null,[[2,12]],Promise)}),[JSON.stringify(t.fields),n,o]);return c.createElement(T.a,{contentContainerStyle:{paddingHorizontal:48}},c.createElement(S.a,{name:"ticket",size:100,color:"#999999",style:{alignSelf:"center"}}),c.createElement(h.a,null),c.createElement(g.b,{style:x.fields},c.createElement(f.a,{mode:"contained",disabled:d.loading,onPress:k,loading:d.loading},"Save")))}var x=d.a.create({container:{flex:1,alignItems:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fields:{width:"100%",marginVertical:16},field:{marginBottom:8}})}}]);
//# sourceMappingURL=47.f85f146b.chunk.js.map