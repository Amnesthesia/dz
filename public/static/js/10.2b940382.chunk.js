(this.webpackJsonp=this.webpackJsonp||[]).push([[10],{487:function(e,n,t){"use strict";t.d(n,"a",(function(){return s}));var l=t(0),r=t.n(l),a=t(1),i=t(129),o=t(301),u=t(36);function s(e){var n=e.title,t=e.subtitle;return r.a.createElement(u.b,{style:d.empty},r.a.createElement(i.a,null,n),r.a.createElement(o.a,{style:{textAlign:"center"}},t))}var d=a.a.create({container:{flex:1,padding:8,display:"flex"},fab:{position:"absolute",margin:16,right:0,bottom:0},empty:{flex:1,alignItems:"center",justifyContent:"center",width:"100%",height:"100%"}})},492:function(e,n,t){"use strict";t.d(n,"a",(function(){return g}));var l,r=t(9),a=t.n(r),i=t(71),o=t.n(i),u=t(49),s=t(72),d=t(0),c=t.n(d),m=t(165),p=t(52),f=t(20),v=Object(s.a)(l||(l=o()(["\n  query QueryAvailableRigs(\n    $dropzoneId: Int!\n    $userId: Int!\n  ) {\n    dropzone(id: $dropzoneId) {\n      id\n      dropzoneUser(userId: $userId) {\n        id\n        availableRigs {\n          id\n          make\n          model\n          canopySize\n          serial\n\n          user {\n            id\n          }\n        }\n      }\n    }\n  }\n"])));function g(e){var n,t,l,r,i,o,s,g,b=Object(d.useState)(!1),h=a()(b,2),y=h[0],E=h[1],I=Object(f.k)((function(e){return e.global})),O=Object(u.useLazyQuery)(v),j=a()(O,2),x=j[0],S=j[1].data;return Object(d.useEffect)((function(){var n;e.userId&&e.dropzoneId&&x({variables:{dropzoneId:Number(null==(n=I.currentDropzone)?void 0:n.id),userId:Number(e.userId)}})}),[e.userId,e.dropzoneId]),Object(d.useEffect)((function(){var n,t,l;!e.value&&e.autoSelectFirst&&null!=S&&null!=(n=S.dropzone)&&null!=(t=n.dropzoneUser)&&null!=(l=t.availableRigs)&&l.length&&e.onSelect(S.dropzone.dropzoneUser.availableRigs[0])}),[e.autoSelectFirst,JSON.stringify(null==S||null==(n=S.dropzone)||null==(t=n.dropzoneUser)?void 0:t.availableRigs)]),c.a.createElement(m.a,{onDismiss:function(){return E(!1)},visible:y,anchor:c.a.createElement(p.b.Item,{onPress:function(){E(!0)},title:e.value?(null==(l=e.value)?void 0:l.make)+" "+(null==(r=e.value)?void 0:r.model)+" ("+((null==(i=e.value)?void 0:i.canopySize)||"?")+"sqft)":"Select rig",description:e.required?null:"Optional",left:function(){return c.a.createElement(p.b.Icon,{icon:"parachute"})}})},null==S||null==(o=S.dropzone)||null==(s=o.dropzoneUser)||null==(g=s.availableRigs)?void 0:g.map((function(n){return c.a.createElement(m.a.Item,{key:"rig-select-"+n.id,onPress:function(){E(!1),e.onSelect(n)},title:(null==n?void 0:n.make)+" "+(null==n?void 0:n.model)+" ("+(null==n?void 0:n.canopySize)+" sqft) "+(n.user?"":"[DROPZONE RIG]")})})))}},534:function(e,n,t){"use strict";t.r(n),t.d(n,"default",(function(){return we}));var l,r,a=t(6),i=t.n(a),o=t(9),u=t.n(o),s=t(71),d=t.n(s),c=t(49),m=t(40),p=t(515),f=t(72),v=t(0),g=t.n(v),b=t(29),h=t(1),y=t(513),E=t(311),I=t(317),O=t(11),j=t.n(O),x=t(80),S=t(154),k=t(142),z=t(116),w=t(20),T=t(22),N=t.n(T),P=t(221),$=t(52),C=t(302),F=t(303),D=t(249),A=t(241),W=t(165),U=Object(f.a)(l||(l=d()(["\n  query JumpTypes($allowedForUserId: Int) {\n    jumpTypes(allowedForUserId: $allowedForUserId) {\n      id\n      name\n    }\n  }\n"])));function M(e){var n,t,l=Object(v.useState)(!1),r=u()(l,2),a=r[0],i=r[1],o=Object(c.useQuery)(U,{variables:{allowedForUserId:e.userId}}),s=o.data;o.loading,o.refetch;return g.a.createElement(g.a.Fragment,null,g.a.createElement($.b.Subheader,null,"Jump type"),g.a.createElement(W.a,{onDismiss:function(){return i(!1)},visible:a,anchor:g.a.createElement($.b.Item,{onPress:function(){i(!0)},title:(null==(n=e.value)?void 0:n.name)||"Please select jump type",description:e.required?null:"Optional"})},null==s||null==(t=s.jumpTypes)?void 0:t.map((function(n){return g.a.createElement(W.a.Item,{onPress:function(){i(!1),e.onSelect(n)},title:n.name||"-"})}))))}var L=Object(f.a)(r||(r=d()(["\n  query TicketTypes($allowManifestingSelf: Boolean, $dropzoneId: Int!) {\n    ticketTypes(allowManifestingSelf: $allowManifestingSelf, dropzoneId: $dropzoneId) {\n      id\n      name\n      isTandem\n      cost\n\n      extras {\n        id\n        name\n        cost\n      }\n    }\n  }\n"])));function q(e){var n,t,l,r=Object(v.useState)(!1),a=u()(r,2),i=a[0],o=a[1],s=Object(w.k)((function(e){return e.global})),d=Object(c.useQuery)(L,{variables:{dropzoneId:Number(null==(n=s.currentDropzone)?void 0:n.id),allowManifestingSelf:e.allowManifestingSelf}}),m=d.data;d.loading,d.refetch;return g.a.createElement(g.a.Fragment,null,g.a.createElement($.b.Subheader,null,"Ticket"),g.a.createElement(W.a,{onDismiss:function(){return o(!1)},visible:i,anchor:g.a.createElement($.b.Item,{onPress:function(){o(!0)},title:(null==(t=e.value)?void 0:t.name)||"Please select ticket type",description:e.required?null:"Optional"})},null==m||null==(l=m.ticketTypes)?void 0:l.map((function(n){return g.a.createElement(W.a.Item,{key:"ticket-type-select-"+n.id,onPress:function(){o(!1),e.onSelect(n)},title:n.name||"-"})}))))}var J=t(170),R=t(492),Q=A.a.actions;function G(){var e,n,t,l,r,a,i,o,u,s,d,c,m,p,f,g,b,h,y,E,I,O,j,S,k=Object(w.k)((function(e){return e.slotForm})),z=Object(w.j)(),T=Object(w.k)((function(e){return e.global}));v.useEffect((function(){var e,n;null!=(e=k.fields.user)&&e.value&&(k.fields.exitWeight.value||z(Q.setField(["exitWeight",Number(k.fields.user.value.exitWeight||60)])),!k.fields.rig.value&&null!=(n=k.fields.user.value.rigs)&&n.length&&z(Q.setField(["rig",k.fields.user.value.rigs[0]])))}),[null==(e=k.fields)||null==(n=e.user)||null==(t=n.value)?void 0:t.id]);var A=null==k||null==(l=k.original)?void 0:l.id,W=Object(J.a)(A?"updateUserSlot":"createUserSlot");return v.createElement(v.Fragment,null,v.createElement(M,{value:k.fields.jumpType.value,required:!0,userId:Number(null==k||null==(r=k.fields)||null==(a=r.user)||null==(i=a.value)?void 0:i.id)||null,onSelect:function(e){return z(Q.setField(["jumpType",e]))}}),v.createElement(P.a,{type:k.fields.jumpType.error?"error":"info"},k.fields.jumpType.error||""),v.createElement(q,{value:k.fields.ticketType.value,required:!0,allowManifestingSelf:!W,onSelect:function(e){return z(Q.setField(["ticketType",e]))}}),v.createElement(P.a,{type:k.fields.ticketType.error?"error":"info"},k.fields.ticketType.error||""),null!=k&&null!=(o=k.fields)&&null!=(u=o.ticketType)&&null!=(s=u.value)&&null!=(d=s.extras)&&d.length?v.createElement($.b.Subheader,null,"Ticket addons"):null,v.createElement(x.a,{horizontal:!0,style:Y.ticketAddons},null==k||null==(c=k.fields)||null==(m=c.ticketType)||null==(p=m.value)||null==(f=p.extras)?void 0:f.map((function(e){var n,t,l,r;return v.createElement(C.a,{selected:null==k||null==(n=k.fields)||null==(t=n.extras.value)?void 0:t.some((function(n){return n.id===e.id})),onPress:null!=k&&null!=(l=k.fields)&&null!=(r=l.extras.value)&&r.some((function(n){return n.id===e.id}))?function(){var n,t;return z(Q.setField(["extras",null==k||null==(n=k.fields)||null==(t=n.extras.value)?void 0:t.filter((function(n){return n.id!==e.id}))]))}:function(){var n,t;return z(Q.setField(["extras",[].concat(N()((null==k||null==(n=k.fields)||null==(t=n.extras)?void 0:t.value)||[]),[e])]))}},e.name+" ($"+e.cost+")")}))),v.createElement(P.a,{type:k.fields.extras.error?"error":"info"},k.fields.extras.error||""),v.createElement(F.a,null),k.fields.user?v.createElement(R.a,{value:k.fields.rig.value,userId:Number(null==(g=k.fields.user)||null==(b=g.value)?void 0:b.id),dropzoneId:Number(null==(h=T.currentDropzone)?void 0:h.id),onSelect:function(e){return z(Q.setField(["jumpType",e]))}}):null,v.createElement(P.a,{type:k.fields.rig.error?"error":"info"},k.fields.rig.error||""),v.createElement(D.a,{style:Y.field,mode:"outlined",label:"Exit weight",error:!!k.fields.exitWeight.error,value:(null==(y=k.fields.exitWeight)||null==(E=y.value)?void 0:E.toString())||"",keyboardType:"numbers-and-punctuation",right:function(){return v.createElement(D.a.Affix,{text:"kg"})},onChangeText:function(e){return z(Q.setField(["exitWeight",Number(e)]))}}),v.createElement(P.a,{type:k.fields.exitWeight.error?"error":"info"},k.fields.exitWeight.error||""),null!=(I=k.fields.ticketType.value)&&I.isTandem?v.createElement(v.Fragment,null,v.createElement($.b.Subheader,null,"Passenger"),v.createElement(D.a,{style:Y.field,mode:"outlined",label:"Passenger name",error:!!k.fields.passengerName.error,value:(null==(O=k.fields.passengerName)||null==(j=O.value)?void 0:j.toString())||"",onChangeText:function(e){return z(Q.setField(["passengerName",e]))}}),v.createElement(D.a,{style:Y.field,mode:"outlined",label:"Passenger exit weight",error:!!k.fields.passengerExitWeight.error,value:(null==(S=k.fields.passengerExitWeight.value)?void 0:S.toString())||"",onChangeText:function(e){return z(Q.setField(["passengerExitWeight",Number(e)]))}})):null)}var H,Y=h.a.create({fields:{flex:1},field:{marginBottom:8},ticketAddons:{marginBottom:8}});function B(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);n&&(l=l.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,l)}return t}function V(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?B(Object(t),!0).forEach((function(n){i()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):B(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var _=Object(c.gql)(H||(H=d()(["\n  mutation CreateSlot(\n    $jumpTypeId: Int\n    $extraIds: [Int!]\n    $loadId: Int\n    $rigId: Int\n    $ticketTypeId: Int\n    $userId: Int\n    $exitWeight: Float\n    $passengerName: String\n    $passengerExitWeight: Float\n  ) {\n    createSlot(\n      input: {\n        attributes: {\n          jumpTypeId: $jumpTypeId\n          extraIds: $extraIds\n          loadId: $loadId\n          rigId: $rigId\n          ticketTypeId: $ticketTypeId\n          userId: $userId\n          exitWeight: $exitWeight\n          passengerExitWeight: $passengerExitWeight\n          passengerName: $passengerName\n        }\n      }\n    ) {\n      errors\n      fieldErrors {\n        field\n        message\n      }\n      slot {\n        id\n        jumpType {\n          id\n          name\n        }\n        extras {\n          id\n          name\n        }\n        exitWeight\n        load {\n          id\n          name\n          createdAt\n          dispatchAt\n          hasLanded\n          maxSlots\n          isFull\n          isOpen\n          plane {\n            id\n            name\n          }\n          gca {\n            id\n            user {\n              id\n              name\n            }\n          }\n          pilot {\n            id\n            user {\n              id\n              name\n            }\n          }\n          loadMaster {\n            id\n            user {\n              id\n              name\n            }\n          }\n          slots {\n            id\n            createdAt\n            user {\n              id\n              name\n            }\n            passengerName\n            passengerExitWeight\n            ticketType {\n              id\n              name\n              isTandem\n              altitude\n            }\n            jumpType {\n              id\n              name\n            }\n            extras {\n              id\n              name\n            }\n          }\n        }\n      }\n    }\n  }\n"])));function Z(e){var n,t,l,r,a,i=Object(w.j)(),o=Object(w.k)((function(e){return e.slotForm})),s=Object(w.k)((function(e){return e.global})),d=Object(c.useMutation)(_),m=u()(d,2),p=m[0],f=m[1],b=Object(v.useCallback)((function(){var e,n,t=!1;return null!=(e=o.fields.jumpType.value)&&e.id||(t=!0,i(w.g.setFieldError(["jumpType","You must specify the type of jump"]))),null!=(n=o.fields.ticketType.value)&&n.id||(t=!0,i(w.g.setFieldError(["ticketType","You must select a ticket type to manifest"]))),!t}),[JSON.stringify(o.fields)]),h=Object(v.useCallback)((function(){var n,t,l,r,a,u,s,d,c,m,f,v,g,h,y,E,I,O,x,S,k,z,T,N,P;return j.a.async((function($){for(;;)switch($.prev=$.next){case 0:if(b()){$.next=2;break}return $.abrupt("return");case 2:return $.prev=2,$.next=5,j.a.awrap(p({variables:V({jumpTypeId:Number(null==(n=o.fields.jumpType.value)?void 0:n.id),extraIds:null==(t=o.fields.extras)||null==(l=t.value)?void 0:l.map((function(e){var n=e.id;return Number(n)})),loadId:Number(null==(r=o.fields.load.value)?void 0:r.id),rigId:null!=(a=o.fields.rig.value)&&a.id?Number(null==(u=o.fields.rig.value)?void 0:u.id):null,ticketTypeId:Number(null==(s=o.fields.ticketType)||null==(d=s.value)?void 0:d.id),userId:Number(null==(c=o.fields.user)||null==(m=c.value)?void 0:m.id),exitWeight:o.fields.exitWeight.value},null!=(f=o.fields.ticketType.value)&&f.isTandem?{passengerName:null==(v=o.fields.passengerName)?void 0:v.value,passengerExitWeight:null==(g=o.fields.passengerExitWeight)?void 0:g.value}:{})}));case 5:if(T=$.sent,null==(h=T.data)||null==(y=h.createSlot)||null==(E=y.fieldErrors)||E.map((function(e){var n=e.field,t=e.message;switch(n){case"jump_type":return i(w.g.setFieldError(["jumpType",t]));case"load":return i(w.g.setFieldError(["load",t]));case"credits":case"extras":case"extra_ids":return i(w.g.setFieldError(["extras",t]));case"ticket_type":return i(w.g.setFieldError(["ticketType",t]));case"rig":return i(w.g.setFieldError(["rig",t]));case"user":return i(w.g.setFieldError(["user",t]));case"exit_weight":return i(w.g.setFieldError(["exitWeight",t]))}})),null==T||null==(I=T.data)||null==(O=I.createSlot)||null==(x=O.errors)||!x.length){$.next=9;break}return $.abrupt("return",i(w.i.showSnackbar({message:null==T||null==(N=T.data)||null==(P=N.createSlot)?void 0:P.errors[0],variant:"error"})));case 9:null!=(S=T.data)&&null!=(k=S.createSlot)&&null!=(z=k.fieldErrors)&&z.length||e.onSuccess(),$.next=15;break;case 12:$.prev=12,$.t0=$.catch(2),i(w.i.showSnackbar({message:$.t0.message,variant:"error"}));case 15:case"end":return $.stop()}}),null,null,[[2,12]],Promise)}),[JSON.stringify(o.fields),p,e.onSuccess]);return g.a.createElement(S.a,null,g.a.createElement(k.a,{visible:!!e.open,style:{maxHeight:500}},g.a.createElement(E.a,{indeterminate:!0,visible:f.loading,color:s.theme.colors.accent}),g.a.createElement(k.a.Title,null,"Manifest "+(null==o||null==(n=o.fields)||null==(t=n.user)||null==(l=t.value)?void 0:l.name)+" on "+(null==(r=o.fields.load)||null==(a=r.value)?void 0:a.name)),g.a.createElement(k.a.ScrollArea,null,g.a.createElement(x.a,null,g.a.createElement(G,null))),g.a.createElement(k.a.Actions,{style:{justifyContent:"flex-end"}},g.a.createElement(z.a,{onPress:function(){i(w.g.reset()),e.onClose()}},"Cancel"),g.a.createElement(z.a,{onPress:h},"Manifest"))))}var K=t(487),X=t(36),ee=t(285);function ne(e){var n=e.hasPlanes,t=e.hasTicketTypes,l=(e.isPublic,Object(ee.a)());return v.createElement(X.b,{style:{width:"70%"}},v.createElement(X.a,{style:re.title},"Set up dropzone"),v.createElement(X.b,{style:re.separator,lightColor:"#eee",darkColor:"rgba(255,255,255,0.1)"}),v.createElement($.b.Item,{title:"Create dropzone",left:function(){return v.createElement($.b.Icon,{color:l.success,icon:"check"})}}),v.createElement($.b.Item,{title:"Add a plane",left:function(){return n?v.createElement($.b.Icon,{color:l.success,icon:"check"}):v.createElement($.b.Icon,{color:l.error,icon:"close"})}}),v.createElement($.b.Item,{title:"Configure jump tickets",left:function(){return t?v.createElement($.b.Icon,{color:l.success,icon:"check"}):v.createElement($.b.Icon,{color:l.error,icon:"close"})}}))}var te,le,re=h.a.create({container:{flex:1,alignItems:"center",justifyContent:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"}}),ae=t(111),ie=t(121),oe=t(371),ue=t(301),se=t(507),de=t(514),ce=Object(f.a)(te||(te=d()(["\n  query QueryDropzoneUsers(\n    $dropzoneId: Int!\n    $permissions: [Permission!]\n  ) {\n    dropzone(id: $dropzoneId) {\n      id\n      name\n\n      dropzoneUsers(permissions: $permissions) {\n        edges {\n          node {\n            id\n            role {\n              id\n              name\n            }\n            user {\n              id\n              name\n            }\n          }\n        }\n      }\n    }\n  }\n"])));function me(e){var n,t,l,r,a,i,o,s=Object(v.useState)(!1),d=u()(s,2),m=d[0],p=d[1],f=Object(w.k)((function(e){return e.global})),b=Object(c.useQuery)(ce,{variables:{dropzoneId:Number(null==(n=f.currentDropzone)?void 0:n.id),permissions:["actAsGCA"]}}).data;return Object(J.a)("updateLoad")?g.a.createElement(W.a,{onDismiss:function(){return p(!1)},visible:m,anchor:g.a.createElement(C.a,{mode:"outlined",icon:"radio-handheld",style:{marginHorizontal:4},onPress:function(){return p(!0)}},null!=(l=e.value)&&l.id?null==(r=e.value)?void 0:r.name:"No gca")},null==b||null==(a=b.dropzone)||null==(i=a.dropzoneUsers)||null==(o=i.edges)?void 0:o.map((function(n){var t,l,r;return g.a.createElement(W.a.Item,{key:"gca-chip-"+(null==n||null==(t=n.node)?void 0:t.id),onPress:function(){var t;p(!1),e.onSelect(null==n||null==(t=n.node)?void 0:t.user)},title:null==n||null==(l=n.node)||null==(r=l.user)?void 0:r.name})}))):g.a.createElement(C.a,{mode:"outlined",icon:"radio-handheld"},(null==(t=e.value)?void 0:t.name)||"No gca")}function pe(e){var n,t,l,r,a=Object(v.useState)(!1),i=u()(a,2),o=i[0],s=i[1],d=Object(J.a)("updateLoad");return d?g.a.createElement(W.a,{onDismiss:function(){return s(!1)},visible:o,anchor:g.a.createElement(C.a,{mode:"outlined",icon:"parachute",style:{marginHorizontal:4},onPress:function(){return d&&s(!0)}},null!=(t=e.value)&&t.id?null==(l=e.value)?void 0:l.name:"No loadmaster")},null==(r=e.slots)?void 0:r.map((function(n){var t;return g.a.createElement(W.a.Item,{key:"lm-chip-"+n.id,onPress:function(){s(!1),e.onSelect(n.user)},title:null==n||null==(t=n.user)?void 0:t.name})}))):g.a.createElement(C.a,{mode:"outlined",icon:"radio-handheld"},(null==(n=e.value)?void 0:n.name)||"No loadmaster")}var fe,ve=Object(f.a)(le||(le=d()(["\n  query QueryDropzoneUsers(\n    $dropzoneId: Int!\n    $permissions: [Permission!]\n  ) {\n    dropzone(id: $dropzoneId) {\n      id\n      name\n\n      dropzoneUsers(permissions: $permissions) {\n        edges {\n          node {\n            id\n            role {\n              id\n              name\n            }\n            user {\n              id\n              name\n            }\n          }\n        }\n      }\n    }\n  }\n"])));function ge(e){var n,t,l,r,a,i,o,s=Object(v.useState)(!1),d=u()(s,2),m=d[0],p=d[1],f=Object(w.k)((function(e){return e.global})),b=Object(c.useQuery)(ve,{variables:{dropzoneId:Number(null==(n=f.currentDropzone)?void 0:n.id),permissions:["actAsPilot"]}}).data;return Object(J.a)("updateLoad")?g.a.createElement(W.a,{onDismiss:function(){return p(!1)},visible:m,anchor:g.a.createElement(C.a,{mode:"outlined",icon:"airplane-takeoff",style:{marginHorizontal:4},onPress:function(){return p(!0)}},null!=(l=e.value)&&l.id?null==(r=e.value)?void 0:r.name:"No pilot")},null==b||null==(a=b.dropzone)||null==(i=a.dropzoneUsers)||null==(o=i.edges)?void 0:o.map((function(n){var t,l;return g.a.createElement(W.a.Item,{key:"pilot-select-"+n.node.id,onPress:function(){var t;p(!1),e.onSelect(null==n||null==(t=n.node)?void 0:t.user)},title:null==n||null==(t=n.node)||null==(l=t.user)?void 0:l.name})}))):g.a.createElement(C.a,{mode:"outlined",icon:"radio-handheld"},(null==(t=e.value)?void 0:t.name)||"No pilot")}var be,he,ye=Object(f.a)(fe||(fe=d()(["\n  query QueryPlanes(\n    $dropzoneId: Int!\n  ) {\n    planes(dropzoneId: $dropzoneId) {\n      id\n      name\n      registration\n      hours\n      minSlots\n      maxSlots\n      nextMaintenanceHours\n      createdAt\n    }\n  }\n"])));function Ee(e){var n,t,l,r,a=Object(v.useState)(!1),i=u()(a,2),o=i[0],s=i[1],d=Object(w.k)((function(e){return e.global})),m=Object(c.useQuery)(ye,{variables:{dropzoneId:Number(null==(n=d.currentDropzone)?void 0:n.id)}}).data,p=Object(J.a)("updateLoad");return p?g.a.createElement(W.a,{onDismiss:function(){return s(!1)},visible:o,anchor:g.a.createElement(C.a,{mode:"outlined",icon:"airplane",style:{marginHorizontal:4},onPress:function(){return p&&s(!0)}},(null==(l=e.value)?void 0:l.name)||"No plane")},null==m||null==(r=m.planes)?void 0:r.map((function(n){return g.a.createElement(W.a.Item,{key:"lm-plane-chip-"+n.id,onPress:function(){s(!1),e.onSelect(n)},title:n.name})}))):g.a.createElement(C.a,{mode:"outlined",icon:"airplane-takeoff"},(null==(t=e.value)?void 0:t.name)||"No plane")}var Ie=Object(c.gql)(be||(be=d()(["\n  query QueryLoad($id: Int!) {\n    load(id: $id) {\n      id\n      name\n      createdAt\n      dispatchAt\n      hasLanded\n      maxSlots\n      loadNumber\n      isFull\n      isOpen\n      plane {\n        id\n        name\n      }\n      gca {\n        id\n        user {\n          id\n          name\n        }\n      }\n      pilot {\n        id\n        user {\n          id\n          name\n        }\n      }\n      loadMaster {\n        id\n        user {\n          id\n          name\n        }\n      }\n      slots {\n        id\n        createdAt\n        exitWeight\n        passengerName\n        passengerExitWeight\n        user {\n          id\n          name\n        }\n        ticketType {\n          id\n          name\n          altitude\n          isTandem\n\n          extras {\n            id\n            name\n            cost\n          }\n        }\n        jumpType {\n          id\n          name\n        }\n        extras {\n          id\n          name\n        }\n      }\n    }\n  }\n"]))),Oe=Object(c.gql)(he||(he=d()(["\n  mutation UpdateLoad(\n    $id: Int!,\n    $pilotId: Int,\n    $gcaId: Int,\n    $planeId: Int,\n    $isOpen: Boolean,\n    $loadMasterId: Int,\n    $dispatchAt: Int,\n    $hasLanded: Boolean,\n  ){\n    updateLoad(input: {\n      id: $id\n      attributes: {\n        pilotId: $pilotId,\n        gcaId: $gcaId,\n        planeId: $planeId,\n        isOpen: $isOpen,\n        loadMasterId: $loadMasterId\n        dispatchAt: $dispatchAt\n        hasLanded: $hasLanded\n      }\n    }) {\n      load {\n        id\n        name\n        createdAt\n        loadNumber\n        dispatchAt\n        hasLanded\n        maxSlots\n        isFull\n        isOpen\n        plane {\n          id\n          name\n        }\n        gca {\n          id\n          user {\n            id\n            name\n          }\n        }\n        pilot {\n          id\n          user {\n            id\n            name\n          }\n        }\n        loadMaster {\n          id\n          user {\n            id\n            name\n          }\n        }\n        slots {\n          id\n          createdAt\n          exitWeight\n\n          passengerName\n          passengerExitWeight\n\n          user {\n            id\n            name\n          }\n          ticketType {\n            id\n            name\n            altitude\n            isTandem\n          }\n          jumpType {\n            id\n            name\n          }\n          extras {\n            id\n            name\n          }\n        }\n      }\n    }\n  }\n"])));function je(e){var n,t,l,r,a,i,o,s,d,p,f,g,b,h,y,I,O,S,k,T,N,P,$,C,F,D,A,U,M=Object(w.k)((function(e){return e.global})),L=Object(w.j)(),q=v.useState(!1),R=u()(q,2),Q=R[0],G=R[1],H=v.useState(!1),Y=u()(H,2),B=Y[0],V=Y[1],_=Object(J.a)("createUserSlot"),Z=Object(m.useNavigation)(),K=e.load,ee=(e.loadNumber,e.onManifest),ne=e.canManifest,te=Object(c.useQuery)(Ie,{variables:{id:Number(K.id)}}),le=te.data,re=te.loading,ce=Object(c.useMutation)(Oe),fe=u()(ce,2),ve=fe[0],be=fe[1],he=v.useCallback((function(e){return j.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,j.a.awrap(ve({variables:{id:Number(K.id),pilotId:Number(e.id)}}));case 3:n.next=7;break;case 5:n.prev=5,n.t0=n.catch(0);case 7:case"end":return n.stop()}}),null,null,[[0,5]],Promise)}),[ve,JSON.stringify(K)]),ye=v.useCallback((function(e){return j.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,j.a.awrap(ve({variables:{id:Number(K.id),gcaId:Number(e.id)}}));case 3:n.next=7;break;case 5:n.prev=5,n.t0=n.catch(0);case 7:case"end":return n.stop()}}),null,null,[[0,5]],Promise)}),[ve,JSON.stringify(K)]),je=v.useCallback((function(e){return j.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,j.a.awrap(ve({variables:{id:Number(K.id),planeId:Number(e.id)}}));case 3:n.next=7;break;case 5:n.prev=5,n.t0=n.catch(0);case 7:case"end":return n.stop()}}),null,null,[[0,5]],Promise)}),[ve,JSON.stringify(K)]),xe=v.useCallback((function(e){return j.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,j.a.awrap(ve({variables:{id:Number(K.id),loadMasterId:Number(e.id)}}));case 3:n.next=7;break;case 5:n.prev=5,n.t0=n.catch(0);case 7:case"end":return n.stop()}}),null,null,[[0,5]],Promise)}),[ve,JSON.stringify(K)]),Se=v.useCallback((function(e){var n;return j.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e?Object(se.a)(new Date,e).getTime()/1e3:null,t.prev=1,t.next=4,j.a.awrap(ve({variables:{id:Number(K.id),dispatchAt:n?Math.ceil(n):null}}));case 4:t.next=8;break;case 6:t.prev=6,t.t0=t.catch(1);case 8:case"end":return t.stop()}}),null,null,[[1,6]],Promise)}),[ve,JSON.stringify(K)]),ke=v.useCallback((function(){return j.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j.a.awrap(ve({variables:{id:Number(K.id),hasLanded:!0}}));case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:case"end":return e.stop()}}),null,null,[[0,5]],Promise)}),[ve,JSON.stringify(K)]),ze=Object(J.a)("updateLoad"),we=Object(J.a)("updateSlot"),Te=Object(J.a)("updateUserSlot");return v.useEffect((function(){var e,n;null!=le&&null!=(e=le.load)&&e.maxSlots&&(null==le||null==(n=le.load)?void 0:n.maxSlots)<5&&!Q&&G(!0)}),[null==le||null==(n=le.load)?void 0:n.maxSlots]),v.createElement(ae.a,{style:{margin:16},elevation:3},v.createElement(ae.a.Title,{style:{justifyContent:"space-between"},title:v.createElement(X.b,{style:{width:"100%",flex:1,flexDirection:"row",alignItems:"center",justifyContent:"space-between"}},v.createElement(X.a,null,"Load "+((null==le||null==(t=le.load)?void 0:t.loadNumber)||0)),v.createElement(X.b,{style:{flexGrow:1}}),!(null!=le&&null!=(l=le.load)&&l.hasLanded)&&(null==le||null==(r=le.load)?void 0:r.dispatchAt)&&(null==le?void 0:le.load.dispatchAt)<(new Date).getTime()/1e3&&_&&v.createElement(ie.a,{icon:"account-group",onPress:function(){var e;L(w.h.reset()),L(w.h.setField(["load",K])),Z.navigate("Users",{screen:"UsersScreen",params:{select:!0,loadId:null==le||null==(e=le.load)?void 0:e.id}})}})),subtitle:K.name}),v.createElement(E.a,{visible:re||be.loading,color:M.theme.colors.accent}),v.createElement(ae.a.Content,{style:{marginVertical:8,height:Q?void 0:300,overflow:"hidden"}},v.createElement(X.b,{style:{flexDirection:"row"}},v.createElement(x.a,{horizontal:!0},v.createElement(Ee,{dropzoneId:Number(null==(a=M.currentDropzone)?void 0:a.id),value:null==le||null==(i=le.load)?void 0:i.plane,onSelect:je}),v.createElement(me,{dropzoneId:Number(null==(o=M.currentDropzone)?void 0:o.id),value:null==le||null==(s=le.load)||null==(d=s.gca)?void 0:d.user,onSelect:ye}),v.createElement(ge,{dropzoneId:Number(null==(p=M.currentDropzone)?void 0:p.id),value:null==le||null==(f=le.load)||null==(g=f.pilot)?void 0:g.user,onSelect:he}),v.createElement(pe,{dropzoneId:Number(null==(b=M.currentDropzone)?void 0:b.id),value:null==le||null==(h=le.load)||null==(y=h.loadMaster)?void 0:y.user,slots:(null==le?void 0:le.load.slots)||[],onSelect:xe}))),v.createElement(oe.a,null,v.createElement(oe.a.Header,{style:{width:"100%"}},v.createElement(oe.a.Title,null,"Name"),v.createElement(oe.a.Title,{numeric:!0},"Exit weight"),v.createElement(oe.a.Title,{numeric:!0},"Jump type"),v.createElement(oe.a.Title,{numeric:!0},"Altitude")),null==le||null==(I=le.load)||null==(O=I.slots)?void 0:O.map((function(n){var t,l,r,a,i,o=null==le||null==(t=le.load)||null==(l=t.slots)?void 0:l.filter((function(e){return e.groupNumber===n.groupNumber}));return v.createElement(oe.a.Row,{key:"slot-"+n.id,onPress:function(){var t,l;(null==(t=n.user)?void 0:t.id)===(null==(l=M.currentUser)?void 0:l.id)?we&&(null!=o&&o.length?e.onSlotGroupPress(o):e.onSlotPress(n)):Te&&(null!=o&&o.length?e.onSlotGroupPress(o):e.onSlotPress(n))},pointerEvents:"none"},v.createElement(oe.a.Cell,null,null==n||null==(r=n.user)?void 0:r.name),v.createElement(oe.a.Cell,{numeric:!0},null==n?void 0:n.exitWeight),v.createElement(oe.a.Cell,{numeric:!0},null==n||null==(a=n.jumpType)?void 0:a.name),v.createElement(oe.a.Cell,{numeric:!0},null==n||null==(i=n.ticketType)?void 0:i.name))})),Array.from({length:((null==K?void 0:K.maxSlots)||0)-((null==K||null==(S=K.slots)?void 0:S.length)||0)},(function(e,n){return n})).map((function(e){return v.createElement(oe.a.Row,{key:K.id+"-empty-slot-"+e},v.createElement(oe.a.Cell,null,"- Available -"),v.createElement(oe.a.Cell,{numeric:!0},"-"),v.createElement(oe.a.Cell,{numeric:!0},"-"),v.createElement(oe.a.Cell,{numeric:!0},"-"))})))),!(null==le||null==(k=le.load)||!k.dispatchAt)&&(null==le||null==(T=le.load)?void 0:T.dispatchAt)>(new Date).getTime()/1e3&&v.createElement(X.b,{style:{flex:1,backgroundColor:"#FF8800",padding:8}},v.createElement(ue.a,null,"Take-off in "+Object(de.a)(new Date,1e3*(null==le||null==(N=le.load)?void 0:N.dispatchAt))+" min")),v.createElement(ae.a.Actions,null,null!=le&&null!=(P=le.load)&&P.maxSlots&&(null==le||null==($=le.load)?void 0:$.maxSlots)<5?null:v.createElement(z.a,{onPress:function(){return G(!Q)}},Q?"Show less":"Show more"),v.createElement(X.b,{style:{flexGrow:1}}),!ze||null!=le&&null!=(C=le.load)&&C.hasLanded?null:null!=le&&null!=(F=le.load)&&F.dispatchAt?v.createElement(z.a,{mode:"outlined",onPress:function(){return Se(null)}},"Cancel"):v.createElement(W.a,{onDismiss:function(){return V(!1)},visible:B,anchor:v.createElement(z.a,{mode:"outlined",onPress:function(){return V(!0)}},"Dispatch")},v.createElement(W.a.Item,{onPress:function(){V(!1),Se(20)},title:"20 minute call"}),v.createElement(W.a.Item,{onPress:function(){V(!1),Se(15)},title:"15 minute call"}),v.createElement(W.a.Item,{onPress:function(){V(!1),Se(10)},title:"10 minute call"}),v.createElement(W.a.Item,{onPress:function(){V(!1),Se(5)},title:"5 minute call"})),null!=le&&null!=(D=le.load)&&D.hasLanded?null:null!=le&&null!=(A=le.load)&&A.dispatchAt&&(null==le?void 0:le.load.dispatchAt)<(new Date).getTime()/1e3&&ze?v.createElement(z.a,{style:{marginLeft:8},mode:"contained",onPress:function(){return ke()}},"Mark as landed"):v.createElement(z.a,{style:{marginLeft:8},mode:"contained",onPress:function(){return ee()},disabled:!ne||Boolean((null==le||null==(U=le.load)?void 0:U.dispatchAt)&&le.load.dispatchAt<(new Date).getTime()/1e3)},"Manifest")))}var xe;h.a.create({container:{flex:1,alignItems:"center",justifyContent:"center",marginVertical:8},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fab:{position:"absolute",margin:16,right:0,bottom:0}});function Se(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);n&&(l=l.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,l)}return t}function ke(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Se(Object(t),!0).forEach((function(n){i()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Se(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var ze=Object(f.a)(xe||(xe=d()(["\n  query QueryDropzone($dropzoneId: Int!, $earliestTimestamp: Int) {\n    dropzone(id: $dropzoneId) {\n      id\n      name\n      primaryColor,\n      secondaryColor,\n      planes {\n        id\n        name\n        registration\n      }\n      ticketTypes {\n        id\n        name\n      }\n\n      currentUser {\n        id\n        hasCredits\n        hasExitWeight\n        hasMembership\n        hasReserveInDate\n        hasRigInspection\n        hasLicense\n\n        transactions {\n          edges {\n            node {\n              id\n              status\n              amount\n            }\n          }\n        }\n\n        user {\n          id\n          name\n          exitWeight\n          email\n          phone\n\n          rigs {\n            id\n            model\n            make\n            serial\n            canopySize\n            repackExpiresAt\n          }\n          jumpTypes {\n            id\n            name\n          }\n          license {\n            id\n            name\n          }\n        }\n      }\n\n      loads(earliestTimestamp: $earliestTimestamp) {\n        edges {\n          node {\n            id\n            name\n            loadNumber\n            isOpen\n            maxSlots\n            isFull\n          }\n        }\n      }\n    }\n  }\n"])));function we(){var e,n,t,l,r,a,i,o,s,d,f,g,h,O,j=Object(w.k)((function(e){return e.global})),x=v.useState(!1),S=u()(x,2),k=S[0],z=S[1],T=Object(w.j)(),N=Object(c.useQuery)(ze,{variables:{dropzoneId:Number(null==(e=j.currentDropzone)?void 0:e.id),earliestTimestamp:Object(p.a)(new Date).getTime()/1e3},fetchPolicy:"no-cache"}),P=N.data,$=N.loading,C=N.refetch,F=Object(m.useNavigation)(),D=Object(m.useIsFocused)();v.useEffect((function(){D&&C()}),[D]);var A=!(null==P||null==(n=P.dropzone)||null==(t=n.planes)||!t.length),W=!(null==P||null==(l=P.dropzone)||null==(r=l.ticketTypes)||!r.length),U=!(null==P||null==(a=P.dropzone)||!a.isPublic),M=A&&W;v.useEffect((function(){var e,n;null!=P&&null!=(e=P.dropzone)&&e.id&&(T(w.c.setDropzone(P.dropzone)),T(w.c.setUser(ke(ke({},null==j?void 0:j.currentUser),(null==P||null==(n=P.dropzone)?void 0:n.currentUser.user)||{}))))}),[JSON.stringify(null==P?void 0:P.dropzone)]),v.useEffect((function(){var e,n,t,l,r,a,i,o;null!=P&&null!=(e=P.dropzone)&&e.primaryColor&&(null==P||null==(n=P.dropzone)?void 0:n.primaryColor)!==(null==(t=j.theme)||null==(l=t.colors)?void 0:l.primary)&&T(w.c.setPrimaryColor(P.dropzone.primaryColor)),null!=P&&null!=(r=P.dropzone)&&r.secondaryColor&&(null==P||null==(a=P.dropzone)?void 0:a.secondaryColor)!==(null==(i=j.theme)||null==(o=i.colors)?void 0:o.accent)&&T(w.c.setPrimaryColor(P.dropzone.secondaryColor))}),[null==P||null==(i=P.dropzone)?void 0:i.primaryColor,null==P||null==(o=P.dropzone)?void 0:o.secondaryColor]);var L=Object(J.a)("createSlot"),q=Object(J.a)("createLoad"),R=v.useCallback((function(e){var n=P.dropzone.currentUser;return n.hasLicense?n.hasMembership?n.hasRigInspection?n.hasReserveInDate?n.hasExitWeight?n.hasCredits?(T(w.g.setField(["user",j.currentUser])),T(w.g.setField(["load",e])),void z(!0)):T(w.i.showSnackbar({message:"You have no credits on your account",variant:"warning"})):T(w.i.showSnackbar({message:"Update your exit weight on your profile before manifesting",variant:"warning"})):T(w.i.showSnackbar({message:"Your rig needs a reserve repack",variant:"warning"})):T(w.i.showSnackbar({message:"Your rig needs to be inspected before manifesting",variant:"warning"})):T(w.i.showSnackbar({message:"Your membership is out of date",variant:"warning"})):T(w.i.showSnackbar({message:"You need to select a license on your user profile",variant:"warning"}))}),[JSON.stringify(null==P||null==(s=P.dropzone)?void 0:s.currentUser)]);return v.createElement(v.Fragment,null,v.createElement(Z,{open:k,onClose:function(){return z(!1)},onSuccess:function(){return z(!1)}}),v.createElement(E.a,{visible:$,indeterminate:!0,color:j.theme.colors.accent}),v.createElement(X.b,{style:Te.container},!$&&(M?v.createElement(X.b,{style:{width:"100%",flex:1,height:b.a.get("window").height}},((null==P||null==(d=P.dropzone)||null==(f=d.loads)||null==(g=f.edges)?void 0:g.length)||0)<1?v.createElement(K.a,{title:"No loads so far today",subtitle:"How's the weather?"}):v.createElement(y.a,{style:{flex:1,height:b.a.get("window").height},contentContainerStyle:{flexGrow:1},numColumns:1,data:(null==P||null==(h=P.dropzone)||null==(O=h.loads)?void 0:O.edges)||[],refreshing:$,onRefresh:C,renderItem:function(e){var n,t,l,r,a,i=e.item,o=e.index;return null!=i&&i.node?v.createElement(je,{key:"load-"+i.node.id,load:i.node,canManifest:L&&(null==i||null==(n=i.node)?void 0:n.isOpen)&&!(null!=i&&null!=(t=i.node)&&t.isFull),loadNumber:((null==P||null==(l=P.dropzone)||null==(r=l.loads)||null==(a=r.edges)?void 0:a.length)||0)-o,onSlotPress:function(e){T(w.g.setOriginal(e)),T(w.g.setField(["load",i.node])),z(!0)},onSlotGroupPress:function(e){T(w.h.reset()),T(w.h.setFromSlots(e)),T(w.h.setField(["load",i.node])),F.navigate("ManifestGroupScreen")},onManifest:function(){return R(i.node)}}):null}})):v.createElement(ne,{hasPlanes:A,hasTicketTypes:W,isPublic:U})),q&&M&&v.createElement(I.a,{style:Te.fab,small:!0,icon:"plus",onPress:function(){return F.navigate("CreateLoadScreen")},label:"New load"})))}var Te=h.a.create({container:{flex:1,alignItems:"center",justifyContent:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fab:{position:"absolute",margin:16,right:0,bottom:0}})}}]);
//# sourceMappingURL=10.2b940382.chunk.js.map