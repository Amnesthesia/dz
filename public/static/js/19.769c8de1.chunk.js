(this.webpackJsonp=this.webpackJsonp||[]).push([[19],{482:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(143),l=n(256),i=a.a.actions;l.a},498:function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var a,l=n(22),i=n.n(l),r=n(9),s=n.n(r),o=n(71),u=n.n(o),d=n(49),c=n(72),f=n(0),m=n(1),v=n(2),g=n(249),p=n(221),b=n(165),h=n(52),k=n(222),E=n(303),y=n(20),w=n(228).a.actions,T=Object(c.a)(a||(a=u()(["\n  query QueryExtras(\n    $dropzoneId: Int!\n  ) {\n    extras(dropzoneId: $dropzoneId) {\n      id\n      cost\n      name\n\n      ticketTypes {\n        id\n        name\n      }\n    }\n  }\n"])));function S(){var e,t,n,a,l,r=Object(y.k)((function(e){return e.ticketTypeForm})),o=Object(y.j)(),u=Object(y.k)((function(e){return e.global})),c=f.useState(!1),m=s()(c,2),S=m[0],F=m[1],I=Object(d.useQuery)(T,{variables:{dropzoneId:Number(null==(e=u.currentDropzone)?void 0:e.id)}}),O=I.data;I.loading,I.refetch;return f.createElement(f.Fragment,null,f.createElement(g.a,{style:x.field,mode:"outlined",label:"Name",error:!!r.fields.name.error,value:r.fields.name.value||"",onChangeText:function(e){return o(w.setField(["name",e]))}}),f.createElement(p.a,{type:r.fields.name.error?"error":"info"},r.fields.name.error||"Name of the ticket users will see"),f.createElement(g.a,{style:x.field,mode:"outlined",label:"Price",error:!!r.fields.cost.error,value:null==(t=r.fields.cost)||null==(n=t.value)?void 0:n.toString(),onChangeText:function(e){return o(w.setField(["cost",Number(e)]))}}),f.createElement(p.a,{type:r.fields.cost.error?"error":"info"},r.fields.cost.error||"Base cost without extra ticket addons"),f.createElement(v.a,{style:{width:"100%"}},f.createElement(b.a,{onDismiss:function(){return F(!1)},visible:S,style:{position:"absolute",right:"10%",left:"10%",flex:1},anchor:f.createElement(h.b.Item,{onPress:function(){F(!0)},title:r.fields.altitude.value&&[4e3,14e3].includes(r.fields.altitude.value)?{14e3:"Height",4e3:"Hop n Pop"}[r.fields.altitude.value.toString()]:"Custom",style:{width:"100%",flex:1},right:function(){return f.createElement(h.b.Icon,{icon:r.fields.altitude.value&&[4e3,14e3].includes(r.fields.altitude.value)?{14e3:"airplane",4e3:"parachute"}[r.fields.altitude.value.toString()]:"pencil-plus"})}})},f.createElement(h.b.Item,{onPress:function(){o(w.setField(["altitude",4e3])),F(!1)},title:"Hop n Pop",right:function(){return f.createElement(h.b.Icon,{icon:"parachute"})}}),f.createElement(h.b.Item,{onPress:function(){o(w.setField(["altitude",14e3])),F(!1)},title:"Height",right:function(){return f.createElement(h.b.Icon,{icon:"airplane-takeoff"})}}),f.createElement(h.b.Item,{onPress:function(){o(w.setField(["altitude",7e3])),F(!1)},title:"Other",right:function(){return f.createElement(h.b.Icon,{icon:"parachute"})}})),(!r.fields.altitude.value||![4e3,14e3].includes(r.fields.altitude.value))&&f.createElement(g.a,{style:x.field,mode:"outlined",label:"Custom altitude",error:!!r.fields.altitude.error,value:null==(a=r.fields.altitude)||null==(l=a.value)?void 0:l.toString(),onChangeText:function(e){return o(w.setField(["altitude",Number(e)]))}}),f.createElement(k.a.Item,{label:"Tandem",style:{width:"100%"},status:r.fields.isTandem.value?"checked":"unchecked",onPress:function(){return o(w.setField(["isTandem",!r.fields.isTandem.value]))}}),f.createElement(p.a,{type:r.fields.isTandem.error?"error":"info"},r.fields.isTandem.error||"Allow also manifesting a passenger when using this ticket type"),f.createElement(k.a.Item,{label:"Public manifesting",style:{width:"100%"},status:r.fields.allowManifestingSelf.value?"checked":"unchecked",onPress:function(){return o(w.setField(["allowManifestingSelf",!r.fields.allowManifestingSelf.value]))}}),f.createElement(p.a,{type:r.fields.allowManifestingSelf.error?"error":"info"},r.fields.allowManifestingSelf.error||"Allow users to manifest themselves with this ticket"),f.createElement(E.a,null),f.createElement(h.b.Subheader,null,"Enabled ticket add-ons"),null==O?void 0:O.extras.map((function(e){var t;return f.createElement(k.a.Item,{key:"extra-"+e.id,label:e.name,status:null!=(t=r.fields.extras.value)&&t.map((function(e){return e.id})).includes(e.id)?"checked":"unchecked",onPress:function(){var t,n;return o(w.setField(["extras",null!=(t=r.fields.extras.value)&&t.map((function(e){return e.id})).includes(e.id)?null==(n=r.fields.extras.value)?void 0:n.filter((function(t){return t.id!==e.id})):[].concat(i()(r.fields.extras.value),[e])]))}})}))))}var x=m.a.create({field:{marginBottom:8,width:"100%"}})},526:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return x}));var a,l=n(9),i=n.n(l),r=n(71),s=n.n(r),o=n(11),u=n.n(o),d=n(0),c=n(1),f=n(116),m=n(49),v=n(20),g=n(36),p=n(482),b=n(112),h=n(228),k=n(498),E=n(40),y=n(351),w=n(169),T=h.a.actions,S=(b.a.actions,Object(m.gql)(a||(a=s()(["\n  mutation UpdateTicketType(\n    $id: Int!,\n    $name: String,\n    $cost: Float,\n    $altitude: Int\n    $allowManifestingSelf: Boolean\n    $isTandem: Boolean\n  ){\n    updateTicketType(input: {\n      id: $id\n      attributes: {\n        name: $name,\n        cost: $cost,\n        altitude: $altitude\n        allowManifestingSelf: $allowManifestingSelf\n        isTandem: $isTandem\n      }\n    }) {\n      ticketType {\n        id\n        name\n        altitude\n        cost\n        allowManifestingSelf\n        extras {\n          id\n          name\n          cost\n        }\n      }\n    }\n  }\n"]))));function x(){var e=Object(v.k)((function(e){return e})),t=e.ticketTypeForm,n=(e.global,Object(v.j)()),a=Object(E.useNavigation)(),l=Object(E.useRoute)().params.ticketType;d.useEffect((function(){n(T.setOriginal(l))}),[null==l?void 0:l.id]);var r=Object(m.useMutation)(S),s=i()(r,2),o=s[0],c=s[1],b=d.useCallback((function(){var e=!1;return(!t.fields.name.value||t.fields.name.value.length<3)&&(e=!0,n(T.setFieldError(["name","Name is too short"]))),t.fields.cost.value<1&&(e=!0,n(T.setFieldError(["cost","Cost must be at least $1"]))),t.fields.altitude.value||(e=!0,n(T.setFieldError(["altitude","Altitude must be specified"]))),!e}),[JSON.stringify(t.fields),n]),h=d.useCallback((function(){var e,l,i,r,s,d,c,f,m,g,h,k,E,y,w,S,x,F,I;return u.a.async((function(O){for(;;)switch(O.prev=O.next){case 0:if(e=t.fields,l=e.name,i=e.cost,r=e.allowManifestingSelf,s=e.altitude,d=e.extras,c=e.isTandem,!b()){O.next=15;break}return O.prev=2,O.next=5,u.a.awrap(o({variables:{id:Number(t.original.id),name:l.value,cost:i.value,altitude:s.value,allowManifestingSelf:r.value,extraIds:null==d||null==(f=d.value)?void 0:f.map((function(e){return e.id})),isTandem:!!c.value}}));case 5:if(null==(x=O.sent)||null==(m=x.data)||null==(g=m.updateTicketType)||null==(h=g.fieldErrors)||h.map((function(e){var t=e.field,a=e.message;switch(t){case"name":return n(T.setFieldError(["name",a]));case"altitude":return n(T.setFieldError(["altitude",a]));case"cost":return n(T.setFieldError(["cost",a]));case"allow_manifesting_self":return n(T.setFieldError(["allowManifestingSelf",a]));case"extras":return n(T.setFieldError(["extras",a]))}})),null==x||null==(k=x.data)||null==(E=k.updateTicketType)||null==(y=E.errors)||!y.length){O.next=9;break}return O.abrupt("return",n(v.i.showSnackbar({message:null==x||null==(F=x.data)||null==(I=F.updateTicketType)?void 0:I.errors[0],variant:"error"})));case 9:null!=(w=x.data)&&null!=(S=w.updateTicketType)&&S.ticketType&&(n(p.a.showSnackbar({message:"Saved",variant:"success"})),a.goBack()),O.next=15;break;case 12:O.prev=12,O.t0=O.catch(2),n(p.a.showSnackbar({message:O.t0.message,variant:"error"}));case 15:case"end":return O.stop()}}),null,null,[[2,12]],Promise)}),[JSON.stringify(t.fields),n,o]);return d.createElement(w.a,{contentContainerStyle:{paddingHorizontal:48}},d.createElement(y.a,{name:"ticket",size:100,color:"#999999",style:{alignSelf:"center"}}),d.createElement(k.a,null),d.createElement(g.b,{style:F.fields},d.createElement(f.a,{mode:"contained",disabled:c.loading,onPress:h,loading:c.loading},"Save")))}var F=c.a.create({container:{flex:1,alignItems:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fields:{width:"100%",marginVertical:16},field:{marginBottom:8}})}}]);
//# sourceMappingURL=19.769c8de1.chunk.js.map